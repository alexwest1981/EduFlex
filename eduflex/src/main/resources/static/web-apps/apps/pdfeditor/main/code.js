/* minified by terser */
if(void 0===Common)var Common={};void 0===Common.define&&(Common.define={}),define("common/main/lib/util/define",[],(function(){"use strict";Common.define.c_oAscMathMainType={Symbol:0,Fraction:1,Script:2,Radical:3,Integral:4,LargeOperator:5,Bracket:6,Function:7,Accent:8,LimitLog:9,Operator:10,Matrix:11},Common.define.c_oAscMathType={Symbol_pm:0,Symbol_infinity:1,Symbol_equals:2,Symbol_neq:3,Symbol_about:4,Symbol_times:5,Symbol_div:6,Symbol_factorial:7,Symbol_propto:8,Symbol_less:9,Symbol_ll:10,Symbol_greater:11,Symbol_gg:12,Symbol_leq:13,Symbol_geq:14,Symbol_mp:15,Symbol_cong:16,Symbol_approx:17,Symbol_equiv:18,Symbol_forall:19,Symbol_additional:20,Symbol_partial:21,Symbol_sqrt:22,Symbol_cbrt:23,Symbol_qdrt:24,Symbol_cup:25,Symbol_cap:26,Symbol_emptyset:27,Symbol_percent:28,Symbol_degree:29,Symbol_fahrenheit:30,Symbol_celsius:31,Symbol_inc:32,Symbol_nabla:33,Symbol_exists:34,Symbol_notexists:35,Symbol_in:36,Symbol_ni:37,Symbol_leftarrow:38,Symbol_uparrow:39,Symbol_rightarrow:40,Symbol_downarrow:41,Symbol_leftrightarrow:42,Symbol_therefore:43,Symbol_plus:44,Symbol_minus:45,Symbol_not:46,Symbol_ast:47,Symbol_bullet:48,Symbol_vdots:49,Symbol_cdots:50,Symbol_rddots:51,Symbol_ddots:52,Symbol_aleph:53,Symbol_beth:54,Symbol_QED:55,Symbol_alpha:65536,Symbol_beta:65537,Symbol_gamma:65538,Symbol_delta:65539,Symbol_varepsilon:65540,Symbol_epsilon:65541,Symbol_zeta:65542,Symbol_eta:65543,Symbol_theta:65544,Symbol_vartheta:65545,Symbol_iota:65546,Symbol_kappa:65547,Symbol_lambda:65548,Symbol_mu:65549,Symbol_nu:65550,Symbol_xsi:65551,Symbol_o:65552,Symbol_pi:65553,Symbol_varpi:65554,Symbol_rho:65555,Symbol_varrho:65556,Symbol_sigma:65557,Symbol_varsigma:65558,Symbol_tau:65559,Symbol_upsilon:65560,Symbol_varphi:65561,Symbol_phi:65562,Symbol_chi:65563,Symbol_psi:65564,Symbol_omega:65565,Symbol_Alpha:131072,Symbol_Beta:131073,Symbol_Gamma:131074,Symbol_Delta:131075,Symbol_Epsilon:131076,Symbol_Zeta:131077,Symbol_Eta:131078,Symbol_Theta:131079,Symbol_Iota:131080,Symbol_Kappa:131081,Symbol_Lambda:131082,Symbol_Mu:131083,Symbol_Nu:131084,Symbol_Xsi:131085,Symbol_O:131086,Symbol_Pi:131087,Symbol_Rho:131088,Symbol_Sigma:131089,Symbol_Tau:131090,Symbol_Upsilon:131091,Symbol_Phi:131092,Symbol_Chi:131093,Symbol_Psi:131094,Symbol_Omega:131095,FractionVertical:16777216,FractionDiagonal:16777217,FractionHorizontal:16777218,FractionSmall:16777219,FractionDifferential_1:16842752,FractionDifferential_2:16842753,FractionDifferential_3:16842754,FractionDifferential_4:16842755,FractionPi_2:16842756,ScriptSup:33554432,ScriptSub:33554433,ScriptSubSup:33554434,ScriptSubSupLeft:33554435,ScriptCustom_1:33619968,ScriptCustom_2:33619969,ScriptCustom_3:33619970,ScriptCustom_4:33619971,RadicalSqrt:50331648,RadicalRoot_n:50331649,RadicalRoot_2:50331650,RadicalRoot_3:50331651,RadicalCustom_1:50397184,RadicalCustom_2:50397185,Integral:67108864,IntegralSubSup:67108865,IntegralCenterSubSup:67108866,IntegralDouble:67108867,IntegralDoubleSubSup:67108868,IntegralDoubleCenterSubSup:67108869,IntegralTriple:67108870,IntegralTripleSubSup:67108871,IntegralTripleCenterSubSup:67108872,IntegralOriented:67174400,IntegralOrientedSubSup:67174401,IntegralOrientedCenterSubSup:67174402,IntegralOrientedDouble:67174403,IntegralOrientedDoubleSubSup:67174404,IntegralOrientedDoubleCenterSubSup:67174405,IntegralOrientedTriple:67174406,IntegralOrientedTripleSubSup:67174407,IntegralOrientedTripleCenterSubSup:67174408,Integral_dx:67239936,Integral_dy:67239937,Integral_dtheta:67239938,LargeOperator_Sum:83886080,LargeOperator_Sum_CenterSubSup:83886081,LargeOperator_Sum_SubSup:83886082,LargeOperator_Sum_CenterSub:83886083,LargeOperator_Sum_Sub:83886084,LargeOperator_Prod:83951616,LargeOperator_Prod_CenterSubSup:83951617,LargeOperator_Prod_SubSup:83951618,LargeOperator_Prod_CenterSub:83951619,LargeOperator_Prod_Sub:83951620,LargeOperator_CoProd:83951621,LargeOperator_CoProd_CenterSubSup:83951622,LargeOperator_CoProd_SubSup:83951623,LargeOperator_CoProd_CenterSub:83951624,LargeOperator_CoProd_Sub:83951625,LargeOperator_Union:84017152,LargeOperator_Union_CenterSubSup:84017153,LargeOperator_Union_SubSup:84017154,LargeOperator_Union_CenterSub:84017155,LargeOperator_Union_Sub:84017156,LargeOperator_Intersection:84017157,LargeOperator_Intersection_CenterSubSup:84017158,LargeOperator_Intersection_SubSup:84017159,LargeOperator_Intersection_CenterSub:84017160,LargeOperator_Intersection_Sub:84017161,LargeOperator_Disjunction:84082688,LargeOperator_Disjunction_CenterSubSup:84082689,LargeOperator_Disjunction_SubSup:84082690,LargeOperator_Disjunction_CenterSub:84082691,LargeOperator_Disjunction_Sub:84082692,LargeOperator_Conjunction:84082693,LargeOperator_Conjunction_CenterSubSup:84082694,LargeOperator_Conjunction_SubSup:84082695,LargeOperator_Conjunction_CenterSub:84082696,LargeOperator_Conjunction_Sub:84082697,LargeOperator_Custom_1:84148224,LargeOperator_Custom_2:84148225,LargeOperator_Custom_3:84148226,LargeOperator_Custom_4:84148227,LargeOperator_Custom_5:84148228,Bracket_Round:100663296,Bracket_Square:100663297,Bracket_Curve:100663298,Bracket_Angle:100663299,Bracket_LowLim:100663300,Bracket_UppLim:100663301,Bracket_Line:100663302,Bracket_LineDouble:100663303,Bracket_Square_OpenOpen:100663304,Bracket_Square_CloseClose:100663305,Bracket_Square_CloseOpen:100663306,Bracket_SquareDouble:100663307,Bracket_Round_Delimiter_2:100728832,Bracket_Curve_Delimiter_2:100728833,Bracket_Angle_Delimiter_2:100728834,Bracket_Angle_Delimiter_3:100728835,Bracket_Round_OpenNone:100794368,Bracket_Round_NoneOpen:100794369,Bracket_Square_OpenNone:100794370,Bracket_Square_NoneOpen:100794371,Bracket_Curve_OpenNone:100794372,Bracket_Curve_NoneOpen:100794373,Bracket_Angle_OpenNone:100794374,Bracket_Angle_NoneOpen:100794375,Bracket_LowLim_OpenNone:100794376,Bracket_LowLim_NoneNone:100794377,Bracket_UppLim_OpenNone:100794378,Bracket_UppLim_NoneOpen:100794379,Bracket_Line_OpenNone:100794380,Bracket_Line_NoneOpen:100794381,Bracket_LineDouble_OpenNone:100794382,Bracket_LineDouble_NoneOpen:100794383,Bracket_SquareDouble_OpenNone:100794384,Bracket_SquareDouble_NoneOpen:100794385,Bracket_Custom_1:100859904,Bracket_Custom_2:100859905,Bracket_Custom_3:100859906,Bracket_Custom_4:100859907,Bracket_Custom_5:100925440,Bracket_Custom_6:100925441,Bracket_Custom_7:100925442,Function_Sin:117440512,Function_Cos:117440513,Function_Tan:117440514,Function_Csc:117440515,Function_Sec:117440516,Function_Cot:117440517,Function_1_Sin:117506048,Function_1_Cos:117506049,Function_1_Tan:117506050,Function_1_Csc:117506051,Function_1_Sec:117506052,Function_1_Cot:117506053,Function_Sinh:117571584,Function_Cosh:117571585,Function_Tanh:117571586,Function_Csch:117571587,Function_Sech:117571588,Function_Coth:117571589,Function_1_Sinh:117637120,Function_1_Cosh:117637121,Function_1_Tanh:117637122,Function_1_Csch:117637123,Function_1_Sech:117637124,Function_1_Coth:117637125,Function_Custom_1:117702656,Function_Custom_2:117702657,Function_Custom_3:117702658,Accent_Dot:134217728,Accent_DDot:134217729,Accent_DDDot:134217730,Accent_Hat:134217731,Accent_Check:134217732,Accent_Accent:134217733,Accent_Grave:134217734,Accent_Smile:134217735,Accent_Tilde:134217736,Accent_Bar:134217737,Accent_DoubleBar:134217738,Accent_CurveBracketTop:134217739,Accent_CurveBracketBot:134217740,Accent_GroupTop:134217741,Accent_GroupBot:134217742,Accent_ArrowL:134217743,Accent_ArrowR:134217744,Accent_ArrowD:134217745,Accent_HarpoonL:134217746,Accent_HarpoonR:134217747,Accent_BorderBox:134283264,Accent_BorderBoxCustom:134283265,Accent_BarTop:134348800,Accent_BarBot:134348801,Accent_Custom_1:134414336,Accent_Custom_2:134414337,Accent_Custom_3:134414338,LimitLog_LogBase:150994944,LimitLog_Log:150994945,LimitLog_Lim:150994946,LimitLog_Min:150994947,LimitLog_Max:150994948,LimitLog_Ln:150994949,LimitLog_Custom_1:151060480,LimitLog_Custom_2:151060481,Operator_ColonEquals:167772160,Operator_EqualsEquals:167772161,Operator_PlusEquals:167772162,Operator_MinusEquals:167772163,Operator_Definition:167772164,Operator_UnitOfMeasure:167772165,Operator_DeltaEquals:167772166,Operator_ArrowL_Top:167837696,Operator_ArrowR_Top:167837697,Operator_ArrowL_Bot:167837698,Operator_ArrowR_Bot:167837699,Operator_DoubleArrowL_Top:167837700,Operator_DoubleArrowR_Top:167837701,Operator_DoubleArrowL_Bot:167837702,Operator_DoubleArrowR_Bot:167837703,Operator_ArrowD_Top:167837704,Operator_ArrowD_Bot:167837705,Operator_DoubleArrowD_Top:167837706,Operator_DoubleArrowD_Bot:167837707,Operator_Custom_1:167903232,Operator_Custom_2:167903233,Matrix_1_2:184549376,Matrix_2_1:184549377,Matrix_1_3:184549378,Matrix_3_1:184549379,Matrix_2_2:184549380,Matrix_2_3:184549381,Matrix_3_2:184549382,Matrix_3_3:184549383,Matrix_Dots_Center:184614912,Matrix_Dots_Baseline:184614913,Matrix_Dots_Vertical:184614914,Matrix_Dots_Diagonal:184614915,Matrix_Identity_2:184680448,Matrix_Identity_2_NoZeros:184680449,Matrix_Identity_3:184680450,Matrix_Identity_3_NoZeros:184680451,Matrix_2_2_RoundBracket:184745984,Matrix_2_2_SquareBracket:184745985,Matrix_2_2_LineBracket:184745986,Matrix_2_2_DLineBracket:184745987,Matrix_Flat_Round:184811520,Matrix_Flat_Square:184811521},Common.define.chartData=_.extend(new function(){return{textLine:"Line",textColumn:"Column",textBar:"Bar",textArea:"Area",textPie:"Pie",textPoint:"XY (Scatter)",textStock:"Stock",textSurface:"Surface",textCharts:"Charts",textSparks:"Sparklines",textLineSpark:"Line",textColumnSpark:"Column",textWinLossSpark:"Win/Loss",textCombo:"Combo",textBarNormal:"Clustered column",textBarStacked:"Stacked column",textBarStackedPer:"100% Stacked column",textBarNormal3d:"3-D Clustered column",textBarStacked3d:"3-D Stacked column",textBarStackedPer3d:"3-D 100% Stacked column",textBarNormal3dPerspective:"3-D column",textLineStacked:"Stacked line",textLineStackedPer:"100% Stacked line",textLineMarker:"Line with markers",textLineStackedMarker:"Stacked line with markers",textLineStackedPerMarker:"100% Stacked line with markers",textLine3d:"3-D line",textDoughnut:"Doughnut",textPie3d:"3-D pie",textHBarNormal:"Clustered bar",textHBarStacked:"Stacked bar",textHBarStackedPer:"100% Stacked bar",textHBarNormal3d:"3-D Clustered bar",textHBarStacked3d:"3-D Stacked bar",textHBarStackedPer3d:"3-D 100% Stacked bar",textAreaStacked:"Stacked area",textAreaStackedPer:"100% Stacked area",textScatter:"Scatter",textScatterSmoothMarker:"Scatter with smooth lines and markers",textScatterSmooth:"Scatter with smooth lines",textScatterLineMarker:"Scatter with straight lines and markers",textScatterLine:"Scatter with straight lines",textComboBarLine:"Clustered column - line",textComboBarLineSecondary:"Clustered column - line on secondary axis",textComboAreaBar:"Stacked area - clustered column",textComboCustom:"Custom combination",textRadar:"Radar",textRadarMarker:"Radar with markers",textRadarFilled:"Filled radar",getChartGroupData:function(t){return[{id:"menu-chart-group-bar",caption:this.textColumn,headername:t?this.textCharts:void 0},{id:"menu-chart-group-line",caption:this.textLine},{id:"menu-chart-group-pie",caption:this.textPie},{id:"menu-chart-group-hbar",caption:this.textBar},{id:"menu-chart-group-area",caption:this.textArea,inline:!0},{id:"menu-chart-group-stock",caption:this.textStock,inline:!0},{id:"menu-chart-group-scatter",caption:this.textPoint},{id:"menu-chart-group-radar",caption:this.textRadar},{id:"menu-chart-group-combo",caption:this.textCombo}]},getChartData:function(){return[{group:"menu-chart-group-bar",type:Asc.c_oAscChartTypeSettings.barNormal,iconCls:"column-normal",tip:this.textBarNormal},{group:"menu-chart-group-bar",type:Asc.c_oAscChartTypeSettings.barStacked,iconCls:"column-stack",tip:this.textBarStacked},{group:"menu-chart-group-bar",type:Asc.c_oAscChartTypeSettings.barStackedPer,iconCls:"column-pstack",tip:this.textBarStackedPer},{group:"menu-chart-group-bar",type:Asc.c_oAscChartTypeSettings.barNormal3d,iconCls:"column-3d-normal",tip:this.textBarNormal3d,is3d:!0},{group:"menu-chart-group-bar",type:Asc.c_oAscChartTypeSettings.barStacked3d,iconCls:"column-3d-stack",tip:this.textBarStacked3d,is3d:!0},{group:"menu-chart-group-bar",type:Asc.c_oAscChartTypeSettings.barStackedPer3d,iconCls:"column-3d-pstack",tip:this.textBarStackedPer3d,is3d:!0},{group:"menu-chart-group-bar",type:Asc.c_oAscChartTypeSettings.barNormal3dPerspective,iconCls:"column-3d-normal-per",tip:this.textBarNormal3dPerspective,is3d:!0},{group:"menu-chart-group-line",type:Asc.c_oAscChartTypeSettings.lineNormal,iconCls:"line-normal",tip:this.textLine},{group:"menu-chart-group-line",type:Asc.c_oAscChartTypeSettings.lineStacked,iconCls:"line-stack",tip:this.textLineStacked},{group:"menu-chart-group-line",type:Asc.c_oAscChartTypeSettings.lineStackedPer,iconCls:"line-pstack",tip:this.textLineStackedPer},{group:"menu-chart-group-line",type:Asc.c_oAscChartTypeSettings.lineNormalMarker,iconCls:"line-normal-marker",tip:this.textLineMarker},{group:"menu-chart-group-line",type:Asc.c_oAscChartTypeSettings.lineStackedMarker,iconCls:"line-stack-marker",tip:this.textLineStackedMarker},{group:"menu-chart-group-line",type:Asc.c_oAscChartTypeSettings.lineStackedPerMarker,iconCls:"line-pstack-marker",tip:this.textLineStackedPerMarker},{group:"menu-chart-group-line",type:Asc.c_oAscChartTypeSettings.line3d,iconCls:"line-3d",tip:this.textLine3d,is3d:!0},{group:"menu-chart-group-pie",type:Asc.c_oAscChartTypeSettings.pie,iconCls:"pie-normal",tip:this.textPie},{group:"menu-chart-group-pie",type:Asc.c_oAscChartTypeSettings.doughnut,iconCls:"pie-doughnut",tip:this.textDoughnut},{group:"menu-chart-group-pie",type:Asc.c_oAscChartTypeSettings.pie3d,iconCls:"pie-3d-normal",tip:this.textPie3d,is3d:!0},{group:"menu-chart-group-hbar",type:Asc.c_oAscChartTypeSettings.hBarNormal,iconCls:"bar-normal",tip:this.textHBarNormal},{group:"menu-chart-group-hbar",type:Asc.c_oAscChartTypeSettings.hBarStacked,iconCls:"bar-stack",tip:this.textHBarStacked},{group:"menu-chart-group-hbar",type:Asc.c_oAscChartTypeSettings.hBarStackedPer,iconCls:"bar-pstack",tip:this.textHBarStackedPer},{group:"menu-chart-group-hbar",type:Asc.c_oAscChartTypeSettings.hBarNormal3d,iconCls:"bar-3d-normal",tip:this.textHBarNormal3d,is3d:!0},{group:"menu-chart-group-hbar",type:Asc.c_oAscChartTypeSettings.hBarStacked3d,iconCls:"bar-3d-stack",tip:this.textHBarStacked3d,is3d:!0},{group:"menu-chart-group-hbar",type:Asc.c_oAscChartTypeSettings.hBarStackedPer3d,iconCls:"bar-3d-pstack",tip:this.textHBarStackedPer3d,is3d:!0},{group:"menu-chart-group-area",type:Asc.c_oAscChartTypeSettings.areaNormal,iconCls:"area-normal",tip:this.textArea},{group:"menu-chart-group-area",type:Asc.c_oAscChartTypeSettings.areaStacked,iconCls:"area-stack",tip:this.textAreaStacked},{group:"menu-chart-group-area",type:Asc.c_oAscChartTypeSettings.areaStackedPer,iconCls:"area-pstack",tip:this.textAreaStackedPer},{group:"menu-chart-group-stock",type:Asc.c_oAscChartTypeSettings.stock,iconCls:"stock-normal",tip:this.textStock},{group:"menu-chart-group-scatter",type:Asc.c_oAscChartTypeSettings.scatter,iconCls:"point-normal",tip:this.textScatter},{group:"menu-chart-group-scatter",type:Asc.c_oAscChartTypeSettings.scatterSmoothMarker,iconCls:"point-smooth-marker",tip:this.textScatterSmoothMarker},{group:"menu-chart-group-scatter",type:Asc.c_oAscChartTypeSettings.scatterSmooth,iconCls:"point-smooth",tip:this.textScatterSmooth},{group:"menu-chart-group-scatter",type:Asc.c_oAscChartTypeSettings.scatterLineMarker,iconCls:"point-line-marker",tip:this.textScatterLineMarker},{group:"menu-chart-group-scatter",type:Asc.c_oAscChartTypeSettings.scatterLine,iconCls:"point-line",tip:this.textScatterLine},{group:"menu-chart-group-radar",type:Asc.c_oAscChartTypeSettings.radar,iconCls:"radar",tip:this.textRadar},{group:"menu-chart-group-radar",type:Asc.c_oAscChartTypeSettings.radarMarker,iconCls:"radar-with-markers",tip:this.textRadarMarker},{group:"menu-chart-group-radar",type:Asc.c_oAscChartTypeSettings.radarFilled,iconCls:"filled-radar",tip:this.textRadarFilled},{group:"menu-chart-group-combo",type:Asc.c_oAscChartTypeSettings.comboBarLine,iconCls:"combo-bar-line",tip:this.textComboBarLine},{group:"menu-chart-group-combo",type:Asc.c_oAscChartTypeSettings.comboBarLineSecondary,iconCls:"combo-bar-line-sec",tip:this.textComboBarLineSecondary},{group:"menu-chart-group-combo",type:Asc.c_oAscChartTypeSettings.comboAreaBar,iconCls:"combo-area-bar",tip:this.textComboAreaBar},{group:"menu-chart-group-combo",type:Asc.c_oAscChartTypeSettings.comboCustom,iconCls:"combo-custom",tip:this.textComboCustom}]},getSparkGroupData:function(t){return[{id:"menu-chart-group-sparkcolumn",inline:!0,headername:t?this.textSparks:void 0},{id:"menu-chart-group-sparkline",inline:!0},{id:"menu-chart-group-sparkwin",inline:!0}]},getSparkData:function(){return[{group:"menu-chart-group-sparkcolumn",type:Asc.c_oAscSparklineType.Column,allowSelected:!0,iconCls:"spark-column",tip:this.textColumnSpark},{group:"menu-chart-group-sparkline",type:Asc.c_oAscSparklineType.Line,allowSelected:!0,iconCls:"spark-line",tip:this.textLineSpark},{group:"menu-chart-group-sparkwin",type:Asc.c_oAscSparklineType.Stacked,allowSelected:!0,iconCls:"spark-win",tip:this.textWinLossSpark}]}}},Common.define.chartData||{}),Common.define.smartArt=_.extend(new function(){return{textList:"List",textProcess:"Process",textCycle:"Cycle",textHierarchy:"Hierarchy",textRelationship:"Relationship",textMatrix:"Matrix",textPyramid:"Pyramid",textPicture:"Picture",textBasicBlockList:"Basic Block List",textAlternatingHexagons:"Alternating Hexagons",textPictureCaptionList:"Picture Caption List",textLinedList:"Lined List",textVerticalBulletList:"Vertical Bullet List",textVerticalBoxList:"Vertical Box List",textHorizontalBulletList:"Horizontal Bullet List",textSquareAccentList:"Square Accent List",textPictureAccentList:"Picture Accent List",textBendingPictureAccentList:"Bending Picture Accent List",textStackedList:"Stacked List",textIncreasingCircleProcess:"Increasing Circle Process",textPieProcess:"Pie Process",textDetailedProcess:"Detailed Process",textGroupedList:"Grouped List",textHorizontalPictureList:"Horizontal Picture List",textContinuousPictureList:"Continuous Picture List",textPictureStrips:"Picture Strips",textVerticalPictureList:"Vertical Picture List",textAlternatingPictureBlocks:"Alternating Picture Blocks",textVerticalPictureAccentList:"Vertical Picture Accent List",textTitledPictureAccentList:"Titled Picture Accent List",textVerticalBlockList:"Vertical Block List",textVerticalChevronList:"Vertical Chevron List",textVerticalAccentList:"Vertical Accent List",textVerticalArrowList:"Vertical Arrow List",textTrapezoidList:"Trapezoid List",textDescendingBlockList:"Descending Block List",textTableList:"Table List",textSegmentedProcess:"Segmented Process",textVerticalCurvedList:"Vertical Curved List",textPyramidList:"Pyramid List",textTargetList:"Target List",textHierarchyList:"Hierarchy List",textVerticalCircleList:"Vertical Circle List",textTableHierarchy:"Table Hierarchy",textBasicProcess:"Basic Process",textStepUpProcess:"Step Up Process",textStepDownProcess:"Step Down Process",textAccentProcess:"Accent Process",textPictureAccentProcess:"Picture Accent Process",textAlternatingFlow:"Alternating Flow",textContinuousBlockProcess:"Continuous Block Process",textIncreasingArrowProcess:"Increasing Arrow Process",textContinuousArrowProcess:"Continuous Arrow Process",textProcessArrows:"Process Arrows",textCircleAccentTimeline:"Circle Accent Timeline",textBasicTimeline:"Basic Timeline",textBasicChevronProcess:"Basic Chevron Process",textClosedChevronProcess:"Closed Chevron Process",textChevronList:"Chevron List",textSubStepProcess:"Sub-Step Process",textPhasedProcess:"Phased Process",textRandomToResultProcess:"Random to Result Process",textVerticalProcess:"Vertical Process",textStaggeredProcess:"Staggered Process",textProcessList:"Process List",textCircleArrowProcess:"Circle Arrow Process",textBasicBendingProcess:"Basic Bending Process",textRepeatingBendingProcess:"Repeating Bending Process",textVerticalBendingProcess:"Vertical Bending Process",textAscendingPictureAccentProcess:"Ascending Picture Accent Process",textUpwardArrow:"Upward Arrow",textDescendingProcess:"Descending Process",textCircularBendingProcess:"Circular Bending Process",textEquation:"Equation",textVerticalEquation:"Vertical Equation",textFunnel:"Funnel",textGear:"Gear",textArrowRibbon:"Arrow Ribbon",textOpposingArrows:"Opposing Arrows",textConvergingArrows:"Converging Arrows",textDivergingArrows:"Diverging Arrows",textBasicCycle:"Basic Cycle",textTextCycle:"Text Cycle",textBlockCycle:"Block Cycle",textNondirectionalCycle:"Nondirectional Cycle",textContinuousCycle:"Continuous Cycle",textMultidirectionalCycle:"Multidirectional Cycle",textSegmentedCycle:"Segmented Cycle",textBasicPie:"Basic Pie",textRadialCycle:"Radial Cycle",textBasicRadial:"Basic Radial",textDivergingRadial:"Diverging Radial",textRadialVenn:"Radial Venn",textCycleMatrix:"Cycle Matrix",textRadialCluster:"Radial Cluster",textOrganizationChart:"Organization Chart",textNameAndTitleOrganizationChart:"Name and Title Organization Chart",textHalfCircleOrganizationChart:"Half Circle Organization Chart",textCirclePictureHierarchy:"Circle Picture Hierarchy",textLabeledHierarchy:"Labeled Hierarchy",textHorizontalOrganizationChart:"Horizontal Organization Chart",textHorizontalMultiLevelHierarchy:"Horizontal Multi-Level Hierarchy",textHorizontalHierarchy:"Horizontal Hierarchy",textHorizontalLabeledHierarchy:"Horizontal Labeled Hierarchy",textBalance:"Balance",textCircleRelationship:"Circle Relationship",textHexagonCluster:"Hexagon Cluster",textOpposingIdeas:"Opposing Ideas",textPlusAndMinus:"Plus and Minus",textReverseList:"Reverse List",textCounterbalanceArrows:"Counterbalance Arrows",textSegmentedPyramid:"Segmented Pyramid",textNestedTarget:"Nested Target",textConvergingRadial:"Converging Radial",textRadialList:"Radial List",textBasicTarget:"Basic Target",textBasicVenn:"Basic Venn",textLinearVenn:"Linear Venn",textStackedVenn:"Stacked Venn",textBasicMatrix:"Basic Matrix",textTitledMatrix:"Titled Matrix",textGridMatrix:"Grid Matrix",textBasicPyramid:"Basic Pyramid",textInvertedPyramid:"Inverted Pyramid",textAccentedPicture:"Accented Picture",textCircularPictureCallout:"Circular Picture Callout",textSnapshotPictureList:"Snapshot Picture List",textSpiralPicture:"Spiral Picture",textCaptionedPictures:"Captioned Pictures",textBendingPictureCaption:"Bending Picture Caption",textBendingPictureSemiTranparentText:"Bending Picture Semi-Tranparent Text",textBendingPictureBlocks:"Bending Picture Blocks",textBendingPictureCaptionList:"Bending Picture Caption List",textTitledPictureBlocks:"Titled Picture Blocks",textPictureGrid:"Picture Grid",textPictureAccentBlocks:"Picture Accent Blocks",textAlternatingPictureCircles:"Alternating Picture Circles",textTitlePictureLineup:"Title Picture Lineup",textPictureLineup:"Picture Lineup",textFramedTextPicture:"Framed Text Picture",textBubblePictureList:"Bubble Picture List",textOther:"Other",textPictureOrganizationChart:"Picture Organization Chart",textChevronAccentProcess:"Chevron Accent Process",textRadialPictureList:"Radial Picture List",textVerticalBracketList:"Vertical Bracket List",textInterconnectedBlockProcess:"Interconnected Block Process",textTabbedArc:"Tabbed Arc",textThemePictureAccent:"Theme Picture Accent",textVaryingWidthList:"Varying Width List",textConvergingText:"Converging Text",textInterconnectedRings:"Interconnected Rings",textArchitectureLayout:"Architecture Layout",textThemePictureAlternatingAccent:"Theme Picture Alternating Accent",textThemePictureGrid:"Theme Picture Grid",textCircleProcess:"Circle Process",textHexagonRadial:"Hexagon Radial",textPictureFrame:"PictureFrame",textTabList:"Tab List",getSmartArtData:function(){return[{id:"menu-smart-art-group-list",sectionId:Asc.c_oAscSmartArtSectionNames.List,caption:this.textList,icon:"btn-smart-list",items:[{type:Asc.c_oAscSmartArtTypes.BasicBlockList,tip:this.textBasicBlockList},{type:Asc.c_oAscSmartArtTypes.AlternatingHexagonList,tip:this.textAlternatingHexagons},{type:Asc.c_oAscSmartArtTypes.PictureCaptionList,tip:this.textPictureCaptionList},{type:Asc.c_oAscSmartArtTypes.LinedList,tip:this.textLinedList},{type:Asc.c_oAscSmartArtTypes.VerticalBulletList,tip:this.textVerticalBulletList},{type:Asc.c_oAscSmartArtTypes.VerticalBoxList,tip:this.textVerticalBoxList},{type:Asc.c_oAscSmartArtTypes.VerticalBracketList,tip:this.textVerticalBracketList},{type:Asc.c_oAscSmartArtTypes.VaryingWidthList,tip:this.textVaryingWidthList},{type:Asc.c_oAscSmartArtTypes.TabList,tip:this.textTabList},{type:Asc.c_oAscSmartArtTypes.HorizontalBulletList,tip:this.textHorizontalBulletList},{type:Asc.c_oAscSmartArtTypes.SquareAccentList,tip:this.textSquareAccentList},{type:Asc.c_oAscSmartArtTypes.PictureAccentList,tip:this.textPictureAccentList},{type:Asc.c_oAscSmartArtTypes.BendingPictureAccentList,tip:this.textBendingPictureAccentList},{type:Asc.c_oAscSmartArtTypes.StackedList,tip:this.textStackedList},{type:Asc.c_oAscSmartArtTypes.IncreasingCircleProcess,tip:this.textIncreasingCircleProcess},{type:Asc.c_oAscSmartArtTypes.PieProcess,tip:this.textPieProcess},{type:Asc.c_oAscSmartArtTypes.DetailedProcess,tip:this.textDetailedProcess},{type:Asc.c_oAscSmartArtTypes.GroupedList,tip:this.textGroupedList},{type:Asc.c_oAscSmartArtTypes.HorizontalPictureList,tip:this.textHorizontalPictureList},{type:Asc.c_oAscSmartArtTypes.ContinuousPictureList,tip:this.textContinuousPictureList},{type:Asc.c_oAscSmartArtTypes.PictureStrips,tip:this.textPictureStrips},{type:Asc.c_oAscSmartArtTypes.VerticalPictureList,tip:this.textVerticalPictureList},{type:Asc.c_oAscSmartArtTypes.AlternatingPictureBlocks,tip:this.textAlternatingPictureBlocks},{type:Asc.c_oAscSmartArtTypes.VerticalPictureAccentList,tip:this.textVerticalPictureAccentList},{type:Asc.c_oAscSmartArtTypes.TitledPictureAccentList,tip:this.textTitledPictureAccentList},{type:Asc.c_oAscSmartArtTypes.VerticalBlockList,tip:this.textVerticalBlockList},{type:Asc.c_oAscSmartArtTypes.VerticalChevronList,tip:this.textVerticalChevronList},{type:Asc.c_oAscSmartArtTypes.VerticalAccentList,tip:this.textVerticalAccentList},{type:Asc.c_oAscSmartArtTypes.VerticalArrowList,tip:this.textVerticalArrowList},{type:Asc.c_oAscSmartArtTypes.TrapezoidList,tip:this.textTrapezoidList},{type:Asc.c_oAscSmartArtTypes.DescendingBlockList,tip:this.textDescendingBlockList},{type:Asc.c_oAscSmartArtTypes.TableList,tip:this.textTableList},{type:Asc.c_oAscSmartArtTypes.SegmentedProcess,tip:this.textSegmentedProcess},{type:Asc.c_oAscSmartArtTypes.VerticalCurvedList,tip:this.textVerticalCurvedList},{type:Asc.c_oAscSmartArtTypes.PyramidList,tip:this.textPyramidList},{type:Asc.c_oAscSmartArtTypes.TargetList,tip:this.textTargetList},{type:Asc.c_oAscSmartArtTypes.HierarchyList,tip:this.textHierarchyList},{type:Asc.c_oAscSmartArtTypes.VerticalCircleList,tip:this.textVerticalCircleList},{type:Asc.c_oAscSmartArtTypes.TableHierarchy,tip:this.textTableHierarchy},{type:Asc.c_oAscSmartArtTypes.ArchitectureLayout,tip:this.textArchitectureLayout}]},{id:"menu-smart-art-group-process",sectionId:Asc.c_oAscSmartArtSectionNames.Process,caption:this.textProcess,icon:"btn-smart-process",items:[{type:Asc.c_oAscSmartArtTypes.BasicProcess,tip:this.textBasicProcess},{type:Asc.c_oAscSmartArtTypes.StepUpProcess,tip:this.textStepUpProcess},{type:Asc.c_oAscSmartArtTypes.StepDownProcess,tip:this.textStepDownProcess},{type:Asc.c_oAscSmartArtTypes.AccentProcess,tip:this.textAccentProcess},{type:Asc.c_oAscSmartArtTypes.PictureAccentProcess,tip:this.textPictureAccentProcess},{type:Asc.c_oAscSmartArtTypes.AlternatingFlow,tip:this.textAlternatingFlow},{type:Asc.c_oAscSmartArtTypes.IncreasingCircleProcess,tip:this.textIncreasingCircleProcess},{type:Asc.c_oAscSmartArtTypes.PieProcess,tip:this.textPieProcess},{type:Asc.c_oAscSmartArtTypes.ContinuousBlockProcess,tip:this.textContinuousBlockProcess},{type:Asc.c_oAscSmartArtTypes.IncreasingArrowsProcess,tip:this.textIncreasingArrowProcess},{type:Asc.c_oAscSmartArtTypes.InterconnectedBlockProcess,tip:this.textInterconnectedBlockProcess},{type:Asc.c_oAscSmartArtTypes.ContinuousArrowProcess,tip:this.textContinuousArrowProcess},{type:Asc.c_oAscSmartArtTypes.ConvergingText,tip:this.textConvergingText},{type:Asc.c_oAscSmartArtTypes.ProcessArrows,tip:this.textProcessArrows},{type:Asc.c_oAscSmartArtTypes.CircleAccentTimeline,tip:this.textCircleAccentTimeline},{type:Asc.c_oAscSmartArtTypes.BasicTimeline,tip:this.textBasicTimeline},{type:Asc.c_oAscSmartArtTypes.CircleProcess,tip:this.textCircleProcess},{type:Asc.c_oAscSmartArtTypes.BasicChevronProcess,tip:this.textBasicChevronProcess},{type:Asc.c_oAscSmartArtTypes.ChevronAccentProcess,tip:this.textChevronAccentProcess},{type:Asc.c_oAscSmartArtTypes.ClosedChevronProcess,tip:this.textClosedChevronProcess},{type:Asc.c_oAscSmartArtTypes.ChevronList,tip:this.textChevronList},{type:Asc.c_oAscSmartArtTypes.VerticalChevronList,tip:this.textVerticalChevronList},{type:Asc.c_oAscSmartArtTypes.SubStepProcess,tip:this.textSubStepProcess},{type:Asc.c_oAscSmartArtTypes.PhasedProcess,tip:this.textPhasedProcess},{type:Asc.c_oAscSmartArtTypes.RandomToResultProcess,tip:this.textRandomToResultProcess},{type:Asc.c_oAscSmartArtTypes.VerticalProcess,tip:this.textVerticalProcess},{type:Asc.c_oAscSmartArtTypes.StaggeredProcess,tip:this.textStaggeredProcess},{type:Asc.c_oAscSmartArtTypes.ProcessList,tip:this.textProcessList},{type:Asc.c_oAscSmartArtTypes.SegmentedProcess,tip:this.textSegmentedProcess},{type:Asc.c_oAscSmartArtTypes.CircleArrowProcess,tip:this.textCircleArrowProcess},{type:Asc.c_oAscSmartArtTypes.BasicBendingProcess,tip:this.textBasicBendingProcess},{type:Asc.c_oAscSmartArtTypes.RepeatingBendingProcess,tip:this.textRepeatingBendingProcess},{type:Asc.c_oAscSmartArtTypes.VerticalBendingProcess,tip:this.textVerticalBendingProcess},{type:Asc.c_oAscSmartArtTypes.ContinuousPictureList,tip:this.textContinuousPictureList},{type:Asc.c_oAscSmartArtTypes.DetailedProcess,tip:this.textDetailedProcess},{type:Asc.c_oAscSmartArtTypes.VerticalArrowList,tip:this.textVerticalArrowList},{type:Asc.c_oAscSmartArtTypes.AscendingPictureAccentProcess,tip:this.textAscendingPictureAccentProcess},{type:Asc.c_oAscSmartArtTypes.UpwardArrow,tip:this.textUpwardArrow},{type:Asc.c_oAscSmartArtTypes.DescendingProcess,tip:this.textDescendingProcess},{type:Asc.c_oAscSmartArtTypes.CircularBendingProcess,tip:this.textCircularBendingProcess},{type:Asc.c_oAscSmartArtTypes.Equation,tip:this.textEquation},{type:Asc.c_oAscSmartArtTypes.VerticalEquation,tip:this.textVerticalEquation},{type:Asc.c_oAscSmartArtTypes.Funnel,tip:this.textFunnel},{type:Asc.c_oAscSmartArtTypes.Gear,tip:this.textGear},{type:Asc.c_oAscSmartArtTypes.ArrowRibbon,tip:this.textArrowRibbon},{type:Asc.c_oAscSmartArtTypes.OpposingArrows,tip:this.textOpposingArrows},{type:Asc.c_oAscSmartArtTypes.ConvergingArrows,tip:this.textConvergingArrows},{type:Asc.c_oAscSmartArtTypes.DivergingArrows,tip:this.textDivergingArrows}]},{id:"menu-smart-art-group-cycle",sectionId:Asc.c_oAscSmartArtSectionNames.Cycle,caption:this.textCycle,icon:"btn-smart-cycle",items:[{type:Asc.c_oAscSmartArtTypes.BasicCycle,tip:this.textBasicCycle},{type:Asc.c_oAscSmartArtTypes.TextCycle,tip:this.textTextCycle},{type:Asc.c_oAscSmartArtTypes.BlockCycle,tip:this.textBlockCycle},{type:Asc.c_oAscSmartArtTypes.NonDirectionalCycle,tip:this.textNondirectionalCycle},{type:Asc.c_oAscSmartArtTypes.ContinuousCycle,tip:this.textContinuousCycle},{type:Asc.c_oAscSmartArtTypes.MultiDirectionalCycle,tip:this.textMultidirectionalCycle},{type:Asc.c_oAscSmartArtTypes.SegmentedCycle,tip:this.textSegmentedCycle},{type:Asc.c_oAscSmartArtTypes.BasicPie,tip:this.textBasicPie},{type:Asc.c_oAscSmartArtTypes.HexagonRadial,tip:this.textHexagonRadial},{type:Asc.c_oAscSmartArtTypes.RadialCycle,tip:this.textRadialCycle},{type:Asc.c_oAscSmartArtTypes.BasicRadial,tip:this.textBasicRadial},{type:Asc.c_oAscSmartArtTypes.DivergingRadial,tip:this.textDivergingRadial},{type:Asc.c_oAscSmartArtTypes.RadialVenn,tip:this.textRadialVenn},{type:Asc.c_oAscSmartArtTypes.CycleMatrix,tip:this.textCycleMatrix},{type:Asc.c_oAscSmartArtTypes.Gear,tip:this.textGear},{type:Asc.c_oAscSmartArtTypes.RadialCluster,tip:this.textRadialCluster},{type:Asc.c_oAscSmartArtTypes.CircleArrowProcess,tip:this.textCircleArrowProcess}]},{id:"menu-smart-art-group-hierarchy",sectionId:Asc.c_oAscSmartArtSectionNames.Hierarchy,caption:this.textHierarchy,icon:"btn-smart-hierarchy",items:[{type:Asc.c_oAscSmartArtTypes.OrganizationChart,tip:this.textOrganizationChart},{type:Asc.c_oAscSmartArtTypes.PictureOrganizationChart,tip:this.textPictureOrganizationChart},{type:Asc.c_oAscSmartArtTypes.NameAndTitleOrganizationChart,tip:this.textNameAndTitleOrganizationChart},{type:Asc.c_oAscSmartArtTypes.HalfCircleOrganizationChart,tip:this.textHalfCircleOrganizationChart},{type:Asc.c_oAscSmartArtTypes.CirclePictureHierarchy,tip:this.textCirclePictureHierarchy},{type:Asc.c_oAscSmartArtTypes.Hierarchy,tip:this.textHierarchy},{type:Asc.c_oAscSmartArtTypes.LabeledHierarchy,tip:this.textLabeledHierarchy},{type:Asc.c_oAscSmartArtTypes.TableHierarchy,tip:this.textTableHierarchy},{type:Asc.c_oAscSmartArtTypes.HorizontalOrganizationChart,tip:this.textHorizontalOrganizationChart},{type:Asc.c_oAscSmartArtTypes.ArchitectureLayout,tip:this.textArchitectureLayout},{type:Asc.c_oAscSmartArtTypes.HorizontalMultiLevelHierarchy,tip:this.textHorizontalMultiLevelHierarchy},{type:Asc.c_oAscSmartArtTypes.HorizontalHierarchy,tip:this.textHorizontalHierarchy},{type:Asc.c_oAscSmartArtTypes.HorizontalLabeledHierarchy,tip:this.textHorizontalLabeledHierarchy},{type:Asc.c_oAscSmartArtTypes.HierarchyList,tip:this.textHierarchyList},{type:Asc.c_oAscSmartArtTypes.LinedList,tip:this.textLinedList}]},{id:"menu-smart-art-group-relationship",sectionId:Asc.c_oAscSmartArtSectionNames.Relationship,caption:this.textRelationship,icon:"btn-smart-relationship",items:[{type:Asc.c_oAscSmartArtTypes.Balance,tip:this.textBalance},{type:Asc.c_oAscSmartArtTypes.CircleRelationship,tip:this.textCircleRelationship},{type:Asc.c_oAscSmartArtTypes.Funnel,tip:this.textFunnel},{type:Asc.c_oAscSmartArtTypes.Gear,tip:this.textGear},{type:Asc.c_oAscSmartArtTypes.HexagonCluster,tip:this.textHexagonCluster},{type:Asc.c_oAscSmartArtTypes.OpposingIdeas,tip:this.textOpposingIdeas},{type:Asc.c_oAscSmartArtTypes.PlusAndMinus,tip:this.textPlusAndMinus},{type:Asc.c_oAscSmartArtTypes.ReverseList,tip:this.textReverseList},{type:Asc.c_oAscSmartArtTypes.ArrowRibbon,tip:this.textArrowRibbon},{type:Asc.c_oAscSmartArtTypes.CounterbalanceArrows,tip:this.textCounterbalanceArrows},{type:Asc.c_oAscSmartArtTypes.ConvergingArrows,tip:this.textConvergingArrows},{type:Asc.c_oAscSmartArtTypes.DivergingArrows,tip:this.textDivergingArrows},{type:Asc.c_oAscSmartArtTypes.OpposingArrows,tip:this.textOpposingArrows},{type:Asc.c_oAscSmartArtTypes.SegmentedPyramid,tip:this.textSegmentedPyramid},{type:Asc.c_oAscSmartArtTypes.TableHierarchy,tip:this.textTableHierarchy},{type:Asc.c_oAscSmartArtTypes.ArchitectureLayout,tip:this.textArchitectureLayout},{type:Asc.c_oAscSmartArtTypes.TargetList,tip:this.textTargetList},{type:Asc.c_oAscSmartArtTypes.NestedTarget,tip:this.textNestedTarget},{type:Asc.c_oAscSmartArtTypes.GroupedList,tip:this.textGroupedList},{type:Asc.c_oAscSmartArtTypes.ContinuousPictureList,tip:this.textContinuousPictureList},{type:Asc.c_oAscSmartArtTypes.HierarchyList,tip:this.textHierarchyList},{type:Asc.c_oAscSmartArtTypes.PictureAccentList,tip:this.textPictureAccentList},{type:Asc.c_oAscSmartArtTypes.Equation,tip:this.textEquation},{type:Asc.c_oAscSmartArtTypes.VerticalEquation,tip:this.textVerticalEquation},{type:Asc.c_oAscSmartArtTypes.ConvergingRadial,tip:this.textConvergingRadial},{type:Asc.c_oAscSmartArtTypes.RadialCluster,tip:this.textRadialCluster},{type:Asc.c_oAscSmartArtTypes.RadialList,tip:this.textRadialList},{type:Asc.c_oAscSmartArtTypes.TabbedArc,tip:this.textTabbedArc},{type:Asc.c_oAscSmartArtTypes.RadialCycle,tip:this.textRadialCycle},{type:Asc.c_oAscSmartArtTypes.BasicRadial,tip:this.textBasicRadial},{type:Asc.c_oAscSmartArtTypes.DivergingRadial,tip:this.textDivergingRadial},{type:Asc.c_oAscSmartArtTypes.NonDirectionalCycle,tip:this.textNondirectionalCycle},{type:Asc.c_oAscSmartArtTypes.BasicTarget,tip:this.textBasicTarget},{type:Asc.c_oAscSmartArtTypes.CycleMatrix,tip:this.textCycleMatrix},{type:Asc.c_oAscSmartArtTypes.BasicPie,tip:this.textBasicPie},{type:Asc.c_oAscSmartArtTypes.BasicVenn,tip:this.textBasicVenn},{type:Asc.c_oAscSmartArtTypes.LinearVenn,tip:this.textLinearVenn},{type:Asc.c_oAscSmartArtTypes.StackedVenn,tip:this.textStackedVenn},{type:Asc.c_oAscSmartArtTypes.RadialVenn,tip:this.textRadialVenn},{type:Asc.c_oAscSmartArtTypes.InterconnectedRings,tip:this.textInterconnectedRings}]},{id:"menu-smart-art-group-matrix",sectionId:Asc.c_oAscSmartArtSectionNames.Matrix,caption:this.textMatrix,icon:"btn-smart-matrix",items:[{type:Asc.c_oAscSmartArtTypes.BasicMatrix,tip:this.textBasicMatrix},{type:Asc.c_oAscSmartArtTypes.TitledMatrix,tip:this.textTitledMatrix},{type:Asc.c_oAscSmartArtTypes.GridMatrix,tip:this.textGridMatrix},{type:Asc.c_oAscSmartArtTypes.CycleMatrix,tip:this.textCycleMatrix}]},{id:"menu-smart-art-group-pyramid",sectionId:Asc.c_oAscSmartArtSectionNames.Pyramid,caption:this.textPyramid,icon:"btn-smart-pyramid",items:[{type:Asc.c_oAscSmartArtTypes.BasicPyramid,tip:this.textBasicPyramid},{type:Asc.c_oAscSmartArtTypes.InvertedPyramid,tip:this.textInvertedPyramid},{type:Asc.c_oAscSmartArtTypes.PyramidList,tip:this.textPyramidList},{type:Asc.c_oAscSmartArtTypes.SegmentedPyramid,tip:this.textSegmentedPyramid}]},{id:"menu-smart-art-group-picture",sectionId:Asc.c_oAscSmartArtSectionNames.Picture,caption:this.textPicture,icon:"btn-menu-image",items:[{type:Asc.c_oAscSmartArtTypes.AccentedPicture,tip:this.textAccentedPicture},{type:Asc.c_oAscSmartArtTypes.CircularPictureCallout,tip:this.textCircularPictureCallout},{type:Asc.c_oAscSmartArtTypes.PictureCaptionList,tip:this.textPictureCaptionList},{type:Asc.c_oAscSmartArtTypes.RadialPictureList,tip:this.textRadialPictureList},{type:Asc.c_oAscSmartArtTypes.SnapshotPictureList,tip:this.textSnapshotPictureList},{type:Asc.c_oAscSmartArtTypes.SpiralPicture,tip:this.textSpiralPicture},{type:Asc.c_oAscSmartArtTypes.CaptionedPictures,tip:this.textCaptionedPictures},{type:Asc.c_oAscSmartArtTypes.BendingPictureCaption,tip:this.textBendingPictureCaption},{type:Asc.c_oAscSmartArtTypes.PictureFrame,tip:this.textPictureFrame},{type:Asc.c_oAscSmartArtTypes.BendingPictureSemiTransparentText,tip:this.textBendingPictureSemiTranparentText},{type:Asc.c_oAscSmartArtTypes.BendingPictureBlocks,tip:this.textBendingPictureBlocks},{type:Asc.c_oAscSmartArtTypes.BendingPictureCaptionList,tip:this.textBendingPictureCaptionList},{type:Asc.c_oAscSmartArtTypes.TitledPictureBlocks,tip:this.textTitledPictureBlocks},{type:Asc.c_oAscSmartArtTypes.PictureGrid,tip:this.textPictureGrid},{type:Asc.c_oAscSmartArtTypes.PictureAccentBlocks,tip:this.textPictureAccentBlocks},{type:Asc.c_oAscSmartArtTypes.PictureStrips,tip:this.textPictureStrips},{type:Asc.c_oAscSmartArtTypes.ThemePictureAccent,tip:this.textThemePictureAccent},{type:Asc.c_oAscSmartArtTypes.ThemePictureGrid,tip:this.textThemePictureGrid},{type:Asc.c_oAscSmartArtTypes.ThemePictureAlternatingAccent,tip:this.textThemePictureAlternatingAccent},{type:Asc.c_oAscSmartArtTypes.TitledPictureAccentList,tip:this.textTitledPictureAccentList},{type:Asc.c_oAscSmartArtTypes.AlternatingPictureBlocks,tip:this.textAlternatingPictureBlocks},{type:Asc.c_oAscSmartArtTypes.AscendingPictureAccentProcess,tip:this.textAscendingPictureAccentProcess},{type:Asc.c_oAscSmartArtTypes.AlternatingPictureCircles,tip:this.textAlternatingPictureCircles},{type:Asc.c_oAscSmartArtTypes.TitlePictureLineup,tip:this.textTitlePictureLineup},{type:Asc.c_oAscSmartArtTypes.PictureLineup,tip:this.textPictureLineup},{type:Asc.c_oAscSmartArtTypes.FramedTextPicture,tip:this.textFramedTextPicture},{type:Asc.c_oAscSmartArtTypes.HexagonCluster,tip:this.textHexagonCluster},{type:Asc.c_oAscSmartArtTypes.BubblePictureList,tip:this.textBubblePictureList},{type:Asc.c_oAscSmartArtTypes.CirclePictureHierarchy,tip:this.textCirclePictureHierarchy},{type:Asc.c_oAscSmartArtTypes.HorizontalPictureList,tip:this.textHorizontalPictureList},{type:Asc.c_oAscSmartArtTypes.ContinuousPictureList,tip:this.textContinuousPictureList},{type:Asc.c_oAscSmartArtTypes.VerticalPictureList,tip:this.textVerticalPictureList},{type:Asc.c_oAscSmartArtTypes.VerticalPictureAccentList,tip:this.textVerticalPictureAccentList},{type:Asc.c_oAscSmartArtTypes.BendingPictureAccentList,tip:this.textBendingPictureAccentList},{type:Asc.c_oAscSmartArtTypes.PictureAccentList,tip:this.textPictureAccentList},{type:Asc.c_oAscSmartArtTypes.PictureAccentProcess,tip:this.textPictureAccentProcess}]},{id:"menu-smart-art-group-other",sectionId:Asc.c_oAscSmartArtSectionNames.OfficeCom,caption:this.textOther,items:[{type:Asc.c_oAscSmartArtTypes.PictureOrganizationChart,tip:this.textPictureOrganizationChart},{type:Asc.c_oAscSmartArtTypes.ChevronAccentProcess,tip:this.textChevronAccentProcess},{type:Asc.c_oAscSmartArtTypes.RadialPictureList,tip:this.textRadialPictureList},{type:Asc.c_oAscSmartArtTypes.VerticalBracketList,tip:this.textVerticalBracketList},{type:Asc.c_oAscSmartArtTypes.InterconnectedBlockProcess,tip:this.textInterconnectedBlockProcess},{type:Asc.c_oAscSmartArtTypes.TabbedArc,tip:this.textTabbedArc},{type:Asc.c_oAscSmartArtTypes.ThemePictureAccent,tip:this.textThemePictureAccent},{type:Asc.c_oAscSmartArtTypes.VaryingWidthList,tip:this.textVaryingWidthList},{type:Asc.c_oAscSmartArtTypes.ConvergingText,tip:this.textConvergingText},{type:Asc.c_oAscSmartArtTypes.InterconnectedRings,tip:this.textInterconnectedRings},{type:Asc.c_oAscSmartArtTypes.ArchitectureLayout,tip:this.textArchitectureLayout},{type:Asc.c_oAscSmartArtTypes.ThemePictureAlternatingAccent,tip:this.textThemePictureAlternatingAccent},{type:Asc.c_oAscSmartArtTypes.ThemePictureGrid,tip:this.textThemePictureGrid},{type:Asc.c_oAscSmartArtTypes.CircleProcess,tip:this.textCircleProcess},{type:Asc.c_oAscSmartArtTypes.HexagonRadial,tip:this.textHexagonRadial},{type:Asc.c_oAscSmartArtTypes.PictureFrame,tip:this.textPictureFrame},{type:Asc.c_oAscSmartArtTypes.TabList,tip:this.textTabList}]}]}}},Common.define.smartArt||{})}));const helper=function(){let t;const e=function(e){if(e){if(!t&&0==(t=$("div[aria-live]")).length){t=$('<div aria-live="assertive" class="sr-only" style=""></div>').appendTo($("body"))}}else t&&(t.remove(t),t=void 0)};return{setEnabled:e,disable:function(){e(!1)},speech:function(i){t||e(!0),t.text(""),setTimeout((function(e){t.text(i)}),0)}}};if(!window.Common&&(window.Common={}),!Common.Utils&&(Common.Utils={}),Common.Utils.ScreeenReaderHelper=new helper,define("common/main/lib/util/ScreenReaderHelper",(function(){})),void 0===Common)Common={};if(void 0===Common.UI&&(Common.UI={}),Common.UI.ScreenReaderFocusManager=new function(){var t,e,i,s,n=!1,a=!1,o=!1,l=0,r=0,c=document,d=document,h=[],p=!1,m=!1,u=!1,g=!1,b=function(t,e){d=c,e?c=e:"esc"!==t?c=$("#file-menu-panel").is(":visible")?$("#file-menu-panel"):0===l?document:t&&t.closest(".hint-section")||document:0===l&&(c=document)},f=function(t){!e||!t&&Common.Utils.ModalWindow.isVisible()||(p=t,e.asc_enableKeyEvents(!t))},C=function(){if((0===h.length||$("#file-menu-panel").is(":visible")&&1===l)&&P(),a)if(l!==r&&(0===l||1===l&&$("#file-menu-panel").is(":visible"))){var e=$(d).prop("id");"toolbar"===e?A():"left-menu"===e||"right-menu"===e?S(e):"file-menu-panel"===e&&w()}else 1!==l||l===r||"left-menu"!==$(c).prop("id")&&"right-menu"!==$(c).prop("id")||T("left-menu"===$(c).prop("id"));else $("#file-menu-panel").is(":visible")?w():A();var i=h[t];i&&($(i).parent().hasClass("ribtab")&&!$(i).parent().hasClass("active")&&"file"!==$(i).data("tab")&&$(i).trigger(jQuery.Event("click",{which:1})),$(h[t]).focus()),h.length>0?(!p&&f(!0),a=!0):a=!1},x=function(){a=!1,o=!1,g=!1},v=function(e){r=l,t=0,h.length=0,void 0!==e?l=e:l++},y=function(){l=$("#file-menu-panel").is(":visible")?1:0,b(),h.length=0},A=function(){for(var e,i=0;i<h.length;i++){var s=$(h[i]).parent();if(s&&s.hasClass("ribtab")&&s.hasClass("active")){e=h[i];break}}e&&(t=i)},S=function(e){for(var i,s=0;s<h.length;s++){var n=$(h[s]);if($(n.closest(".hint-section")).prop("id")===e&&n.hasClass("btn-category")&&n.hasClass("active")){i=h[s];break}}i&&(t=s)},w=function(){for(var e,i=0;i<h.length;i++)if($(h[i]).parent().hasClass("active")){e=h[i];break}e&&(t=i)},T=function(e){var s,n=0;if(e&&(s=i.getController("LeftMenu").getView("LeftMenu").getFocusElement()),s)for(var a=0;a<h.length;a++)if($(h[a]).is($(s))){n=a;break}t=n},P=function(){h=[];var t=[];_.isArray(c)?c.forEach((function(e){t=t.concat($(e).find("[data-hint="+l+"]").toArray())})):t=$(c).find("[data-hint="+l+"]").toArray(),(h=t.filter((function(t){return $(t).is(":visible")&&!function(t){return t.hasClass("disabled")||t.parent().hasClass("disabled")||t.attr("disabled")}($(t))}))).forEach((function(t){void 0===$(t).attr("tabindex")&&$(t).attr("tabindex",0)}))},k=function(){x(),y(),p&&f(!1)};return{init:function(d){if(!(Common.Utils.isIE||Common.UI.isMac&&Common.Utils.isGecko)){e=d,i=window.DE||window.PE||window.SSE||window.PDFE||window.VE,u=!0;var _=Common.localStorage.getKeysFilter();s=_&&_.length?_.split(",")[0]:"",Common.Utils.ScreeenReaderHelper||require(["common/main/lib/util/ScreenReaderHelper"],(function(){Common.Utils.ScreeenReaderHelper.setEnabled(!0)})),$("#editor_sdk").on("click",(function(){k()})),$(document).on("mousedown",(function(){k()})),$(document).on("keyup",(function(t){t.keyCode!=Common.UI.Keys.ALT&&91!==t.keyCode||!n||window.SSE&&window.SSE.getController("Statusbar").getIsDragDrop()?m?(f(!1),m=!1):a&&t.preventDefault():(t.preventDefault(),a?k():($("input:focus").blur(),l=$("#file-menu-panel").is(":visible")?1:0,b(),C())),n=!1})),$(document).on("keydown.after.bs.dropdown",(function(e){if(a){var i=$(h[t]).prop("tagName"),s="INPUT"===i||"TEXTAREA"===i,n=e.keyCode==Common.UI.Keys.TAB||e.keyCode==Common.UI.Keys.LEFT||e.keyCode==Common.UI.Keys.RIGHT||e.keyCode==Common.UI.Keys.UP||e.keyCode==Common.UI.Keys.DOWN,d=e.keyCode==Common.UI.Keys.ESC||e.keyCode==Common.UI.Keys.RETURN||e.keyCode==Common.UI.Keys.SPACE;if($(h[t]).data("move-focus-only-tab")&&e.keyCode!==Common.UI.Keys.TAB&&!d)return;if(!n&&!d||e.keyCode==Common.UI.Keys.SPACE&&s)return;n&&e.preventDefault(),Common.UI.Menu.Manager.hideAll();var u,f,_,A,S=!1,w=h[t]&&$(h[t]),T=$("#file-menu-panel").is(":visible"),P=w&&w.hasClass("btn-category"),I=e.keyCode==Common.UI.Keys.LEFT,D=e.keyCode==Common.UI.Keys.RIGHT,F=e.keyCode==Common.UI.Keys.UP,M=e.keyCode==Common.UI.Keys.DOWN,V=e.keyCode==Common.UI.Keys.TAB,L=e.shiftKey&&e.keyCode==Common.UI.Keys.TAB;if(T?(u=I||F,f=2===l?D||M||V&&!L:D||M,_=L,A=V&&!L):P?(u=F||L,f=M||V,_=!1,A=D||I):g?(u=L,f=V,_=!1,A=!1):(u=I||L,f=D||V&&!L,_=F,A=M),e.keyCode==Common.UI.Keys.ESC)return void k();if(e.keyCode==Common.UI.Keys.RETURN||e.keyCode==Common.UI.Keys.SPACE){if(w&&(w.attr("for")?e.keyCode==Common.UI.Keys.RETURN?$("#"+w.attr("for")).trigger(jQuery.Event("click",{which:1})):e.preventDefault():"file"===w.data("tab")||T&&1===l||P?w.trigger(jQuery.Event("click",{which:1})):setTimeout((function(){w.trigger(jQuery.Event("click",{which:1}))}),1),"dropdown"!==w.data("toggle")&&w.blur()),!(w&&"file"===w.data("tab")||T&&1===l||P&&w.hasClass("active")))return x(),y(),Common.UI.HintManager.isHintVisible()&&Common.UI.HintManager.clearHints(!1,!0),w&&"dropdown"!==w.data("toggle")&&(m=!0),void(p=!1);P&&w.hasClass("active")&&(g=!0),v(),b(w)}else if(u)S=!0,r=l,--t<0&&(t=h.length-1);else if(f)S=!0,r=l,++t>h.length-1&&(t=0);else if(A){var U='[data-hint="'+(l+1)+'"]';if(0===$(c).find(U).length||w&&0===$(w.closest(".hint-section")).find(U).filter(":visible").length)return;S=!0,v(),b(w),P&&(g=!0)}else if(_){if(0===l)return;S=!0,r=l,h.length=0,l--,b(w)}!o&&S&&(o=!0,Common.UI.HintManager.isHintVisible()&&Common.UI.HintManager.clearHints(!1,!0)),C()}})),$(document).on("keydown",(function(t){n=Common.Utils.InternalSettings.get(s+"settings-show-alt-hints")&&t.keyCode==Common.UI.Keys.ALT&&!t.shiftKey&&!Common.Utils.ModalWindow.isVisible()&&u&&!(window.PE&&$("#pe-preview").is(":visible")),Common.localStorage.getBool("screen-reader-focus-mode",!1)?!$(document.body).hasClass("focus-mode")&&$(document.body).addClass("focus-mode"):$(document.body).hasClass("focus-mode")&&$(document.body).removeClass("focus-mode")}))}},isFocusMode:function(){return!!o},exitFocusMode:k}},define("common/main/lib/controller/ScreenReaderFocus",(function(){})),void 0===Common)Common={};if(define("common/main/lib/component/ComboBoxDataView",[],(function(){"use strict";Common.UI.ComboBoxDataView=Common.UI.BaseView.extend({options:{id:null,cls:"",style:"",hint:!1,formTemplate:null,disabled:!1,menuCls:"",menuStyle:"",restoreHeight:0,takeFocusOnClose:!1,dataHint:"",dataHintDirection:"",dataHintOffset:""},template:_.template(['<div class="input-group combobox combo-dataview-menu input-group-nr dropdown-toggle <%= cls %>" data-toggle="dropdown" id="<%= id %>" style="<%= style %>">',"<%= formTemplate() %>",'<div style="display: table-cell;"></div>','<button type="button" class="btn btn-default dropdown-toggle"><span class="caret"></span></button>',"</div>"].join("")),initialize:function(t){Common.UI.BaseView.prototype.initialize.call(this,t);var e=this;e.id=e.options.id||Common.UI.getId(),this.cls=e.options.cls,this.style=e.options.style,this.menuCls=e.options.menuCls,this.menuStyle=e.options.menuStyle,this.dataViewStyle=e.options.dataViewStyle,this.dataViewCls=e.options.dataViewCls,this.template=e.options.template||e.template,this.itemTemplate=e.options.itemTemplate,this.disabled=e.options.disabled,this.groups=e.options.groups||null,this.store=e.options.store||new Common.UI.DataViewStore,this.updateFormControl=e.options.updateFormControl,this.options.data&&e.store.add(this.options.data),this.formTemplate=this.options.formTemplate||_.template(['<div class="form-control" style="width: 100px;" data-hint="<%= dataHint %>" data-hint-direction="<%= dataHintDirection %>" data-hint-offset="<%= dataHintOffset %>">','<i class="img-arrows"><svg><use xlink:href=""></use></svg></i>',"</div>"].join("")),e.rendered=e.options.rendered||!1,e.options.el?e.render():e.options.parentEl&&e.render(e.options.parentEl)},render:function(t){var e=this;if(e.rendered?this.cmpEl=e.$el||$(this.el):(this.cmpEl=$(this.template({id:this.id,cls:this.cls,style:this.style,formTemplate:this.formTemplate,dataHintDirection:this.options.dataHintDirection,dataHintOffset:this.options.dataHintOffset,isRTL:Common.UI.isRTL()})),t?(this.setElement(t,!1),t.html(this.cmpEl)):this.$el.html(this.cmpEl)),!e.rendered){var i=this.cmpEl;this._button=i.find(".btn"),this._formControl=i.find(".form-control"),Common.NotificationCenter.on("menumanager:hideall",_.bind(e.closeMenu,e))}return e.getMenu(),e.rendered=!0,e.disabled&&e.setDisabled(e.disabled),this},getMenu:function(t){if("object"!=typeof this.menu){t=t||this.options;var e=Common.UI.getId(),i=this.$el||$(this.el),s=new Common.UI.Menu({id:e,cls:t.menuCls,style:t.menuStyle,additionalAlign:t.additionalAlign,items:(t.additionalItems?t.additionalItems:[]).concat([{template:_.template('<div id="'+e+'-data-menu" style="'+t.dataViewStyle+'" class="'+t.dataViewCls+'"></div>')}])}).render(i);this.dataPicker=new Common.UI.DataView({el:i.find("#"+e+"-data-menu"),parentMenu:s,outerMenu:{menu:s,index:t.additionalItems?t.additionalItems.length:0,focusOnShow:!t.additionalItems},groups:t.groups,store:t.store,itemTemplate:t.itemTemplate,restoreHeight:t.restoreHeight}),this.dataPicker.on("item:click",_.bind(this.onClickItem,this)),s.setInnerMenu([{menu:this.dataPicker,index:t.additionalItems?t.additionalItems.length:0}]);var n=this;s.on("keydown:before",_.bind(this.onBeforeKeyDown,this)),s.on("show:after",(function(e){n.dataPicker&&_.delay((function(){!t.additionalItems&&n.dataPicker.focus()}),10)})).on("hide:after",(function(){n.options.takeFocusOnClose&&setTimeout((function(){n.focus()}),1)})),this.menu=s}return this.menu},getPicker:function(){return this.dataPicker},onClickItem:function(t,e,i){this.updateFormControl&&this.updateFormControl.call(this,i),this.disabled||this.isSuspendEvents||this.trigger("item:click",this,t,e,i)},selectRecord:function(t){this.rendered&&(this.dataPicker&&this.dataPicker.selectRecord(t,!0),this.updateFormControl&&this.updateFormControl.call(this,t))},onBeforeKeyDown:function(t,e){if((e.keyCode==Common.UI.Keys.DOWN||e.keyCode==Common.UI.Keys.SPACE)&&!this.isMenuOpen())return $("button",this.cmpEl).click(),e.preventDefault(),e.stopPropagation(),!1},closeMenu:function(){(this.$el||$(this.el)).removeClass("open")},isMenuOpen:function(){return(this.$el||$(this.el)).hasClass("open")},setTabIndex:function(t){this.rendered&&(this.tabindex=t.toString(),!this.disabled&&this._formControl.attr("tabindex",this.tabindex))},setDisabled:function(t){t=!!t,this.disabled=t,this.rendered&&(void 0!==this.tabindex&&(t&&(this.tabindex=this._formControl.attr("tabindex")),this._formControl.attr("tabindex",t?"-1":this.tabindex)),this.cmpEl.toggleClass("disabled",t),this._button.toggleClass("disabled",t),this._formControl.toggleClass("disabled",t))},isDisabled:function(){return this.disabled},focus:function(){this._formControl&&this._formControl.focus()}})})),define("common/main/lib/view/AdvancedSettingsWindow",[],(function(){"use strict";Common.Views.AdvancedSettingsWindow=Common.UI.Window.extend(_.extend({initialize:function(t){var e={};_.extend(e,{height:"auto",header:!0,cls:"advanced-settings-dlg",toggleGroup:"advanced-settings-group",contentTemplate:"",contentStyle:"",items:[],buttons:["ok","cancel"],separator:!0},t),this.template=t.template||['<div class="box">',"<% if (items.length>0) { %>",'<div class="menu-panel">',"<% _.each(items, function(item) { %>",'<div id="slot-category-<%= item.panelId %>"></div>',"<% }); %>","</div>",'<div class="separator"></div>',"<% } %>",'<div class="content-panel" style="<%= contentStyle %>">'+e.contentTemplate+"</div>","</div>","<% if (separator) { %>",'<div class="separator horizontal"></div>',"<% } %>"].join(""),e.tpl=_.template(this.template)(e),this.handler=e.handler,this.toggleGroup=e.toggleGroup,this.contentWidth=e.contentWidth,this.storageName=e.storageName,Common.UI.Window.prototype.initialize.call(this,e)},render:function(){Common.UI.Window.prototype.render.call(this);var t=this,e=this.getChild();e.find(".dlg-btn").on("click",_.bind(this.onDlgBtnClick,this)),this.on("animate:after",_.bind(this.onAnimateAfter,this)),this.btnsCategory=[],this.options.items.forEach((function(i,s){var n=new Common.UI.Button({parentEl:e.find("#slot-category-"+i.panelId),cls:"btn-category "+(i.categoryCls||""),caption:i.panelCaption,iconCls:i.categoryIcon||"",enableToggle:!0,toggleGroup:t.toggleGroup,allowDepress:!1,contentTarget:i.panelId});n.cmpEl.attr("content-target",i.panelId),n.on("click",_.bind(t.onCategoryClick,t,n,s)),t.btnsCategory.push(n)}));let i=e.find(".menu-panel");if(this.content_panel=e.find(".content-panel"),this.content_panel.width(this.contentWidth),e.width((i.length>0?i.outerWidth():0)+this.content_panel.outerWidth()+2),this.options.contentHeight)e.find(".body > .box").css("height",this.options.contentHeight);else if("number"==typeof this.options.height){var s=e.find(".body"),n=parseInt(e.find(".header").css("height"))+parseInt(e.find(".footer").css("height"))+parseInt(s.css("padding-top"))+parseInt(s.css("padding-bottom"))+parseInt(e.css("border-bottom-width"))+parseInt(e.css("border-top-width"));e.find(".body > .box").css("height",this.options.height-n)}this.content_panels=e.find(".settings-panel"),this.btnsCategory.length>0&&this.btnsCategory[0].toggle(!0,!0);var a=function(){e.width((i.length>0?i.outerWidth():0)+t.content_panel.outerWidth()+2)};$(window).on("resize",a),this.on("close",(function(){$(window).off("resize",a)}))},setHeight:function(t){Common.UI.Window.prototype.setHeight.call(this,t);var e=this.getChild(),i=e.find(".body"),s=parseInt(e.find(".footer").css("height"))+parseInt(i.css("padding-top"))+parseInt(i.css("padding-bottom"));e.find(".body > .box").css("height",parseInt(i.css("height"))-s)},setInnerHeight:function(t){var e=this.getChild(),i=e.find(".body"),s=parseInt(e.find(".header").css("height"))+parseInt(e.find(".footer").css("height"))+parseInt(i.css("padding-top"))+parseInt(i.css("padding-bottom"))+parseInt(e.css("border-bottom-width"))+parseInt(e.css("border-top-width"));void 0===t&&(t=parseInt(e.find(".body > .box").css("height"))),Common.UI.Window.prototype.setHeight.call(this,t+s),e.find(".body > .box").css("height",t)},fixHeight:function(t){let e=this.content_panels.filter(".active").height()-this.content_panel.height();(t||e>0)&&this.setInnerHeight(parseInt(this.$window.find(".body > .box").css("height"))+e)},onDlgBtnClick:function(t){var e=t.currentTarget.attributes.result.value;this.handler&&this.handler.call(this,e,"ok"==e?this.getSettings():void 0)||this.close()},onCategoryClick:function(t,e){this.content_panels.filter(".active").removeClass("active"),$("#"+t.options.contentTarget).addClass("active"),this.fixHeight()},getSettings:function(){},onPrimary:function(){return this.handler&&this.handler.call(this,"ok",this.getSettings())||this.close(),!1},setActiveCategory:function(t){if(!(this.btnsCategory.length<1)){t=t>=0&&t<this.btnsCategory.length?t:0;var e=this.btnsCategory[t];if(!e.isVisible()||e.isDisabled())for(var i=0;i<this.btnsCategory.length;i++){var s=this.btnsCategory[i];if(s.isVisible()&&!s.isDisabled()){e=s,t=i;break}}e.toggle(!0),this.onCategoryClick(e,t)}},getActiveCategory:function(){var t=-1;return this.btnsCategory.forEach((function(e,i){e.pressed&&(t=i)})),t},close:function(t){this.storageName&&Common.localStorage.setItem(this.storageName,this.getActiveCategory()),Common.UI.Window.prototype.close.call(this,t)},onThemeChanged:function(){this.$window&&this.isVisible()&&(Common.UI.Window.prototype.onThemeChanged.call(this),this.fixHeight())},onAnimateAfter:function(){}},Common.Views.AdvancedSettingsWindow||{}))})),define("text",["module"],(function(t){"use strict";var e,i,s,n,a,o=["Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.4.0"],l=/^\s*<\?xml(\s)+version=[\'\"](\d)*.(\d)*[\'\"](\s)*\?>/im,r=/<body[^>]*>\s*([\s\S]+)\s*<\/body>/im,c="undefined"!=typeof location&&location.href,d=c&&location.protocol&&location.protocol.replace(/\:/,""),h=c&&location.hostname,p=c&&(location.port||void 0),m={},u=t.config&&t.config()||{};function g(t,e){return void 0===t||""===t?e:t}return e={version:"2.0.16",strip:function(t){if(t){var e=(t=t.replace(l,"")).match(r);e&&(t=e[1])}else t="";return t},jsEscape:function(t){return t.replace(/(['\\])/g,"\\$1").replace(/[\f]/g,"\\f").replace(/[\b]/g,"\\b").replace(/[\n]/g,"\\n").replace(/[\t]/g,"\\t").replace(/[\r]/g,"\\r").replace(/[\u2028]/g,"\\u2028").replace(/[\u2029]/g,"\\u2029")},createXhr:u.createXhr||function(){var t,e,i;if("undefined"!=typeof XMLHttpRequest)return new XMLHttpRequest;if("undefined"!=typeof ActiveXObject)for(e=0;e<3;e+=1){i=o[e];try{t=new ActiveXObject(i)}catch(t){}if(t){o=[i];break}}return t},parseName:function(t){var e,i,s,n=!1,a=t.lastIndexOf("."),o=0===t.indexOf("./")||0===t.indexOf("../");return-1!==a&&(!o||a>1)?(e=t.substring(0,a),i=t.substring(a+1)):e=t,-1!==(a=(s=i||e).indexOf("!"))&&(n="strip"===s.substring(a+1),s=s.substring(0,a),i?i=s:e=s),{moduleName:e,ext:i,strip:n}},xdRegExp:/^((\w+)\:)?\/\/([^\/\\]+)/,useXhr:function(t,i,s,n){var a,o,l,r=e.xdRegExp.exec(t);return!r||(a=r[2],l=(o=(o=r[3]).split(":"))[1],o=o[0],(!a||a===i)&&(!o||o.toLowerCase()===s.toLowerCase())&&(!l&&!o||function(t,e,i,s){if(e===s)return!0;if(t===i){if("http"===t)return g(e,"80")===g(s,"80");if("https"===t)return g(e,"443")===g(s,"443")}return!1}(a,l,i,n)))},finishLoad:function(t,i,s,n){s=i?e.strip(s):s,u.isBuild&&(m[t]=s),n(s)},load:function(t,i,s,n){if(n&&n.isBuild&&!n.inlineText)s();else{u.isBuild=n&&n.isBuild;var a=e.parseName(t),o=a.moduleName+(a.ext?"."+a.ext:""),l=i.toUrl(o),r=u.useXhr||e.useXhr;0!==l.indexOf("empty:")?!c||r(l,d,h,p)?e.get(l,(function(i){e.finishLoad(t,a.strip,i,s)}),(function(t){s.error&&s.error(t)})):i([o],(function(t){e.finishLoad(a.moduleName+"."+a.ext,a.strip,t,s)}),(function(t){s.error&&s.error(t)})):s()}},write:function(t,i,s,n){if(m.hasOwnProperty(i)){var a=e.jsEscape(m[i]);s.asModule(t+"!"+i,"define(function () { return '"+a+"';});\n")}},writeFile:function(t,i,s,n,a){var o=e.parseName(i),l=o.ext?"."+o.ext:"",r=o.moduleName+l,c=s.toUrl(o.moduleName+l)+".js";e.load(r,s,(function(i){var s=function(t){return n(c,t)};s.asModule=function(t,e){return n.asModule(t,c,e)},e.write(t,r,s,a)}),a)}},"node"===u.env||!u.env&&"undefined"!=typeof process&&process.versions&&process.versions.node&&!process.versions["node-webkit"]&&!process.versions["atom-shell"]?(i=require.nodeRequire("fs"),e.get=function(t,e,s){try{var n=i.readFileSync(t,"utf8");"\ufeff"===n[0]&&(n=n.substring(1)),e(n)}catch(t){s&&s(t)}}):"xhr"===u.env||!u.env&&e.createXhr()?e.get=function(t,i,s,n){var a,o=e.createXhr();if(o.open("GET",t,!0),n)for(a in n)n.hasOwnProperty(a)&&o.setRequestHeader(a.toLowerCase(),n[a]);u.onXhr&&u.onXhr(o,t),o.onreadystatechange=function(e){var n,a;4===o.readyState&&((n=o.status||0)>399&&n<600?((a=new Error(t+" HTTP status: "+n)).xhr=o,s&&s(a)):i(o.responseText),u.onXhrComplete&&u.onXhrComplete(o,t))},o.send(null)}:"rhino"===u.env||!u.env&&"undefined"!=typeof Packages&&"undefined"!=typeof java?e.get=function(t,e){var i,s,n=new java.io.File(t),a=java.lang.System.getProperty("line.separator"),o=new java.io.BufferedReader(new java.io.InputStreamReader(new java.io.FileInputStream(n),"utf-8")),l="";try{for(i=new java.lang.StringBuffer,(s=o.readLine())&&s.length()&&65279===s.charAt(0)&&(s=s.substring(1)),null!==s&&i.append(s);null!==(s=o.readLine());)i.append(a),i.append(s);l=String(i.toString())}finally{o.close()}e(l)}:("xpconnect"===u.env||!u.env&&"undefined"!=typeof Components&&Components.classes&&Components.interfaces)&&(s=Components.classes,n=Components.interfaces,Components.utils.import("resource://gre/modules/FileUtils.jsm"),a="@mozilla.org/windows-registry-key;1"in s,e.get=function(t,e){var i,o,l,r={};a&&(t=t.replace(/\//g,"\\")),l=new FileUtils.File(t);try{(i=s["@mozilla.org/network/file-input-stream;1"].createInstance(n.nsIFileInputStream)).init(l,1,0,!1),(o=s["@mozilla.org/intl/converter-input-stream;1"].createInstance(n.nsIConverterInputStream)).init(i,"utf-8",i.available(),n.nsIConverterInputStream.DEFAULT_REPLACEMENT_CHARACTER),o.readString(i.available(),r),o.close(),i.close(),e(r.value)}catch(t){throw new Error((l&&l.path||"")+": "+t)}}),e})),define("text!common/main/lib/template/AutoCorrectDialog.template",[],(function(){return'<div id="id-autocorrect-dialog-settings-math" class="settings-panel active">\n    <div class="inner-content">\n        <table cols="1" style="width: 100%;" role="presentation">\n        <tr>\n            <td class="padding-small">\n                <div id="auto-correct-chb-replace-type"></div>\n            </td>\n        </tr>\n        <tr>\n            <td>\n                <label style="width: 117px;"><%= scope.textReplace %>:</label>\n                <label><%= scope.textBy %>:</label>\n                </td>\n            </tr>\n        <tr>\n            <td class="padding-very-small">\n                <div id="auto-correct-replace" class="margin-right-2" style="width: 115px;display: inline-block;"></div>\n                <div id="auto-correct-by" style="width: 234px;display: inline-block;"></div>\n                </td>\n            </tr>\n        <tr>\n            <td class="padding-small">\n                <div id="auto-correct-math-list" class="" style="width:100%; height: 208px;"></div>\n                </td>\n            </tr>\n        <tr>\n            <td class="padding-small">\n                <button type="button" class="btn btn-text-default auto" id="auto-correct-btn-reset" style="min-width: 86px;"><%= scope.textResetAll %></button>\n                <button type="button" class="btn btn-text-default auto float-right" id="auto-correct-btn-delete" style="min-width: 86px;"><%= scope.textDelete %></button>\n                <button type="button" class="btn btn-text-default auto float-right margin-right-5" id="auto-correct-btn-edit" style="min-width: 86px;"><%= scope.textAdd %></button>\n                </td>\n            </tr>\n        </table>\n    </div>\n</div>\n<div id="id-autocorrect-dialog-settings-recognized" class="settings-panel">\n    <div class="inner-content">\n        <table cols="1" style="width: 100%;" role="presentation">\n            <tr>\n                <td class="padding-small">\n                    <label><%= scope.textRecognizedDesc %></label>\n                </td>\n            </tr>\n            <tr>\n                <td>\n                    <div id="auto-correct-rec-find" style="width: 100%;margin-bottom: 4px;"></div>\n                </td>\n            </tr>\n            <tr>\n                <td class="padding-small">\n                    <div id="auto-correct-recognized-list" class="" style="width:100%; height: 208px;"></div>\n                </td>\n            </tr>\n            <tr>\n                <td class="padding-small">\n                    <button type="button" class="btn btn-text-default auto" id="auto-correct-btn-rec-reset" style="min-width: 86px;"><%= scope.textResetAll %></button>\n                    <button type="button" class="btn btn-text-default auto float-right" id="auto-correct-btn-rec-delete" style="min-width: 86px;"><%= scope.textDelete %></button>\n                    <button type="button" class="btn btn-text-default auto float-right margin-right-5" id="auto-correct-btn-rec-edit" style="min-width: 86px;"><%= scope.textAdd %></button>\n                </td>\n            </tr>\n        </table>\n    </div>\n</div>\n<div id="id-autocorrect-dialog-settings-de-autoformat" class="settings-panel">\n    <div class="inner-content" style="width: 100%;">\n        <div class="padding-small">\n            <label class="header"><%= scope.textReplaceText %></label>\n        </div>\n        <div class="padding-small">\n            <div class="padding-small" id="id-autocorrect-dialog-chk-quotes"></div>\n            <div class="padding-small" id="id-autocorrect-dialog-chk-hyphens"></div>\n            <div class="padding-small"  id="id-autocorrect-dialog-chk-hyperlink"></div>\n            <div class="padding-small" id="id-autocorrect-dialog-chk-double-space"></div>\n        </div>\n        <div class="padding-small">\n            <label class="header"><%= scope.textApplyText %></label>\n        </div>\n        <div class="padding-small">\n            <div class="padding-small" id="id-autocorrect-dialog-chk-bulleted"></div>\n            <div class="padding-small" id="id-autocorrect-dialog-chk-numbered"></div>\n        </div>\n    </div>\n</div>\n<div id="id-autocorrect-dialog-settings-sse-autoformat" class="settings-panel">\n    <div class="inner-content" style="width: 100%;">\n        <div class="padding-small">\n            <label class="header"><%= scope.textReplaceText %></label>\n        </div>\n        <div class="padding-small">\n            <div class="padding-small" id="id-autocorrect-dialog-chk-hyperlink"></div>\n        </div>\n        <div class="padding-small">\n            <label class="header"><%= scope.textApplyAsWork %></label>\n        </div>\n        <div class="padding-small">\n            <div class="padding-small" id="id-autocorrect-dialog-chk-new-rows"></div>\n        </div>\n    </div>\n</div>\n<div id="id-autocorrect-dialog-settings-exceptions" class="settings-panel">\n    <div class="inner-content">\n        <table cols="1" style="width: 100%;" role="presentation">\n            <tr>\n                <td class="padding-large">\n                    <div id="auto-correct-exceptions-chk-sentence" class="padding-small"></div>\n                    <div id="auto-correct-exceptions-chk-cells"></div>\n                </td>\n            </tr>\n            <tr>\n                <td>\n                    <label><%= scope.textForLangFL %></label>\n                </td>\n            </tr>\n            <tr>\n                <td class="padding-large">\n                    <div id="auto-correct-exceptions-lang" style="display: inline-block;vertical-align: middle;"></div>\n                </td>\n            </tr>\n            <tr>\n                <td>\n                    <label><%= scope.textFLDont %></label>\n                    <div id="auto-correct-exceptions-find" style="width: 100%;margin-bottom: 4px;"></div>\n                </td>\n            </tr>\n            <tr>\n                <td class="padding-small">\n                    <div id="auto-correct-exceptions-list" class="" style="width:100%; height: 139px;"></div>\n                </td>\n            </tr>\n            <tr>\n                <td class="padding-small">\n                    <button type="button" class="btn btn-text-default auto" id="auto-correct-btn-exceptions-reset" style="min-width: 86px;"><%= scope.textResetAll %></button>\n                    <button type="button" class="btn btn-text-default auto float-right" id="auto-correct-btn-exceptions-delete" style="min-width: 86px;"><%= scope.textDelete %></button>\n                    <button type="button" class="btn btn-text-default auto float-right margin-right-5" id="auto-correct-btn-exceptions-edit" style="min-width: 86px;"><%= scope.textAdd %></button>\n                </td>\n            </tr>\n        </table>\n    </div>\n</div>\n'})),void 0===Common)Common={};if(define("common/main/lib/view/AutoCorrectDialog",["text!common/main/lib/template/AutoCorrectDialog.template","common/main/lib/view/AdvancedSettingsWindow"],(function(t){"use strict";var e=new Common.UI.DataViewStore,i=new Common.UI.DataViewStore,s=new Common.UI.DataViewStore,n=[1033,1049];Common.Views.AutoCorrectDialog=Common.Views.AdvancedSettingsWindow.extend(_.extend({options:{contentWidth:375,contentHeight:355,buttons:["close"],toggleGroup:"autocorrect-dialog-group"},initialize:function(e){var i=Common.localStorage.getKeysFilter();this.appPrefix=i&&i.length?i.split(",")[0]:"";var s=[{panelId:"id-autocorrect-dialog-settings-math",panelCaption:this.textMathCorrect},{panelId:"id-autocorrect-dialog-settings-recognized",panelCaption:this.textRecognized}];"de-"==this.appPrefix||"pe-"==this.appPrefix?(s.push({panelId:"id-autocorrect-dialog-settings-de-autoformat",panelCaption:this.textAutoFormat}),s.push({panelId:"id-autocorrect-dialog-settings-exceptions",panelCaption:this.textAutoCorrect})):"sse-"==this.appPrefix&&s.push({panelId:"id-autocorrect-dialog-settings-sse-autoformat",panelCaption:this.textAutoFormat}),_.extend(this.options,{title:this.textTitle,storageName:this.appPrefix+"autocorrect-dialog-category",items:s,contentTemplate:_.template(t)({scope:this})},e||{}),this.api=this.options.api;var n=this.appPrefix+"settings-math-correct",a=Common.Utils.InternalSettings.get(n+"-add");this.arrAdd=a?JSON.parse(a):[],a=Common.Utils.InternalSettings.get(n+"-rem"),this.arrRem=a?JSON.parse(a):[],n=this.appPrefix+"settings-rec-functions",a=Common.Utils.InternalSettings.get(n+"-add"),this.arrAddRec=a?JSON.parse(a):[],a=Common.Utils.InternalSettings.get(n+"-rem"),this.arrRemRec=a?JSON.parse(a):[],this.arrAddExceptions={},this.arrRemExceptions={},Common.Views.AdvancedSettingsWindow.prototype.initialize.call(this,this.options)},render:function(){Common.Views.AdvancedSettingsWindow.prototype.render.call(this);var t=this.getChild(),a=this,o=t.find("#id-autocorrect-dialog-settings-"+("pe-"==this.appPrefix?"de-":this.appPrefix)+"autoformat");if(this.chReplaceType=new Common.UI.CheckBox({el:t.find("#auto-correct-chb-replace-type"),labelText:this.textReplaceType,value:Common.Utils.InternalSettings.get(this.appPrefix+"settings-math-correct-replace-type")}).on("change",(function(t,e,i,s){var n="checked"===t.getValue();Common.localStorage.setBool(a.appPrefix+"settings-math-correct-replace-type",n),Common.Utils.InternalSettings.set(a.appPrefix+"settings-math-correct-replace-type",n),a.api.asc_updateFlagAutoCorrectMathSymbols(n)})),this.onInitList(),this.mathList=new Common.UI.ListView({el:t.find("#auto-correct-math-list"),store:new Common.UI.DataViewStore(e.slice(0,9)),simpleAddMode:!1,template:_.template(['<div class="listview inner" style=""></div>'].join("")),itemTemplate:_.template(['<div id="<%= id %>" class="list-item" style="pointer-events:none;width: 100%;display:flex;">','<div class="padding-right-5" style="width:110px;overflow: hidden;text-overflow: ellipsis;<% if (defaultDisabled) { %> font-style:italic; opacity: 0.5;<% } %>"><%= Common.Utils.String.htmlEncode(replaced) %></div>','<div style="width:230px;overflow-x: clip;overflow-y:visible;text-overflow: ellipsis;flex-grow:1;font-family: Cambria Math;font-size:13px;white-space: nowrap;<% if (defaultDisabled) { %> font-style:italic; opacity: 0.5;<% } %>"><%= Common.Utils.String.htmlEncode(by) %></div>',"</div>"].join("")),scrollAlwaysVisible:!0,tabindex:1}),this.mathList.on("item:select",_.bind(this.onSelectMathItem,this)),this.inputReplace=new Common.UI.InputField({el:t.find("#auto-correct-replace"),allowBlank:!0,validateOnChange:!0,maxLength:31,validation:function(){return!0}}).on("changing",(function(t,e){var i;e.length&&((i=a.mathList.store.find((function(t){if(0==t.get("replaced").indexOf(e))return!0})))&&(a.mathList.scrollToRecord(i,!0),i.get("replaced")==e?a.mathList.selectRecord(i,!0):i=null));!i&&a.mathList.deselectAll(),a.updateControls(i)})),this.inputReplace.cmpEl.find("input").on("keydown",(function(t){if("ArrowDown"==t.key){var e=a.mathList.getSelectedRec()||a.mathList.store.at(0);e&&(a.mathList.selectRecord(e),a.mathList.scrollToRecord(e)),_.delay((function(){a.mathList.focus()}),10)}})),this.inputBy=new Common.UI.InputField({el:t.find("#auto-correct-by"),allowBlank:!0,validateOnChange:!0,maxLength:255,validation:function(){return!0}}).on("changing",(function(t,e){a.updateControls()})),this.btnReset=new Common.UI.Button({el:t.find("#auto-correct-btn-reset")}),this.btnReset.on("click",_.bind(this.onResetToDefault,this)),this.btnEdit=new Common.UI.Button({el:t.find("#auto-correct-btn-edit")}),this.btnEdit.on("click",_.bind(this.onEdit,this,!1)),this.btnDelete=new Common.UI.Button({el:t.find("#auto-correct-btn-delete")}),this.btnDelete.on("click",_.bind(this.onDelete,this,!1)),this.onInitRecList(),this.mathRecList=new Common.UI.ListView({el:t.find("#auto-correct-recognized-list"),store:new Common.UI.DataViewStore(i.slice(0,9)),simpleAddMode:!1,template:_.template(['<div class="listview inner" style=""></div>'].join("")),itemTemplate:_.template(['<div id="<%= id %>" class="list-item" style="width: 340px;text-overflow: ellipsis;overflow: hidden;<% if (defaultDisabled) { %> font-style:italic; opacity: 0.5;<% } %>"><%= value %></div>'].join("")),scrollAlwaysVisible:!0,tabindex:1}),this.mathRecList.on("item:select",_.bind(this.onSelectRecItem,this)),this.inputRecFind=new Common.UI.InputField({el:t.find("#auto-correct-rec-find"),allowBlank:!0,validateOnChange:!0,maxLength:255,validation:function(){return!0}}).on("changing",(function(t,e){var i;e.length&&((i=a.mathRecList.store.find((function(t){if(0==t.get("value").indexOf(e))return!0})))&&(a.mathRecList.scrollToRecord(i,!0),i.get("value")==e?a.mathRecList.selectRecord(i,!0):i=null));!i&&a.mathRecList.deselectAll(),a.updateRecControls(i)})),this.inputRecFind.cmpEl.find("input").on("keydown",(function(t){if("ArrowDown"==t.key){var e=a.mathRecList.getSelectedRec()||a.mathRecList.store.at(0);e&&(a.mathRecList.selectRecord(e),a.mathRecList.scrollToRecord(e)),_.delay((function(){a.mathRecList.focus()}),10)}})),this.btnResetRec=new Common.UI.Button({el:t.find("#auto-correct-btn-rec-reset")}),this.btnResetRec.on("click",_.bind(this.onResetRecToDefault,this)),this.btnAddRec=new Common.UI.Button({el:t.find("#auto-correct-btn-rec-edit")}),this.btnAddRec.on("click",_.bind(this.onAddRec,this,!1)),this.btnDeleteRec=new Common.UI.Button({el:t.find("#auto-correct-btn-rec-delete")}),this.btnDeleteRec.on("click",_.bind(this.onDeleteRec,this,!1)),"de-"==this.appPrefix||"pe-"==this.appPrefix){this.chQuotes=new Common.UI.CheckBox({el:t.find("#id-autocorrect-dialog-chk-quotes"),labelText:this.textQuotes,value:Common.Utils.InternalSettings.get(this.appPrefix+"settings-autoformat-smart-quotes")}).on("change",(function(t,e,i,s){var n="checked"===t.getValue();Common.localStorage.setBool(a.appPrefix+"settings-autoformat-smart-quotes",n),Common.Utils.InternalSettings.set(a.appPrefix+"settings-autoformat-smart-quotes",n),a.api.asc_SetAutoCorrectSmartQuotes(n)})),this.chHyphens=new Common.UI.CheckBox({el:t.find("#id-autocorrect-dialog-chk-hyphens"),labelText:this.textHyphens,value:Common.Utils.InternalSettings.get(this.appPrefix+"settings-autoformat-hyphens")}).on("change",(function(t,e,i,s){var n="checked"===t.getValue();Common.localStorage.setBool(a.appPrefix+"settings-autoformat-hyphens",n),Common.Utils.InternalSettings.set(a.appPrefix+"settings-autoformat-hyphens",n),a.api.asc_SetAutoCorrectHyphensWithDash(n)})),this.chBulleted=new Common.UI.CheckBox({el:t.find("#id-autocorrect-dialog-chk-bulleted"),labelText:this.textBulleted,value:Common.Utils.InternalSettings.get(this.appPrefix+"settings-autoformat-bulleted")}).on("change",(function(t,e,i,s){var n="checked"===t.getValue();Common.localStorage.setBool(a.appPrefix+"settings-autoformat-bulleted",n),Common.Utils.InternalSettings.set(a.appPrefix+"settings-autoformat-bulleted",n),a.api.asc_SetAutomaticBulletedLists(n)})),this.chNumbered=new Common.UI.CheckBox({el:t.find("#id-autocorrect-dialog-chk-numbered"),labelText:this.textNumbered,value:Common.Utils.InternalSettings.get(this.appPrefix+"settings-autoformat-numbered")}).on("change",(function(t,e,i,s){var n="checked"===t.getValue();Common.localStorage.setBool(a.appPrefix+"settings-autoformat-numbered",n),Common.Utils.InternalSettings.set(a.appPrefix+"settings-autoformat-numbered",n),a.api.asc_SetAutomaticNumberedLists(n)})),this.chDoubleSpaces=new Common.UI.CheckBox({el:o.find("#id-autocorrect-dialog-chk-double-space"),labelText:this.textDoubleSpaces,value:Common.Utils.InternalSettings.get(this.appPrefix+"settings-autoformat-double-space")}).on("change",(function(t,e,i,s){var n="checked"===t.getValue();Common.localStorage.setBool(a.appPrefix+"settings-autoformat-double-space",n),Common.Utils.InternalSettings.set(a.appPrefix+"settings-autoformat-double-space",n),a.api.asc_SetAutoCorrectDoubleSpaceWithPeriod(n)})),this.api&&(n=this.api.asc_GetAutoCorrectSettings().get_FirstLetterExceptionManager().get_DefaultLangs()||[]),n.forEach((function(t){var e=a.appPrefix+"settings-letter-exception",i=Common.Utils.InternalSettings.get(e+"-add-"+t);a.arrAddExceptions[t]=i?JSON.parse(i):[],i=Common.Utils.InternalSettings.get(e+"-rem-"+t),a.arrRemExceptions[t]=i?JSON.parse(i):[]}));var l=Common.Utils.InternalSettings.get("settings-letter-exception-lang");if(this.exceptionsLangCmb=new Common.UI.ComboBox({el:t.find("#auto-correct-exceptions-lang"),style:"width: 145px;",menuStyle:"min-width:100%;",editable:!1,takeFocusOnClose:!0,restoreMenuHeightAndTop:!0,cls:"input-group-nr",dataHintDirection:"bottom",data:n.map((function(t){t=parseInt(t);var e=Common.util.LanguageInfo.getLocalLanguageName(t);return{displayValue:e[1],shortName:e[0],value:t}}))}).on("selected",(function(t,e){l!=e.value&&(l=e.value,Common.Utils.InternalSettings.set("settings-letter-exception-lang",l),a.onInitExceptionsList(!0),a.onChangeInputException(a.exceptionsFindInput,a.exceptionsFindInput.getValue()))})),!l){var r=this.exceptionsLangCmb.store.findWhere({value:this.api.asc_getDefaultLanguage()});if(!r){var c=Common.util.LanguageInfo.getLocalLanguageName(this.api.asc_getDefaultLanguage())[0].split(/[\-\_]/)[0];r=this.exceptionsLangCmb.store.find((function(t){return 0==t.get("shortName").indexOf(c)}))}r&&(l=r.get("value"))}this.exceptionsLangCmb.setValue(l||n[0]),this.onInitExceptionsList(!0),this.exceptionsList=new Common.UI.ListView({el:t.find("#auto-correct-exceptions-list"),store:new Common.UI.DataViewStore(s.slice(0,6)),simpleAddMode:!1,template:_.template(['<div class="listview inner" style=""></div>'].join("")),itemTemplate:_.template(['<div id="<%= id %>" class="list-item" style="width: 340px;text-overflow: ellipsis;overflow: hidden;<% if (defaultDisabled) { %> font-style:italic; opacity: 0.5;<% } %>"><%= value + "."%></div>'].join("")),scrollAlwaysVisible:!0,tabindex:1}),this.exceptionsList.on("item:select",_.bind(this.onSelectExceptionItem,this)),this.exceptionsFindInput=new Common.UI.InputField({el:t.find("#auto-correct-exceptions-find"),allowBlank:!0,validateOnChange:!0,maxLength:255,validation:function(){return!0}}).on("changing",_.bind(this.onChangeInputException,this)),this.exceptionsFindInput.cmpEl.find("input").on("keydown",(function(t){if("ArrowDown"==t.key){var e=a.exceptionsList.getSelectedRec()||a.exceptionsList.store.at(0);e&&(a.exceptionsList.selectRecord(e),a.exceptionsList.scrollToRecord(e)),_.delay((function(){a.exceptionsList.focus()}),10)}})),this.btnResetExceptions=new Common.UI.Button({el:t.find("#auto-correct-btn-exceptions-reset")}),this.btnResetExceptions.on("click",_.bind(this.onResetExceptionsToDefault,this)),this.btnAddExceptions=new Common.UI.Button({el:t.find("#auto-correct-btn-exceptions-edit")}),this.btnAddExceptions.on("click",_.bind(this.onAddException,this,!1)),this.btnDeleteExceptions=new Common.UI.Button({el:t.find("#auto-correct-btn-exceptions-delete")}),this.btnDeleteExceptions.on("click",_.bind(this.onDeleteException,this,!1)),this.chkSentenceExceptions=new Common.UI.CheckBox({el:t.find("#auto-correct-exceptions-chk-sentence"),labelText:this.textFLSentence,value:Common.Utils.InternalSettings.get(this.appPrefix+"settings-letter-exception-sentence")}).on("change",(function(t,e,i,s){var n="checked"===t.getValue();Common.localStorage.setBool(a.appPrefix+"settings-letter-exception-sentence",n),Common.Utils.InternalSettings.set(a.appPrefix+"settings-letter-exception-sentence",n),a.api.asc_SetAutoCorrectFirstLetterOfSentences&&a.api.asc_SetAutoCorrectFirstLetterOfSentences(n)})),this.chkSentenceCells=new Common.UI.CheckBox({el:t.find("#auto-correct-exceptions-chk-cells"),labelText:this.textFLCells,value:Common.Utils.InternalSettings.get(this.appPrefix+"settings-letter-exception-cells")}).on("change",(function(t,e,i,s){var n="checked"===t.getValue();Common.localStorage.setBool(a.appPrefix+"settings-letter-exception-cells",n),Common.Utils.InternalSettings.set(a.appPrefix+"settings-letter-exception-cells",n),a.api.asc_SetAutoCorrectFirstLetterOfCells&&a.api.asc_SetAutoCorrectFirstLetterOfCells(n)})),this.btnsCategory[3].on("click",_.bind(this.onAutocorrectCategoryClick,this,!1))}else"sse-"==this.appPrefix&&(this.chNewRows=new Common.UI.CheckBox({el:t.find("#id-autocorrect-dialog-chk-new-rows"),labelText:this.textNewRowCol,value:Common.Utils.InternalSettings.get(this.appPrefix+"settings-autoformat-new-rows")}).on("change",(function(t,e,i,s){var n="checked"===t.getValue();Common.localStorage.setBool(a.appPrefix+"settings-autoformat-new-rows",n),Common.Utils.InternalSettings.set(a.appPrefix+"settings-autoformat-new-rows",n),a.api.asc_setIncludeNewRowColTable(n)})));this.chHyperlink=new Common.UI.CheckBox({el:o.find("#id-autocorrect-dialog-chk-hyperlink"),labelText:this.textHyperlink,value:Common.Utils.InternalSettings.get(this.appPrefix+"settings-autoformat-hyperlink")}).on("change",(function(t,e,i,s){var n="checked"===t.getValue();Common.localStorage.setBool(a.appPrefix+"settings-autoformat-hyperlink",n),Common.Utils.InternalSettings.set(a.appPrefix+"settings-autoformat-hyperlink",n),a.api.asc_SetAutoCorrectHyperlinks(n)})),this.btnsCategory[0].on("click",_.bind(this.onMathCategoryClick,this,!1)),this.btnsCategory[1].on("click",_.bind(this.onRecCategoryClick,this,!1)),this.btnsCategory[2].on("click",_.bind(this.onAutoformatCategoryClick,this,!1)),this.afterRender()},afterRender:function(){if(this.updateControls(),this.updateRecControls(),this.updateExceptionsControls(),this.storageName){var t=Common.localStorage.getItem(this.storageName);this.setActiveCategory(null!==t?parseInt(t):0)}},getFocusedComponents:function(){var t=this.btnsCategory.concat([this.chReplaceType,this.inputReplace,this.inputBy,this.mathList,this.btnReset,this.btnEdit,this.btnDelete,this.inputRecFind,this.mathRecList,this.btnResetRec,this.btnAddRec,this.btnDeleteRec]);return t=(t=(t=t.concat(this.chNewRows?[this.chHyperlink,this.chNewRows]:[this.chQuotes,this.chHyphens,this.chHyperlink,this.chDoubleSpaces,this.chBulleted,this.chNumbered])).concat(this.chkSentenceExceptions?[this.chkSentenceExceptions,this.chkSentenceCells,this.exceptionsLangCmb,this.exceptionsFindInput,this.exceptionsList,this.btnResetExceptions,this.btnAddExceptions,this.btnDeleteExceptions]:[])).concat(this.getFooterButtons())},getSettings:function(){},onSelectMathItem:function(t,e,i){i&&(this.inputReplace.setValue(i.get("replaced")),this.inputBy.setValue(i.get("by"))),this.updateControls(i)},updateControls:function(t){if(this.mathList){t=t||this.mathList.getSelectedRec();var e=this.inputBy.getValue(),i=this.inputReplace.getValue();if(t){var s=t.get("defaultDisabled"),n=t.get("defaultValue")&&t.get("defaultValueStr")!==t.get("by");this.btnDelete.setCaption(s?this.textRestore:this.textDelete),this.btnEdit.setDisabled(s||e===t.get("by")&&!n||!e||!i),this.btnEdit.setCaption(n&&e===t.get("by")?this.textReset:this.textReplace)}else this.btnDelete.setCaption(this.textDelete),this.btnEdit.setDisabled(!e||!i),this.btnEdit.setCaption(this.textAdd);this.btnDelete.setDisabled(!t)}},show:function(){Common.Views.AdvancedSettingsWindow.prototype.show.apply(this,arguments);var t=this.getActiveCategory();0==t?this.onMathCategoryClick(!0):1==t?this.onRecCategoryClick(!0):2==t?this.onAutoformatCategoryClick(!0):3==t&&this.onAutocorrectCategoryClick(!0)},close:function(){Common.Views.AdvancedSettingsWindow.prototype.close.apply(this,arguments),this.mathList&&this.mathList.deselectAll(),this.mathRecList&&this.mathRecList.deselectAll()},onMathCategoryClick:function(t){var i=this;_.delay((function(){$("input",i.inputReplace.cmpEl).select().focus()}),t?50:0),i.mathList.store.length<e.length&&_.delay((function(){i.mathList.setStore(e),i.mathList.onResetItems()}),t?100:10)},onAutoformatCategoryClick:function(t){var e=this;_.delay((function(){"sse-"==e.appPrefix?e.chHyperlink.focus():e.chQuotes.focus()}),t?50:0)},onAutocorrectCategoryClick:function(t){var e=this;_.delay((function(){$("input",e.exceptionsFindInput.cmpEl).select().focus()}),t?50:0),e.exceptionsList.store.length<s.length&&_.delay((function(){e.exceptionsList.setStore(s),e.exceptionsList.onResetItems()}),t?100:10)},onDelete:function(){var t,i=this.mathList.getSelectedRec(),s="";if(i){if(i.get("defaultValue")){s=this.appPrefix+"settings-math-correct-rem";var n=!i.get("defaultDisabled");i.set("defaultDisabled",n),n?this.arrRem.push(i.get("replaced")):this.arrRem.splice(this.arrRem.indexOf(i.get("replaced")),1),t=JSON.stringify(this.arrRem),Common.Utils.InternalSettings.set(s,t),Common.localStorage.setItem(s,t),this.btnDelete.setCaption(n?this.textRestore:this.textDelete),n?this.api.asc_deleteFromAutoCorrectMathSymbols(i.get("replaced")):this.api.asc_AddOrEditFromAutoCorrectMathSymbols(i.get("replaced"),i.get("defaultValue"))}else e.remove(i),this.arrAdd.splice(this.arrAdd.indexOf(i.get("replaced")),1),s=this.appPrefix+"settings-math-correct-add",t=JSON.stringify(this.arrAdd),Common.Utils.InternalSettings.set(s,t),Common.localStorage.setItem(s,t),this.mathList.scroller&&this.mathList.scroller.update({}),this.api.asc_deleteFromAutoCorrectMathSymbols(i.get("replaced"));this.updateControls()}},onEdit:function(){var t=this.mathList.getSelectedRec(),i="",s=this,n=function(t,e){var i=s.appPrefix+"settings-math-correct-add",n=JSON.stringify(s.arrAdd);Common.Utils.InternalSettings.set(i,n),Common.localStorage.setItem(i,n),s.api.asc_AddOrEditFromAutoCorrectMathSymbols(t.get("replaced"),e),s.mathList.selectRecord(t),s.mathList.scrollToRecord(t)};if(t||(t=e.findWhere({replaced:this.inputReplace.getValue()})),t){var a=_.findIndex(this.arrAdd,(function(e){return e[0]==t.get("replaced")})),o=t.get("defaultValue")&&t.get("defaultValueStr")!==t.get("by")&&this.inputBy.getValue()===t.get("by");Common.UI.warning({maxwidth:500,msg:o?this.warnRestore.replace("%1",Common.Utils.String.htmlEncode(t.get("replaced"))):this.warnReplace.replace("%1",Common.Utils.String.htmlEncode(t.get("replaced"))),buttons:["yes","no"],primary:"yes",callback:_.bind((function(e,s){"yes"==e&&(o?(i=t.get("defaultValue"),t.set("by",t.get("defaultValueStr")),a>=0&&this.arrAdd.splice(a,1)):(i=this.inputBy.getValue(),t.set("by",i),a<0?this.arrAdd.push([t.get("replaced"),i]):this.arrAdd[a][1]=i),n(t,i))}),this)})}else t=e.add({replaced:this.inputReplace.getValue(),by:this.inputBy.getValue(),defaultDisabled:!1}),i=t.get("by"),this.arrAdd.push([t.get("replaced"),i]),n(t,i)},onResetToDefault:function(){Common.UI.warning({maxwidth:500,msg:this.warnReset,buttons:["yes","no"],primary:"yes",callback:_.bind((function(t,e){"yes"==t&&(this.api.asc_resetToDefaultAutoCorrectMathSymbols(),this.onResetList())}),this)})},onResetList:function(){var t=this.appPrefix+"settings-math-correct",i=JSON.stringify([]);Common.Utils.InternalSettings.set(t+"-add",i),Common.localStorage.setItem(t+"-add",i),Common.Utils.InternalSettings.set(t+"-rem",i),Common.localStorage.setItem(t+"-rem",i),this.arrAdd=[],this.arrRem=[],e.remove(e.where({defaultValue:void 0})),e.each((function(t,e){t.set("by",t.get("defaultValueStr")),t.set("defaultDisabled",!1)})),this.mathList.deselectAll(),this.mathList.scroller&&(this.mathList.scroller.update(),this.mathList.scroller.scrollTop(0)),this.updateControls()},onInitList:function(){if(!(e.length>0)){e.comparator=function(t,e){var i=t.get("replaced").toLowerCase(),s=e.get("replaced").toLowerCase();return i==s?0:i<s?-1:1};var t=this.arrAdd,i=this.arrRem,s=this.api?this.api.asc_getAutoCorrectMathSymbols():[],n=[];_.each(s,(function(t,e){var s={replaced:t[0],defaultValue:t[1],defaultDisabled:i.indexOf(t[0])>-1};"object"==typeof t[1]?(s.defaultValueStr="",_.each(t[1],(function(t){s.defaultValueStr+=Common.Utils.String.encodeSurrogateChar(t)})),s.by=s.defaultValueStr):s.by=s.defaultValueStr=Common.Utils.String.encodeSurrogateChar(t[1]),n.push(s)}));var a=[];_.each(t,(function(t,e){var i=_.findIndex(n,{replaced:t[0]});i<0?a.push({replaced:t[0],by:t[1],defaultDisabled:!1}):n[i].by=t[1]})),e.reset(n.concat(a)),this.updateControls()}},onInitRecList:function(){if(!(i.length>0)){i.comparator=function(t,e){var i=t.get("value").toLowerCase(),s=e.get("value").toLowerCase();return i==s?0:i<s?-1:1};var t=this.arrAddRec,e=this.arrRemRec,s=this.api?this.api.asc_getAutoCorrectMathFunctions():[],n=[];_.each(s,(function(t,i){n.push({value:t,defaultValue:!0,defaultDisabled:e.indexOf(t)>-1})}));var a=[];_.each(t,(function(t,e){_.findIndex(n,{value:t})<0&&a.push({value:t,defaultValue:!1,defaultDisabled:!1})})),i.reset(n.concat(a)),this.updateRecControls()}},onResetRecToDefault:function(){Common.UI.warning({maxwidth:500,msg:this.textWarnResetRec,buttons:["yes","no"],primary:"yes",callback:_.bind((function(t,e){"yes"==t&&(this.api.asc_resetToDefaultAutoCorrectMathFunctions(),this.onResetRecList())}),this)})},onResetRecList:function(){var t=this.appPrefix+"settings-rec-functions",e=JSON.stringify([]);Common.Utils.InternalSettings.set(t+"-add",e),Common.localStorage.setItem(t+"-add",e),Common.Utils.InternalSettings.set(t+"-rem",e),Common.localStorage.setItem(t+"-rem",e),this.arrAddRec=[],this.arrRemRec=[],i.remove(i.where({defaultValue:!1})),i.each((function(t,e){t.set("defaultDisabled",!1)})),this.mathRecList.deselectAll(),this.mathRecList.scroller&&(this.mathRecList.scroller.update(),this.mathRecList.scroller.scrollTop(0)),this.updateRecControls()},onRecCategoryClick:function(t){var e=this;_.delay((function(){$("input",e.inputRecFind.cmpEl).select().focus()}),t?50:0),e.mathRecList.store.length<i.length&&_.delay((function(){e.mathRecList.setStore(i),e.mathRecList.onResetItems()}),t?100:10)},onDeleteRec:function(){var t,e,s=this.mathRecList.getSelectedRec();if(s){if(s.get("defaultValue")){t=this.appPrefix+"settings-rec-functions-rem";var n=!s.get("defaultDisabled");s.set("defaultDisabled",n),n?this.arrRemRec.push(s.get("value")):this.arrRemRec.splice(this.arrRemRec.indexOf(s.get("value")),1),e=JSON.stringify(this.arrRemRec),Common.Utils.InternalSettings.set(t,e),Common.localStorage.setItem(t,e),this.btnDeleteRec.setCaption(n?this.textRestore:this.textDelete),n?this.api.asc_deleteFromAutoCorrectMathFunctions(s.get("value")):this.api.asc_AddFromAutoCorrectMathFunctions(s.get("value"))}else i.remove(s),this.arrAddRec.splice(this.arrAddRec.indexOf(s.get("value")),1),t=this.appPrefix+"settings-rec-functions-add",e=JSON.stringify(this.arrAddRec),Common.Utils.InternalSettings.set(t,e),Common.localStorage.setItem(t,e),this.mathRecList.scroller&&this.mathRecList.scroller.update({}),this.api.asc_deleteFromAutoCorrectMathFunctions(s.get("value"));this.updateRecControls()}},onAddRec:function(){var t,e,s,n=this.mathRecList.getSelectedRec(),a=this;n||(n=i.findWhere({value:this.inputRecFind.getValue()})),n?(a.mathRecList.selectRecord(n),a.mathRecList.scrollToRecord(n)):/^[A-Z]+$/i.test(this.inputRecFind.getValue())?(n=i.add({value:this.inputRecFind.getValue(),defaultValue:!1,defaultDisabled:!1}),this.arrAddRec.push(n.get("value")),t=n,e=a.appPrefix+"settings-rec-functions-add",s=JSON.stringify(a.arrAddRec),Common.Utils.InternalSettings.set(e,s),Common.localStorage.setItem(e,s),a.api.asc_AddFromAutoCorrectMathFunctions(t.get("value")),a.mathRecList.selectRecord(t),a.mathRecList.scrollToRecord(t)):Common.UI.warning({maxwidth:500,msg:this.textWarnAddRec})},onSelectRecItem:function(t,e,i){i&&this.inputRecFind.setValue(i.get("value")),this.updateRecControls(i)},updateRecControls:function(t){if(this.mathRecList){t=t||this.mathRecList.getSelectedRec();var e=this.inputRecFind.getValue();this.btnDeleteRec.setCaption(t&&t.get("defaultDisabled")?this.textRestore:this.textDelete),this.btnDeleteRec.setDisabled(!t),this.btnAddRec.setDisabled(!!t||!e)}},onInitExceptionsList:function(t){if(!(s.length>0)||t){s.comparator=function(t,e){var i=t.get("value").toLowerCase(),s=e.get("value").toLowerCase();return i==s?0:i<s?-1:1};var e=this.exceptionsLangCmb.getValue(),i=this.arrAddExceptions[e]?this.arrAddExceptions[e]:[],n=this.arrRemExceptions[e]?this.arrRemExceptions[e]:[],a=this.api?this.api.asc_GetAutoCorrectSettings().get_FirstLetterExceptionManager().get_DefaultExceptions(e):[],o=[];_.each(a,(function(t,e){o.push({value:t,defaultValue:!0,defaultDisabled:n.indexOf(t)>-1})}));var l=[];_.each(i,(function(t,e){_.findIndex(o,{value:t})<0&&l.push({value:t,defaultValue:!1,defaultDisabled:!1})})),s.reset(o.concat(l)),this.updateExceptionsControls()}},onResetExceptionsToDefault:function(){var t=this.api.asc_GetAutoCorrectSettings().get_FirstLetterExceptionManager(),e=this.exceptionsLangCmb.getValue();Common.UI.warning({maxwidth:500,msg:this.textWarnResetFL,buttons:["yes","no"],primary:"yes",callback:_.bind((function(i,s){"yes"==i&&(t.put_Exceptions(t.get_DefaultExceptions(e),e),this.onResetExceptionsList())}),this)})},onResetExceptionsList:function(){var t=this.appPrefix+"settings-letter-exception",e=this.exceptionsLangCmb.getValue(),i=JSON.stringify([]);Common.Utils.InternalSettings.set(t+"-add-"+e,i),Common.localStorage.setItem(t+"-add-"+e,i),Common.Utils.InternalSettings.set(t+"-rem-"+e,i),Common.localStorage.setItem(t+"-rem-"+e,i),this.arrAddExceptions[e]=[],this.arrRemExceptions[e]=[],s.remove(s.where({defaultValue:!1})),s.each((function(t,e){t.set("defaultDisabled",!1)})),this.exceptionsList.deselectAll(),this.exceptionsList.scroller&&(this.exceptionsList.scroller.update(),this.exceptionsList.scroller.scrollTop(0)),this.updateExceptionsControls()},onDeleteException:function(){var t=this.exceptionsList.getSelectedRec(),e=this.api.asc_GetAutoCorrectSettings().get_FirstLetterExceptionManager(),i=this.exceptionsLangCmb.getValue();if(t){var n,a="";if(t.get("defaultValue")){var o=!t.get("defaultDisabled");a=this.appPrefix+"settings-letter-exception-rem-"+i,t.set("defaultDisabled",o),o?this.arrRemExceptions[i].push(t.get("value")):this.arrRemExceptions[i].splice(this.arrRemExceptions[i].indexOf(t.get("value")),1),n=JSON.stringify(this.arrRemExceptions[i]),Common.Utils.InternalSettings.set(a,n),Common.localStorage.setItem(a,n),this.btnDeleteExceptions.setCaption(o?this.textRestore:this.textDelete),o?e.remove_Exception(t.get("value"),i):e.add_Exception(t.get("value"),i)}else s.remove(t),this.arrAddExceptions[i].splice(this.arrAddExceptions[i].indexOf(t.get("value")),1),a=this.appPrefix+"settings-letter-exception-add-"+i,n=JSON.stringify(this.arrAddExceptions[i]),Common.Utils.InternalSettings.set(a,n),Common.localStorage.setItem(a,n),this.exceptionsList.scroller&&this.exceptionsList.scroller.update({}),e.remove_Exception(t.get("value"),i);this.updateExceptionsControls()}},onAddException:function(){var t,e,i,n=this.exceptionsList.getSelectedRec(),a=this.exceptionsLangCmb.getValue(),o=this,l=this.exceptionsFindInput.getValue().trim();n||(n=s.findWhere({value:l})),n?(o.exceptionsList.selectRecord(n),o.exceptionsList.scrollToRecord(n)):("."===l[l.length-1]&&(l=l.slice(0,-1)),/^[^\%/\\&\?\,\.\s\d\'\;:!-+!@#\$\^*)(]{1,20}$/.test(l)?(n=s.add({value:l,defaultValue:!1,defaultDisabled:!1}),this.arrAddExceptions[a].push(n.get("value")),t=n,e=o.appPrefix+"settings-letter-exception-add-"+a,i=JSON.stringify(o.arrAddExceptions[a]),Common.Utils.InternalSettings.set(e,i),Common.localStorage.setItem(e,i),o.api.asc_GetAutoCorrectSettings().get_FirstLetterExceptionManager().add_Exception(t.get("value"),a),o.exceptionsList.selectRecord(t),o.exceptionsList.scrollToRecord(t)):Common.UI.warning({maxwidth:500,msg:this.textWarnAddFL}))},onSelectExceptionItem:function(t,e,i){i&&this.exceptionsFindInput.setValue(i.get("value")),this.updateExceptionsControls(i)},onChangeInputException:function(t,e){var i;(e=e.trim()).length&&("."===e[e.length-1]&&(e=e.slice(0,-1)),(i=this.exceptionsList.store.find((function(t){if(0==t.get("value").indexOf(e))return!0})))&&(this.exceptionsList.scrollToRecord(i,!0),i.get("value")==e?this.exceptionsList.selectRecord(i,!0):i=null));!i&&this.exceptionsList.deselectAll(),this.updateExceptionsControls(i)},updateExceptionsControls:function(t){if(this.exceptionsList){t=t||this.exceptionsList.getSelectedRec();var e=this.exceptionsFindInput.getValue();this.btnDeleteExceptions.setCaption(t&&t.get("defaultDisabled")?this.textRestore:this.textDelete),this.btnDeleteExceptions.setDisabled(!t),this.btnAddExceptions.setDisabled(!!t||!e)}},textTitle:"AutoCorrect",textMathCorrect:"Math AutoCorrect",textReplace:"Replace",textBy:"By",textResetAll:"Reset to default",textAdd:"Add",textDelete:"Delete",textRestore:"Restore",textReset:"Reset",textReplaceType:"Replace text as you type",warnReset:"Any autocorrect you added will be removed and the changed ones will be restored to their original values. Do you want to continue?",warnReplace:"The autocorrect entry for %1 already exists. Do you want to replace it?",warnRestore:"The autocorrect entry for %1 will be reset to its original value. Do you want to continue?",textRecognized:"Recognized Functions",textRecognizedDesc:"The following expressions are recognized math expressions. They will not be automatically italicized.",textWarnAddRec:"Recognized functions must contain only the letters A through Z, uppercase or lowercase.",textWarnResetRec:"Any expression you added will be removed and the removed ones will be restored. Do you want to continue?",textAutoFormat:"AutoFormat As You Type",textReplaceText:"Replace As You Type",textApplyText:"Apply As You Type",textQuotes:'"Straight quotes" with "smart quotes"',textHyphens:"Hyphens (--) with dash ()",textBulleted:"Automatic bulleted lists",textNumbered:"Automatic numbered lists",textApplyAsWork:"Apply as you work",textNewRowCol:"Include new rows and columns in table",textAutoCorrect:"AutoCorrect",textFLSentence:"Capitalize first letter of sentences",textWarnResetFL:"Any exceptions you added will be removed and the removed ones will be restored. Do you want to continue?",textWarnAddFL:"Exceptions must contain only the letters, uppercase or lowercase.",textForLangFL:"Exceptions for the language:",textHyperlink:"Internet and network paths with hyperlinks",textFLCells:"Capitalize first letter of table cells",textFLDont:"Don`t capitalize after",textDoubleSpaces:"Add period with double-space"},Common.Views.AutoCorrectDialog||{}))})),define("common/main/lib/view/DocumentAccessDialog",[],(function(){"use strict";Common.Views.DocumentAccessDialog=Common.UI.Window.extend(_.extend({initialize:function(t){var e={};_.extend(e,{title:this.textTitle,width:600,header:!0},t),this.template=['<div id="id-sharing-placeholder"></div>'].join(""),e.tpl=_.template(this.template)(e),this.settingsurl=t.settingsurl||"",Common.UI.Window.prototype.initialize.call(this,e)},render:function(){Common.UI.Window.prototype.render.call(this),this.$window.find("> .body").css({height:"auto",overflow:"hidden"});var t=document.createElement("iframe");t.width="100%",t.height=500,t.align="top",t.frameBorder=0,t.scrolling="no",t.onload=_.bind(this._onLoad,this),$("#id-sharing-placeholder").append(t),this.loadMask=new Common.UI.LoadMask({owner:$("#id-sharing-placeholder")}),this.loadMask.setTitle(this.textLoading),this.loadMask.show(),t.src=this.settingsurl;var e=this;this._eventfunc=function(t){e._onWindowMessage(t)},this._bindWindowEvents.call(this),this.on("close",(function(t){e._unbindWindowEvents()}))},_bindWindowEvents:function(){window.addEventListener?window.addEventListener("message",this._eventfunc,!1):window.attachEvent&&window.attachEvent("onmessage",this._eventfunc)},_unbindWindowEvents:function(){window.removeEventListener?window.removeEventListener("message",this._eventfunc):window.detachEvent&&window.detachEvent("onmessage",this._eventfunc)},_onWindowMessage:function(t){if(t&&window.JSON)try{this._onMessage.call(this,window.JSON.parse(t.data))}catch(t){}},_onMessage:function(t){t&&"onlyoffice"==t.Referer&&(t.needUpdate&&this.trigger("accessrights",this,t.sharingSettings),Common.NotificationCenter.trigger("window:close",this))},_onLoad:function(){this.loadMask&&this.loadMask.hide()},textTitle:"Sharing Settings",textLoading:"Loading"},Common.Views.DocumentAccessDialog||{}))})),define("common/main/lib/view/SaveAsDlg",[],(function(){"use strict";Common.Views.SaveAsDlg=Common.UI.Window.extend(_.extend({initialize:function(t){var e={};_.extend(e,{title:this.textTitle,width:420,header:!0},t),this.template=['<div id="id-saveas-folder-placeholder"></div>'].join(""),e.tpl=_.template(this.template)(e),this.saveFolderUrl=t.saveFolderUrl||"",this.saveFileUrl=t.saveFileUrl||"",this.defFileName=t.defFileName||"",this.saveFolderUrl=this.saveFolderUrl.replace("{title}",encodeURIComponent(this.defFileName)).replace("{fileuri}",encodeURIComponent(this.saveFileUrl)),Common.UI.Window.prototype.initialize.call(this,e)},render:function(){Common.UI.Window.prototype.render.call(this),this.$window.find("> .body").css({height:"auto",overflow:"hidden"});var t=document.createElement("iframe");t.width="100%",t.height=645,t.align="top",t.frameBorder=0,t.scrolling="no",t.onload=_.bind(this._onLoad,this),$("#id-saveas-folder-placeholder").append(t),this.loadMask=new Common.UI.LoadMask({owner:$("#id-saveas-folder-placeholder")}),this.loadMask.setTitle(this.textLoading),this.loadMask.show(),t.src=this.saveFolderUrl;var e=this;this._eventfunc=function(t){e._onWindowMessage(t)},this._bindWindowEvents.call(this),this.on("close",(function(t){e._unbindWindowEvents()}))},_bindWindowEvents:function(){window.addEventListener?window.addEventListener("message",this._eventfunc,!1):window.attachEvent&&window.attachEvent("onmessage",this._eventfunc)},_unbindWindowEvents:function(){window.removeEventListener?window.removeEventListener("message",this._eventfunc):window.detachEvent&&window.detachEvent("onmessage",this._eventfunc)},_onWindowMessage:function(t){if(t&&window.JSON)try{this._onMessage.call(this,window.JSON.parse(t.data))}catch(t){}},_onMessage:function(t){t&&"onlyoffice"==t.Referer&&(_.isEmpty(t.error)?_.isEmpty(t.message)||Common.NotificationCenter.trigger("showmessage",{msg:t.message}):this.trigger("saveaserror",this,t.error),Common.NotificationCenter.trigger("window:close",this))},_onLoad:function(){this.loadMask&&this.loadMask.hide()},textTitle:"Folder for save",textLoading:"Loading"},Common.Views.SaveAsDlg||{}))})),void 0===Common)Common={};if(define("common/main/lib/view/CopyWarningDialog",[],(function(){"use strict";Common.Views.CopyWarningDialog=Common.UI.Window.extend(_.extend({options:{width:500,cls:"modal-dlg copy-warning",buttons:["ok"]},initialize:function(t){_.extend(this.options,{title:this.textTitle,buttons:["ok"]},t||{});const e=(window.DE||window.PE||window.SSE||window.PDFE||window.VE).getController("Common.Controllers.Shortcuts"),i={Copy:"",Cut:"",Paste:""};for(const t in i){const s=e.getShortcutsByActionType(t);s&&s[0]&&(i[t]=s[0].keys.join("+"))}this.template=['<div class="box">','<p class="message">'+this.textMsg+"</p>",'<div class="hotkeys">',"<div>",'<p class="hotkey">'+i.Copy+"</p>",'<p class="message">'+this.textToCopy+"</p>","</div>","<div>",'<p class="hotkey">'+i.Cut+"</p>",'<p class="message">'+this.textToCut+"</p>","</div>","<div>",'<p class="hotkey">'+i.Paste+"</p>",'<p class="message">'+this.textToPaste+"</p>","</div>","</div>",'<div id="copy-warning-checkbox" class="text-align-left" style="padding: 15px 0;"></div>',"</div>",'<div class="separator horizontal"></div>'].join(""),this.options.tpl=_.template(this.template)(this.options),Common.UI.Window.prototype.initialize.call(this,this.options)},render:function(){Common.UI.Window.prototype.render.call(this),this.chDontShow=new Common.UI.CheckBox({el:$("#copy-warning-checkbox"),labelText:this.textDontShow}),this.getChild().find(".dlg-btn").on("click",_.bind(this.onBtnClick,this))},getFocusedComponents:function(){return[this.chDontShow].concat(this.getFooterButtons())},getDefaultFocusableComponent:function(){return this.chDontShow},onBtnClick:function(t){this.options.handler&&this.options.handler.call(this,"checked"==this.chDontShow.getValue()),this.close()},onKeyPress:function(t){t.keyCode==Common.UI.Keys.RETURN&&(this.options.handler&&this.options.handler.call(this,"checked"==this.chDontShow.getValue()),this.close())},getSettings:function(){return"checked"==this.chDontShow.getValue()},textTitle:"Copy, Cut and Paste Actions",textMsg:"Copy, cut and paste actions using the editor toolbar buttons and context menu actions will be performed within this editor tab only.<br><br>To copy or paste to or from applications outside the editor tab use the following keyboard combinations:",textToCopy:"for Copy",textToPaste:"for Paste",textToCut:"for Cut",textDontShow:"Don't show this message again"},Common.Views.CopyWarningDialog||{}))})),define("common/main/lib/view/SelectFileDlg",[],(function(){"use strict";Common.Views.SelectFileDlg=Common.UI.Window.extend(_.extend({initialize:function(t){var e={};_.extend(e,{title:this.textTitle,width:1024,header:!0},t),this.template=['<div id="id-select-file-placeholder"></div>'].join(""),e.tpl=_.template(this.template)(e),this.fileChoiceUrl=t.fileChoiceUrl||"",Common.UI.Window.prototype.initialize.call(this,e)},render:function(){Common.UI.Window.prototype.render.call(this),this.$window.find("> .body").css({height:"auto",overflow:"hidden"});var t=document.createElement("iframe");t.width="100%",t.height=585,t.align="top",t.frameBorder=0,t.scrolling="no",t.onload=_.bind(this._onLoad,this),$("#id-select-file-placeholder").append(t),this.loadMask=new Common.UI.LoadMask({owner:$("#id-select-file-placeholder")}),this.loadMask.setTitle(this.textLoading),this.loadMask.show(),t.src=this.fileChoiceUrl;var e=this;this._eventfunc=function(t){e._onWindowMessage(t)},this._bindWindowEvents.call(this),this.on("close",(function(t){e._unbindWindowEvents()}))},_bindWindowEvents:function(){window.addEventListener?window.addEventListener("message",this._eventfunc,!1):window.attachEvent&&window.attachEvent("onmessage",this._eventfunc)},_unbindWindowEvents:function(){window.removeEventListener?window.removeEventListener("message",this._eventfunc):window.detachEvent&&window.detachEvent("onmessage",this._eventfunc)},_onWindowMessage:function(t){if(t&&window.JSON)try{this._onMessage.call(this,window.JSON.parse(t.data))}catch(t){}},_onMessage:function(t){if(t&&"onlyoffice"==t.Referer&&void 0!==t.file){Common.NotificationCenter.trigger("window:close",this);var e=this;setTimeout((function(){_.isEmpty(t.file)||e.trigger("selectfile",e,t.file)}),50)}},_onLoad:function(){this.loadMask&&this.loadMask.hide()},textTitle:"Select Data Source",textLoading:"Loading"},Common.Views.SelectFileDlg||{}))})),function(t,e){var i=1057,s=1124,n=1,a=2,o=3,l=4,r=5,c=6,d=7,h=8,p=9,m=10,u=11,g=12,b=13,f=14,C=15,x=16,v=17,y=18,_=19,A=20,S=21,w=22,T=23,P=24,k=25,I=26,D=27,F=28,M=29,V=30,L=31,U=32,B=33,E=34,H=35,R=36,N=37,O=38,z=39,$=40,W=41,G=42,q=43,j=44,K=45,Y=46,X=47,J=48,Q=49,Z=50,tt=51,et=52,it=53,st=54,nt=55,at=56,ot=57,lt=58,rt=59,ct=60,dt=61,ht=62,pt=63,mt=64,ut=65,gt=66,bt=67,ft=68,Ct=69,xt=70,vt=71,yt=72,_t=73,At=74,St=75,wt=76,Tt=77,Pt=78,kt=79,It=80,Dt=81,Ft=82,Mt=83,Vt=84,Lt=85,Ut=86,Bt=87,Et=88,Ht=89,Rt=90,Nt=91,Ot=92,zt=93,$t=94,Wt=95,Gt=96,qt=97,jt=98,Kt=99,Yt=100,Xt=101,Jt=102,Qt=103,Zt=104,te=105,ee=106,ie=107,se=108,ne=109,ae=110,oe=111,le=112,re=113,ce=114,de=115,he=116,pe=117,me=118,ue=119,ge=120,be=121,fe=122,Ce=123,xe=124,ve=125,ye=126,_e=127,Ae=128,Se=129,we=130,Te=131,Pe=132,ke=133,Ie=134,De=135,Fe=136,Me=137,Ve=138,Le=139,Ue=140,Be=141,Ee=142,He=143,Re=144,Ne=145,Oe=146,ze=147,$e=148,We=149,Ge=150,qe=151,je=152,Ke=153,Ye=154,Xe=155,Je=156,Qe=157,Ze=158,ti=159,ei=160,ii=161,si=162,ni=163,ai=164,oi=165,li=166,ri=167,ci=168,di=169,hi=170,pi=171,mi=172,ui=173,gi=174,bi=175,fi=176,Ci=177,xi=178,vi=179,yi=180,_i=181,Ai=182,Si=183,wi=184,Ti=185,Pi=186,ki=187,Ii=188,Di=189,Fi=190,Mi=191,Vi=192,Li=193,Ui=194,Bi=195,Ei=196,Hi=197,Ri=198,Ni=199,Oi=200,zi=201,$i=202,Wi=203,Gi=204,qi=205,ji=206,Ki=207,Yi=208,Xi=209,Ji=210,Qi=211,Zi=212,ts=213,es=214,is=215,ss=216,ns=217,as=218,os=219,ls=220,rs=221,cs=222,ds=223,hs=224,ps=225,ms=226,us=227,gs=228,bs=229,fs=230,Cs=231,xs=232,vs=233,ys=234,_s=235,As=236,Ss=237,ws=238,Ts=239,Ps=240,ks=241,Is=242,Ds=243,Fs=244,Ms=245,Vs=246,Ls=247,Us=248,Bs=249,Es=250,Hs=251,Rs=252,Ns=253,Os=254,zs=255,$s=256,Ws=257,Gs=258,qs=259,js=260,Ks=261,Ys=262,Xs=263,Js=264,Qs=265,Zs=266,tn=267,en=268,sn=269,nn=270,an=271,on=272,ln=273,rn=0,cn=1,dn=2,hn=3,pn=4,mn=5,un=6,gn=7,bn=8,fn=16,Cn=17,xn=18,vn=19,yn=20,_n=30,An=19,Sn=21,wn=29,Tn={Basic_Latin:0,Latin_1_Supplement:1,Latin_Extended_A:2,Latin_Extended_B:3,IPA_Extensions:4,Spacing_Modifier_Letters:5,Combining_Diacritical_Marks:6,Greek_and_Coptic:7,Coptic:8,Cyrillic:9,Armenian:10,Hebrew:11,Vai:12,Arabic:13,NKo:14,Devanagari:15,Bengali:16,Gurmukhi:17,Gujarati:18,Oriya:19,Tamil:20,Telugu:21,Kannada:22,Malayalam:23,Thai:24,Lao:25,Georgian:26,Balinese:27,Hangul_Jamo:28,Latin_Extended_Additional:29,Greek_Extended:30,General_Punctuation:31},Pn={Superscripts_And_Subscripts:0,Currency_Symbols:1,Combining_Diacritical_Marks_For_Symbols:2,Letterlike_Symbols:3,Number_Forms:4,Arrows:5,Mathematical_Operators:6,Miscellaneous_Technical:7,Control_Pictures:8,Optical_Character_Recognition:9,Enclosed_Alphanumerics:10,Box_Drawing:11,Block_Elements:12,Geometric_Shapes:13,Miscellaneous_Symbols:14,Dingbats:15,CJK_Symbols_And_Punctuation:16,Hiragana:17,Katakana:18,Bopomofo:19,Hangul_Compatibility_Jamo:20,Phags_pa:21,Enclosed_CJK_Letters_And_Months:22,CJK_Compatibility:23,Hangul_Syllables:24,Non_Plane:25,Phoenician:26,CJK_Unified_Ideographs:27,Private_Use_Area_plane_0:28,CJK_Strokes:29,Alphabetic_Presentation_Forms:30,Arabic_Presentation_Forms_A:31},kn={Combining_Half_Marks:0,Vertical_Forms:1,Small_Form_Variants:2,Arabic_Presentation_Forms_B:3,Halfwidth_And_Fullwidth_Forms:4,Specials:5,Tibetan:6,Syriac:7,Thaana:8,Sinhala:9,Myanmar:10,Ethiopic:11,Cherokee:12,Unified_Canadian_Aboriginal_Syllabics:13,Ogham:14,Runic:15,Khmer:16,Mongolian:17,Braille_Patterns:18,Yi_Syllables:19,Tagalog:20,Old_Italic:21,Gothic:22,Deseret:23,Byzantine_Musical_Symbols:24,Mathematical_Alphanumeric_Symbols:25,Private_Use_plane_15:26,Variation_Selectors:27,Tags:28,Limbu:29,Tai_Le:30,New_Tai_Lue:31},In=1,Dn=2,Fn=3,Mn=4,Vn=5,Ln=6,Un=7,Bn=8,En=9,Hn=10,Rn=11,Nn=12,On=14,zn=16,$n=17,Wn=18,Gn=19,qn=20,jn=21,Kn=22,Yn=23,Xn=24,Jn=25,Qn=26;function Zn(t,e,i,s,n){this.Start=t,this.End=e,this.Name=i,this.Lid=s,this.Param=n}var ta=[new Zn(32,126,n,1033,[1<<Tn.Basic_Latin,0,0,0,1<<rn,0]),new Zn(160,255,a,0,[1<<Tn.Basic_Latin|1<<Tn.Latin_1_Supplement,0,0,0,1<<rn,0]),new Zn(256,383,o,0,[1<<Tn.Basic_Latin|1<<Tn.Latin_Extended_A,0,0,0,1<<rn|1<<cn|1<<pn|1<<gn,0]),new Zn(384,591,l,0,[1<<Tn.Basic_Latin|1<<Tn.Latin_Extended_B,0,0,0,1<<rn|1<<cn|1<<pn|1<<gn,0]),new Zn(592,687,r,0,[1<<Tn.IPA_Extensions,0,0,0,0,0]),new Zn(688,767,c,0,[1<<Tn.Spacing_Modifier_Letters,0,0,0,0,0]),new Zn(768,879,d,0,[1<<Tn.Combining_Diacritical_Marks,0,0,0,0,0]),new Zn(880,1023,h,1032,[1<<Tn.Greek_and_Coptic,0,0,0,1<<hn,0]),new Zn(1024,1279,p,1049,[1<<Tn.Cyrillic,0,0,0,1<<dn,0]),new Zn(1280,1327,m,0,[1<<Tn.Cyrillic,0,0,0,1<<dn,0]),new Zn(1328,1423,u,1067,[1<<Tn.Armenian,0,0,0,0,0]),new Zn(1424,1535,g,1037,[1<<Tn.Hebrew,0,0,0,1<<mn,1<<Sn]),new Zn(1536,1791,b,1,[1<<Tn.Arabic,0,0,0,1<<un,1<<An|1<<wn]),new Zn(1792,1871,f,1114,[1<<Tn.Arabic,0,0,0,1<<un,1<<An|1<<wn]),new Zn(1872,1919,C,1,[1<<Tn.Arabic,0,0,0,1<<un,1<<An|1<<wn]),new Zn(1920,1983,x,1125,[1<<Tn.Arabic,0,0,0,1<<un,1<<An|1<<wn]),new Zn(1984,2047,v,0,[1<<Tn.NKo,0,0,0,0,0]),new Zn(2048,2111,y,0,[1<<Tn.Hebrew,0,0,0,1<<mn,0]),new Zn(2112,2143,_,0,[1<<Tn.Arabic,0,0,0,1<<un,1<<An|1<<wn]),new Zn(2208,2303,A,1,[1<<Tn.Arabic,0,0,0,1<<un,1<<An|1<<wn]),new Zn(2304,2431,S,1081,[1<<Tn.Devanagari,0,0,0,0,0]),new Zn(2432,2559,w,1093,[1<<Tn.Bengali,0,0,0,0,0]),new Zn(2560,2687,T,1094,[1<<Tn.Gurmukhi,0,0,0,0,0]),new Zn(2688,2815,P,1095,[1<<Tn.Gujarati,0,0,0,0,0]),new Zn(2816,2943,k,1096,[1<<Tn.Oriya,0,0,0,0,0]),new Zn(2944,3071,I,1097,[1<<Tn.Tamil,0,0,0,0,0]),new Zn(3072,3199,D,1098,[1<<Tn.Telugu,0,0,0,0,0]),new Zn(3200,3327,F,1099,[1<<Tn.Kannada,0,0,0,0,0]),new Zn(3328,3455,M,1100,[1<<Tn.Malayalam,0,0,0,0,0]),new Zn(3456,3583,V,1115,[0,0,1<<kn.Sinhala,0,0,0]),new Zn(3584,3711,L,1054,[1<<Tn.Thai,0,0,0,1<<fn,0]),new Zn(3712,3839,U,1108,[1<<Tn.Lao,0,0,0,0,0]),new Zn(3840,4095,B,2129,[0,0,1<<kn.Tibetan,0,0,0]),new Zn(4096,4255,E,1109,[0,0,1<<kn.Myanmar,0,0,0]),new Zn(4256,4351,H,1079,[1<<Tn.Georgian,0,0,0,0,0]),new Zn(4352,4607,R,1042,[1<<Tn.Hangul_Jamo,0,0,0,1<<vn,0]),new Zn(4608,4991,N,1138,[0,0,1<<kn.Ethiopic,0,0,0]),new Zn(4992,5023,O,0,[0,0,1<<kn.Ethiopic,0,0,0]),new Zn(5024,5119,z,1116,[0,0,1<<kn.Cherokee,0,0,0]),new Zn(5120,5759,$,1117,[0,0,1<<kn.Unified_Canadian_Aboriginal_Syllabics,0,0,0]),new Zn(5760,5791,W,0,[0,0,1<<kn.Ogham,0,0,0]),new Zn(5792,5887,G,0,[0,0,1<<kn.Runic,0,0,0]),new Zn(5888,5919,q,s,[0,0,1<<kn.Tagalog,0,0,0]),new Zn(5920,5951,j,s,[0,0,1<<kn.Tagalog,0,0,0]),new Zn(5952,5983,K,s,[0,0,1<<kn.Tagalog,0,0,0]),new Zn(5984,6015,Y,s,[0,0,1<<kn.Tagalog,0,0,0]),new Zn(6016,6143,X,1107,[0,0,1<<kn.Khmer,0,0,0]),new Zn(6144,6319,J,1104,[0,0,1<<kn.Mongolian,0,0,0]),new Zn(6320,6399,Q,1117,[0,0,1<<kn.Unified_Canadian_Aboriginal_Syllabics,0,0,0]),new Zn(6400,6479,Z,0,[0,0,1<<kn.Limbu,0,0,0]),new Zn(6480,6527,tt,0,[0,0,1<<kn.Tai_Le,0,0,0]),new Zn(6528,6623,et,0,[0,0,1<<kn.New_Tai_Lue,0,0,0]),new Zn(6624,6655,it,1107,[0,0,1<<kn.Khmer,0,0,0]),new Zn(6656,6687,st,0,[0,0,1<<kn.Buginese,0,0,0]),new Zn(6688,6831,nt,1054,[0,0,1<<kn.Tai_Le,0,0,0]),new Zn(6832,6911,at,0,[1<<Tn.Combining_Diacritical_Marks,0,0,0,0,0]),new Zn(6912,7039,ot,i,[1<<Tn.Balinese,0,0,0,0,0]),new Zn(7040,7103,lt,i,[0,0,0,1<<zn,0,0]),new Zn(7104,7167,rt,i,[]),new Zn(7168,7247,ct,0,[0,0,0,1<<$n,0,0]),new Zn(7248,7295,dt,0,[0,0,0,1<<Wn,0,0]),new Zn(7296,7311,ht,0,[1<<Tn.Cyrillic,0,0,0,0,0]),new Zn(7360,7375,pt,0,[0,0,0,1<<zn,0,0]),new Zn(7376,7423,mt,0,[]),new Zn(7424,7551,ut,0,[1<<Tn.IPA_Extensions,0,0,0,0,0]),new Zn(7552,7615,gt,0,[1<<Tn.IPA_Extensions,0,0,0,0,0]),new Zn(7616,7679,bt,0,[1<<Tn.Combining_Diacritical_Marks,0,0,0,0,0]),new Zn(7680,7935,ft,0,[1<<Tn.Latin_Extended_Additional,0,0,0,1<<bn,0]),new Zn(7936,8191,Ct,0,[1<<Tn.Greek_Extended,0,0,0,0,0]),new Zn(8192,8303,xt,0,[1<<Tn.Punctuation,0,0,0,0,0]),new Zn(8304,8351,vt,0,[0,1<<Pn.Superscripts_And_Subscripts,0,0,0,0]),new Zn(8352,8399,yt,0,[0,1<<Pn.Currency_Symbols,0,0,0,0]),new Zn(8400,8447,_t,0,[0,1<<Pn.Combining_Diacritical_Marks_For_Symbols,0,0,0,0]),new Zn(8448,8527,At,0,[0,1<<Pn.Letterlike_Symbols,0,0,0,0]),new Zn(8528,8591,St,0,[0,1<<Pn.Number_Forms,0,0,0,0]),new Zn(8592,8703,wt,0,[0,1<<Pn.Arrows,0,0,0,0]),new Zn(8704,8959,Tt,0,[0,1<<Pn.Mathematical_Operators,0,0,0,0]),new Zn(8960,9215,Pt,0,[0,1<<Pn.Miscellaneous_Technical,0,0,0,0]),new Zn(9216,9279,kt,0,[0,1<<Pn.Control_Pictures,0,0,0,0]),new Zn(9280,9311,It,0,[0,1<<Pn.Optical_Character_Recognition,0,0,0,0]),new Zn(9312,9471,Dt,0,[0,1<<Pn.Enclosed_Alphanumerics,0,0,0,0]),new Zn(9472,9599,Ft,0,[0,1<<Pn.Box_Drawing,0,0,0,0]),new Zn(9600,9631,Mt,0,[0,1<<Pn.Block_Elements,0,0,0,0]),new Zn(9632,9727,Vt,0,[0,1<<Pn.Geometric_Shapes,0,0,0,0]),new Zn(9728,9983,Lt,0,[0,1<<Pn.Miscellaneous_Symbols,0,0,0,0]),new Zn(9984,10175,Ut,0,[0,1<<Pn.Dingbats,0,0,0,0]),new Zn(10176,10223,Bt,0,[0,1<<Pn.Mathematical_Operators,0,0,0,0]),new Zn(10224,10239,Et,0,[0,1<<Pn.Arrows,0,0,0,0]),new Zn(10240,10495,Ht,0,[0,0,1<<kn.Braille_Patterns,0,0,0]),new Zn(10496,10623,Rt,0,[0,1<<Pn.Arrows,0,0,0,0]),new Zn(10624,10751,Nt,0,[0,1<<Pn.Mathematical_Operators,0,0,0,0]),new Zn(10752,11007,Ot,0,[0,1<<Pn.Mathematical_Operators,0,0,0,0]),new Zn(11008,11263,zt,0,[0,1<<Pn.Arrows,0,0,0,0]),new Zn(11264,11359,$t,0,[0,0,0,1<<Pn.Glagolitic,0,0]),new Zn(11360,11391,Wt,0,[1<<Tn.Latin_Extended_Additional,0,0,0,0,0]),new Zn(11392,11519,Gt,0,[1<<Tn.Coptic,0,0,0,0,0]),new Zn(11520,11567,qt,0,[1<<Tn.Georgian,0,0,0,0,0]),new Zn(11568,11647,jt,0,[0,0,0,1<<Dn,0,0]),new Zn(11648,11743,Kt,0,[0,0,1<<kn.Ethiopic,0,0,0]),new Zn(11744,11775,Yt,0,[1<<Tn.Cyrillic,0,0,0,1<<dn,0]),new Zn(11776,11903,Xt,0,[1<<Tn.General_Punctuation,0,0,0,0,0]),new Zn(11904,12031,Jt,0,[0,1<<Pn.CJK_Unified_Ideographs,0,0,0,0]),new Zn(12032,12255,Qt,0,[0,1<<Pn.CJK_Unified_Ideographs,0,0,0,0]),new Zn(12272,12287,Zt,0,[0,1<<Pn.CJK_Unified_Ideographs,0,0,0,0]),new Zn(12288,12351,te,0,[0,1<<Pn.CJK_Symbols_And_Punctuation,0,0,1<<Cn|1<<_n,0]),new Zn(12352,12447,ee,1041,[0,1<<Pn.Hiragana,0,0,0,0]),new Zn(12448,12543,ie,1041,[0,1<<Pn.Katakana,0,0,0,0]),new Zn(12544,12591,se,0,[0,1<<Pn.Bopomofo,0,0,0,0]),new Zn(12592,12687,ne,0,[0,1<<Pn.Hangul_Compatibility_Jamo,0,0,1<<vn,0]),new Zn(12688,12703,ae,2052,[0,1<<Pn.CJK_Unified_Ideographs,0,0,0,0]),new Zn(12704,12735,oe,0,[0,1<<Pn.Bopomofo,0,0,0,0]),new Zn(12736,12783,le,0,[0,1<<Pn.CJK_Strokes,0,0,0,0]),new Zn(12784,12799,re,0,[0,1<<Pn.Katakana,0,0,0,0]),new Zn(12800,13055,ce,0,[0,1<<Pn.Enclosed_CJK_Letters_And_Months,0,0,0,0]),new Zn(13056,13311,de,0,[0,1<<Pn.CJK_Compatibility,0,0,0,0]),new Zn(13312,19903,he,0,[0,1<<Pn.CJK_Unified_Ideographs,0,0,1<<xn|1<<yn,0]),new Zn(19904,19967,pe,0,[0,0,0,1<<Fn,1<<xn|1<<yn,0]),new Zn(19968,40959,me,0,[0,1<<Pn.CJK_Unified_Ideographs,0,0,1<<xn|1<<yn|1<<Cn|1<<_n,0]),new Zn(40960,42127,ue,0,[0,0,1<<kn.Yi_Syllables,0,0,0]),new Zn(42128,42191,ge,0,[0,0,1<<kn.Yi_Radicals,0,0,0]),new Zn(42192,42239,be,0,[]),new Zn(42240,42559,fe,0,[1<<Tn.Vai,0,0,0,0,0]),new Zn(42560,42655,Ce,0,[1<<Tn.Cyrillic,0,0,0,1<<dn,0]),new Zn(42656,42751,xe,0,[]),new Zn(42752,42783,ve,0,[1<<Tn.Spacing_Modifier_Letters,0,0,0,0,0]),new Zn(42784,43007,ye,0,[1<<Tn.Latin_Extended_Additional,0,0,0,0,0]),new Zn(43008,43055,_e,0,[0,0,0,1<<Mn,0,0]),new Zn(43056,43071,Ae,0,[]),new Zn(43072,43135,Se,0,[0,1<<Pn.Phags_pa,0,0,0,0]),new Zn(43136,43231,we,0,[0,0,0,1<<Gn,0,0]),new Zn(43232,43263,Te,0,[1<<Tn.Devanagari,0,0,0,0,0]),new Zn(43264,43311,Pe,0,[0,0,0,1<<qn,0,0]),new Zn(43312,43359,ke,0,[0,0,0,1<<jn,0,0]),new Zn(43360,43391,Ie,0,[1<<Tn.Hangul_Jamo,0,0,0,0,0]),new Zn(43392,43487,De,i,[]),new Zn(43488,43519,Fe,0,[0,0,1<<kn.Myanmar,0,0,0]),new Zn(43520,43615,Me,0,[0,0,0,1<<Kn,0,0]),new Zn(43616,43647,Ve,0,[0,0,1<<kn.Myanmar,0,0,0]),new Zn(43648,43743,Le,0,[]),new Zn(43744,43775,Ue,0,[]),new Zn(43776,43823,Be,0,[]),new Zn(43824,43887,Ee,0,[1<<Tn.Latin_Extended_Additional,0,0,0,0,0]),new Zn(43888,43967,He,0,[]),new Zn(43968,44031,Re,0,[]),new Zn(44032,55215,Ne,0,[0,1<<Pn.Hangul_Syllables,0,0,1<<vn,0]),new Zn(55216,55295,Oe,0,[1<<Tn.Hangul_Jamo,0,0,0,0,0]),new Zn(55296,56191,ze,0,[]),new Zn(56192,56319,$e,0,[]),new Zn(56320,57343,We,0,[]),new Zn(57344,63743,Ge,0,[0,1<<Pn.Private_Use_Area_plane_0,0,0,0,0]),new Zn(63744,64255,qe,0,[0,1<<Pn.CJK_Compatibility_Ideographs,0,0,1<<xn|1<<yn,0]),new Zn(64256,64335,je,0,[0,1<<Pn.Alphabetic_Presentation_Forms,0,0,0,0]),new Zn(64336,65023,Ke,0,[0,1<<Pn.Arabic_Presentation_Forms_A,0,0,1<<un,1<<An|1<<wn]),new Zn(65024,65039,Ye,0,[0,0,1<<kn.Variation_Selectors,0,0,0]),new Zn(65040,65055,Xe,0,[0,0,1<<kn.Vertical_Forms,0,0,0]),new Zn(65056,65071,Je,0,[0,0,1<<kn.Combining_Half_Marks,0,0,0]),new Zn(65072,65103,Qe,0,[0,0,1<<kn.Vertical_Forms,0,0,0]),new Zn(65104,65135,Ze,0,[0,0,1<<kn.Small_Form_Variants,0,0,0]),new Zn(65136,65279,ti,0,[0,0,1<<kn.Arabic_Presentation_Forms_B,0,1<<un,1<<An|1<<wn]),new Zn(65280,65519,ei,0,[0,0,1<<kn.Halfwidth_And_Fullwidth_Forms,0,1<<vn|1<<xn|1<<yn|1<<Cn|1<<_n,0]),new Zn(65520,65535,ii,0,[0,0,1<<kn.Specials,0,0,0]),new Zn(65536,65663,si,0,[0,0,0,1<<Vn,0,0]),new Zn(65664,65791,ni,0,[0,0,0,1<<Vn,0,0]),new Zn(65792,65855,ai,0,[0,0,0,1<<Vn,0,0]),new Zn(65856,65935,oi,0,[0,0,0,1<<Ln,0,0]),new Zn(65936,65999,li,0,[0,0,0,1<<Yn,0,0]),new Zn(66e3,66047,ri,0,[0,0,0,1<<Xn,0,0]),new Zn(66176,66207,ci,0,[0,0,0,1<<Jn,0,0]),new Zn(66208,66271,di,0,[0,0,0,1<<Jn,0,0]),new Zn(66272,66303,hi,0,[1<<Tn.Coptic,0,0,0,0,0]),new Zn(66304,66351,pi,0,[0,0,1<<kn.Old_Italic,0,0,0]),new Zn(66352,66383,mi,0,[0,0,1<<kn.Gothic,0,0,0]),new Zn(66384,66431,ui,0,[]),new Zn(66432,66463,gi,0,[0,0,0,1<<Un,0,0]),new Zn(66464,66527,bi,0,[0,0,0,1<<Bn,0,0]),new Zn(66560,66639,fi,0,[0,0,1<<kn.Deseret,0,0,0]),new Zn(66640,66687,Ci,0,[0,0,0,1<<En,0,0]),new Zn(66688,66735,xi,0,[0,0,0,1<<Hn,0,0]),new Zn(66736,66815,vi,0,[]),new Zn(66816,66863,yi,0,[]),new Zn(66864,66927,_i,0,[]),new Zn(67072,67455,Ai,0,[]),new Zn(67584,67647,Si,0,[0,0,0,1<<Rn,0,0]),new Zn(67648,67679,wi,0,[]),new Zn(67680,67711,Ti,0,[]),new Zn(67712,67759,Pi,0,[]),new Zn(67808,67839,ki,0,[]),new Zn(67840,67871,Ii,0,[0,1<<Pn.Phoenician,0,0,0,0]),new Zn(67872,67903,Di,0,[0,0,0,1<<Jn,0,0]),new Zn(67968,67999,Fi,0,[]),new Zn(68e3,68095,Mi,0,[]),new Zn(68096,68191,Vi,0,[0,0,0,1<<Nn,0,0]),new Zn(68192,68223,Li,0,[]),new Zn(68224,68255,Ui,0,[]),new Zn(68288,68351,Bi,0,[]),new Zn(68352,68415,Ei,0,[]),new Zn(68416,68447,Hi,0,[]),new Zn(68448,68479,Ri,0,[]),new Zn(68480,68527,Ni,0,[]),new Zn(68608,68687,Oi,0,[]),new Zn(68736,68863,zi,0,[]),new Zn(69216,69247,$i,0,[]),new Zn(69632,69759,Wi,0,[]),new Zn(69760,69839,Gi,0,[]),new Zn(69840,69887,qi,0,[]),new Zn(69888,69967,ji,0,[]),new Zn(69968,70015,Ki,0,[]),new Zn(70016,70111,Yi,0,[]),new Zn(70112,70143,Xi,0,[0,0,1<<kn.Sinhala,0,0,0]),new Zn(70144,70223,Ji,0,[]),new Zn(70272,70319,Qi,0,[]),new Zn(70320,70399,Zi,0,[]),new Zn(70400,70527,ts,0,[]),new Zn(70656,70783,es,0,[]),new Zn(70784,70879,is,0,[]),new Zn(71040,71167,ss,0,[]),new Zn(71168,71263,ns,0,[]),new Zn(71264,71295,as,0,[0,0,1<<kn.Mongolian,0,0,0]),new Zn(71296,71375,os,0,[]),new Zn(71424,71487,ls,0,[]),new Zn(71840,71935,rs,0,[]),new Zn(72384,72447,cs,0,[]),new Zn(72704,72815,ds,0,[]),new Zn(72816,72895,hs,0,[]),new Zn(73728,74751,ps,0,[0,0,0,1<<On,0,0]),new Zn(74752,74879,ms,0,[0,0,0,1<<On,0,0]),new Zn(74880,75087,us,0,[]),new Zn(77824,78895,gs,0,[]),new Zn(82944,83583,bs,0,[]),new Zn(92160,92735,fs,0,[]),new Zn(92736,92783,Cs,0,[]),new Zn(92880,92927,xs,0,[]),new Zn(92928,93071,vs,0,[]),new Zn(93952,94111,ys,2052,[]),new Zn(94176,94207,_s,0,[]),new Zn(94208,100351,As,0,[]),new Zn(100352,101119,Ss,0,[]),new Zn(110592,110847,ws,0,[]),new Zn(113664,113823,Ts,0,[]),new Zn(113824,113839,Ps,0,[]),new Zn(118784,119039,ks,0,[0,0,1<<kn.Byzantine_Musical_Symbols,0,0,0]),new Zn(119040,119295,Is,0,[0,0,1<<kn.Byzantine_Musical_Symbols,0,0,0]),new Zn(119296,119375,Ds,0,[0,0,1<<kn.Byzantine_Musical_Symbols,0,0,0]),new Zn(119552,119647,Fs,0,[]),new Zn(119648,119679,Ms,0,[]),new Zn(119808,120831,Vs,0,[0,0,1<<kn.Mathematical_Alphanumeric_Symbols,0,0,0]),new Zn(120832,121519,Ls,0,[]),new Zn(122880,122927,Us,0,[0,0,0,1<<In,0,0]),new Zn(124928,125151,Bs,0,[]),new Zn(125184,125279,Es,0,[]),new Zn(126464,126719,Hs,0,[]),new Zn(126976,127023,Rs,0,[0,0,0,1<<Qn,0,0]),new Zn(127024,127135,Ns,0,[0,0,0,1<<Qn,0,0]),new Zn(127136,127231,Os,0,[]),new Zn(127232,127487,zs,0,[]),new Zn(127488,127743,$s,0,[]),new Zn(127744,128511,Ws,0,[]),new Zn(128512,128591,Gs,0,[]),new Zn(128592,128639,qs,0,[]),new Zn(128640,128767,js,0,[]),new Zn(128768,128895,Ks,0,[]),new Zn(128896,129023,Ys,0,[0,1<<Pn.Geometric_Shapes,0,0,0,0]),new Zn(129024,129279,Xs,0,[0,1<<Pn.Arrows,0,0,0,0]),new Zn(129280,129535,Js,0,[]),new Zn(131072,173791,Qs,0,[0,0,1<<kn.CJK_Unified_Ideographs,0,1<<xn|1<<yn,0]),new Zn(173824,177983,Zs,0,[0,0,1<<kn.CJK_Unified_Ideographs,0,1<<xn|1<<yn,0]),new Zn(177984,178207,tn,0,[0,0,1<<kn.CJK_Unified_Ideographs,0,1<<xn|1<<yn,0]),new Zn(178208,183983,en,0,[0,0,1<<kn.CJK_Unified_Ideographs,0,1<<xn|1<<yn,0]),new Zn(194560,195103,sn,0,[0,0,1<<kn.CJK_Strokes,0,1<<xn|1<<yn,0]),new Zn(917504,917631,nn,0,[0,0,1<<kn.Tags,0,0,0]),new Zn(917760,917999,an,0,[0,0,1<<kn.Variation_Selectors,0,0,0]),new Zn(983040,1048575,on,0,[0,0,1<<kn.Private_Use_plane_15,0,0,0]),new Zn(1048576,1114111,ln,0,[0,0,1<<kn.Private_Use_plane_15,0,0,0])];t.getSupportedFonts=function(e){var i=function(t,e){var i=0,s=e.length-1,n=0,a=null;if(i>=s)return null;for(;i<s;)if((a=e[n=i+s>>1]).Start>t)s=n-1;else{if(!(a.End<t))return e[n];i=n+1}return i>s||(a=e[i]).Start>t||a.End<t?null:e[i]}(e,ta);return t.getSupportedFontsByRange(i)},t.getSupportedFontsByRange=function(t){if(null==t)return[];for(var e=AscFonts.g_fontApplication.g_fontSelections.List,i=e.length,s=[],n=0;n<i;n++){var a=e[n],o=t.Param;if(o[0]==(a.m_ulUnicodeRange1&o[0])&&(o[1]==(a.m_ulUnicodeRange2&o[1])&&o[2]==(a.m_ulUnicodeRange3&o[2])&&o[3]==(a.m_ulUnicodeRange4&o[3]))){if(t.Name==me){if(0==(a.m_ulCodePageRange1&o[4]))continue}else if(o[4]!=(a.m_ulCodePageRange1&o[4]))continue;o[5]==(a.m_ulCodePageRange2&o[5])&&s.push(a.m_wsFontName)}}return s},t.getSupportedRangesByFont=function(t){for(var e=[],i=0;i<ta.length;++i){var s=ta[i],o=s.Param;o[0]==(t.m_ulUnicodeRange1&o[0])&&(o[1]==(t.m_ulUnicodeRange2&o[1])&&o[2]==(t.m_ulUnicodeRange3&o[2])&&o[3]==(t.m_ulUnicodeRange4&o[3])&&o[4]==(t.m_ulCodePageRange1&o[4])&&o[5]==(t.m_ulCodePageRange2&o[5])&&e.push(s))}return 0===e.length&&(e.push(new Zn(32,126,n,1033,[1<<Tn.Basic_Latin,0,0,0,1<<rn,0])),e.push(new Zn(160,255,a,0,[1<<Tn.Basic_Latin|1<<Tn.Latin_1_Supplement,0,0,0,1<<rn,0]))),e}}(window),define("common/main/lib/util/character",(function(){})),void 0===Common)Common={};if(define("common/main/lib/view/SymbolTableDialog",["common/main/lib/util/character"],(function(){"use strict";var t={1:"Basic Latin",2:"Latin 1 Supplement",3:"Latin Extended A",4:"Latin Extended B",5:"IPA Extensions",6:"Spacing Modifier Letters",7:"Combining Diacritical Marks",8:"Greek and Coptic",9:"Cyrillic",10:"Cyrillic Supplement",11:"Armenian",12:"Hebrew",13:"Arabic",14:"Syriac",15:"Arabic Supplement",16:"Thaana",17:"NKo",18:"Samaritan",19:"Mandaic",20:"Arabic Extended A",21:"Devanagari",22:"Bengali",23:"Gurmukhi",24:"Gujarati",25:"Oriya",26:"Tamil",27:"Telugu",28:"Kannada",29:"Malayalam",30:"Sinhala",31:"Thai",32:"Lao",33:"Tibetan",34:"Myanmar",35:"Georgian",36:"Hangul Jamo",37:"Ethiopic",38:"Ethiopic Supplement",39:"Cherokee",40:"Unified Canadian Aboriginal Syllabics",41:"Ogham",42:"Runic",43:"Tagalog",44:"Hanunoo",45:"Buhid",46:"Tagbanwa",47:"Khmer",48:"Mongolian",49:"Unified Canadian Aboriginal Syllabics Extended",50:"Limbu",51:"Tai Le",52:"New Tai Lue",53:"Khmer Symbols",54:"Buginese",55:"Tai Tham",56:"Combining Diacritical Marks Extended",57:"Balinese",58:"Sundanese",59:"Batak",60:"Lepcha",61:"Ol Chiki",62:"Cyrillic Extended C",63:"Sundanese Supplement",64:"Vedic Extensions",65:"Phonetic Extensions",66:"Phonetic Extensions Supplement",67:"Combining Diacritical Marks Supplement",68:"Latin Extended Additional",69:"Greek Extended",70:"General Punctuation",71:"Superscripts and Subscripts",72:"Currency Symbols",73:"Combining Diacritical Marks for Symbols",74:"Letterlike Symbols",75:"Number Forms",76:"Arrows",77:"Mathematical Operators",78:"Miscellaneous Technical",79:"Control Pictures",80:"Optical Character Recognition",81:"Enclosed Alphanumerics",82:"Box Drawing",83:"Block Elements",84:"Geometric Shapes",85:"Miscellaneous Symbols",86:"Dingbats",87:"Miscellaneous Mathematical Symbols A",88:"Supplemental Arrows A",89:"Braille Patterns",90:"Supplemental Arrows B",91:"Miscellaneous Mathematical Symbols B",92:"Supplemental Mathematical Operators",93:"Miscellaneous Symbols and Arrows",94:"Glagolitic",95:"Latin Extended C",96:"Coptic",97:"Georgian Supplement",98:"Tifinagh",99:"Ethiopic Extended",100:"Cyrillic Extended A",101:"Supplemental Punctuation",102:"CJK Radicals Supplement",103:"Kangxi Radicals",104:"Ideographic Description Characters",105:"CJK Symbols and Punctuation",106:"Hiragana",107:"Katakana",108:"Bopomofo",109:"Hangul Compatibility Jamo",110:"Kanbun",111:"Bopomofo Extended",112:"CJK Strokes",113:"Katakana Phonetic Extensions",114:"Enclosed CJK Letters and Months",115:"CJK Compatibility",116:"CJK Unified Ideographs Extension",117:"Yijing Hexagram Symbols",118:"CJK Unified Ideographs",119:"Yi Syllables",120:"Yi Radicals",121:"Lisu",122:"Vai",123:"Cyrillic Extended B",124:"Bamum",125:"Modifier Tone Letters",126:"Latin Extended D",127:"Syloti Nagri",128:"Common Indic Number Forms",129:"Phags pa",130:"Saurashtra",131:"Devanagari Extended",132:"Kayah Li",133:"Rejang",134:"Hangul Jamo Extended A",135:"Javanese",136:"Myanmar Extended B",137:"Cham",138:"Myanmar Extended A",139:"Tai Viet",140:"Meetei Mayek Extensions",141:"Ethiopic Extended A",142:"Latin Extended E",143:"Cherokee Supplement",144:"Meetei Mayek",145:"Hangul Syllables",146:"Hangul Jamo Extended B",147:"High Surrogates",148:"High Private Use Surrogates",149:"Low Surrogates",150:"Private Use Area",151:"CJK Compatibility Ideographs",152:"Alphabetic Presentation Forms",153:"Arabic Presentation Forms A",154:"Variation Selectors",155:"Vertical Forms",156:"Combining Half Marks",157:"CJK Compatibility Forms",158:"Small Form Variants",159:"Arabic Presentation Forms B",160:"Halfwidth and Fullwidth Forms",161:"Specials",162:"Linear B Syllabary",163:"Linear B Ideograms",164:"Aegean Numbers",165:"Ancient Greek Numbers",166:"Ancient Symbols",167:"Phaistos Disc",168:"Lycian",169:"Carian",170:"Coptic Epact Numbers",171:"Old Italic",172:"Gothic",173:"Old Permic",174:"Ugaritic",175:"Old Persian",176:"Deseret",177:"Shavian",178:"Osmanya",179:"Osage",180:"Elbasan",181:"Caucasian Albanian",182:"Linear A",183:"Cypriot Syllabary",184:"Imperial Aramaic",185:"Palmyrene",186:"Nabataean",187:"Hatran",188:"Phoenician",189:"Lydian",190:"Meroitic Hieroglyphs",191:"Meroitic Cursive",192:"Kharoshthi",193:"Old South Arabian",194:"Old North Arabian",195:"Manichaean",196:"Avestan",197:"Inscriptional Parthian",198:"Inscriptional Pahlavi",199:"Psalter Pahlavi",200:"Old Turkic",201:"Old Hungarian",202:"Rumi Numeral Symbols",203:"Brahmi",204:"Kaithi",205:"Sora Sompeng",206:"Chakma",207:"Mahajani",208:"Sharada",209:"Sinhala Archaic Numbers",210:"Khojki",211:"Multani",212:"Khudawadi",213:"Grantha",214:"Newa",215:"Tirhuta",216:"Siddham",217:"Modi",218:"Mongolian Supplement",219:"Takri",220:"Ahom",221:"Warang Citi",222:"Pau Cin Hau",223:"Bhaiksuki",224:"Marchen",225:"Cuneiform",226:"Cuneiform Numbers and Punctuation",227:"Early Dynastic Cuneiform",228:"Egyptian Hieroglyphs",229:"Anatolian Hieroglyphs",230:"Bamum Supplement",231:"Mro",232:"Bassa Vah",233:"Pahawh Hmong",234:"Miao",235:"Ideographic Symbols and Punctuation",236:"Tangut",237:"Tangut Components",238:"Kana Supplement",239:"Duployan",240:"Shorthand Format Controls",241:"Byzantine Musical Symbols",242:"Musical Symbols",243:"Ancient Greek Musical Notation",244:"Tai Xuan Jing Symbols",245:"Counting Rod Numerals",246:"Mathematical Alphanumeric Symbols",247:"Sutton SignWriting",248:"Glagolitic Supplement",249:"Mende Kikakui",250:"Adlam",251:"Arabic Mathematical Alphabetic Symbols",252:"Mahjong Tiles",253:"Domino Tiles",254:"Playing Cards",255:"Enclosed Alphanumeric Supplement",256:"Enclosed Ideographic Supplement",257:"Miscellaneous Symbols and Pictographs",258:"Emoticons",259:"Ornamental Dingbats",260:"Transport and Map Symbols",261:"Alchemical Symbols",262:"Geometric Shapes Extended",263:"Supplemental Arrows C",264:"Supplemental Symbols and Pictographs",265:"CJK Unified Ideographs Extension B",266:"CJK Unified Ideographs Extension C",267:"CJK Unified Ideographs Extension D",268:"CJK Unified Ideographs Extension E",269:"CJK Compatibility Ideographs Supplement",270:"Tags",271:"Variation Selectors Supplement",272:"Supplementary Private Use Area A",273:"Supplementary Private Use Area B"},e=33,i=[],s=[],n=[],a=-1,o=-1,l=!0,r=-1,c="",d=-1e3,h="",p=-1e3,m=-1,u=-1,g=20,b=20,f=["pt-pt","zh-tw","sr-cyrl"];Common.Views.SymbolTableDialog=Common.UI.Window.extend(_.extend({options:{resizable:!0,minwidth:448,minheight:420,width:448,height:420,cls:"modal-dlg invisible-borders",buttons:["ok","cancel"]},initialize:function(e){var r=Common.localStorage.getKeysFilter();this.appPrefix=r&&r.length?r.split(",")[0]:"";var c=this.appPrefix+"settings-size-symbol-table",d=Common.Utils.InternalSettings.get(c);null!=d&&null!=d||(d=Common.localStorage.getItem(c)||"",Common.Utils.InternalSettings.set(c,d)),d=d?JSON.parse(d):[],this.options=_.extend({resizable:!0,minwidth:448,minheight:420,width:448,height:420,cls:"modal-dlg invisible-borders",buttons:["ok","cancel"]},{title:this.textTitle,width:d[0]||448,height:d[1]||420},e||{}),this.api=this.options.api,this.type=this.options.type||0,this.special=this.options.special||!1,this.showShortcutKey=this.options.showShortcutKey||!1,this.special&&(this.options.height+=38),this.special&&(this.options.minheight+=38),this.template=['<div class="box">','<div id="symbol-table-switcher" style="margin-bottom: 16px;" class="'+(this.special?"":"hidden")+'">','<button type="button" class="btn btn-text-default auto" id="symbol-table-symbols">',this.textSymbols,"</button>",'<button type="button" class="btn btn-text-default auto" id="symbol-table-special">',this.textSpecial,"</button>","</div>",'<div id="symbol-table-pnl-symbols">','<table cols="2" style="width: 100%;max-width: 497px;">',"<tr>",'<td class="padding-right-5" style="padding-bottom: 8px;width: 50%;">','<label class="input-label">'+this.textFont+"</label>",'<div id="symbol-table-cmb-fonts"></div>',"</td>",'<td class="padding-left-5" style="padding-bottom: 8px;">','<label class="input-label">'+this.textRange+"</label>",'<div id="symbol-table-cmb-range"></div>',"</td>","</tr>","</table>",'<table cols="1" style="width: 100%;">',"<tr>","<td>",'<div id="symbol-table-scrollable-div" style="position: relative;height:'+(this.options.height-304-38*(this.special?1:0))+'px;">','<div style="width: 100%;">','<div id="id-preview">',"<div>",'<div style="position: absolute; top: 0;"><div id="id-preview-data" tabindex="0" oo_editor_input="true"></div></div>',"</div>","</div>","</div>","</div>","</td>","</tr>","</table>",'<table cols="1" style="width: 100%;">',"<tr>",'<td style="padding-bottom: 16px;padding-top: 16px;">','<label class="input-label">'+this.textRecent+"</label>",'<div id="symbol-table-recent" tabindex="0" oo_editor_input="true" style="width: 100%;"></div>',"</td>","</tr>","</table>",'<table cols="2" style="width: 100%;max-width: 497px;">',"<tr>",'<td class="padding-right-5" style="width: 50%;">','<label class="input-label">'+this.textCode+"</label>","</td>",'<td class="padding-left-5">',"</td>","</tr>","<tr>",'<td class="padding-right-5">','<div id="symbol-table-text-code" oo_editor_input="true"></div>',"</td>",'<td class="padding-left-5">','<div id="symbol-table-label-font" style="overflow: hidden; text-overflow: ellipsis;white-space: nowrap;max-width: 160px;"></div>',"</td>","</tr>","</table>","</div>",'<div id="symbol-table-pnl-special">','<table cols="1" style="width: 100%;">',"<tr>","<td>",'<label id="symbol-table-lbl-char">'+this.textCharacter+"</label>",'<label id="symbol-table-lbl-shortcut" style="width: 112px;" class="float-right">'+this.textShortcut+"</label>","</td>","</tr>","<tr>","<td>",'<div id="symbol-table-special-list" class="no-borders" style="width:100%; height: '+(this.options.height-157)+'px;"></div>',"</td>","</tr>","</table>","</div>","</div>"].join(""),this.options.tpl=_.template(this.template)(this.options);var h,p=i.length<1;if(p&&this.initFonts(),this.fillRecentSymbols(),e.font?h=e.font:n.length>0&&(h=n[0].font),h)for(var m=0;m<i.length;++m)if(i[m].displayValue===h){a=m;break}if(a<0&&(a=0),s=this.getArrRangesByFont(a),-1===o&&(o=s[0].Start),e.code?o=e.code:e.symbol?o=this.fixedCharCodeAt(e.symbol,0):n.length>0&&(o=n[0].symbol),p&&this.options.lang&&"en"!=this.options.lang){var u=this;!function(e,i){e=(e=e.toLowerCase().split(/[\-_]/))[0]+(e.length>1?"-"+e[1]:"");var s=f.indexOf(e);e=s<0?e.split(/[\-]/)[0]:f[s],Common.Utils.loadConfig("resources/symboltable/"+e+".json",(function(e){if("error"!==e)for(var s=1;s<274;s++){var n=t[s];t[s]=e[n]||n}i&&i()}))}(this.options.lang,(function(){u.updateRangeSelector()}))}Common.UI.Window.prototype.initialize.call(this,this.options),this.on("resizing",_.bind(this.onWindowResizing,this)),this.on("resize",_.bind(this.onWindowResize,this)),l=!0},initFonts:function(){var t,e,s=this.api.pluginMethod_GetFontList();s.sort((function(t,e){return t.m_wsFontName<e.m_wsFontName?-1:t.m_wsFontName>e.m_wsFontName?1:0}));for(var n,o=[],l={},r=0;r<s.length;++r)(e=l[n=(t=s[r]).m_wsFontName])?e.m_bBold&&e.m_bItalic||e.m_bBold&&!t.m_bBold?l[n]=t:!e.m_bItalic||t.m_bBold||t.m_bItalic||(l[n]=t):l[n]=t;delete l.ASCW3;r=0;for(var d in l)l.hasOwnProperty(d)&&(o.push(l[d]),o[o.length-1].displayValue=l[d].m_wsFontName);for((i=o).sort((function(t,e){return t.displayValue.toLowerCase()>e.displayValue.toLowerCase()?1:-1})),r=0;r<i.length;++r)i[r].value=r;if(l[c]||(l["Cambria Math"]?c="Cambria Math":l["Asana-Math"]&&(c="Asana-Math")),l[c])for(r=0;r<i.length;++r)if(i[r].displayValue===c){a=r;break}},render:function(){Common.UI.Window.prototype.render.call(this);var t=this,e=this.getChild();this.btnSymbols=new Common.UI.Button({el:e.find("#symbol-table-symbols"),enableToggle:!0,toggleGroup:"hyperlink-type",allowDepress:!1,pressed:!0}),this.btnSymbols.on("click",_.bind(this.onModeClick,this,!1)),this.btnSpecial=new Common.UI.Button({el:e.find("#symbol-table-special"),enableToggle:!0,toggleGroup:"hyperlink-type",allowDepress:!1}),this.btnSpecial.on("click",_.bind(this.onModeClick,this,!0)),Common.UI.GroupedButtons([this.btnSymbols,this.btnSpecial]),this.cmbFonts=new Common.UI.ComboBox({el:e.find("#symbol-table-cmb-fonts"),cls:"input-group-nr",data:i,editable:!1,search:!0,menuStyle:"min-width: 100%; max-height: 209px;"}).on("selected",(function(e,i){var n=t.getRangeBySymbol(s,o);if(a=i.value,s=t.getArrRangesByFont(a),n){for(var r=0;r<s.length&&n.Name!==s[r].Name;++r);r===s.length&&(o=s[0].Start)}else o=s[0].Start;l=!0,t.updateView(),setTimeout((function(){t.previewPanel.focus()}),1)})),this.cmbFonts.setValue(a),this.cmbRange=new Common.UI.ComboBox({el:e.find("#symbol-table-cmb-range"),cls:"input-group-nr",editable:!1,search:!0,menuStyle:"min-width: 100%; max-height: 209px;"}).on("selected",(function(e,i){var n=t.getRangeByName(s,parseInt(i.value));o=n.Start,l=!0,t.updateView(void 0,void 0,void 0,void 0,!1),setTimeout((function(){t.previewPanel.focus()}),1)})),this.updateRangeSelector(),t.inputCode=new Common.UI.InputField({el:e.find("#symbol-table-text-code"),allowBlank:!1,blankError:t.txtEmpty,style:"width: 100%;",validateOnBlur:!1,validateOnChange:!0}).on("changing",(function(i,n,a){var r=parseInt(n,16);if(!isNaN(r)&&r>31&&t.getRangeBySymbol(s,r)){var c=0===e.find("#c"+r).length;o=r,l=!0,t.updateView(c,void 0,!1)}})).on("change:after",(function(e,i,s){t.updateInput()})),this.symbolTablePanel=e.find("#symbol-table-scrollable-div"),this.previewPanel=e.find("#id-preview-data"),this.previewParent=this.previewPanel.parent(),this.previewScrolled=e.find("#id-preview"),this.previewInner=this.previewScrolled.find("> div:first-child"),this.recentPanel=e.find("#symbol-table-recent"),this.fontLabel=e.find("#symbol-table-label-font"),this.boxPanel=e.find(".box"),this.updateView(void 0,void 0,void 0,!0);var n=[{symbol:"",description:this.textEmDash,shortcutKey:Common.Utils.String.platformKey(Common.Utils.isMac?"Alt Shift -":"Alt+Ctrl+Num -","{0}"),code:"2014"},{symbol:"",description:this.textEnDash,shortcutKey:Common.Utils.String.platformKey(Common.Utils.isMac?"Ctrl Num -":"Ctrl+Num -","{0}"),code:"2013"},{symbol:"",description:this.textNBHyphen,shortcutKey:Common.Utils.String.platformKey(Common.Utils.isMac?"Ctrl Shift _":"Ctrl+Shift+_","{0}"),code:"002D",special:{NonBreakingHyphen:!0}},{symbol:"",description:this.textEmSpace,shortcutKey:"",code:"2003"},{symbol:"",description:this.textEnSpace,shortcutKey:"",code:"2002"},{symbol:"",description:this.textQEmSpace,shortcutKey:"",code:"2005"},{symbol:"",description:this.textNBSpace,shortcutKey:Common.Utils.String.platformKey(Common.Utils.isMac?"Alt ":"Ctrl+Shift+","{0}")+"Space",code:"00A0"},{symbol:"",description:this.textCopyright,shortcutKey:Common.Utils.String.platformKey(Common.Utils.isMac?"Alt Ctrl ":"Alt+Ctrl+","{0}")+"G",code:"00A9"},{symbol:"",description:this.textRegistered,shortcutKey:Common.Utils.String.platformKey(Common.Utils.isMac?"Alt Ctrl ":"Alt+Ctrl+","{0}")+"R",code:"00AE"},{symbol:"",description:this.textTradeMark,shortcutKey:Common.Utils.String.platformKey(Common.Utils.isMac?"Alt Ctrl ":"Alt+Ctrl+","{0}")+"T",code:"2122"},{symbol:"",description:this.textSection,shortcutKey:"",code:"00A7"},{symbol:"",description:this.textPilcrow,shortcutKey:"",code:"00B6"},{symbol:"",description:this.textEllipsis,shortcutKey:Common.Utils.String.platformKey(Common.Utils.isMac?"Alt Ctrl ":"Alt+Ctrl+","{0}")+".",code:"2026"},{symbol:"",description:this.textSOQuote,shortcutKey:"",code:"2018"},{symbol:"",description:this.textSCQuote,shortcutKey:"",code:"2019"},{symbol:"",description:this.textDOQuote,shortcutKey:"",code:"201C"},{symbol:"",description:this.textDCQuote,shortcutKey:"",code:"201D"}];this.specialList=new Common.UI.ListView({el:e.find("#symbol-table-special-list"),store:new Common.UI.DataViewStore(n),simpleAddMode:!0,cls:"dbl-clickable",itemTemplate:_.template(['<div id="<%= id %>" class="list-item" style="width: 100%;display:flex;">','<div class="padding-right-5" style="width:70px;text-align: center;"><%= symbol %></div>','<div class="padding-right-5" style="flex-grow:1;"><%= description %></div>',"<% if ("+this.showShortcutKey+") { %>",'<div style="width:105px;"><%= shortcutKey %></div>',"<% } %>","</div>"].join(""))}),this.specialList.on("item:dblclick",_.bind(this.onDblClickSpecialItem,this)).on("entervalue",_.bind(this.onDblClickSpecialItem,this)),this.specialList.selectByIndex(0),this.lblShortCut=e.find("#symbol-table-lbl-shortcut"),this.lblShortCut.toggleClass("hidden",!this.showShortcutKey),e.find(".dlg-btn").on("click",_.bind(this.onBtnClick,this)),this.symbolsPanel=e.find("#symbol-table-pnl-symbols"),this.specialPanel=e.find("#symbol-table-pnl-special")},calcControlsHeight:function(){var t=this.$window,e=this.symbolsPanel.find("> table"),i=t.find("#symbol-table-switcher"),s=t.find(".body");this.hfHeight=parseInt(t.find(".header").css("height"))+parseInt(t.find(".footer").css("height"))+parseInt(s.css("padding-top"))+parseInt(s.css("padding-bottom"))+parseInt(t.css("border-bottom-width"))+parseInt(t.css("border-top-width")),this.switcherHeight=this.special?i.height()+parseInt(i.css("margin-bottom")):0,this.controlsSpecialHeight=this.special&&this.btnSpecial.isActive()?t.find("#symbol-table-lbl-char").height()+i.height()+parseInt(i.css("margin-bottom")):0,this.controlsSymbolsHeight=this.special&&this.btnSpecial.isActive()?0:e.eq(0).height()+e.eq(2).height()+e.eq(3).height()+(this.special?i.height()+parseInt(i.css("margin-bottom")):0)},show:function(){Common.UI.Window.prototype.show.apply(this,arguments),this.binding||(this.binding={}),this.binding.keydownSymbols=_.bind(this.onKeyDown,this),this.binding.keypressSymbols=_.bind(this.onKeyPress,this),$(document).on("keydown."+this.cid,"#symbol-table-scrollable-div #id-preview-data, #symbol-table-recent",this.binding.keydownSymbols),$(document).on("keypress."+this.cid,"#symbol-table-scrollable-div #id-preview-data, #symbol-table-recent",this.binding.keypressSymbols);var t=this.special&&!!Common.Utils.InternalSettings.get(this.appPrefix+"symbol-table-special");t?this.btnSpecial.toggle(!0):this.btnSymbols.toggle(!0),this.ShowHideElem(t)},close:function(t){$(document).off("keydown."+this.cid,this.binding.keydownSymbols),$(document).off("keypress."+this.cid,this.binding.keypressSymbols),this.special&&Common.Utils.InternalSettings.set(this.appPrefix+"symbol-table-special",this.btnSpecial.isActive()),Common.UI.Window.prototype.close.apply(this,arguments)},getPasteSymbol:function(t){var e,s=!1;if(t&&t.length>0)if(s="c"===t[0])e=i[a].displayValue;else{var n=parseInt(t.split("_")[2]);e=i[n].displayValue}return{font:e,symbol:this.encodeSurrogateChar(o),code:o,updateRecents:s}},getSpecialSymbol:function(){var t=this.specialList.getSelectedRec();return{font:void 0,symbol:this.encodeSurrogateChar(t.get("code")),code:parseInt(t.get("code"),16),special:t.get("special"),speccharacter:!0}},onBtnClick:function(t){this._handleInput(t.currentTarget.attributes.result.value,!0)},onPrimary:function(t){return this._handleInput("ok"),!1},_handleInput:function(t,e){if(e||!document.activeElement||"textarea"!=document.activeElement.localName||!/area_id/.test(document.activeElement.id)){var i=this.btnSpecial.isActive(),s="ok"==t?i?this.getSpecialSymbol():this.getPasteSymbol(this.$window.find(".cell-selected").attr("id")):{};this.options.handler&&this.options.handler.call(this,this,t,s),"ok"==t&&(!i&&this.checkRecent(o,s.font),!i&&s.updateRecents&&this.updateRecents(),this.type)||this.close()}},encodeSurrogateChar:function(t){if(t<65536)return String.fromCharCode(t);var e=55296|(t-=65536)>>10,i=56320|1023&t;return String.fromCharCode(e)+String.fromCharCode(i)},fixedCharCodeAt:function(t,e){e=e||0;var i,s,n=t.charCodeAt(e);if(55296<=n&&n<=56319){if(i=n,s=t.charCodeAt(e+1),isNaN(s))throw"        fixedCharCodeAt()";return 1024*(i-55296)+(s-56320)+65536}return!(56320<=n&&n<=57343)&&n},getArrRangesByFont:function(t){var e=getSupportedRangesByFont(i[t]);return 0===e.length&&e.push({Start:32,End:255}),e[0].Start<32&&(e[0].Start=32),e},getRangeBySymbol:function(t,e){for(var i=0;i<t.length;++i)if(t[i].Start<=e&&t[i].End>=e)return t[i];return null},getRangeByName:function(t,e){for(var i=0;i<t.length;++i)if(t[i].Name===e)return t[i];return null},getLinearIndexByCode:function(t,e){for(var i,s=0,n=0;n<t.length;++n){if((i=t[n]).Start>e)return-1;if(i.Start<=e&&i.End>=e)return s+(e-i.Start);s+=i.End-i.Start+1}return-1},getCodeByLinearIndex:function(t,e){if(e<0)return-1;for(var i,s=0,n=t[0],a=0;a<t.length;++a){if(s+(i=(n=t[a]).End-n.Start+1)>e)return n.Start+e-s;s+=i}return-1},createTable:function(t,e,i){for(var s,n=e*i,a=0,o="",l=0;l<n;++l)s=l/i>>0==e-1?"style='border-bottom: none'":"",l<t.length?o+='<div dir="ltr" class="cell" '+s+' id="'+("c"+t[l])+'">&#'+t[l].toString(10)+"</div>":o+='<div dir="ltr" class="cell"'+s+"></div>",++a>=i&&(o+='<br class="noselect">',a=0);this.previewPanel.html(o)},fillRecentSymbols:function(){var t,e=Common.localStorage.getItem(this.appPrefix+"recentSymbols");""!=e&&(t=JSON.parse(e)),_.isArray(t)&&(n=t)},saveRecent:function(){var t=JSON.stringify(n);Common.localStorage.setItem(this.appPrefix+"recentSymbols",t)},checkRecent:function(t,e){if(0===n.length)return n.push({symbol:t,font:e}),void this.saveRecent();for(var i=0;i<n.length;++i)if(n[i].symbol===t&&n[i].font===e){n.splice(i,1);break}n.splice(0,0,{symbol:t,font:e}),n.length>36&&n.splice(36,n.length-36),this.saveRecent()},createCell:function(t,e){var s="",n="";if(e){for(var a=0,o=0;o<i.length;++o)if(i[o].displayValue===e){a=o;break}s="r_"+t+"_"+a,n="&#"+t.toString()}else void 0!==t&&(s="r"+t,n="&#"+t.toString());var l=$('<div dir="ltr" id="'+s+'">'+n+"</div>");return l.addClass("cell"),l.addClass("noselect"),l.mousedown(_.bind(this.cellClickHandler,this)),e&&l.css("font-family","'"+e+"'"),l},cellClickHandler:function(t){var e=$(t.target).attr("id");if(e){var i=(new Date).getTime();if(e===h&&i-p<300)this.cellDblClickHandler(t);else{if("c"===e[0])o=parseInt(e.slice(1,e.length)),l=!0;else{var s=e.split("_");o=parseInt(s[1]),r=parseInt(s[2]),l=!1}this.updateView(!1)}h=t.target.id,p=i}},cellDblClickHandler:function(t){if(this.type){var e=this.getPasteSymbol($(t.target).attr("id"));this.checkRecent(o,e.font),e.updateRecents&&this.updateView(!1,void 0,void 0,!0),this.fireEvent("symbol:dblclick",this,"ok",e)}else this._handleInput("ok")},onDblClickSpecialItem:function(t){if(this.type){var e=this.getSpecialSymbol();this.fireEvent("symbol:dblclick",this,"ok",e)}else this._handleInput("ok")},updateRecents:function(){var t=this.recentPanel;t.empty();var e=this.getColsCount(),i=n.length;t.width(31*e);for(var s=0;s<e;++s){var a=s<i?this.createCell(n[s].symbol,n[s].font):this.createCell();a.css("border-bottom","none"),t.append(a),s===e-1&&a.css(Common.UI.isRTL()?"border-left":"border-right","none")}},getColsCount:function(){return(this.boxPanel.width()-13)/31>>0},getMaxHeight:function(){return this.symbolTablePanel.height()-2},getRowsCount:function(){return Math.max(1,this.getMaxHeight()/e>>0)},getAllSymbolsCount:function(t){for(var e,i=0,s=0;s<t.length;++s)i+=(e=t[s]).End-e.Start+1;return i},setTable:function(t){for(var e,n=this.getColsCount(),o=this.getRowsCount(),l=this.getLinearIndexByCode(s,t),r=this.getAllSymbolsCount(s),c=Math.ceil(r/n),d=Math.max(0,Math.min(c-o,l/n>>0)),h=d*n,p=o*n,m=[],u=0;u<p&&-1!==(e=this.getCodeByLinearIndex(s,h+u));++u)m.push(e);return this.previewPanel.css("font-family","'"+i[a].displayValue+"'"),this.createTable(m,o,n),d},updateView:function(t,n,c,d,h){l&&!1!==h&&this.updateRangeSelector(),l?this.fontLabel.text(i[a]?i[a].displayValue:""):this.fontLabel.text(i[r]?i[r].displayValue:""),!1!==t&&this.cmbFonts.setValue(a);var p=this.getRowsCount()*e;if(!1,!1!==t){var m=null!=n?n:o,u=this.setTable(m),f=this.getAllSymbolsCount(s),C=Math.ceil(f/this.getColsCount())*e;this.previewInner.height(C),this.previewPanel.height(p),this.previewScrolled.height(p),this.scrollerY||(g=Math.max(22,p/8+.5>>0),b=Math.min(Math.floor(this.previewPanel.height()/e)*e/10,20),this.scrollerY=new Common.UI.Scroller({el:this.previewScrolled,minScrollbarLength:g,alwaysVisibleY:!0,wheelSpeed:b,useKeyboard:!1,onChange:_.bind((function(){this.scrollerY&&(this._preventUpdateScroll=!0,this.onScrollEnd(),this._preventUpdateScroll=!1,this.previewParent.height(p),this.previewParent.css({top:this.scrollerY.getScrollTop()}))}),this)})),this._preventUpdateScroll||(this.scrollerY.update({minScrollbarLength:g,wheelSpeed:b}),this.scrollerY.scrollTop(u*e));var x=this.previewPanel.find(".cell");x.off("mousedown"),x.mousedown(_.bind(this.cellClickHandler,this))}d&&this.updateRecents(),this.$window.find(".cell").removeClass("cell-selected"),l?this.$window.find("#c"+o).addClass("cell-selected"):this.$window.find("#r_"+o+"_"+r).addClass("cell-selected"),!1!==c&&this.updateInput()},onScrollEnd:function(){if(this.scrollerY.getScrollTop()!==d){var t=this.getAllSymbolsCount(s),i=this.getColsCount(),n=this.getRowsCount(),a=Math.ceil(t/i),r=a*e,c=Math.max(0,Math.min(a-n,a*this.scrollerY.getScrollTop()/r+.5>>0));if(d=this.scrollerY.getScrollTop(),l){var h=this.previewPanel.children()[0];if(h){var p=h.id;if(p){var m=parseInt(p.slice(1,p.length)),u=this.getLinearIndexByCode(s,m),g=c*i+(this.getLinearIndexByCode(s,o)-u);o=this.getCodeByLinearIndex(s,g);var b=c*i;for(g-=i;-1===o&&g>=b;)o=this.getCodeByLinearIndex(s,g),g-=i;-1===o&&(o=this.getCodeByLinearIndex(s,b))}else o=this.getCodeByLinearIndex(s,c*i)}}else o=this.getCodeByLinearIndex(s,c*i),l=!0;this.updateView(!0,this.getCodeByLinearIndex(s,c*i))}},updateInput:function(){for(var t=o.toString(16).toUpperCase(),e=t.length;e<5;++e)t="0"+t;this.inputCode.setValue(t)},updateRangeSelector:function(){var e=this.getRangeBySymbol(s,o);if(e&&e.Name){this.cmbRange.setDisabled(!1);var i,n=[];for(i=0;i<s.length;++i)n.push({value:s[i].Name,displayValue:t[s[i].Name]});this.cmbRange.setData(n),this.cmbRange.setValue(e.Name)}else this.cmbRange.setDisabled(!0),this.cmbRange.setValue("")},onKeyDown:function(t){if(!document.activeElement||!document.activeElement.nodeName||"span"!==document.activeElement.nodeName.toLowerCase()){var e=t.which||t.charCode||t.keyCode||0,i=!0;if(l){var n=-1;if(e===Common.UI.Keys.LEFT?n=this.getCodeByLinearIndex(s,this.getLinearIndexByCode(s,o)-1):e===Common.UI.Keys.UP?n=this.getCodeByLinearIndex(s,this.getLinearIndexByCode(s,o)-this.getColsCount()):e===Common.UI.Keys.RIGHT?n=this.getCodeByLinearIndex(s,this.getLinearIndexByCode(s,o)+1):e===Common.UI.Keys.DOWN?n=this.getCodeByLinearIndex(s,this.getLinearIndexByCode(s,o)+this.getColsCount()):e===Common.UI.Keys.HOME?s.length>0&&(n=s[0].Start):e===Common.UI.Keys.END?s.length>0&&(n=s[s.length-1].End):i=!1,n>-1){o=n;var a=0===this.$window.find("#c"+o).length;this.updateView(a)}}else{var c,d;if(e===Common.UI.Keys.LEFT){if((c=this.$window.find(".cell-selected")[0])&&"r"===c.id[0]){var h=this.$window.find(c).prev();h.length>0&&(d=this.$window.find(h).attr("id").split("_"),o=parseInt(d[1]),r=parseInt(d[2]),this.updateView(!1))}}else if(e===Common.UI.Keys.RIGHT){if((c=this.$window.find(".cell-selected")[0])&&"r"===c.id[0]){var p=this.$window.find(c).next();p.length>0&&(d=this.$window.find(p).attr("id").split("_"),o=parseInt(d[1]),r=parseInt(d[2]),this.updateView(!1))}}else if(e===Common.UI.Keys.HOME){var g=this.$window.find("#recent-table").children()[0];g&&(d=g.id.split("_"),o=parseInt(d[1]),r=parseInt(d[2]),this.updateView(!1))}else if(e===Common.UI.Keys.END){var b=this.recentPanel.children(),f=b[b.length-1];f&&(d=f.id.split("_"),o=parseInt(d[1]),r=parseInt(d[2]),this.updateView(!1))}else i=!1}i&&(u=e,m=(new Date).getTime())}},onKeyPress:function(t){if(!document.activeElement||!document.activeElement.nodeName||"span"!==document.activeElement.nodeName.toLowerCase()){var e=t.which||t.charCode||t.keyCode||0;if(!(u===e&&Math.abs(m-(new Date).getTime())<1e3)){if(!isNaN(e)&&e>31)if(this.getRangeBySymbol(s,e)){var i=0===this.$window.find("#c"+e).length;o=e,l=!0,this.updateView(i,void 0,!0)}t.preventDefault&&t.preventDefault()}}},onWindowResize:function(t){var e=this.getSize();if(t&&"start"==t[1])this._preventUpdateScroll=!0,this.curSize={resize:!1,width:e[0],height:e[1]};else if(this.curSize.resize){this._preventUpdateScroll=!1,this.scrollerY=null,this.curSize.height=e[1],this.curSize.width=e[0],this.applyInnerSize(e[1]),this.special&&(e[1]-=this.switcherHeight);var i=JSON.stringify(e);Common.localStorage.setItem(this.appPrefix+"settings-size-symbol-table",i),Common.Utils.InternalSettings.set(this.appPrefix+"settings-size-symbol-table",i)}},onWindowResizing:function(){if(this.curSize){var t=this.getSize();t[0]===this.curSize.width&&t[1]===this.curSize.height||(this.curSize.resize||(this.curSize.resize=!0),this.curSize.width=t[0],this.curSize.height=t[1],this.applyInnerSize(t[1]))}},applyInnerSize:function(t){var i=t-this.hfHeight;this.controlsSymbolsHeight?(i-=this.controlsSymbolsHeight,this.symbolTablePanel.css({height:i+"px"}),i=Math.max(1,(i-2)/e>>0)*e,this.previewPanel.css({height:i+"px"}),this.previewScrolled.css({height:i+"px"}),this.updateView(void 0,void 0,void 0,!0)):this.specialList.cmpEl.height(i-this.controlsSpecialHeight)},onModeClick:function(t,e,i){this.ShowHideElem(t)},ShowHideElem:function(t){this.symbolsPanel.toggleClass("hidden",t),this.specialPanel.toggleClass("hidden",!t),this.calcControlsHeight(),this.applyInnerSize(this.getSize()[1]);var e=this;_.delay((function(){t?e.specialList.focus():e.previewPanel.focus()}),50)},onThemeChanged:function(){this.$window&&this.isVisible()&&(Common.UI.Window.prototype.onThemeChanged.call(this),this.calcControlsHeight(),this.applyInnerSize(this.getSize()[1]))},textTitle:"Symbol",textFont:"Font",textRange:"Range",textRecent:"Recently used symbols",textCode:"Unicode HEX value",textSymbols:"Symbols",textSpecial:"Special characters",textCharacter:"Character",textShortcut:"Shortcut key",textEmDash:"Em Dash",textEnDash:"En Dash",textNBHyphen:"Non-breaking Hyphen",textSHyphen:"Soft Hyphen",textEmSpace:"Em Space",textEnSpace:"En Space",textQEmSpace:"1/4 Em Space",textNBSpace:"No-break Space",textCopyright:"Copyright Sign",textRegistered:"Registered Sign",textTradeMark:"Trade Mark Sign",textSection:"Section Sign",textPilcrow:"Pilcrow Sign",textEllipsis:"Horizontal Ellipsis",textSOQuote:"Single Opening Quote",textSCQuote:"Single Closing Quote",textDOQuote:"Double Opening Quote",textDCQuote:"Double Closing Quote"},Common.Views.SymbolTableDialog||{}))})),void 0===Common)Common={};if(define("common/main/lib/view/InsertTableDialog",[],(function(){"use strict";Common.Views.InsertTableDialog=Common.UI.Window.extend(_.extend({options:{width:230,style:"min-width: 230px;",cls:"modal-dlg",id:"window-insert-table",split:!1,buttons:["ok","cancel"]},initialize:function(t){_.extend(this.options,{title:t.split?this.txtTitleSplit:this.txtTitle},t||{}),this.template=['<div class="box">','<div class="input-row">','<label class="text columns-text" style="width: 130px;">'+this.txtColumns+'</label><div class="columns-val float-right"></div>',"</div>",'<div class="input-row" style="margin-top: 10px;">','<label class="text rows-text" style="width: 130px;">'+this.txtRows+'</label><div class="rows-val float-right"></div>',"</div>","</div>"].join(""),this.options.tpl=_.template(this.template)(this.options),Common.UI.Window.prototype.initialize.call(this,this.options)},render:function(){Common.UI.Window.prototype.render.call(this);var t=this.getChild();t.find(".dlg-btn").on("click",_.bind(this.onBtnClick,this)),this.udColumns=new Common.UI.MetricSpinner({el:t.find(".columns-val"),step:1,width:64,value:2,defaultUnit:"",maxValue:63,minValue:1,allowDecimal:!1}),this.udRows=new Common.UI.MetricSpinner({el:t.find(".rows-val"),step:1,width:64,value:2,defaultUnit:"",maxValue:100,minValue:1,allowDecimal:!1})},getFocusedComponents:function(){return[this.udColumns,this.udRows].concat(this.getFooterButtons())},getDefaultFocusableComponent:function(){return this.udColumns},onBtnClick:function(t){this.options.handler&&this.options.handler.call(this,t.currentTarget.attributes.result.value,{columns:this.udColumns.getNumberValue(),rows:this.udRows.getNumberValue()}),this.close()},onPrimary:function(){return this.options.handler&&this.options.handler.call(this,"ok",{columns:this.udColumns.getNumberValue(),rows:this.udRows.getNumberValue()}),this.close(),!1},txtTitle:"Table Size",txtTitleSplit:"Split Cell",txtColumns:"Number of Columns",txtRows:"Number of Rows",textInvalidRowsCols:"You need to specify valid rows and columns count.",txtMinText:"The minimum value for this field is {0}",txtMaxText:"The maximum value for this field is {0}"},Common.Views.InsertTableDialog||{}))})),define("common/main/lib/view/SearchDialog",[],(function(){"use strict";Common.UI.SearchDialog=Common.UI.Window.extend(_.extend({options:{width:550,title:"Search & Replace",modal:!1,cls:"search",toolclose:"hide",alias:"SearchDialog"},initialize:function(t){_.extend(this.options,t||{}),this.template=['<div class="box">','<div class="input-row">','<span class="btn-placeholder" id="search-placeholder-btn-options"></span>','<input type="text" id="sd-text-search" class="input-field form-control" maxlength="255" placeholder="'+this.textSearchStart+'" autocomplete="off">',"</div>",'<div class="input-row">','<input type="text" id="sd-text-replace" class="input-field form-control" maxlength="255" placeholder="'+this.textReplaceDef+'" autocomplete="off">',"</div>",'<div class="input-row">','<label class="link" id="search-label-replace" result="replaceshow">'+this.txtBtnReplace+"</label>","</div>","</div>",'<div class="separator horizontal"></div>','<div class="footer right">','<button class="btn normal dlg-btn" result="replace">'+this.txtBtnReplace+"</button>",'<button class="btn normal dlg-btn margin-left-6" result="replaceall" style="width: auto;min-width: 100px;">'+this.txtBtnReplaceAll+"</button>",'<button class="btn normal dlg-btn iconic" result="back"><span class="icon img-commonctrl back"></span></button>','<button class="btn normal dlg-btn iconic margin-left-6" result="next"><span class="icon img-commonctrl next"></span></button>',"</div>"].join(""),this.options.tpl=_.template(this.template)(this.options),Common.UI.Window.prototype.initialize.call(this,this.options)},render:function(){return Common.UI.Window.prototype.render.call(this),this.miMatchCase=new Common.UI.MenuItem({caption:this.textMatchCase,checkable:!0}),this.miMatchWord=new Common.UI.MenuItem({caption:this.options.matchwordstr||this.textWholeWords,checkable:!0}),this.miHighlight=new Common.UI.MenuItem({caption:this.textHighlight,checkable:!0}),this.btnOptions=new Common.UI.Button({id:"search-btn-options",cls:"btn-toolbar",iconCls:"toolbar__icon btn-settings",menu:new Common.UI.Menu({items:[this.miMatchCase,this.miMatchWord,this.miHighlight]})}),this.options.extraoptions&&(this.btnOptions.menu.addItem({caption:"--"}),this.options.extraoptions.forEach((function(t){this.btnOptions.menu.addItem(t)}),this)),this.btnOptions.render(this.$window.find("#search-placeholder-btn-options")),this.options.matchcase||this.miMatchCase.hide(),this.options.matchword||this.miMatchWord.hide(),this.options.markresult?this.options.markresult.applied&&this.miHighlight.setChecked(!0,!0):this.miHighlight.hide(),"search"===this.options.mode&&$(this.$window.find(".input-row").get(2)).hide(),this.txtSearch=this.$window.find("#sd-text-search"),this.txtReplace=this.$window.find("#sd-text-replace"),this.lblReplace=this.$window.find("#search-label-replace"),this.miHighlight.on("toggle",_.bind(this.onHighlight,this)),this.$window.find(".btn[result=back]").on("click",_.bind(this.onBtnClick,this,"back")),this.$window.find(".btn[result=next]").on("click",_.bind(this.onBtnClick,this,"next")),this.$window.find(".btn[result=replace]").on("click",_.bind(this.onBtnClick,this,"replace")),this.$window.find(".btn[result=replaceall]").on("click",_.bind(this.onBtnClick,this,"replaceall")),this.$window.find("label[result=replaceshow]").on("click",_.bind(this.onShowReplace,this)),this.txtSearch.on("keydown",null,"search",_.bind(this.onKeyPress,this)),this.txtReplace.on("keydown",null,"replace",_.bind(this.onKeyPress,this)),this.on("animate:before",_.bind(this.onAnimateBefore,this)),this},show:function(t,e){Common.UI.Window.prototype.show.call(this),!this.mode&&!t&&(t="search"),t&&this.mode!=t&&this.setMode(t),e&&this.setSearchText(e),this.options.markresult&&this.miHighlight.checked&&this.fireEvent("search:highlight",[this,!0]),this.focus()},focus:function(t){var e="replace"===t?this.txtReplace:this.txtSearch;setTimeout((function(){e.focus(),e.select()}),10)},onAnimateBefore:function(){this.focus()},onKeyPress:function(t){this.isLocked()||(t.keyCode==Common.UI.Keys.RETURN?("search"==t.data?this.onBtnClick("next",t):"replace"==t.data&&"replace"==this.mode&&this.onBtnClick("replace",t),t.preventDefault(),t.stopPropagation()):t.keyCode==Common.UI.Keys.ESC&&$(".asc-loadmask").length<1&&(this.hide(),t.preventDefault(),t.stopPropagation()))},onBtnClick:function(t,e){if(!$(".asc-loadmask").length){var i={textsearch:this.txtSearch.val(),textreplace:this.txtReplace.val(),matchcase:this.miMatchCase.checked,matchword:this.miMatchWord.checked,highlight:this.miHighlight.checked};this.fireEvent("search:"+t,[this,i])}},setMode:function(t){this.mode=t;var e=this.$window.find(".input-row");"no-replace"===t?(this.setTitle(this.textTitle2),e.eq(1).hide(),e.eq(2).hide(),this.$window.find(".btn[result=replace]").hide(),this.$window.find(".btn[result=replaceall]").hide(),this.options.matchcase||this.options.matchword||this.options.markresult||(this.txtSearch.addClass("clear"),this.btnOptions.hide()),this.menuLookin&&this.menuLookin.menu.items[1].setDisabled(!1),this.setHeight(170)):(this.txtSearch.removeClass("clear"),this.setTitle(this.textTitle),"search"===t?(e.eq(2).show(),this.lblReplace.text(this.txtBtnReplace),e.eq(1).hide(),this.$window.find(".btn[result=replace]").hide(),this.$window.find(".btn[result=replaceall]").hide(),this.menuLookin&&this.menuLookin.menu.items[1].setDisabled(!1),this.setHeight(200)):(e.eq(2).show(),this.lblReplace.text(this.txtBtnHideReplace),e.eq(1).show(),this.$window.find(".btn[result=replace]").show(),this.$window.find(".btn[result=replaceall]").show(),this.menuLookin&&(this.menuLookin.menu.items[0].setChecked(!0),this.menuLookin.menu.items[1].setDisabled(!0)),this.setHeight(230)))},setSearchText:function(t){this.txtSearch&&this.txtSearch.val(t)},onShowReplace:function(t){this.setMode("replace"==this.mode?"search":"replace");var e=this;_.defer((function(){"replace"==e.mode?e.txtReplace.focus():e.txtSearch.focus()}),300)},onHighlight:function(t,e){this.fireEvent("search:highlight",[this,e])},getSettings:function(){return{textsearch:this.txtSearch.val(),matchcase:this.miMatchCase.checked,matchword:this.miMatchWord.checked}},textTitle:"Search & Replace",textTitle2:"Search",txtBtnReplace:"Replace",txtBtnReplaceAll:"Replace All",textMatchCase:"Case sensitive",textWholeWords:"Whole words only",textHighlight:"Highlight results",textReplaceDef:"Enter the replacement text",textSearchStart:"Enter text for search",txtBtnHideReplace:"Hide Replace"},Common.UI.SearchDialog||{}))})),define("common/main/lib/view/RenameDialog",[],(function(){"use strict";Common.Views.RenameDialog=Common.UI.Window.extend(_.extend({options:{width:330,header:!1,cls:"modal-dlg",filename:"",buttons:["ok","cancel"]},initialize:function(t){_.extend(this.options,t||{}),this.template=['<div class="box">','<div class="input-row">',"<label>"+this.textName+"</label>","</div>",'<div id="id-dlg-newname" class="input-row"></div>',"</div>"].join(""),this.options.tpl=_.template(this.template)(this.options),Common.UI.Window.prototype.initialize.call(this,this.options)},render:function(){Common.UI.Window.prototype.render.call(this);var t=this;t.inputName=new Common.UI.InputField({el:$("#id-dlg-newname"),style:"width: 100%;",validateOnBlur:!1,maxLength:t.options.maxLength,validation:function(e){return!/[\t*\+:\"<>?|\\\\/]/gim.test(e)||t.txtInvalidName+'*+:"<>?|/'}});var e=this.getChild();e.find(".btn").on("click",_.bind(this.onBtnClick,this)),t.inputNameEl=e.find("input")},getFocusedComponents:function(){return[this.inputName].concat(this.getFooterButtons())},getDefaultFocusableComponent:function(){return this.inputName},show:function(){Common.UI.Window.prototype.show.apply(this,arguments);var t=this,e=t.options.filename.lastIndexOf(".");e>0&&(t.options.filename=t.options.filename.substring(0,e)),_.delay((function(){t.inputName.setValue(t.options.filename),t.inputNameEl.focus().select()}),100)},onPrimary:function(t){return this._handleInput("ok"),!1},onBtnClick:function(t){this._handleInput(t.currentTarget.attributes.result.value)},_handleInput:function(t){if(this.options.handler){if("ok"==t&&!0!==this.inputName.checkValidate())return void this.inputNameEl.focus();this.options.handler.call(this,t,this.inputName.getValue())}this.close()},textName:"File name",txtInvalidName:"The file name cannot contain any of the following characters: "},Common.Views.RenameDialog||{}))})),define("common/main/lib/view/ExternalEditor",[],(function(){"use strict";Common.Views.ExternalEditor=Common.UI.Window.extend(_.extend({initialize:function(t){var e=Common.localStorage.getKeysFilter(),i=e&&e.length?e.split(",")[0]:"";this.storageName=t.storageName?i+t.storageName:null;var s={},n=t.initwidth||900,a=t.initheight||700,o=void 0===t.footer||t.footer;if(this.storageName){var l=Common.localStorage.getItem(this.storageName+"-width");l&&(n=parseFloat(l)),(l=Common.localStorage.getItem(this.storageName+"-height"))&&(a=parseFloat(l))}_.extend(s,{width:n,height:a,cls:"advanced-settings-dlg",header:!0,toolclose:"hide",toolcallback:_.bind(this.onToolClose,this),resizable:!0,footer:o},t),!o&&(s.cls+=" no-footer"),this.template=['<div id="id-editor-container" class="box" style="padding: 0 5px;">','<div id="'+(s.sdkplaceholder||"")+'" style="width: 100%;height: 100%;"></div>',"</div>","<% if (footer) { %>",'<div class="separator horizontal"></div>','<div class="footer" style="text-align: center;">','<button id="id-btn-editor-apply" class="btn normal dlg-btn primary auto" result="ok" data-hint="1" data-hint-direction="bottom" data-hint-offset="big">'+this.textSave+"</button>",'<button id="id-btn-editor-cancel" class="btn normal dlg-btn" result="cancel" data-hint="1" data-hint-direction="bottom" data-hint-offset="big">'+this.textClose+"</button>","</div>","<% } %>"].join(""),s.tpl=_.template(this.template)(s),this.handler=s.handler,this._isNewObject=!0,this.on("resize",_.bind(this.onWindowResize,this)),Common.UI.Window.prototype.initialize.call(this,s)},render:function(){Common.UI.Window.prototype.render.call(this),this.boxEl=this.$window.find(".body > .box");var t=this.$window.find("> .body");this._headerFooterHeight=this.initConfig.header?parseFloat(this.$window.find(".header").css("height")):0,this._headerFooterHeight+=(this.initConfig.footer?parseFloat(this.$window.find(".footer").css("height")):0)+parseFloat(t.css("padding-top"))+parseFloat(t.css("padding-bottom")),this._headerFooterHeight+=parseFloat(this.$window.css("border-top-width"))+parseFloat(this.$window.css("border-bottom-width"));var e=this.$window.find(".resize-border.bottom");e.length>0&&(this._headerFooterHeight+=$(e[0]).height()-2),this.boxEl.css("height",this.getHeight()-this._headerFooterHeight),this.btnSave=new Common.UI.Button({el:this.$window.find("#id-btn-editor-apply"),disabled:!0}),this.btnCancel=new Common.UI.Button({el:this.$window.find("#id-btn-editor-cancel")}),this.$window.find(".dlg-btn").on("click",_.bind(this.onDlgBtnClick,this))},show:function(){Common.UI.Window.prototype.show.apply(this,arguments)},setEditMode:function(t){this._isNewObject=!t},isEditMode:function(){return!this._isNewObject},setControlsDisabled:function(t){this.btnSave.setDisabled(t),this.btnCancel.setDisabled(t),t?this.$window.find(".tool.close").addClass("disabled"):this.$window.find(".tool.close").removeClass("disabled")},onDlgBtnClick:function(t){this.handler?this.handler.call(this,t.currentTarget.attributes.result.value):this.hide()},onToolClose:function(){this.handler?this.handler.call(this,"cancel"):this.hide()},setHeight:function(t){if(this.$window&&t>=0){var e=parseInt(this.$window.css("min-height"));t<e&&(t=e),this.$window.height(t);var i=this.initConfig.header?parseFloat(this.$window.find("> .header").css("height")):0;this.$window.find("> .body").css("height",t-i),this.$window.find("> .body > .box").css("height",t-this._headerFooterHeight)}},setInCenter:function(){var t=this.$window.height(),e=(Common.Utils.innerHeight()-Common.Utils.InternalSettings.get("window-inactive-area-top")-parseInt(t))/2,i=(Common.Utils.innerWidth()-parseInt(this.initConfig.width))/2;this.$window.css("left",i),this.$window.css("top",Common.Utils.InternalSettings.get("window-inactive-area-top")+e)},setInnerSize:function(t,e){var i=Common.Utils.innerHeight(),s=Common.Utils.innerWidth(),n=parseFloat(this.$window.css("border-left-width"))+parseFloat(this.$window.css("border-right-width")),a=parseFloat(this.boxEl.css("padding-left"))+parseFloat(this.boxEl.css("padding-right"));i<(e+=90)+this._headerFooterHeight&&(e=i-this._headerFooterHeight),s<t+a+n&&(t=s-a-n),this.boxEl.css("height",e),this.setHeight(e+this._headerFooterHeight),this.setWidth(t+a+n),this.getLeft()<0&&this.$window.css("left",0),this.getTop()<Common.Utils.InternalSettings.get("window-inactive-area-top")&&this.$window.css("top",Common.Utils.InternalSettings.get("window-inactive-area-top"))},onWindowResize:function(t){if(t&&"end"==t[1]){var e=this.getSize();this.storageName&&(Common.localStorage.setItem(this.storageName+"-width",e[0]),Common.localStorage.setItem(this.storageName+"-height",e[1]))}},textSave:"Save & Exit",textClose:"Close"},Common.Views.ExternalEditor||{}))})),define("common/main/lib/view/ExternalDiagramEditor",["common/main/lib/view/ExternalEditor"],(function(){"use strict";Common.Views.ExternalDiagramEditor=Common.Views.ExternalEditor.extend(_.extend({initialize:function(t){var e={};_.extend(e,{id:"id-external-diagram-editor",title:this.textTitle,sdkplaceholder:"id-diagram-editor-placeholder",initwidth:730,initheight:275,minwidth:730,minheight:275,footer:!1,transparentMask:!0},t),this._chartData=null,Common.Views.ExternalEditor.prototype.initialize.call(this,e)},show:function(){this.setPlaceholder(),Common.Views.ExternalEditor.prototype.show.apply(this,arguments)},setChartData:function(t){this._chartData=t,this._isExternalDocReady&&this.fireEvent("setchartdata",this)},setPlaceholder:function(t){this._placeholder=t},getPlaceholder:function(){return this._placeholder},textTitle:"Chart Editor"},Common.Views.ExternalDiagramEditor||{}))})),define("common/main/lib/view/FormatSettingsDialog",["common/main/lib/view/AdvancedSettingsWindow"],(function(){"use strict";Common.Views.FormatSettingsDialog=Common.Views.AdvancedSettingsWindow.extend(_.extend({options:{contentWidth:284,contentHeight:265},initialize:function(t){var e=this;e.numFormatData=[{value:Asc.c_oAscNumFormatType.General,displayValue:this.txtGeneral},{value:Asc.c_oAscNumFormatType.Number,displayValue:this.txtNumber},{value:Asc.c_oAscNumFormatType.Scientific,displayValue:this.txtScientific},{value:Asc.c_oAscNumFormatType.Accounting,displayValue:this.txtAccounting},{value:Asc.c_oAscNumFormatType.Currency,displayValue:this.txtCurrency},{value:Asc.c_oAscNumFormatType.Date,displayValue:this.txtDate},{value:Asc.c_oAscNumFormatType.Time,displayValue:this.txtTime},{value:Asc.c_oAscNumFormatType.Percent,displayValue:this.txtPercentage},{value:Asc.c_oAscNumFormatType.Fraction,displayValue:this.txtFraction},{value:Asc.c_oAscNumFormatType.Text,displayValue:this.txtText},{value:Asc.c_oAscNumFormatType.Custom,displayValue:this.txtCustom}],e.FractionData=[{displayValue:this.txtUpto1,value:"# ?/?"},{displayValue:this.txtUpto2,value:"# ??/??"},{displayValue:this.txtUpto3,value:"# ???/???"},{displayValue:this.txtAs2,value:"# ?/2"},{displayValue:this.txtAs4,value:"# ?/4"},{displayValue:this.txtAs8,value:"# ?/8"},{displayValue:this.txtAs16,value:"# ??/16"},{displayValue:this.txtAs10,value:"# ?/10"},{displayValue:this.txtAs100,value:"# ??/100"}],e.CurrencySymbolsData=null,e.langId=1033,this.api=t.api,this.handler=t.handler,this.props=t.props,this.linked=t.linked||!1;var i=this.linked?275:265;_.extend(this.options,{title:this.textTitle,contentHeight:i,contentStyle:"padding: 5px;",contentTemplate:_.template(['<div class="settings-panel active">','<div class="inner-content">','<table cols="1" style="width: 100%;">',"<tr>",'<td style="width:170px;padding-bottom: 3px;">','<label class="header">',e.textCategory,"</label>",'<div id="format-settings-combo-format" class="input-group-nr" style="width:264px;"></div>',"</td>","</tr>","<tr>",'<td class="padding-large" style="white-space: nowrap;">','<label class="format-sample margin-right-4" style="vertical-align: middle;">'+e.txtSample+"</label>",'<label class="format-sample" id="format-settings-label-example" style="vertical-align: middle; max-width: 220px; overflow: hidden; text-overflow: ellipsis;">100</label>',"</td>","</tr>",'<tr class="format-no-code">','<td class="padding-small">',"</td>","</tr>",'<tr class="format-decimal">','<td class="padding-large" style="vertical-align: bottom;">','<label class="header">',e.textDecimal,"</label>",'<div id="format-settings-spin-decimal"></div>',"</td>","</tr>",'<tr class="format-separator">','<td class="padding-large">','<div id="format-settings-checkbox-separator"></div>',"</td>","</tr>",'<tr class="format-symbols">','<td class="padding-large">','<label class="header">',e.textSymbols,"</label>",'<div id="format-settings-combo-symbols" class="input-group-nr" style="width:264px;"></div>',"</td>","</tr>",'<tr class="format-decimal">','<td class="padding-large format-negative">','<label class="header">',e.textFormat,"</label>",'<div id="format-settings-combo-negative" class="input-group-nr" style="width:264px;"></div>',"</td>","</tr>",'<tr class="format-lang">','<td class="padding-large">','<label class="header">',e.textLocale,"</label>",'<div id="format-settings-combo-lang" class="input-group-nr" style="width:264px;"></div>',"</td>","</tr>",'<tr class="format-type">','<td class="padding-large">','<label class="header">',e.textFormat,"</label>",'<div id="format-settings-list-type" class="input-group-nr" style="width:264px; height: 93px;"></div>',"</td>","</tr>",'<tr class="format-code">','<td colspan="1" class="padding-large">','<label class="header">',e.textFormat,"</label>",'<div id="format-settings-txt-code" class="input-group-nr" style="width:264px;margin-bottom: 8px;"></div>','<div id="format-settings-list-code" style="width:264px; height: 116px;"></div>',"</td>","</tr>","<tr>",'<td colspan="1">','<div id="format-settings-chk-linked"></div>',"</td>","</tr>","</table>","</div></div>"].join(""))({scope:this})},t),Common.Views.AdvancedSettingsWindow.prototype.initialize.call(this,this.options),this._state={hasDecimal:!1,hasNegative:!1,hasSeparator:!1,hasType:!1,hasSymbols:!1,hasCode:!1},this.FormatType=Asc.c_oAscNumFormatType.General,this.Format="General",this.FormatInfo=new Asc.asc_CFormatCellsInfo,this.CustomFormat=null},render:function(){Common.Views.AdvancedSettingsWindow.prototype.render.call(this);var t=this;this.cmbFormat=new Common.UI.ComboBox({el:$("#format-settings-combo-format"),cls:"input-group-nr",menuStyle:"min-width: 264px;",editable:!1,data:this.numFormatData,takeFocusOnClose:!0}),this.cmbFormat.setValue(this.FormatType),this.cmbFormat.on("selected",_.bind(this.onFormatSelect,this)),this.cmbNegative=new Common.UI.ComboBox({el:$("#format-settings-combo-negative"),cls:"input-group-nr",menuStyle:"min-width: 264px;max-height:235px;",editable:!1,data:[],scrollAlwaysVisible:!0,takeFocusOnClose:!0}),this.cmbNegative.on("selected",_.bind(this.onNegativeSelect,this)),this.spnDecimal=new Common.UI.MetricSpinner({el:$("#format-settings-spin-decimal"),step:1,width:45,defaultUnit:"",value:2,maxValue:30,minValue:0,allowDecimal:!1}),this.spnDecimal.on("change",_.bind(this.onDecimalChange,this)),this.chSeparator=new Common.UI.CheckBox({el:$("#format-settings-checkbox-separator"),labelText:this.textSeparator}),this.chSeparator.on("change",_.bind(this.onSeparatorChange,this)),this.cmbSymbols=new Common.UI.ComboBox({el:$("#format-settings-combo-symbols"),cls:"input-group-nr",menuStyle:"min-width: 264px;max-height:235px;",editable:!1,data:[],scrollAlwaysVisible:!0,takeFocusOnClose:!0,search:!0}),this.cmbSymbols.on("selected",_.bind(this.onSymbolsSelect,this)),this.listType=new Common.UI.ListView({el:$("#format-settings-list-type"),store:new Common.UI.DataViewStore,tabindex:1,itemTemplate:_.template('<div id="<%= id %>" class="list-item" style="pointer-events:none;overflow: hidden; text-overflow: ellipsis;"><%= Common.Utils.String.htmlEncode(displayValue) %></div>')}),this.listType.on("item:select",_.bind(this.onListTypeSelect,this)),this.listType.on("entervalue",_.bind(this.onPrimary,this)),this.codesList=new Common.UI.ListView({el:$("#format-settings-list-code"),store:new Common.UI.DataViewStore,tabindex:1,itemTemplate:_.template('<div id="<%= id %>" class="list-item" style="pointer-events:none;overflow: hidden; text-overflow: ellipsis;"><%= Common.Utils.String.htmlEncode(value) %></div>')}),this.codesList.on("item:select",_.bind(this.onCodeSelect,this)),this.codesList.on("entervalue",_.bind(this.onPrimary,this)),this.inputCustomFormat=new Common.UI.InputField({el:$("#format-settings-txt-code"),allowBlank:!0,validateOnChange:!0,validation:function(){return!0}}).on("changing",(function(e,i){t.codesList.deselectAll(),t.Format=t.api.asc_convertNumFormatLocal2NumFormat(i),t.lblExample.text(t.api.asc_getLocaleExample(t.Format)),t.chLinked.setValue(!1,!0),t._state.warning||(e.showWarning([t.txtCustomWarning]),t._state.warning=!0)})),this.chLinked=new Common.UI.CheckBox({el:$("#format-settings-chk-linked"),labelText:this.textLinked}).on("change",(function(e,i,s,n){t.props.linked="checked"==e.getValue(),t.props.linked&&(t.props.chartFormat.putSourceLinked(!0),t.props.format=t.props.chartFormat.getFormatCode(),t.props.formatInfo=t.props.chartFormat.getFormatCellsInfo(),t._setDefaults(t.props))})),this.chLinked.setVisible(this.linked),this.cmbLang=new Common.UI.ComboBox({el:$("#format-settings-combo-lang"),menuStyle:"min-width: 100%; max-height: 185px;",cls:"input-group-nr",editable:!1,takeFocusOnClose:!0,data:Common.util.LanguageInfo.getRegionalData(),itemsTemplate:_.template(["<% _.each(items, function(item) { %>",'<li id="<%= item.id %>" data-value="<%= item.value %>">','<a tabindex="-1" type="menuitem" role="menuitemcheckbox" aria-checked="false">',"<div>","<%= item.displayValue %>","</div>",'<label style="opacity: 0.6"><%= item.displayValueEn %></label>',"</a>","</li>","<% }); %>"].join("")),search:!0,searchFields:["displayValue","displayValueEn"],scrollAlwaysVisible:!0}),this.cmbLang.setValue(1033),this.cmbLang.on("selected",_.bind((function(t,e){this.onSelectLang(e.value)}),this)),this._decimalPanel=this.$window.find(".format-decimal"),this._negativePanel=this.$window.find(".format-negative"),this._separatorPanel=this.$window.find(".format-separator"),this._typePanel=this.$window.find(".format-type"),this._symbolsPanel=this.$window.find(".format-symbols"),this._codePanel=this.$window.find(".format-code"),this._nocodePanel=this.$window.find(".format-no-code"),this._langPanel=this.$window.find(".format-lang"),this.$window.find(".format-sample").toggleClass("hidden",this.linked),this.lblExample=this.$window.find("#format-settings-label-example"),this.afterRender()},getFocusedComponents:function(){return[this.cmbFormat,this.spnDecimal,this.chSeparator,this.cmbSymbols,this.cmbNegative,this.cmbLang,this.listType,this.inputCustomFormat,this.codesList,this.chLinked].concat(this.getFooterButtons())},getDefaultFocusableComponent:function(){return this.cmbFormat},afterRender:function(){this._setDefaults(this.props)},show:function(){Common.Views.AdvancedSettingsWindow.prototype.show.apply(this,arguments)},_setDefaults:function(t){if(t&&t.formatInfo){t.langId&&(this.langId=t.langId);var e=t.formatInfo.asc_getType(),i=this.cmbLang.store.findWhere({value:(e==Asc.c_oAscNumFormatType.Date||e==Asc.c_oAscNumFormatType.Time)&&t.formatInfo.asc_getSymbol()||this.langId});if(i=i?i.get("value"):1033,this.cmbLang.setValue(i),this.cmbFormat.setValue(e,this.txtCustom),this.FormatInfo=t.formatInfo,e==Asc.c_oAscNumFormatType.Custom&&t.format&&(this.CustomFormat=this.Format=t.format),this.onFormatSelect(this.cmbFormat,this.cmbFormat.getSelectedRecord(),null,t.formatInfo),this._state.hasDecimal&&this.spnDecimal.setValue(t.formatInfo.asc_getDecimalPlaces()),this._state.hasSeparator&&this.chSeparator.setValue(t.formatInfo.asc_getSeparator()),this._state.hasSymbols&&this.cmbSymbols.setValue(t.formatInfo.asc_getSymbol()||t.formatInfo.asc_getCurrencySymbol()),t.format){if(this._state.hasNegative)(s=this.cmbNegative.store.findWhere({value:t.format}))?this.cmbNegative.selectRecord(s):this.cmbNegative.setValue(this.api.asc_getLocaleExample(t.format));else if(this._state.hasType){var s;if(s=this.listType.store.findWhere({value:t.format}))this.listType.selectRecord(s),this.listType.scrollToRecord(s);else if(e==Asc.c_oAscNumFormatType.Time.Fraction)this.listType.deselectAll();else{var n=e==Asc.c_oAscNumFormatType.Time?1.534:38822;s=this.listType.store.unshift({value:t.format,displayValue:this.api.asc_getLocaleExample(t.format,n)}),this.listType.selectRecord(s),this.listType.scrollToRecord(s)}}this.Format=t.format,this.lblExample.text(this.api.asc_getLocaleExample(this.Format))}}t&&t.chartFormat&&this.chLinked.setValue(!!t.chartFormat.getSourceLinked(),!0)},getSettings:function(){return{format:this.Format,formatInfo:this.FormatInfo,linked:"checked"===this.chLinked.getValue()}},onDlgBtnClick:function(t){var e="object"==typeof t?t.currentTarget.attributes.result.value:t;"ok"==e&&this.handler&&this.handler.call(this,e,"ok"==e?this.getSettings():void 0),this.close()},onPrimary:function(){return this.onDlgBtnClick("ok"),!1},onNegativeSelect:function(t,e){this.Format=e.value,this.lblExample.text(this.api.asc_getLocaleExample(this.Format)),this.chLinked.setValue(!1,!0)},onSymbolsSelect:function(t,e){var i=this,s=new Asc.asc_CFormatCellsInfo;s.asc_setType(this.FormatType),s.asc_setDecimalPlaces(this.spnDecimal.getNumberValue()),s.asc_setSeparator(!1),"string"==typeof e.value?s.asc_setCurrencySymbol(e.value):s.asc_setSymbol(e.value);var n=this.api.asc_getFormatCells(s),a=[];n.forEach((function(t){a.push({value:t,displayValue:i.api.asc_getLocaleExample(t,-1234.1234567890124)})})),this.cmbNegative.setData(a),this.cmbNegative.selectRecord(this.cmbNegative.store.at(0)),this.cmbNegative.cmpEl.find("li:nth-child(2) a, li:nth-child(4) a").css({color:"#ff0000"}),this.Format=n[0],this.FormatInfo=s,this.lblExample.text(this.api.asc_getLocaleExample(this.Format)),this.chLinked.setValue(!1,!0)},onDecimalChange:function(t,e,i,s){var n=this,a=new Asc.asc_CFormatCellsInfo;if(a.asc_setType(this.FormatType),a.asc_setDecimalPlaces(t.getNumberValue()),a.asc_setSeparator(this.FormatType==Asc.c_oAscNumFormatType.Number&&"checked"==this.chSeparator.getValue()),this.FormatType==Asc.c_oAscNumFormatType.Currency||this.FormatType==Asc.c_oAscNumFormatType.Accounting){var o=this.cmbSymbols.getValue();"string"==typeof o?a.asc_setCurrencySymbol(o):a.asc_setSymbol(o)}else a.asc_setSymbol(!1);var l=this.api.asc_getFormatCells(a);if(this.FormatType==Asc.c_oAscNumFormatType.Number||this.FormatType==Asc.c_oAscNumFormatType.Currency||this.FormatType==Asc.c_oAscNumFormatType.Accounting){var r=[];l.forEach((function(t){r.push({value:t,displayValue:n.api.asc_getLocaleExample(t,-1234.1234567890124)})})),this.cmbNegative.setData(r),this.cmbNegative.selectRecord(this.cmbNegative.store.at(0)),this.cmbNegative.cmpEl.find("li:nth-child(2) a, li:nth-child(4) a").css({color:"#ff0000"}),this.Format=l[0]}else this.Format=l[0];this.FormatInfo=a,this.lblExample.text(this.api.asc_getLocaleExample(this.Format)),this.chLinked.setValue(!1,!0)},onSeparatorChange:function(t,e,i,s){var n=this,a=new Asc.asc_CFormatCellsInfo;a.asc_setType(this.FormatType),a.asc_setDecimalPlaces(this.spnDecimal.getNumberValue()),a.asc_setSeparator("checked"==t.getValue());var o=this.api.asc_getFormatCells(a),l=[];o.forEach((function(t){l.push({value:t,displayValue:n.api.asc_getLocaleExample(t,-1234.1234567890124)})})),this.cmbNegative.setData(l),this.cmbNegative.selectRecord(this.cmbNegative.store.at(0)),this.cmbNegative.cmpEl.find("li:nth-child(2) a, li:nth-child(4) a").css({color:"#ff0000"}),this.Format=o[0],this.FormatInfo=a,this.lblExample.text(this.api.asc_getLocaleExample(this.Format)),this.chLinked.setValue(!1,!0)},onListTypeSelect:function(t,e,i){this.Format=i.get("value"),this.lblExample.text(this.api.asc_getLocaleExample(this.Format)),this.chLinked.setValue(!1,!0)},onCodeSelect:function(t,e,i){i&&(this.Format=i.get("format"),this.lblExample.text(this.api.asc_getLocaleExample(this.Format)),this.inputCustomFormat.setValue(i.get("value")),this.chLinked.setValue(!1,!0),this.inputCustomFormat.showWarning(),this._state.warning=!1)},onFormatSelect:function(t,e,i,s){if(e){this.FormatType=e.value;var n=e.value==Asc.c_oAscNumFormatType.Date||e.value==Asc.c_oAscNumFormatType.Time,a=e.value==Asc.c_oAscNumFormatType.Number||e.value==Asc.c_oAscNumFormatType.Scientific||e.value==Asc.c_oAscNumFormatType.Accounting||e.value==Asc.c_oAscNumFormatType.Currency||e.value==Asc.c_oAscNumFormatType.Percent,o=e.value==Asc.c_oAscNumFormatType.Number||e.value==Asc.c_oAscNumFormatType.Currency||e.value==Asc.c_oAscNumFormatType.Accounting,l=e.value==Asc.c_oAscNumFormatType.Number,r=n||e.value==Asc.c_oAscNumFormatType.Fraction,c=e.value==Asc.c_oAscNumFormatType.Accounting||e.value==Asc.c_oAscNumFormatType.Currency,d=e.value==Asc.c_oAscNumFormatType.Custom,h=this,p=s?s.asc_getDecimalPlaces():this.spnDecimal.getNumberValue(),m=s?s.asc_getSeparator():"checked"==this.chSeparator.getValue(),u=s?s.asc_getSymbol()||s.asc_getCurrencySymbol():this.langId;if(e.value!==Asc.c_oAscNumFormatType.Custom){if((v=new Asc.asc_CFormatCellsInfo).asc_setType(e.value),v.asc_setDecimalPlaces(a?p:0),v.asc_setSeparator(!!l&&m),o||n){if(c){if(!h.CurrencySymbolsData){h.CurrencySymbolsData=[];var g=this.api.asc_getCurrencySymbols();for(var b in g)g.hasOwnProperty(b)&&h.CurrencySymbolsData.push({value:parseInt(b),displayValue:g[b]+" "+Common.util.LanguageInfo.getLocalLanguageName(b)[1]});h.CurrencySymbolsData.sort((function(t,e){return t.displayValue<e.displayValue?-1:t.displayValue>e.displayValue?1:0})),h.CurrencySymbolsData.unshift({value:null,displayValue:h.txtNone}),(g=this.api.asc_getAdditionalCurrencySymbols()).forEach((function(t){h.CurrencySymbolsData.push({value:t,displayValue:t})})),this.cmbSymbols.setData(this.CurrencySymbolsData),this.cmbSymbols.setValue(u)}v.asc_setSymbol(this.cmbSymbols.getValue())}else n&&v.asc_setSymbol(this.cmbLang.getValue());var f=this.api.asc_getFormatCells(v),C=[],x=e.value==Asc.c_oAscNumFormatType.Date?38822:e.value==Asc.c_oAscNumFormatType.Time?1.534:parseFloat("-1234.12345678901234567890");f.forEach((function(t){C.push({value:t,displayValue:h.api.asc_getLocaleExample(t,x)})})),o?(this.cmbNegative.setData(C),this.cmbNegative.selectRecord(this.cmbNegative.store.at(0)),this.cmbNegative.cmpEl.find("li:nth-child(2) a, li:nth-child(4) a").css({color:"#ff0000"})):(this.listType.store.reset(C),this.listType.selectRecord(this.listType.store.at(0)),this.listType.scrollToRecord(this.listType.store.at(0)),this.listType.$el[0].style.height="93px"),this.Format=f[0]}else e.value==Asc.c_oAscNumFormatType.Fraction?(this.listType.store.reset(this.FractionData),this.listType.selectRecord(this.listType.store.at(0)),this.listType.scrollToRecord(this.listType.store.at(0)),this.listType.$el[0].style.height="139px",this.Format=this.listType.getSelectedRec().get("value")):this.Format=this.api.asc_getFormatCells(v)[0];this.FormatInfo=v}else{var v;(v=new Asc.asc_CFormatCellsInfo).asc_setType(Asc.c_oAscNumFormatType.Custom),v.asc_setSymbol(u),this.FormatInfo=v;f=this.api.asc_getFormatCells(v),C=[];var y,_=!!this.CustomFormat;if(f.forEach((function(t){var e=new Common.UI.DataViewModel;e.set({value:h.api.asc_convertNumFormat2NumFormatLocal(t),format:t}),C.push(e),h.CustomFormat==t&&(_=!1)})),_)(y=new Common.UI.DataViewModel).set({value:h.api.asc_convertNumFormat2NumFormatLocal(this.CustomFormat),format:this.CustomFormat}),C.push(y);this.codesList.store.reset(C,{silent:!1}),(y=this.codesList.store.findWhere({value:this.Format}))&&this.codesList.selectRecord(y),y&&this.codesList.scrollToRecord(y),this.inputCustomFormat.setValue(h.api.asc_convertNumFormat2NumFormatLocal(this.Format))}this.lblExample.text(this.api.asc_getLocaleExample(this.Format)),this._decimalPanel.toggleClass("hidden",!a),this._negativePanel.toggleClass("hidden",!o),this._separatorPanel.toggleClass("hidden",!l),this._typePanel.toggleClass("hidden",!r),this._symbolsPanel.toggleClass("hidden",!c),this._codePanel.toggleClass("hidden",!d),this._nocodePanel.toggleClass("hidden",d),this._langPanel.toggleClass("hidden",!n),this._state={hasDecimal:a,hasNegative:o,hasSeparator:l,hasType:r,hasSymbols:c,hasCode:d},!s&&this.chLinked.setValue(!1,!0)}},onSelectLang:function(t){var e=new Asc.asc_CFormatCellsInfo;e.asc_setType(this.FormatType),e.asc_setDecimalPlaces(0),e.asc_setSeparator(!1),e.asc_setSymbol(t);var i=this,s=this.api.asc_getFormatCells(e),n=[],a=this.FormatType==Asc.c_oAscNumFormatType.Date?38822:this.FormatType==Asc.c_oAscNumFormatType.Time?1.534:parseFloat("-1234.12345678901234567890");s.forEach((function(t){n.push({value:t,displayValue:i.api.asc_getLocaleExample(t,a)})})),this.listType.store.reset(n,{silent:!1}),this.listType.selectRecord(this.listType.store.at(0)),this.listType.scrollToRecord(this.listType.store.at(0)),this.Format=s[0],this.FormatInfo=e,this.lblExample.text(this.api.asc_getLocaleExample(this.Format))},textTitle:"Number Format",textCategory:"Category",textDecimal:"Decimal",textSeparator:"Use 1000 separator",textFormat:"Format",textSymbols:"Symbols",txtGeneral:"General",txtNumber:"Number",txtCustom:"Custom",txtCurrency:"Currency",txtAccounting:"Accounting",txtDate:"Date",txtTime:"Time",txtPercentage:"Percentage",txtFraction:"Fraction",txtScientific:"Scientific",txtText:"Text",txtUpto1:"Up to one digit (1/3)",txtUpto2:"Up to two digits (12/25)",txtUpto3:"Up to three digits (131/135)",txtAs2:"As halfs (1/2)",txtAs8:"As eighths (4/8)",txtAs4:"As fourths (2/4)",txtAs16:"As sixteenths (8/16)",txtAs10:"As tenths (5/10)",txtAs100:"As hundredths (50/100)",txtSample:"Sample:",txtNone:"None",textLinked:"Linked to source",txtCustomWarning:"Please enter the custom number format carefully. Spreadsheet Editor does not check custom formats for errors that may affect the xlsx file.",textLocale:"Locale"},Common.Views.FormatSettingsDialog||{}))})),void 0===Common)Common={};if(Common.Views=Common.Views||{},define("common/main/lib/view/PluginDlg",[],(function(){"use strict";Common.Views.PluginDlg=Common.UI.Window.extend(_.extend({initialize:function(t){var e={};_.extend(e,{header:!0,enableKeyEvents:!1,automove:!1},t),this.bordersOffset=40,e.width=Common.Utils.innerWidth()-2*this.bordersOffset-e.width<0?Common.Utils.innerWidth()-2*this.bordersOffset:e.width,e.cls+=" advanced-settings-dlg invisible-borders",(!e.buttons||_.size(e.buttons)<1)&&(e.cls+=" no-footer"),e.contentHeight=e.height,e.height="auto",this.template=['<div id="id-plugin-container" class="box" style="height:'+e.contentHeight+'px;">','<div id="id-plugin-placeholder" style="width: 100%;height: 100%;"></div>',"</div>",'<% if ((typeof buttons !== "undefined") && _.size(buttons) > 0) { %>','<div class="separator horizontal"></div>',"<% } %>"].join(""),e.tpl=_.template(this.template)(e),this.url=t.url||"",this.loader=void 0===t.loader||t.loader,this.frameId=t.frameId||"plugin_iframe",this.guid=t.guid,Common.UI.Window.prototype.initialize.call(this,e)},render:function(){Common.UI.Window.prototype.render.call(this);var t=this.$window.find("> .body");t.css({height:"auto",overflow:"hidden"}),this.boxEl=this.$window.find(".body > .box"),this._headerFooterHeight=this.options.header?parseInt(this.$window.find(".header").css("height")):0,this.options.buttons&&_.size(this.options.buttons)>0&&(this._headerFooterHeight+=parseInt(this.$window.find(".footer").css("height"))+parseInt(t.css("padding-top"))+parseInt(t.css("padding-bottom"))),this._headerFooterHeight+=parseInt(this.$window.css("border-top-width"))+parseInt(this.$window.css("border-bottom-width")),Common.Utils.innerHeight()-2*this.bordersOffset<this.options.contentHeight+this._headerFooterHeight&&(this._restoreHeight=this.options.contentHeight+this._headerFooterHeight,this.options.contentHeight=Common.Utils.innerHeight()-2*this.bordersOffset-this._headerFooterHeight,this.boxEl.css("height",this.options.contentHeight)),this.$window.find(".header").prepend($('<div class="tools left hidden"></div>'));var e=document.createElement("iframe");e.id=this.frameId,e.name="pluginFrameEditor",e.width="100%",e.height="100%",e.align="top",e.frameBorder=0,e.scrolling="no",e.allow="camera; microphone; display-capture",e.onload=_.bind(this._onLoad,this);var i=this,s=this.$window.find("#id-plugin-placeholder");this.loader&&setTimeout((function(){i.isLoaded||(i.loadMask=new Common.UI.LoadMask({owner:s}),i.loadMask.setTitle(i.textLoading),i.loadMask.show(),i.isLoaded&&i.loadMask.hide())}),500),e.src=this.url,s.append(e),this.frame=e,this.on("resizing",(function(t){i.boxEl.css("height",parseInt(i.$window.css("height"))-i._headerFooterHeight)}));var n=function(){i.onWindowResize()};$(window).on("resize",n),this.on("close",(function(){$(window).off("resize",n)})),this.options.isCanDocked&&this.showDockedButton()},_onLoad:function(){this.isLoaded=!0,this.loadMask&&this.loadMask.hide()},setInnerSize:function(t,e){var i=Common.Utils.innerHeight(),s=Common.Utils.innerWidth(),n=parseInt(this.$window.css("border-left-width"))+parseInt(this.$window.css("border-right-width")),a=2*this.bordersOffset;i-a<e+this._headerFooterHeight&&(e=i-a-this._headerFooterHeight),s-a<t+n&&(t=s-a-n),this.boxEl.css("height",e),Common.UI.Window.prototype.setHeight.call(this,e+this._headerFooterHeight),Common.UI.Window.prototype.setWidth.call(this,t+n),this.getLeft()+t+n>s&&this.$window.css("left",Math.max(0,s-t-n-this.bordersOffset)),this.getTop()+e+this._headerFooterHeight>i&&this.$window.css("top",Math.max(0,i-e-this._headerFooterHeight-this.bordersOffset)),this._restoreHeight=this._restoreWidth=void 0},onWindowResize:function(){var t=Common.Utils.innerWidth(),e=Common.Utils.innerHeight(),i=this.getWidth(),s=this.getHeight(),n=this.resizable?0:this.bordersOffset;if(s<e-2*n+.1){if(!this.resizable&&this._restoreHeight>0&&s<this._restoreHeight){var a=Math.max(Math.min(this._restoreHeight,e-2*n),this.initConfig.minheight);this.setHeight(a),this.boxEl.css("height",a-this._headerFooterHeight)}var o=this.getTop();o<n?this.$window.css("top",n):o+s>e-n&&this.$window.css("top",e-n-s)}else void 0===this._restoreHeight&&(this._restoreHeight=s),this.setHeight(Math.max(e-2*n,this.initConfig.minheight)),this.boxEl.css("height",Math.max(e-2*n,this.initConfig.minheight)-this._headerFooterHeight),this.$window.css("top",n);if(i<t-2*n+.1){!this.resizable&&this._restoreWidth>0&&i<this._restoreWidth&&this.setWidth(Math.max(Math.min(this._restoreWidth,t-2*n),this.initConfig.minwidth));var l=this.getLeft();l<n?this.$window.css("left",n):l+i>t-n&&this.$window.css("left",t-n-i)}else void 0===this._restoreWidth&&(this._restoreWidth=i),this.setWidth(Math.max(t-2*n,this.initConfig.minwidth)),this.$window.css("left",n)},showDockedButton:function(){var t=this.$window.find(".header .tools:not(.left)"),e="id-plugindlg-docked",i=t.find("#"+e);if(i.length<1){(i=$('<div id="'+e+'" class="tool custom toolbar__icon btn-pin"></div>')).on("click",_.bind((function(){var t=i.data("bs.tooltip");t&&(t.dontShow=!0),this.fireEvent("docked",this.frameId)}),this)),t.append(i),i.tooltip({title:this.textDock,placement:"cursor",zIndex:parseInt(this.$window.css("z-index"))+10})}i.show(),t.removeClass("hidden")},showButton:function(t,e){var i=this.$window.find(e?".header .tools:not(.left)":".header .tools.left"),s=i.find("#id-plugindlg-"+t);if(s.length<1){var n="back"===t?"btn-promote":"btn-"+Common.Utils.String.htmlEncode(t);(s=$('<div id="id-plugindlg-'+t+'" class="tool custom toolbar__icon '+n+'"></div>')).on("click",_.bind((function(){this.fireEvent("header:click",t)}),this)),i.append(s)}s.show(),i.removeClass("hidden")},hideButton:function(t){var e=this.$window.find(".header #id-plugindlg-"+t);e.length>0&&e.hide()},enablePointerEvents:function(t){this.frame&&(this.frame.style.pointerEvents=t?"":"none")},textLoading:"Loading",textDock:"Pin plugin"},Common.Views.PluginDlg||{}))})),void 0===Common)Common={};if(Common.Views=Common.Views||{},define("common/main/lib/view/PluginPanel",[],(function(){"use strict";Common.Views.PluginPanel=Common.UI.BaseView.extend(_.extend({template:_.template(['<div class="current-plugin-box layout-ct vbox">','<div class="current-plugin-frame">',"</div>",'<div class="current-plugin-header">','<div class="tools">','<div class="plugin-close close"></div>','<div class="plugin-hide"></div>',"</div>","<label></label>","</div>","</div>",'<div id="plugins-mask" style="display: none;">'].join("")),initialize:function(t){_.extend(this,t),this._state={},this.menu||(this.menu="left"),Common.UI.BaseView.prototype.initialize.call(this,arguments)},render:function(t){t&&(this.$el=$(t)),this.$el.html(this.template({scope:this})),this.pluginName=$(".current-plugin-header label",this.$el),this.pluginsMask=$("#plugins-mask",this.$el),this.currentPluginPanel=$(".current-plugin-box",this.$el),this.currentPluginFrame=$(".current-plugin-frame",this.$el),this.pluginClose=new Common.UI.Button({parentEl:this.$el.find(".plugin-close"),cls:"btn-toolbar",iconCls:"toolbar__icon btn-close",hint:this.textClosePanel});var e=1;return this.sideMenuButton&&(this.pluginHide=new Common.UI.Button({parentEl:this.$el.find(".plugin-hide"),cls:"btn-toolbar"+("right"===this.menu^Common.UI.isRTL()?" icon-mirrored":""),iconCls:"toolbar__icon btn-panel-left-collapse",hint:this.textHidePanel}),e++),this.isCanDocked&&(this.showDockedButton(),e++),this.pluginName.css(Common.UI.isRTL()?"padding-left":"padding-right",parseInt(Common.UI.Themes.getThemeProps("small-btn-size"))*e+5+"px"),this.trigger("render:after",this),this},showDockedButton:function(){var t=this.$el.find(".current-plugin-header .tools"),e="plugin-undock",i=t.find("."+e);i.length<1&&(i=$('<div class="'+e+'"></div>'),this.$el.find(".plugin-close").after(i),new Common.UI.Button({parentEl:this.$el.find("."+e),cls:"btn-toolbar",iconCls:"toolbar__icon btn-unpin",hint:this.textUndock}).on("click",_.bind((function(){this.fireEvent("docked",this.iframePlugin.id)}),this)));i.show(),t.removeClass("hidden")},openInsideMode:function(t,e,i,s){return this.pluginName||this.render(),this.pluginName.text(t),this.iframePlugin||(this.iframePlugin=document.createElement("iframe"),this.iframePlugin.id=void 0===i?"plugin_iframe":i,this.iframePlugin.name="pluginFrameEditor",this.iframePlugin.width="100%",this.iframePlugin.height="100%",this.iframePlugin.align="top",this.iframePlugin.frameBorder=0,this.iframePlugin.scrolling="no",this.iframePlugin.allow="camera; microphone; display-capture",this.iframePlugin.onload=_.bind(this._onLoad,this),this.currentPluginFrame.append(this.iframePlugin),this.loadMask||(this.loadMask=new Common.UI.LoadMask({owner:this.currentPluginFrame})),this.loadMask.setTitle(this.textLoading),this.loadMask.show(),this.iframePlugin.src=e),this._state.insidePlugin=s,!0},closeInsideMode:function(){this.iframePlugin&&(this.currentPluginFrame.empty(),this.iframePlugin=null),this._state.insidePlugin=void 0},_onLoad:function(){this.loadMask&&this.loadMask.hide()},hide:function(){Common.UI.BaseView.prototype.hide.call(this,arguments)},enablePointerEvents:function(t){this.iframePlugin&&(this.iframePlugin.style.pointerEvents=t?"":"none")},textClosePanel:"Close plugin",textLoading:"Loading",textUndock:"Unpin plugin",textHidePanel:"Collapse plugin"},Common.Views.PluginPanel||{}))})),define("common/main/lib/view/ShapeShadowDialog",["common/main/lib/view/AdvancedSettingsWindow"],(function(){"use strict";Common.Views.ShapeShadowDialog=Common.Views.AdvancedSettingsWindow.extend(_.extend({options:{alias:"ShapeShadowDialog",contentWidth:230,separator:!1},initialize:function(t){var e=this;_.extend(this.options,{title:this.txtTitle,contentStyle:"padding: 5px;",contentTemplate:['<div class="settings-panel active">','<div class="inner-content">','<table cols="1" style="width: 100%;">',"<tr>","<td>",'<label class="header">'+e.txtTransparency+"</label>",'<div style="display: flex; align-items: center; justify-content: space-between;">','<div id="shape-shadow-transparency-slider" style="display: inline-block"></div>','<div id="shape-shadow-transparency-spin"></div>',"</div>","</td>","</tr>","<tr>","<td>",'<label class="header">'+e.txtSize+"</label>",'<div style="display: flex; align-items: center; justify-content: space-between;">','<div id="shape-shadow-size-slider" style="display: inline-block"></div>','<div id="shape-shadow-size-spin"></div>',"</div>","</td>","</tr>","<tr>","<td>",'<label class="header">'+e.txtAngle+"</label>",'<div style="display: flex; align-items: center; justify-content: space-between;">','<div id="shape-shadow-angle-slider" style="display: inline-block"></div>','<div id="shape-shadow-angle-spin"></div>',"</div>","</td>","</tr>","<tr>","<td>",'<label class="header">'+e.txtDistance+"</label>",'<div style="display: flex; align-items: center; justify-content: space-between;">','<div id="shape-shadow-distance-slider" style="display: inline-block"></div>','<div id="shape-shadow-distance-spin"></div>',"</div>","</td>","</tr>","</table>","</div>","</div>"].join("")},t),this.handler=t.handler,this.api=t.api,this.shadowProps=t.shadowProps,this.methodApplySettings=t.methodApplySettings,this.isShadowEmpty=!this.shadowProps,this.shadowProps||(this.shadowProps=new Asc.asc_CShadowProperty,this.shadowProps.putPreset("t")),this.oldTransparency=this.shadowProps.getTransparency(),this.oldSize=this.shadowProps.getSize(),this.oldAngle=this.shadowProps.getAngle(),this.oldDistance=this._mm2pt(this.shadowProps.getDistance()),Common.Views.AdvancedSettingsWindow.prototype.initialize.call(this,this.options)},render:function(){if(Common.Views.AdvancedSettingsWindow.prototype.render.call(this),this.api.setStartPointHistory(),this.isShadowEmpty){var t=new Asc.asc_CShapeProperty;t.asc_putShadow(this.shadowProps),this.methodApplySettings&&this.methodApplySettings.call(this,t)}this.sldrTransparency=new Common.UI.SingleSlider({el:$("#shape-shadow-transparency-slider"),width:128,minValue:0,maxValue:100,value:this.oldTransparency}),this.sldrTransparency.on("change",_.bind(this.onSliderTransparencyChange,this)),this.spinTransparency=new Common.UI.MetricSpinner({el:$("#shape-shadow-transparency-spin"),step:1,width:62,allowDecimal:!1,value:"0 %",defaultUnit:"%",maxValue:100,minValue:0,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"big"}),this.spinTransparency.setValue(this.oldTransparency,!0),this.spinTransparency.on("change",_.bind(this.onSpinnerTransparencyChange,this)),this.sldrSize=new Common.UI.SingleSlider({el:$("#shape-shadow-size-slider"),width:128,minValue:1,maxValue:200,value:this.oldSize}),this.sldrSize.on("change",_.bind(this.onSliderSizeChange,this)),this.spinSize=new Common.UI.MetricSpinner({el:$("#shape-shadow-size-spin"),step:1,width:62,allowDecimal:!1,value:"0 %",defaultUnit:"%",maxValue:200,minValue:1,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"big"}),this.spinSize.setValue(this.oldSize,!0),this.spinSize.on("change",_.bind(this.onSpinnerSizeChange,this)),this.sldrAngle=new Common.UI.SingleSlider({el:$("#shape-shadow-angle-slider"),width:128,minValue:0,maxValue:359,value:this.oldAngle}),this.sldrAngle.on("change",_.bind(this.onSliderAngleChange,this)),this.spinAngle=new Common.UI.MetricSpinner({el:$("#shape-shadow-angle-spin"),step:1,width:62,allowDecimal:!1,value:"0 ",defaultUnit:"",maxValue:359,minValue:0,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"big"}),this.spinAngle.setValue(this.oldAngle,!0),this.spinAngle.on("change",_.bind(this.onSpinnerAngleChange,this)),this.sldrDistance=new Common.UI.SingleSlider({el:$("#shape-shadow-distance-slider"),width:128,minValue:0,maxValue:200,value:this.oldDistance}),this.sldrDistance.on("change",_.bind(this.onSliderDistanceChange,this));var e=Common.Utils.Metric.getMetricName(Common.Utils.Metric.c_MetricUnits.pt);this.spinDistance=new Common.UI.MetricSpinner({el:$("#shape-shadow-distance-spin"),step:1,width:62,allowDecimal:!1,value:"0 "+e,defaultUnit:e,maxValue:200,minValue:0,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"big"}),this.spinDistance.setValue(this.oldDistance,!0),this.spinDistance.on("change",_.bind(this.onSpinnerDistanceChange,this)),this.on("close",_.bind(this.handleCancelClose,this))},onSliderTransparencyChange:function(t,e,i){this.spinTransparency.setValue(e,!0),this.setTransparency(e)},onSpinnerTransparencyChange:function(t,e,i){var s=t.getNumberValue();this.sldrTransparency.setValue(s,!0),this.setTransparency(s)},setTransparency:function(t){var e=new Asc.asc_CShapeProperty;this.shadowProps.putTransparency(t),e.asc_putShadow(this.shadowProps),this.methodApplySettings&&this.methodApplySettings.call(this,e)},onSliderSizeChange:function(t,e,i){this.spinSize.setValue(e,!0),this.setSize(e)},onSpinnerSizeChange:function(t,e,i){var s=t.getNumberValue();this.sldrSize.setValue(s,!0),this.setSize(s)},setSize:function(t){var e=new Asc.asc_CShapeProperty;this.shadowProps.putSize(t),e.asc_putShadow(this.shadowProps),this.methodApplySettings&&this.methodApplySettings.call(this,e)},onSliderAngleChange:function(t,e,i){this.spinAngle.setValue(e,!0),this.setAngle(e)},onSpinnerAngleChange:function(t,e,i){var s=t.getNumberValue();this.sldrAngle.setValue(s,!0),this.setAngle(s)},setAngle:function(t){var e=new Asc.asc_CShapeProperty;this.shadowProps.putAngle(t),e.asc_putShadow(this.shadowProps),this.methodApplySettings&&this.methodApplySettings.call(this,e)},onSliderDistanceChange:function(t,e,i){this.spinDistance.setValue(e,!0),this.setDistance(e)},onSpinnerDistanceChange:function(t,e,i){var s=t.getNumberValue();this.sldrDistance.setValue(s,!0),this.setDistance(s)},setDistance:function(t){var e=new Asc.asc_CShapeProperty;this.shadowProps.putDistance(this._pt2mm(t)),e.asc_putShadow(this.shadowProps),this.methodApplySettings&&this.methodApplySettings.call(this,e)},setAllProperties:function(t,e,i,s){var n=new Asc.asc_CShapeProperty;this.shadowProps.putTransparency(t),this.shadowProps.putSize(e),this.shadowProps.putAngle(i),this.shadowProps.putDistance(this._pt2mm(s)),n.asc_putShadow(this.shadowProps),this.methodApplySettings&&this.methodApplySettings.call(this,n)},getFocusedComponents:function(){return[this.spinTransparency,this.spinSize,this.spinAngle,this.spinDistance].concat(this.getFooterButtons())},getDefaultFocusableComponent:function(){return this.spinTransparency},_pt2mm:function(t){return 25.4*t/72},_mm2pt:function(t){return 72*t/25.4},onPrimary:function(){return this.handleOkClose(),this.close(!0),!1},onDlgBtnClick:function(t){"ok"==t.currentTarget.attributes.result.value?this.handleOkClose():this.handleCancelClose(),this.close(!0)},onDblClickFunction:function(){this.handleOkClose(),this.close(!0)},handleOkClose:function(){this.api.setEndPointHistory(),this.setAllProperties(parseInt(this.spinTransparency.getValue()),parseInt(this.spinSize.getValue()),parseInt(this.spinAngle.getValue()),parseInt(this.spinDistance.getValue())),this.handler&&this.handler.call(this,"ok")},handleCancelClose:function(){if(this.isShadowEmpty){var t=new Asc.asc_CShapeProperty;t.asc_putShadow(null),this.methodApplySettings&&this.methodApplySettings.call(this,t)}else this.setAllProperties(this.oldTransparency,this.oldSize,this.oldAngle,this.oldDistance);this.api.setEndPointHistory(),this.handler&&this.handler.call(this,"cancel")},txtTitle:"Adjust Shadow",txtTransparency:"Transparency",txtSize:"Size",txtAngle:"Angle",txtDistance:"Distance"},Common.Views.ShapeShadowDialog||{}))})),define("common/main/lib/view/TextInputDialog",[],(function(){"use strict";Common.Views.TextInputDialog=Common.UI.Window.extend(_.extend({initialize:function(t){var e={};_.extend(e,{header:!!t.title,label:t.label||"",description:t.description||"",width:330,cls:"modal-dlg",buttons:["ok","cancel"]},t||{}),this.template=['<div class="box">','<div class="input-row <% if (!label) { %> hidden <% } %>">',"<label><%= label %></label>","</div>",'<div id="id-dlg-label-custom-input" class="input-row"></div>','<div class="input-row <% if (!description) { %> hidden <% } %>">','<label class="light"><%= description %></label>',"</div>","</div>"].join(""),this.inputConfig=_.extend({allowBlank:!0},t.inputConfig||{}),this.inputFixedConfig=t.inputFixedConfig,e.tpl=_.template(this.template)(e),Common.UI.Window.prototype.initialize.call(this,e)},render:function(){Common.UI.Window.prototype.render.call(this);var t=this;t.inputLabel=this.inputFixedConfig?new Common.UI.InputFieldFixed({el:$("#id-dlg-label-custom-input"),allowBlank:t.inputConfig.allowBlank,blankError:t.inputConfig.blankError,maxLength:t.inputFixedConfig.fixedValue&&t.inputConfig.maxLength?t.inputConfig.maxLength-t.inputFixedConfig.fixedValue.length:t.inputConfig.maxLength,style:"width: 100%;",validateOnBlur:!1,validation:t.inputConfig.validation,cls:"text-align-left",fixedValue:t.inputFixedConfig.fixedValue,fixedCls:"light",fixedWidth:t.inputFixedConfig.fixedWidth}):new Common.UI.InputField({el:$("#id-dlg-label-custom-input"),allowBlank:t.inputConfig.allowBlank,blankError:t.inputConfig.blankError,maxLength:t.inputConfig.maxLength,style:"width: 100%;",validateOnBlur:!1,validation:t.inputConfig.validation}),t.inputLabel.cmpEl.on("focus","input.fixed-text",(function(){setTimeout((function(){t.inputLabel._input&&t.inputLabel._input.focus()}),1)})),t.inputLabel.setValue(t.options.value||""),this.getChild().find(".dlg-btn").on("click",_.bind(this.onBtnClick,this))},getFocusedComponents:function(){return[{cmp:this.inputLabel,selector:"input:not(.fixed-text)"}].concat(this.getFooterButtons())},getDefaultFocusableComponent:function(){return this.inputLabel},show:function(){Common.UI.Window.prototype.show.apply(this,arguments);var t=this;_.delay((function(){t.getChild("input").focus()}),50)},onPrimary:function(t){return this._handleInput("ok"),!1},onBtnClick:function(t){this._handleInput(t.currentTarget.attributes.result.value)},_handleInput:function(t){if(this.options.handler){if("ok"==t&&!0!==this.inputLabel.checkValidate())return void this.inputLabel.cmpEl.find("input").focus();this.options.handler.call(this,t,this.inputLabel.getValue())}this.close()}},Common.Views.TextInputDialog||{})),Common.Views.ImageFromUrlDialog=Common.Views.TextInputDialog.extend(_.extend({initialize:function(t){var e={},i=this;_.extend(e,{header:!1,label:t.label||i.textUrl,inputConfig:{allowBlank:!1,blankError:i.txtEmpty,validation:function(t){return!!/((^https?)|(^ftp)):\/\/.+/i.test(t)||i.txtNotUrl}}},t||{}),Common.Views.TextInputDialog.prototype.initialize.call(this,e)},textUrl:"Paste an image URL:",txtEmpty:"This field is required",txtNotUrl:'This field should be a URL in the format "http://www.example.com"'},Common.Views.ImageFromUrlDialog||{}))})),define("common/main/lib/view/DocumentHolderExt",[],(function(){"use strict";let t=window.DE||window.PDFE||window.PDFE||window.PE||window.SSE||window.VE;if(t&&t.Views&&t.Views.DocumentHolder){let e=t.Views.DocumentHolder.prototype;e.addEquationMenu=function(t,e){if(t){var i=this;i.clearEquationMenu(t,e);var s=i.initEquationMenu();return s.length>0&&_.each(s,(function(s,n){s.menu?_.each(s.menu.items,(function(t){t.on("click",_.bind(i.equationCallback,i,t.options.equationProps))})):s.on("click",_.bind(i.equationCallback,i,s.options.equationProps)),t.insertItem(e,s),e++})),s.length}},e.clearEquationMenu=function(t,e){for(var i=e;i<t.items.length&&t.items[i].options.equation;i++)t.items[i].menu?_.each(t.items[i].menu.items,(function(t){t.off("click")})):t.items[i].off("click"),t.removeItem(t.items[i]),i--},e.equationCallback=function(t){var e;if(t){switch(t.type){case Asc.c_oAscMathInterfaceType.Accent:e=new CMathMenuAccent;break;case Asc.c_oAscMathInterfaceType.BorderBox:e=new CMathMenuBorderBox;break;case Asc.c_oAscMathInterfaceType.Box:e=new CMathMenuBox;break;case Asc.c_oAscMathInterfaceType.Bar:e=new CMathMenuBar;break;case Asc.c_oAscMathInterfaceType.Script:e=new CMathMenuScript;break;case Asc.c_oAscMathInterfaceType.Fraction:e=new CMathMenuFraction;break;case Asc.c_oAscMathInterfaceType.Limit:e=new CMathMenuLimit;break;case Asc.c_oAscMathInterfaceType.Matrix:e=new CMathMenuMatrix;break;case Asc.c_oAscMathInterfaceType.EqArray:e=new CMathMenuEqArray;break;case Asc.c_oAscMathInterfaceType.LargeOperator:e=new CMathMenuNary;break;case Asc.c_oAscMathInterfaceType.Delimiter:e=new CMathMenuDelimiter;break;case Asc.c_oAscMathInterfaceType.GroupChar:e=new CMathMenuGroupCharacter;break;case Asc.c_oAscMathInterfaceType.Radical:e=new CMathMenuRadical;break;case Asc.c_oAscMathInterfaceType.Common:e=new CMathMenuBase}e&&e[t.callback](t.value)}this.fireEvent("equation:callback",[e])},e.initEquationMenu=function(){var t=this._currentTranslateObj;if(t._currentMathObj){var e,i=t._currentMathObj.get_Type(),s=t._currentMathObj,n=[];switch(i){case Asc.c_oAscMathInterfaceType.Accent:e=new Common.UI.MenuItem({caption:t.txtRemoveAccentChar,equation:!0,disabled:t._currentParaObjDisabled,equationProps:{type:i,callback:"remove_AccentCharacter"}}),n.push(e);break;case Asc.c_oAscMathInterfaceType.BorderBox:e=new Common.UI.MenuItem({caption:t.txtBorderProps,equation:!0,disabled:t._currentParaObjDisabled,menu:new Common.UI.Menu({cls:"shifted-right",menuAlign:"tl-tr",items:[{caption:s.get_HideTop()?t.txtAddTop:t.txtHideTop,equationProps:{type:i,callback:"put_HideTop",value:!s.get_HideTop()}},{caption:s.get_HideBottom()?t.txtAddBottom:t.txtHideBottom,equationProps:{type:i,callback:"put_HideBottom",value:!s.get_HideBottom()}},{caption:s.get_HideLeft()?t.txtAddLeft:t.txtHideLeft,equationProps:{type:i,callback:"put_HideLeft",value:!s.get_HideLeft()}},{caption:s.get_HideRight()?t.txtAddRight:t.txtHideRight,equationProps:{type:i,callback:"put_HideRight",value:!s.get_HideRight()}},{caption:s.get_HideHor()?t.txtAddHor:t.txtHideHor,equationProps:{type:i,callback:"put_HideHor",value:!s.get_HideHor()}},{caption:s.get_HideVer()?t.txtAddVer:t.txtHideVer,equationProps:{type:i,callback:"put_HideVer",value:!s.get_HideVer()}},{caption:s.get_HideTopLTR()?t.txtAddLT:t.txtHideLT,equationProps:{type:i,callback:"put_HideTopLTR",value:!s.get_HideTopLTR()}},{caption:s.get_HideTopRTL()?t.txtAddLB:t.txtHideLB,equationProps:{type:i,callback:"put_HideTopRTL",value:!s.get_HideTopRTL()}}]})}),n.push(e);break;case Asc.c_oAscMathInterfaceType.Bar:e=new Common.UI.MenuItem({caption:t.txtRemoveBar,equation:!0,disabled:t._currentParaObjDisabled,equationProps:{type:i,callback:"remove_Bar"}}),n.push(e),e=new Common.UI.MenuItem({caption:s.get_Pos()==Asc.c_oAscMathInterfaceBarPos.Top?t.txtUnderbar:t.txtOverbar,equation:!0,disabled:t._currentParaObjDisabled,equationProps:{type:i,callback:"put_Pos",value:s.get_Pos()==Asc.c_oAscMathInterfaceBarPos.Top?Asc.c_oAscMathInterfaceBarPos.Bottom:Asc.c_oAscMathInterfaceBarPos.Top}}),n.push(e);break;case Asc.c_oAscMathInterfaceType.Script:var a=s.get_ScriptType();a==Asc.c_oAscMathInterfaceScript.PreSubSup?(e=new Common.UI.MenuItem({caption:t.txtScriptsAfter,equation:!0,disabled:t._currentParaObjDisabled,equationProps:{type:i,callback:"put_ScriptType",value:Asc.c_oAscMathInterfaceScript.SubSup}}),n.push(e),e=new Common.UI.MenuItem({caption:t.txtRemScripts,equation:!0,disabled:t._currentParaObjDisabled,equationProps:{type:i,callback:"put_ScriptType",value:Asc.c_oAscMathInterfaceScript.None}}),n.push(e)):(a==Asc.c_oAscMathInterfaceScript.SubSup&&(e=new Common.UI.MenuItem({caption:t.txtScriptsBefore,equation:!0,disabled:t._currentParaObjDisabled,equationProps:{type:i,callback:"put_ScriptType",value:Asc.c_oAscMathInterfaceScript.PreSubSup}}),n.push(e)),a!=Asc.c_oAscMathInterfaceScript.SubSup&&a!=Asc.c_oAscMathInterfaceScript.Sub||(e=new Common.UI.MenuItem({caption:t.txtRemSubscript,equation:!0,disabled:t._currentParaObjDisabled,equationProps:{type:i,callback:"put_ScriptType",value:a==Asc.c_oAscMathInterfaceScript.SubSup?Asc.c_oAscMathInterfaceScript.Sup:Asc.c_oAscMathInterfaceScript.None}}),n.push(e)),a!=Asc.c_oAscMathInterfaceScript.SubSup&&a!=Asc.c_oAscMathInterfaceScript.Sup||(e=new Common.UI.MenuItem({caption:t.txtRemSuperscript,equation:!0,disabled:t._currentParaObjDisabled,equationProps:{type:i,callback:"put_ScriptType",value:a==Asc.c_oAscMathInterfaceScript.SubSup?Asc.c_oAscMathInterfaceScript.Sub:Asc.c_oAscMathInterfaceScript.None}}),n.push(e)));break;case Asc.c_oAscMathInterfaceType.Fraction:var o=s.get_FractionType();o!=Asc.c_oAscMathInterfaceFraction.Skewed&&o!=Asc.c_oAscMathInterfaceFraction.Linear||(e=new Common.UI.MenuItem({caption:t.txtFractionStacked,equation:!0,disabled:t._currentParaObjDisabled,equationProps:{type:i,callback:"put_FractionType",value:Asc.c_oAscMathInterfaceFraction.Bar}}),n.push(e)),o!=Asc.c_oAscMathInterfaceFraction.Bar&&o!=Asc.c_oAscMathInterfaceFraction.Linear||(e=new Common.UI.MenuItem({caption:t.txtFractionSkewed,equation:!0,disabled:t._currentParaObjDisabled,equationProps:{type:i,callback:"put_FractionType",value:Asc.c_oAscMathInterfaceFraction.Skewed}}),n.push(e)),o!=Asc.c_oAscMathInterfaceFraction.Bar&&o!=Asc.c_oAscMathInterfaceFraction.Skewed||(e=new Common.UI.MenuItem({caption:t.txtFractionLinear,equation:!0,disabled:t._currentParaObjDisabled,equationProps:{type:i,callback:"put_FractionType",value:Asc.c_oAscMathInterfaceFraction.Linear}}),n.push(e)),o!=Asc.c_oAscMathInterfaceFraction.Bar&&o!=Asc.c_oAscMathInterfaceFraction.NoBar||(e=new Common.UI.MenuItem({caption:o==Asc.c_oAscMathInterfaceFraction.Bar?t.txtRemFractionBar:t.txtAddFractionBar,equation:!0,disabled:t._currentParaObjDisabled,equationProps:{type:i,callback:"put_FractionType",value:o==Asc.c_oAscMathInterfaceFraction.Bar?Asc.c_oAscMathInterfaceFraction.NoBar:Asc.c_oAscMathInterfaceFraction.Bar}}),n.push(e));break;case Asc.c_oAscMathInterfaceType.Limit:e=new Common.UI.MenuItem({caption:s.get_Pos()==Asc.c_oAscMathInterfaceLimitPos.Top?t.txtLimitUnder:t.txtLimitOver,equation:!0,disabled:t._currentParaObjDisabled,equationProps:{type:i,callback:"put_Pos",value:s.get_Pos()==Asc.c_oAscMathInterfaceLimitPos.Top?Asc.c_oAscMathInterfaceLimitPos.Bottom:Asc.c_oAscMathInterfaceLimitPos.Top}}),n.push(e),e=new Common.UI.MenuItem({caption:t.txtRemLimit,equation:!0,disabled:t._currentParaObjDisabled,equationProps:{type:i,callback:"put_Pos",value:Asc.c_oAscMathInterfaceLimitPos.None}}),n.push(e);break;case Asc.c_oAscMathInterfaceType.Matrix:e=new Common.UI.MenuItem({caption:s.get_HidePlaceholder()?t.txtShowPlaceholder:t.txtHidePlaceholder,equation:!0,disabled:t._currentParaObjDisabled,equationProps:{type:i,callback:"put_HidePlaceholder",value:!s.get_HidePlaceholder()}}),n.push(e),e=new Common.UI.MenuItem({caption:t.insertText,equation:!0,disabled:t._currentParaObjDisabled,menu:new Common.UI.Menu({cls:"shifted-right",menuAlign:"tl-tr",items:[{caption:t.insertRowAboveText,equationProps:{type:i,callback:"insert_MatrixRow",value:!0}},{caption:t.insertRowBelowText,equationProps:{type:i,callback:"insert_MatrixRow",value:!1}},{caption:t.insertColumnLeftText,equationProps:{type:i,callback:"insert_MatrixColumn",value:!0}},{caption:t.insertColumnRightText,equationProps:{type:i,callback:"insert_MatrixColumn",value:!1}}]})}),n.push(e),e=new Common.UI.MenuItem({caption:t.deleteText,equation:!0,disabled:t._currentParaObjDisabled,menu:new Common.UI.Menu({cls:"shifted-right",menuAlign:"tl-tr",items:[{caption:t.deleteRowText,equationProps:{type:i,callback:"delete_MatrixRow"}},{caption:t.deleteColumnText,equationProps:{type:i,callback:"delete_MatrixColumn"}}]})}),n.push(e),e=new Common.UI.MenuItem({caption:t.txtMatrixAlign,equation:!0,disabled:t._currentParaObjDisabled,menu:new Common.UI.Menu({cls:"shifted-right",menuAlign:"tl-tr",items:[{caption:t.txtTop,checkable:!0,checked:s.get_MatrixAlign()==Asc.c_oAscMathInterfaceMatrixMatrixAlign.Top,equationProps:{type:i,callback:"put_MatrixAlign",value:Asc.c_oAscMathInterfaceMatrixMatrixAlign.Top}},{caption:t.centerText,checkable:!0,checked:s.get_MatrixAlign()==Asc.c_oAscMathInterfaceMatrixMatrixAlign.Center,equationProps:{type:i,callback:"put_MatrixAlign",value:Asc.c_oAscMathInterfaceMatrixMatrixAlign.Center}},{caption:t.txtBottom,checkable:!0,checked:s.get_MatrixAlign()==Asc.c_oAscMathInterfaceMatrixMatrixAlign.Bottom,equationProps:{type:i,callback:"put_MatrixAlign",value:Asc.c_oAscMathInterfaceMatrixMatrixAlign.Bottom}}]})}),n.push(e),e=new Common.UI.MenuItem({caption:t.txtColumnAlign,equation:!0,disabled:t._currentParaObjDisabled,menu:new Common.UI.Menu({cls:"shifted-right",menuAlign:"tl-tr",items:[{caption:t.leftText,checkable:!0,checked:s.get_ColumnAlign()==Asc.c_oAscMathInterfaceMatrixColumnAlign.Left,equationProps:{type:i,callback:"put_ColumnAlign",value:Asc.c_oAscMathInterfaceMatrixColumnAlign.Left}},{caption:t.centerText,checkable:!0,checked:s.get_ColumnAlign()==Asc.c_oAscMathInterfaceMatrixColumnAlign.Center,equationProps:{type:i,callback:"put_ColumnAlign",value:Asc.c_oAscMathInterfaceMatrixColumnAlign.Center}},{caption:t.rightText,checkable:!0,checked:s.get_ColumnAlign()==Asc.c_oAscMathInterfaceMatrixColumnAlign.Right,equationProps:{type:i,callback:"put_ColumnAlign",value:Asc.c_oAscMathInterfaceMatrixColumnAlign.Right}}]})}),n.push(e);break;case Asc.c_oAscMathInterfaceType.EqArray:e=new Common.UI.MenuItem({caption:t.txtInsertEqBefore,equation:!0,disabled:t._currentParaObjDisabled,equationProps:{type:i,callback:"insert_Equation",value:!0}}),n.push(e),e=new Common.UI.MenuItem({caption:t.txtInsertEqAfter,equation:!0,disabled:t._currentParaObjDisabled,equationProps:{type:i,callback:"insert_Equation",value:!1}}),n.push(e),e=new Common.UI.MenuItem({caption:t.txtDeleteEq,equation:!0,disabled:t._currentParaObjDisabled,equationProps:{type:i,callback:"delete_Equation"}}),n.push(e),e=new Common.UI.MenuItem({caption:t.alignmentText,equation:!0,disabled:t._currentParaObjDisabled,menu:new Common.UI.Menu({cls:"shifted-right",menuAlign:"tl-tr",items:[{caption:t.txtTop,checkable:!0,checked:s.get_Align()==Asc.c_oAscMathInterfaceEqArrayAlign.Top,equationProps:{type:i,callback:"put_Align",value:Asc.c_oAscMathInterfaceEqArrayAlign.Top}},{caption:t.centerText,checkable:!0,checked:s.get_Align()==Asc.c_oAscMathInterfaceEqArrayAlign.Center,equationProps:{type:i,callback:"put_Align",value:Asc.c_oAscMathInterfaceEqArrayAlign.Center}},{caption:t.txtBottom,checkable:!0,checked:s.get_Align()==Asc.c_oAscMathInterfaceEqArrayAlign.Bottom,equationProps:{type:i,callback:"put_Align",value:Asc.c_oAscMathInterfaceEqArrayAlign.Bottom}}]})}),n.push(e);break;case Asc.c_oAscMathInterfaceType.LargeOperator:e=new Common.UI.MenuItem({caption:t.txtLimitChange,equation:!0,disabled:t._currentParaObjDisabled,equationProps:{type:i,callback:"put_LimitLocation",value:s.get_LimitLocation()==Asc.c_oAscMathInterfaceNaryLimitLocation.UndOvr?Asc.c_oAscMathInterfaceNaryLimitLocation.SubSup:Asc.c_oAscMathInterfaceNaryLimitLocation.UndOvr}}),n.push(e),void 0!==s.get_HideUpper()&&(e=new Common.UI.MenuItem({caption:s.get_HideUpper()?t.txtShowTopLimit:t.txtHideTopLimit,equation:!0,disabled:t._currentParaObjDisabled,equationProps:{type:i,callback:"put_HideUpper",value:!s.get_HideUpper()}}),n.push(e)),void 0!==s.get_HideLower()&&(e=new Common.UI.MenuItem({caption:s.get_HideLower()?t.txtShowBottomLimit:t.txtHideBottomLimit,equation:!0,disabled:t._currentParaObjDisabled,equationProps:{type:i,callback:"put_HideLower",value:!s.get_HideLower()}}),n.push(e));break;case Asc.c_oAscMathInterfaceType.Delimiter:e=new Common.UI.MenuItem({caption:t.txtInsertArgBefore,equation:!0,disabled:t._currentParaObjDisabled,equationProps:{type:i,callback:"insert_DelimiterArgument",value:!0}}),n.push(e),e=new Common.UI.MenuItem({caption:t.txtInsertArgAfter,equation:!0,disabled:t._currentParaObjDisabled,equationProps:{type:i,callback:"insert_DelimiterArgument",value:!1}}),n.push(e),s.can_DeleteArgument()&&(e=new Common.UI.MenuItem({caption:t.txtDeleteArg,equation:!0,disabled:t._currentParaObjDisabled,equationProps:{type:i,callback:"delete_DelimiterArgument"}}),n.push(e)),e=new Common.UI.MenuItem({caption:s.has_Separators()?t.txtDeleteCharsAndSeparators:t.txtDeleteChars,equation:!0,disabled:t._currentParaObjDisabled,equationProps:{type:i,callback:"remove_DelimiterCharacters"}}),n.push(e),e=new Common.UI.MenuItem({caption:s.get_HideOpeningBracket()?t.txtShowOpenBracket:t.txtHideOpenBracket,equation:!0,disabled:t._currentParaObjDisabled,equationProps:{type:i,callback:"put_HideOpeningBracket",value:!s.get_HideOpeningBracket()}}),n.push(e),e=new Common.UI.MenuItem({caption:s.get_HideClosingBracket()?t.txtShowCloseBracket:t.txtHideCloseBracket,equation:!0,disabled:t._currentParaObjDisabled,equationProps:{type:i,callback:"put_HideClosingBracket",value:!s.get_HideClosingBracket()}}),n.push(e),e=new Common.UI.MenuItem({caption:t.txtStretchBrackets,equation:!0,disabled:t._currentParaObjDisabled,checkable:!0,checked:s.get_StretchBrackets(),equationProps:{type:i,callback:"put_StretchBrackets",value:!s.get_StretchBrackets()}}),n.push(e),e=new Common.UI.MenuItem({caption:t.txtMatchBrackets,equation:!0,disabled:!s.get_StretchBrackets()||t._currentParaObjDisabled,checkable:!0,checked:s.get_StretchBrackets()&&s.get_MatchBrackets(),equationProps:{type:i,callback:"put_MatchBrackets",value:!s.get_MatchBrackets()}}),n.push(e);break;case Asc.c_oAscMathInterfaceType.GroupChar:s.can_ChangePos()&&(e=new Common.UI.MenuItem({caption:s.get_Pos()==Asc.c_oAscMathInterfaceGroupCharPos.Top?t.txtGroupCharUnder:t.txtGroupCharOver,equation:!0,disabled:t._currentParaObjDisabled,equationProps:{type:i,callback:"put_Pos",value:s.get_Pos()==Asc.c_oAscMathInterfaceGroupCharPos.Top?Asc.c_oAscMathInterfaceGroupCharPos.Bottom:Asc.c_oAscMathInterfaceGroupCharPos.Top}}),n.push(e),e=new Common.UI.MenuItem({caption:t.txtDeleteGroupChar,equation:!0,disabled:t._currentParaObjDisabled,equationProps:{type:i,callback:"put_Pos",value:Asc.c_oAscMathInterfaceGroupCharPos.None}}),n.push(e));break;case Asc.c_oAscMathInterfaceType.Radical:void 0!==s.get_HideDegree()&&(e=new Common.UI.MenuItem({caption:s.get_HideDegree()?t.txtShowDegree:t.txtHideDegree,equation:!0,disabled:t._currentParaObjDisabled,equationProps:{type:i,callback:"put_HideDegree",value:!s.get_HideDegree()}}),n.push(e)),e=new Common.UI.MenuItem({caption:t.txtDeleteRadical,equation:!0,disabled:t._currentParaObjDisabled,equationProps:{type:i,callback:"remove_Radical"}}),n.push(e)}return s.can_IncreaseArgumentSize()&&(e=new Common.UI.MenuItem({caption:t.txtIncreaseArg,equation:!0,disabled:t._currentParaObjDisabled,equationProps:{type:i,callback:"increase_ArgumentSize"}}),n.push(e)),s.can_DecreaseArgumentSize()&&(e=new Common.UI.MenuItem({caption:t.txtDecreaseArg,equation:!0,disabled:t._currentParaObjDisabled,equationProps:{type:i,callback:"decrease_ArgumentSize"}}),n.push(e)),s.can_InsertManualBreak()&&(e=new Common.UI.MenuItem({caption:t.txtInsertBreak,equation:!0,disabled:t._currentParaObjDisabled,equationProps:{type:i,callback:"insert_ManualBreak"}}),n.push(e)),s.can_DeleteManualBreak()&&(e=new Common.UI.MenuItem({caption:t.txtDeleteBreak,equation:!0,disabled:t._currentParaObjDisabled,equationProps:{type:i,callback:"delete_ManualBreak"}}),n.push(e)),s.can_AlignToCharacter()&&(e=new Common.UI.MenuItem({caption:t.txtAlignToChar,equation:!0,disabled:t._currentParaObjDisabled,equationProps:{type:i,callback:"align_ToCharacter"}}),n.push(e)),n}},e.updateCustomItems=function(t,e){if(t&&e&&!(e.length<1)){var i=this,s=i.mode&&i.mode.lang?i.mode.lang.split(/[\-_]/)[0]:"en";i._preventCustomClick&&clearTimeout(i._preventCustomClick),i._hasCustomItems&&(i._preventCustomClick=setTimeout((function(){i._preventCustomClick=null}),500)),i._hasCustomItems=!0;var n,a=function(e,i){if(t&&t.items.length>0)for(var s=t.items.length-1;s>=0;s--)if(t.items[s].isCustomItem&&(void 0===i&&t.items[s].options.guid===e||t.items[s].options.guid===e&&t.items[s].value===i))return t.items[s]},o=function(t,e,n){var a=!1;return n?n.removeAll():((n=new Common.UI.Menu({cls:"shifted-right",menuAlign:"tl-tr",items:[]})).on("item:custom-click",(function(t,e,s){!i._preventCustomClick&&i.api&&i.api.onPluginContextMenuItemClick&&i.api.onPluginContextMenuItemClick(e.options.guid,e.value)})),n.on("menu:click",(function(t,e){i._preventCustomClick&&e.stopPropagation()}))),t.forEach((function(t){t.separator&&n.addItem(new Common.UI.MenuItemCustom({caption:"--",guid:e})),t.text&&n.addItem(new Common.UI.MenuItemCustom({caption:("object"==typeof t.text?t.text[s]||t.text.en:t.text)||"",value:t.id,guid:e,menu:!!t.items&&o(t.items,e),iconsSet:t.icons,baseUrl:"",disabled:!!t.disabled})),a=a||!!t.icons})),a&&(n.cmpEl?n.cmpEl.toggleClass("shifted-right",!0):n.options.cls="shifted-right"),n};if(e.forEach((function(e){var l=!a(e.guid);e&&e.items&&e.items.length>0&&e.items.forEach((function(r){if(r.separator&&l&&t.addItem(new Common.UI.MenuItemCustom({caption:"--",guid:e.guid})),r.text){var c=a(e.guid,r.id),d=("object"==typeof r.text?r.text[s]||r.text.en:r.text)||"";if(c)c.setCaption(d),c.setDisabled(!!r.disabled),r.items&&(c.menu?(c.menu.isVisible()&&c.menu.cmpEl.find(" > li:not(.divider):not(.disabled):visible").find("> a").filter(":focus").length>0&&(c.menu.isOver=!0,n=c.cmpEl),o(r.items,e.guid,c.menu)):c.setMenu(o(r.items,e.guid)));else{c=new Common.UI.MenuItemCustom({caption:d,value:r.id,guid:e.guid,menu:!!(r.items&&r.items.length>=0)&&o(r.items,e.guid),iconsSet:r.icons,baseUrl:"",disabled:!!r.disabled}).on("click",(function(t,e){!i._preventCustomClick&&i.api&&i.api.onPluginContextMenuItemClick&&i.api.onPluginContextMenuItemClick(t.options.guid,t.value)}));t.addItem(c)}}}))})),n){var l=$("> [role=menu]",n).find("> li:not(.divider):not(.disabled):visible > a");l.length>0&&l.eq(0).focus()}t.alignPosition()}},e.clearCustomItems=function(t){if(t&&t.items.length>0)for(var e=0;e<t.items.length;e++)t.items[e].isCustomItem&&(t.removeItem(t.items[e]),e--);this._hasCustomItems=!1}}})),void 0===Common)Common={};if(define("common/main/lib/view/ListSettingsDialog",[],(function(){"use strict";var t={none:-1,symbol:0,image:2,newSymbol:1,newImage:-2};Common.Views.ListSettingsDialog=Common.UI.Window.extend(_.extend({options:{type:0,width:285,height:261,style:"min-width: 240px;",cls:"modal-dlg",id:"window-list-settings",split:!1,buttons:["ok","cancel"]},initialize:function(t){this.type=t.type||0,_.extend(this.options,{title:this.txtTitle},t||{}),this.template=['<div class="box">','<div style="margin-bottom: 16px;">','<button type="button" class="btn btn-text-default auto" id="id-dlg-list-bullet">',this.textBulleted,"</button>",'<button type="button" class="btn btn-text-default auto" id="id-dlg-list-numbering">',this.textNumbering,"</button>","</div>",'<div style="height:120px;">','<table cols="3">',"<tr>",'<td class="padding-right-5" style="padding-bottom: 8px;min-width: 50px;">','<label class="text">'+this.txtType+"</label>","</td>",'<td class="padding-right-5" style="padding-bottom: 8px;width: 105px;">','<div id="id-dlg-list-numbering-format" class="input-group-nr" style="width: 105px;"></div>','<div id="id-dlg-list-bullet-format" class="input-group-nr" style="width: 105px;"></div>',"</td>",'<td style="padding-bottom: 8px;"></td>',"</tr>",'<tr class="image">','<td class="padding-right-5" style="padding-bottom: 8px;min-width: 50px;">','<label class="text">'+this.txtImport+"</label>","</td>",'<td class="padding-right-5" style="padding-bottom: 8px;width: 105px;">','<div id="id-dlg-list-image" style="width: 105px;"></div>',"</td>",'<td style="padding-bottom: 8px;"></td>',"</tr>","<tr>",'<td class="padding-right-5" style="padding-bottom: 8px;min-width: 50px;">','<label class="text">'+this.txtSize+"</label>","</td>",'<td class="padding-right-5" style="padding-bottom: 8px;width: 105px;">','<div id="id-dlg-list-size"></div>',"</td>",'<td style="padding-bottom: 8px;">','<label class="text" style="white-space: nowrap;">'+this.txtOfText+"</label>","</td>","</tr>",'<tr class="numbering">','<td class="padding-right-5" style="padding-bottom: 8px;min-width: 50px;">','<label class="text" style="white-space: nowrap;">'+this.txtStart+"</label>","</td>",'<td class="padding-right-5" style="padding-bottom: 8px;width: 105px;">','<div id="id-dlg-list-start"></div>',"</td>",'<td style="padding-bottom: 8px;"></td>',"</tr>",'<tr class="color">','<td class="padding-right-5" style="padding-bottom: 8px;min-width: 50px;">','<label class="text">'+this.txtColor+"</label>","</td>",'<td class="padding-right-5" style="padding-bottom: 8px;width: 105px;">','<div id="id-dlg-list-color"></div>',"</td>",'<td style="padding-bottom: 8px;"></td>',"</tr>","</table>","</div>","</div>"].join(""),this.props=t.props,this.options.tpl=_.template(this.template)(this.options),this.color="000000",this.storage=!!t.storage,this.api=t.api,Common.UI.Window.prototype.initialize.call(this,this.options)},render:function(){Common.UI.Window.prototype.render.call(this);var e=this,i=this.getChild();i.find(".dlg-btn").on("click",_.bind(this.onBtnClick,this)),e.btnBullet=new Common.UI.Button({el:$("#id-dlg-list-bullet"),enableToggle:!0,toggleGroup:"list-type",allowDepress:!1,pressed:!0}),e.btnBullet.on("click",_.bind(e.onListTypeClick,e,0)),e.btnNumbering=new Common.UI.Button({el:$("#id-dlg-list-numbering"),enableToggle:!0,toggleGroup:"list-type",allowDepress:!1}),e.btnNumbering.on("click",_.bind(e.onListTypeClick,e,1)),Common.UI.GroupedButtons([e.btnBullet,e.btnNumbering]),this.cmbNumFormat=new Common.UI.ComboBox({el:$("#id-dlg-list-numbering-format"),menuStyle:"min-width: 100%;max-height: 183px;",editable:!1,takeFocusOnClose:!0,cls:"input-group-nr",data:[{displayValue:this.txtNone,value:-1},{displayValue:"A, B, C,...",value:4},{displayValue:"a), b), c),...",value:5},{displayValue:"a, b, c,...",value:6},{displayValue:"1, 2, 3,...",value:1},{displayValue:"1), 2), 3),...",value:2},{displayValue:"I, II, III,...",value:3},{displayValue:"i, ii, iii,...",value:7}]}),this.cmbNumFormat.on("selected",_.bind((function(t,e){this._changedProps&&this._changedProps.asc_putListType(1,e.value)}),this)),this.cmbNumFormat.setValue(1);var s=["<% _.each(items, function(item) { %>",'<li id="<%= item.id %>" data-value="<%= item.value %>"><a tabindex="-1" type="menuitem">',"<%= item.displayValue %>",'<% if (item.value === 0) { %><span style="font-family:<%=item.font%>;"><%=item.symbol%></span>','<% } else if (item.value === 2) { %><span id="id-dlg-list-bullet-image-preview" class="margin-left-4" style="width:12px; height: 12px; margin-bottom: 1px;display: inline-block; vertical-align: middle;"></span><% } %>',"</a></li>","<% }); %>"],n=['<div class="input-group combobox input-group-nr <%= cls %>" id="<%= id %>" style="<%= style %>">','<div class="form-control" style="padding-top:3px; line-height: 14px; cursor: pointer; <%= style %>"></div>','<div style="display: table-cell;"></div>','<button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown"><span class="caret"></span></button>','<ul class="dropdown-menu <%= menuCls %>" style="<%= menuStyle %>" role="menu">'].concat(s).concat(["</ul>","</div>"]);this.cmbBulletFormat=new Common.UI.ComboBoxCustom({el:$("#id-dlg-list-bullet-format"),menuStyle:"min-width: 100%;max-height: 183px;",style:"width: 105px;",editable:!1,takeFocusOnClose:!0,template:_.template(n.join("")),itemsTemplate:_.template(s.join("")),data:[{displayValue:this.txtNone,value:t.none},{displayValue:this.txtSymbol+": ",value:t.symbol,symbol:"",font:"Arial"},{displayValue:this.txtSymbol+": ",value:t.symbol,symbol:"o",font:"Courier New"},{displayValue:this.txtSymbol+": ",value:t.symbol,symbol:"",font:"Wingdings"},{displayValue:this.txtSymbol+": ",value:t.symbol,symbol:"v",font:"Wingdings"},{displayValue:this.txtSymbol+": ",value:t.symbol,symbol:"",font:"Wingdings"},{displayValue:this.txtSymbol+": ",value:t.symbol,symbol:"",font:"Wingdings"},{displayValue:this.txtSymbol+": ",value:t.symbol,symbol:"w",font:"Wingdings"},{displayValue:this.txtSymbol+": ",value:t.symbol,symbol:"",font:"Arial"},{displayValue:this.txtNewBullet,value:t.newSymbol},{displayValue:this.txtNewImage,value:t.newImage}],updateFormControl:function(i){var s=$(this.el).find(".form-control");if(i)if(i.get("value")===t.symbol)s[0].innerHTML=i.get("displayValue")+'<span style="font-family:'+(i.get("font")||"Arial")+'">'+i.get("symbol")+"</span>";else if(i.get("value")===t.image){s[0].innerHTML=i.get("displayValue")+'<span id="id-dlg-list-bullet-combo-preview" class="margin-left-2" style="width:12px; height: 12px; margin-bottom: 1px;display: inline-block; vertical-align: middle;"></span>';var n=new Asc.asc_CBullet;n.asc_fillBulletImage(e.imageProps.id),n.drawSquareImage("id-dlg-list-bullet-combo-preview")}else i.get("value")===t.newImage?s[0].innerHTML=e.txtImage:s[0].innerHTML=i.get("displayValue");else s[0].innerHTML=""}});var a=this.cmbBulletFormat.store.at(1);this.cmbBulletFormat.selectRecord(a),this.bulletProps={symbol:a.get("symbol"),font:a.get("font")},this.cmbBulletFormat.on("selected",_.bind((function(e,i){if(this.imageControls.toggleClass("hidden",!(i.value===t.image||i.value===t.newImage)),this.colorControls.toggleClass("hidden",i.value===t.image||i.value===t.newImage),i.value===t.newSymbol){var s,n=this,a=n.bulletProps,o=function(i,o,l){s=o,"ok"==o&&(a.changed=!0,a.code=l.code,a.font=l.font,a.symbol=l.symbol,n._changedProps&&(n._changedProps.asc_putFont(a.font),n._changedProps.asc_putSymbol(a.symbol)));var r=e.store;if(!r.findWhere({value:t.symbol,symbol:a.symbol,font:a.font})){var c=r.indexOf(r.findWhere({value:t.image}));c<0&&(c=r.indexOf(r.findWhere({value:t.newSymbol}))),r.add({displayValue:n.txtSymbol+": ",value:t.symbol,symbol:a.symbol,font:a.font},{at:c})}n.imageProps&&(n.imageProps.redraw=!0),e.setData(r.models),e.selectRecord(e.store.findWhere({value:t.symbol,symbol:a.symbol,font:a.font}))},l=new Common.Views.SymbolTableDialog({api:n.options.api,lang:n.options.interfaceLang,modal:!0,type:0,font:a.font,symbol:a.symbol,handler:o}).on("close",(function(t){void 0===s&&o&&o.call(n),setTimeout((function(){n.cmbBulletFormat.focus()}),1)}));l.show(),l.on("symbol:dblclick",o)}else i.value==t.newImage||(i.value==t.image?this._changedProps&&this._changedProps.asc_fillBulletImage(this.imageProps.id):i.value==t.none?this._changedProps&&this._changedProps.asc_putListType(0,i.value):(this.bulletProps.changed=!0,this.bulletProps.code=i.code,this.bulletProps.font=i.font,this.bulletProps.symbol=i.symbol,this._changedProps&&(this._changedProps.asc_putFont(this.bulletProps.font),this._changedProps.asc_putSymbol(this.bulletProps.symbol))));this.btnOk.setDisabled(i.value===t.newImage)}),this)),this.cmbBulletFormat.on("show:after",_.bind(this.onBulletFormatOpen,this)),this.spnSize=new Common.UI.MetricSpinner({el:i.find("#id-dlg-list-size"),step:1,width:105,value:100,defaultUnit:"",maxValue:400,minValue:25,allowDecimal:!1}).on("change",(function(t,i,s,n){e._changedProps&&e._changedProps.asc_putSize(t.getNumberValue())}));var o=this.options.colorConfig||{};this.btnColor=new Common.UI.ColorButton({parentEl:i.find("#id-dlg-list-color"),style:"width:45px;",additionalAlign:this.menuAddAlign,color:this.color,colors:o.colors,dynamiccolors:o.dynamiccolors,themecolors:o.themecolors,effects:o.effects,columns:o.columns,paletteCls:o.cls,paletteWidth:o.paletteWidth,takeFocusOnClose:!0}),this.btnColor.on("color:select",_.bind(this.onColorsSelect,this)),this.colors=this.btnColor.getPicker(),this.spnStart=new Common.UI.MetricSpinner({el:i.find("#id-dlg-list-start"),step:1,width:105,value:1,defaultUnit:"",maxValue:32767,minValue:1,allowDecimal:!1}).on("change",(function(t,i,s,n){e._changedProps&&e._changedProps.asc_putNumStartAt(t.getNumberValue())})),this.btnSelectImage=new Common.UI.Button({parentEl:$("#id-dlg-list-image"),cls:"btn-text-menu-default",caption:this.textSelect,style:"width: 100%;",menu:new Common.UI.Menu({style:"min-width: 105px;",maxHeight:200,additionalAlign:this.menuAddAlign,items:[{caption:this.textFromFile,value:0},{caption:this.textFromUrl,value:1},{caption:this.textFromStorage,value:2}]}),takeFocusOnClose:!0}),this.btnSelectImage.menu.on("item:click",_.bind(this.onImageSelect,this)),this.btnSelectImage.menu.items[2].setVisible(this.storage),this.btnOk=_.find(this.getFooterButtons(),(function(t){return t.$el&&t.$el.find(".primary").addBack().filter(".primary").length>0}))||new Common.UI.Button({el:i.find(".primary")}),e.numberingControls=i.find("tr.numbering"),e.imageControls=i.find("tr.image"),e.colorControls=i.find("tr.color");var l=i.find("table tr:first() td:first()");l.width(Math.max(i.find(".numbering .text").width(),l.width())),this.afterRender()},getFocusedComponents:function(){return[this.btnBullet,this.btnNumbering,this.cmbNumFormat,this.cmbBulletFormat,this.btnSelectImage,this.spnSize,this.spnStart,this.btnColor].concat(this.getFooterButtons())},afterRender:function(){!this.options.colorConfig&&this.updateThemeColors(),this._setDefaults(this.props);var e=this,i=function(i){e.imageProps={id:i.asc_getImageId(),redraw:!0},e._changedProps&&e._changedProps.asc_fillBulletImage(e.imageProps.id);var s=e.cmbBulletFormat.store;if(!s.findWhere({value:t.image})){var n=s.indexOf(s.findWhere({value:t.newSymbol}));s.add({displayValue:e.txtImage+":",value:t.image},{at:n})}e.cmbBulletFormat.setData(s.models),e.cmbBulletFormat.selectRecord(e.cmbBulletFormat.store.findWhere({value:t.image})),e.btnOk.setDisabled(!1)};this.api.asc_registerCallback("asc_onBulletImageLoaded",i);var s=function(t){t&&t._urls&&"bullet"==t.c&&(new Asc.asc_CBullet).asc_putImageUrl(t._urls[0],t.token)};Common.NotificationCenter.on("storage:image-insert",s),this.on("close",(function(t){e.api.asc_unregisterCallback("asc_onBulletImageLoaded",i),Common.NotificationCenter.off("storage:image-insert",s)}))},onBulletFormatOpen:function(e){if(e.store.findWhere({value:t.image})&&this.imageProps.redraw){var i=new Asc.asc_CBullet;i.asc_fillBulletImage(this.imageProps.id),i.drawSquareImage("id-dlg-list-bullet-image-preview"),this.imageProps.redraw=!1}},updateThemeColors:function(){this.colors.updateColors(Common.Utils.ThemeColor.getEffectColors(),Common.Utils.ThemeColor.getStandartColors())},onColorsSelect:function(t,e){this.color=e,this._changedProps&&this._changedProps.asc_putColor(Common.Utils.ThemeColor.getRgbColor(e))},onListTypeClick:function(t,e,i){this.ShowHideElem(t)},ShowHideElem:function(e){var i=0==e&&(this.cmbBulletFormat.getValue()===t.image||this.cmbBulletFormat.getValue()===t.newImage||(void 0===this.cmbBulletFormat.getValue()||""===this.cmbBulletFormat.getValue())&&this.originalType===AscFormat.BULLET_TYPE_BULLET_BLIP);this.numberingControls.toggleClass("hidden",0==e),this.imageControls.toggleClass("hidden",!i),this.colorControls.toggleClass("hidden",i),this.cmbNumFormat.setVisible(1==e),this.cmbBulletFormat.setVisible(0==e),this.btnOk.setDisabled(i&&this.cmbBulletFormat.getValue()===t.newImage);var s=this;_.delay((function(){e?s.cmbNumFormat.focus():s.cmbBulletFormat.focus()}),50)},_handleInput:function(e){if(this.options.handler){if("ok"==e&&this.btnOk.isDisabled())return;var i=this.btnBullet.pressed?0:1;this.originalType==AscFormat.BULLET_TYPE_BULLET_NONE&&(this._changedProps=new Asc.asc_CBullet,this._changedProps.asc_putSize(this.spnSize.getNumberValue()),0==i&&this.cmbBulletFormat.getValue()===t.image&&this.imageProps?this._changedProps.asc_fillBulletImage(this.imageProps.id):this._changedProps.asc_putColor(Common.Utils.ThemeColor.getRgbColor(this.color))),(this.originalType==AscFormat.BULLET_TYPE_BULLET_NONE||(this.originalType==AscFormat.BULLET_TYPE_BULLET_CHAR||this.originalType==AscFormat.BULLET_TYPE_BULLET_BLIP)&&1==i||this.originalType==AscFormat.BULLET_TYPE_BULLET_AUTONUM&&0==i)&&(0==i?this.cmbBulletFormat.getValue()==t.none?this._changedProps.asc_putListType(0,-1):this.cmbBulletFormat.getValue()==t.image||(this._changedProps.asc_putFont(this.bulletProps.font),this._changedProps.asc_putSymbol(this.bulletProps.symbol)):(this._changedProps.asc_putListType(1,this.cmbNumFormat.getValue()),this._changedProps.asc_putNumStartAt(this.spnStart.getNumberValue()))),this.options.handler.call(this,e,this._changedProps)}this.close()},onBtnClick:function(t){this._handleInput(t.currentTarget.attributes.result.value)},onPrimary:function(t){return this._handleInput("ok"),!1},_setDefaults:function(e){if(e){var i=0,s=e.asc_getBullet();if(s){this.originalType=s.asc_getType(),this.spnSize.setValue(s.asc_getSize()||"",!0);var n=s.asc_getColor();if(n=n?n.get_type()==Asc.c_oAscColor.COLOR_TYPE_SCHEME?{color:Common.Utils.ThemeColor.getHexColor(n.get_r(),n.get_g(),n.get_b()),effectValue:n.get_value()}:Common.Utils.ThemeColor.getHexColor(n.get_r(),n.get_g(),n.get_b()):"transparent",this.color=Common.Utils.ThemeColor.colorValue2EffectId(n),this.btnColor.setColor(n),Common.Utils.ThemeColor.selectPickerColorByEffect(n,this.colors),this.originalType==AscFormat.BULLET_TYPE_BULLET_NONE)this.cmbNumFormat.setValue(-1),this.cmbBulletFormat.setValue(t.none),i=this.type;else if(this.originalType==AscFormat.BULLET_TYPE_BULLET_CHAR){var a=s.asc_getSymbol();a?(this.bulletProps={symbol:a,font:s.asc_getFont()},this.cmbBulletFormat.store.findWhere({value:t.symbol,symbol:this.bulletProps.symbol,font:this.bulletProps.font})||this.cmbBulletFormat.store.add({displayValue:this.txtSymbol+": ",value:t.symbol,symbol:this.bulletProps.symbol,font:this.bulletProps.font},{at:this.cmbBulletFormat.store.length-2}),this.cmbBulletFormat.setData(this.cmbBulletFormat.store.models),this.cmbBulletFormat.selectRecord(this.cmbBulletFormat.store.findWhere({value:t.symbol,symbol:this.bulletProps.symbol,font:this.bulletProps.font}))):this.cmbBulletFormat.setValue(""),this._changedProps=s,i=0}else if(this.originalType==AscFormat.BULLET_TYPE_BULLET_BLIP){var o=s.asc_getImageId();o?(this.imageProps={id:o,redraw:!0},this.cmbBulletFormat.store.findWhere({value:t.image})||this.cmbBulletFormat.store.add({displayValue:this.txtImage+":",value:t.image},{at:this.cmbBulletFormat.store.length-2}),this.cmbBulletFormat.setData(this.cmbBulletFormat.store.models),this.cmbBulletFormat.selectRecord(this.cmbBulletFormat.store.findWhere({value:t.image}))):this.cmbBulletFormat.setValue(""),this._changedProps=s,i=0}else if(this.originalType==AscFormat.BULLET_TYPE_BULLET_AUTONUM){var l=s.asc_getAutoNumType();this.cmbNumFormat.setValue(l,"");var r=s.asc_getNumStartAt();this.spnStart.setValue(r||"",!0),this.spnStart.setDisabled(null===r),this._changedProps=s,i=1}}else this.cmbNumFormat.setValue(-1),this.cmbBulletFormat.setValue(t.none),this._changedProps=new Asc.asc_CBullet,i=this.type}1==i?this.btnNumbering.toggle(!0):this.btnBullet.toggle(!0),this.ShowHideElem(i)},onImageSelect:function(t,e){if(1==e.value){var i=this;new Common.Views.ImageFromUrlDialog({handler:function(t,e){if("ok"==t){var i=e.replace(/ /g,"");_.isEmpty(i)||(new Asc.asc_CBullet).asc_putImageUrl(i)}}}).on("close",(function(){i.btnSelectImage.focus()})).show()}else 2==e.value?Common.NotificationCenter.trigger("storage:image-load","bullet"):(new Asc.asc_CBullet).asc_showFileDialog()},txtTitle:"List Settings",txtSize:"Size",txtColor:"Color",txtOfText:"% of text",txtStart:"Start at",textBulleted:"Bulleted",textNumbering:"Numbered",txtType:"Type",txtNone:"None",txtNewBullet:"New bullet",txtSymbol:"Symbol",txtNewImage:"New image",txtImage:"Image",txtImport:"Import",textSelect:"Select From",textFromUrl:"From URL",textFromFile:"From File",textFromStorage:"From Storage"},Common.Views.ListSettingsDialog||{}))})),define("common/main/lib/view/ExternalLinksDlg",["common/main/lib/view/AdvancedSettingsWindow"],(function(){"use strict";Common.Views.ExternalLinksDlg=Common.Views.AdvancedSettingsWindow.extend(_.extend({options:{alias:"ExternalLinksDlg",contentWidth:510,separator:!1,buttons:["close"]},initialize:function(t){_.extend(this.options,{title:this.txtTitle,contentStyle:"padding: 10px 0 0;",contentTemplate:_.template(['<div class="settings-panel active">','<div class="inner-content">','<table cols="1" style="width: 100%;">',"<tr>",'<td class="padding-small">','<div id="external-links-btn-update" class="float-left margin-right-5"></div>','<div id="external-links-btn-change" class="float-left margin-right-5"></div>','<div id="external-links-btn-open" class="float-left margin-right-5"></div>','<div id="external-links-btn-delete" class="float-left"></div>',"</td>","</tr>","<tr>",'<td class="padding-small">','<div id="external-links-list" class="range-tableview" style="width:100%; height: 171px;"></div>',"</td>","</tr>","<tr>",'<td class="">','<div id="external-links-auto-update"></div>',"</td>","</tr>","</table>","</div></div>"].join(""))({scope:this})},t),this.api=t.api,this.handler=t.handler,this.isUpdating=t.isUpdating||!1,this.canRequestReferenceData=t.canRequestReferenceData||!1,this.canRequestOpen=t.canRequestOpen||!1,this.canRequestReferenceSource=t.canRequestReferenceSource||!1,this.isOffline=t.isOffline||!1,this.linkStatus=[],this.wrapEvents={onUpdateExternalReferenceList:_.bind(this.refreshList,this)},Common.Views.AdvancedSettingsWindow.prototype.initialize.call(this,this.options)},render:function(){Common.Views.AdvancedSettingsWindow.prototype.render.call(this);this.linksList=new Common.UI.ListView({el:$("#external-links-list",this.$window),store:new Common.UI.DataViewStore,simpleAddMode:!0,headers:[{name:this.textSource,width:240},{name:this.textStatus,width:175}],itemTemplate:_.template(['<div id="<%= id %>" class="list-item" style="width: 100%;display:inline-block;">','<div class="padding-right-5" style="width:240px;" data-toggle="tooltip"><%= value %></div>','<div style="width:175px;" data-toggle="tooltip"><%= status %></div>',"</div>"].join("")),tabindex:1}),this.linksList.on("item:add",_.bind(this.addTooltips,this)),this.linksList.on("item:change",_.bind(this.addTooltips,this)),this.linksList.on("reset:before",_.bind(this.resetItemsBefore,this)),this.btnUpdate=new Common.UI.Button({parentEl:$("#external-links-btn-update",this.$window),cls:"btn-text-split-default auto",caption:this.textUpdate,split:!0,visible:!!this.canRequestReferenceData,menu:new Common.UI.Menu({style:"min-width:100px;",items:[{caption:this.textUpdate,value:0},{caption:this.textUpdateAll,value:1}]}),takeFocusOnClose:!0});var t=$(this.btnUpdate.cmpEl.find("button")[0]);t.css("min-width",Math.max(87,t.outerWidth())+"px"),this.btnUpdate.on("click",_.bind(this.onUpdate,this)),this.btnUpdate.menu.on("item:click",_.bind(this.onUpdateMenu,this)),this.btnDelete=new Common.UI.Button({parentEl:$("#external-links-btn-delete",this.$window),cls:"btn-text-split-default auto",caption:this.textDelete,split:!0,menu:new Common.UI.Menu({style:"min-width:100px;",items:[{caption:this.textDelete,value:0},{caption:this.textDeleteAll,value:1}]}),takeFocusOnClose:!0}),$(this.btnDelete.cmpEl.find("button")[0]).css("min-width","87px"),this.btnDelete.on("click",_.bind(this.onDelete,this)),this.btnDelete.menu.on("item:click",_.bind(this.onDeleteMenu,this)),this.btnOpen=new Common.UI.Button({parentEl:$("#external-links-btn-open",this.$window),cls:"btn-text-default auto",caption:this.textOpen,visible:!!this.canRequestOpen}),this.btnOpen.on("click",_.bind(this.onOpen,this)),this.btnChange=new Common.UI.Button({parentEl:$("#external-links-btn-change",this.$window),cls:"btn-text-default auto",caption:this.textChange,visible:!!this.canRequestReferenceSource}),this.btnChange.on("click",_.bind(this.onChange,this)),this.chUpdate=new Common.UI.CheckBox({el:$("#external-links-auto-update"),labelText:this.textAutoUpdate}),this.chUpdate.on("change",_.bind((function(t,e,i,s){this.api&&this.api.asc_setUpdateLinks("checked"===t.getValue())}),this)),this.afterRender()},afterRender:function(){this._setDefaults(),this.api.asc_registerCallback("asc_onUpdateExternalReferenceList",this.wrapEvents.onUpdateExternalReferenceList),this.isUpdating&&this.setIsUpdating(this.isUpdating,!0)},getFocusedComponents:function(){return[this.btnUpdate,this.btnChange,this.btnOpen,this.btnDelete,this.linksList,this.chUpdate].concat(this.getFooterButtons())},close:function(){this.api.asc_unregisterCallback("asc_onUpdateExternalReferenceList",this.wrapEvents.onUpdateExternalReferenceList),Common.Views.AdvancedSettingsWindow.prototype.close.call(this)},getDefaultFocusableComponent:function(){return this.linksList},_setDefaults:function(t){this.refreshList(),window.SSE?this.api&&this.chUpdate.setValue(this.api.asc_getUpdateLinks(),!0):this.chUpdate.setVisible(!1)},refreshList:function(){var t=[],e=this.api.asc_getExternalReferences();if(e)for(var i=0;i<e.length;i++)t.push({linkid:e[i].asc_getId(),value:(e[i].asc_getSource()||"").replace(new RegExp("%20","g")," "),idx:i,externalRef:e[i],status:this.linkStatus[e[i].asc_getId()]||this.textUnknown});this.linksList.store.reset(t),this.linksList.store.length>0&&this.linksList.selectByIndex(0),this.updateButtons()},onUpdate:function(){if(!this.isUpdating){var t=this.linksList.getSelectedRec();t&&(this.isOffline&&this.setLinkStatus(t.get("linkid"),this.textOk),Common.NotificationCenter.trigger("data:updatereferences",[t.get("externalRef")],!0))}},onUpdateMenu:function(t,e){if(!this.isUpdating)if(1==e.value){var i=[],s=this;this.linksList.store.each((function(t){i.push(t.get("externalRef")),s.isOffline&&s.setLinkStatus(t.get("linkid"),s.textOk)}),this),i.length>0&&Common.NotificationCenter.trigger("data:updatereferences",i,!0)}else this.onUpdate()},onDelete:function(){if(!this.isUpdating){var t=this.linksList.getSelectedRec();t&&this.api.asc_removeExternalReferences([t.get("externalRef")]),this.refreshList()}},onDeleteMenu:function(t,e){if(!this.isUpdating)if(1==e.value){var i=[];this.linksList.store.each((function(t){i.push(t.get("externalRef"))}),this),i.length>0&&this.api.asc_removeExternalReferences(i),this.refreshList()}else this.onDelete()},onOpen:function(){var t=this.linksList.getSelectedRec();if(t){var e=this.api.asc_openExternalReference(t.get("externalRef"));if(e){switch(e.asc_getType()){case Asc.c_oAscExternalReferenceType.link:e={link:e.asc_getData()};break;case Asc.c_oAscExternalReferenceType.path:e={path:e.asc_getData()};break;case Asc.c_oAscExternalReferenceType.referenceData:e={referenceData:e.asc_getData(),path:e.asc_getPath()}}e.windowName="wname-"+Date.now(),window.open("",e.windowName),Common.Gateway.requestOpen(e)}}},onChange:function(){var t=this.linksList.getSelectedRec();t&&(this.isOffline?this.api.asc_changeExternalReference(t.get("externalRef")):this.fireEvent("change:source",this,t.get("externalRef")))},updateButtons:function(){var t=this.linksList.store.length>0&&!!this.linksList.getSelectedRec();this.btnUpdate.setDisabled(!t||this.isUpdating),this.btnDelete.setDisabled(!t||this.isUpdating),this.btnOpen.setDisabled(!t||this.isUpdating),this.btnChange.setDisabled(!t||this.isUpdating)},setIsUpdating:function(t,e){if(e=e||!t,this.isUpdating=t,!t&&this.timerId&&(clearTimeout(this.timerId),this.timerId=0),e)this.updateButtons(),this.btnUpdate.setCaption(t?this.textUpdating:this.textUpdate);else if(!this.timerId){var i=this;i.timerId=setTimeout((function(){i.updateButtons(),i.btnUpdate.setCaption(t?i.textUpdating:i.textUpdate)}),500)}!t&&this.refreshList()},setLinkStatus:function(t,e){t&&(this.linkStatus[t]=e||this.textOk)},resetItemsBefore:function(t){t.dataViewItems&&_.each(t.dataViewItems,(function(t){t.tipsArray&&t.tipsArray.forEach((function(t){t&&(void 0===t.dontShow&&(t.dontShow=!0),t.tip().remove())}))}),this)},addTooltips:function(t,e,i){e.tipsArray&&e.tipsArray.forEach((function(t){t&&(void 0===t.dontShow&&(t.dontShow=!0),t.tip().remove())}));var s=document.createElement("span"),n=Common.UI.Themes.getThemeProps("font");s.style.fontSize=n&&n.size?n.size:"11px",s.style.fontFamily=n&&n.name?n.name:'Arial, Helvetica, "Helvetica Neue", sans-serif',s.style.position="absolute",s.style.top="-1000px",s.style.left="-1000px",document.body.appendChild(s);var a=$(e.el).find(".list-item > div");this.checkTextOfItem(s,e,$(a[0]),i.get("value"),this.linksList.options.headers[0].width),this.checkTextOfItem(s,e,$(a[1]),i.get("status"),this.linksList.options.headers[1].width),document.body.removeChild(s),e.tipsArray=[]},checkTextOfItem:function(t,e,i,s,n){t.innerHTML=s;var a=this.linksList;t.offsetWidth>n&&i.one("mouseenter",(function(t){var i=$(t.target);i.tooltip({title:s,placement:"cursor",zIndex:a.tipZIndex}),i.mouseenter(),e.tipsArray.push(i.data("bs.tooltip"))}))},txtTitle:"External Links",textUpdate:"Update Values",textUpdateAll:"Update All",textSource:"Source",closeButtonText:"Close",textDelete:"Break Links",textDeleteAll:"Break All Links",textOpen:"Open Source",textChange:"Change Source",textStatus:"Status",textOk:"OK",textUnknown:"Unknown",textUpdating:"Updating...",textAutoUpdate:"Update automatically"},Common.Views.ExternalLinksDlg||{}))})),void 0===Common)Common={};if(define("common/main/lib/view/CustomizeQuickAccessDialog",[],(function(){"use strict";Common.Views.CustomizeQuickAccessDialog=Common.UI.Window.extend(_.extend({options:{width:296,style:"min-width: 296px;",cls:"modal-dlg quick-access-dlg",buttons:["ok","cancel"]},initialize:function(t){_.extend(this.options,{title:this.textTitle},t||{}),this.template=['<div class="box">','<label class="padding-medium">'+this.textMsg+"</label>",'<div class="padding-small" id="quick-access-chb-save"></div>','<div class="padding-small" id="quick-access-chb-print"></div>','<div class="padding-small" id="quick-access-chb-quick-print" style="display:none;"></div>','<div class="padding-small" id="quick-access-chb-undo"></div>','<div class="padding-small" id="quick-access-chb-redo"></div>','<div class="padding-small" id="quick-access-chb-start-over" style="display:none;"></div>',"</div>"].join(""),this.options.tpl=_.template(this.template)(this.options),this.props=this.options.props,Common.UI.Window.prototype.initialize.call(this,this.options)},render:function(){Common.UI.Window.prototype.render.call(this),this.focusedComponents=[],this.getChild().find(".dlg-btn").on("click",_.bind(this.onBtnClick,this)),this.options.showSave&&(this.chSave=new Common.UI.CheckBox({el:$("#quick-access-chb-save"),labelText:this.options.mode&&(this.options.mode.canSaveToFile||this.options.mode.isDesktopApp&&this.options.mode.isOffline)?this.textSave:this.textDownload,value:this.props.save}),this.focusedComponents.push(this.chSave)),this.options.showPrint&&(this.chPrint=new Common.UI.CheckBox({el:$("#quick-access-chb-print"),labelText:this.textPrint,value:this.props.print}),this.focusedComponents.push(this.chPrint)),this.options.showQuickPrint&&(this.chQuickPrint=new Common.UI.CheckBox({el:$("#quick-access-chb-quick-print"),labelText:this.textQuickPrint,value:this.props.quickPrint}),this.focusedComponents.push(this.chQuickPrint),this.chQuickPrint.show()),this.chUndo=new Common.UI.CheckBox({el:$("#quick-access-chb-undo"),labelText:this.textUndo,value:this.props.undo}),this.focusedComponents.push(this.chUndo),this.chRedo=new Common.UI.CheckBox({el:$("#quick-access-chb-redo"),labelText:this.textRedo,value:this.props.redo}),this.focusedComponents.push(this.chRedo),window.PE&&(this.chStartOver=new Common.UI.CheckBox({el:$("#quick-access-chb-start-over"),labelText:this.textStartOver,value:this.props.startOver}),this.focusedComponents.push(this.chStartOver),this.chStartOver.show())},getFocusedComponents:function(){return this.focusedComponents.concat(this.getFooterButtons())},getDefaultFocusableComponent:function(){return this.focusedComponents[0]},onBtnClick:function(t){"ok"===t.currentTarget.attributes.result.value&&Common.NotificationCenter.trigger("quickaccess:changed",{save:this.chSave?"checked"===this.chSave.getValue():void 0,print:this.chPrint?"checked"===this.chPrint.getValue():void 0,quickPrint:this.chQuickPrint?"checked"===this.chQuickPrint.getValue():void 0,undo:"checked"===this.chUndo.getValue(),redo:"checked"===this.chRedo.getValue(),startOver:this.chStartOver?"checked"===this.chStartOver.getValue():void 0}),this.close()},textTitle:"Customize quick access",textMsg:"Check the commands that will be displayed on the Quick Access Toolbar",textSave:"Save",textPrint:"Print",textQuickPrint:"Quick Print",textUndo:"Undo",textRedo:"Redo",textDownload:"Download file"},Common.Views.CustomizeQuickAccessDialog||{}))})),define("common/main/lib/view/PasswordDialog",[],(function(){"use strict";Common.Views.PasswordDialog=Common.UI.Window.extend(_.extend({applyFunction:void 0,initialize:function(t){var e=this,i={};_.extend(i,{width:395,header:!0,cls:"modal-dlg",contentTemplate:"",title:e.txtTitle,buttons:["ok","cancel"]},t),this.handler=t.handler,this.template=t.template||['<div class="box">','<div class="input-row" style="margin-bottom: 10px;">',"<label>"+e.txtDescription+"</label>","</div>",'<div class="input-row">',"<label>"+e.txtPassword+(e.passwordOptional?" ("+e.txtOptional+")":"")+"</label>","</div>",'<div id="id-password-txt" class="input-row" style="margin-bottom: 5px;"></div>','<div class="input-row">',"<label>"+e.txtRepeat+"</label>","</div>",'<div id="id-repeat-txt" class="input-row" style="margin-bottom: 10px;"></div>',"<label>"+e.txtWarning+"</label>","</div>"].join(""),i.tpl=_.template(this.template)(i),Common.UI.Window.prototype.initialize.call(this,i)},render:function(){if(Common.UI.Window.prototype.render.call(this),this.$window){var t=this;this.$window.find(".dlg-btn").on("click",_.bind(this.onBtnClick,this)),this.repeatPwd=new Common.UI.InputField({el:$("#id-repeat-txt"),type:"password",allowBlank:!1,style:"width: 100%;",maxLength:255,validateOnBlur:!1,validation:function(e){return t.txtIncorrectPwd}}),this.inputPwd=new Common.UI.InputFieldBtnPassword({el:$("#id-password-txt"),type:"password",allowBlank:!1,style:"width: 100%;",maxLength:255,validateOnBlur:!1,repeatInput:this.repeatPwd,showPwdOnClick:!1})}},getFocusedComponents:function(){return[this.inputPwd,this.repeatPwd].concat(this.getFooterButtons())},getDefaultFocusableComponent:function(){return this.inputPwd},onPrimary:function(t){return this._handleInput("ok"),!1},onBtnClick:function(t){this._handleInput(t.currentTarget.attributes.result.value)},_handleInput:function(t){if(this.handler){if("ok"==t){if(!0!==this.inputPwd.checkValidate())return void this.inputPwd.focus();if(this.inputPwd.getValue()!==this.repeatPwd.getValue())return this.repeatPwd.checkValidate(),void this.repeatPwd.focus()}this.handler.call(this,t,this.inputPwd.getValue())}this.close()},txtTitle:"Set Password",txtPassword:"Password",txtDescription:"A Password is required to open this document",txtRepeat:"Repeat password",txtIncorrectPwd:"Confirmation password is not identical",txtWarning:"Warning: If you lose or forget the password, it cannot be recovered. Please keep it in a safe place."},Common.Views.PasswordDialog||{}))})),void 0===Common)Common={};if(define("common/main/lib/component/TextareaField",[],(function(){"use strict";Common.UI.TextareaField=Common.UI.BaseView.extend({options:{id:null,cls:"",style:"",value:"",maxlength:void 0,placeHolder:"",spellcheck:!1,disabled:!1,resize:!1},template:_.template(['<div class="textarea-field" style="<%= style %>">',"<textarea ",'spellcheck="<%= spellcheck %>" ','class="form-control <%= cls %>" ','placeholder="<%= placeHolder %>" ',"<% if (dataHint) {%>",'data-hint="<%= dataHint %>" ',"<% } %>","<% if (dataHintDirection) {%>",'data-hint-direction="<%= dataHintDirection %>" ',"<% } %>","<% if (dataHintOffset) {%>",'data-hint-offset="<%= dataHintOffset %>" ',"<% } %>","></textarea>","</div>"].join("")),initialize:function(t){Common.UI.BaseView.prototype.initialize.call(this,t);var e=this;this.id=e.options.id||Common.UI.getId(),this.cls=e.options.cls,this.style=e.options.style,this.value=e.options.value,this.placeHolder=e.options.placeHolder,this.template=e.options.template||e.template,this.disabled=e.options.disabled,this.spellcheck=e.options.spellcheck,this.maxLength=e.options.maxLength,e.rendered=e.options.rendered||!1,e.options.el&&e.render()},render:function(t){var e=this;return e.rendered?this.cmpEl=this.$el:(this.cmpEl=$(this.template({id:this.id,cls:this.cls,style:this.style,placeHolder:this.placeHolder,spellcheck:this.spellcheck,dataHint:this.options.dataHint,dataHintDirection:this.options.dataHintDirection,dataHintOffset:this.options.dataHintOffset,scope:e})),t?(this.setElement(t,!1),t.html(this.cmpEl)):this.$el.html(this.cmpEl)),e.rendered||(this.cmpEl,this._input=this.cmpEl.find("textarea").addBack().filter("textarea"),this._input.on("blur",_.bind(this.onInputChanged,this)),this._input.on("keydown",_.bind(this.onKeyDown,this)),this.maxLength&&this._input.attr("maxlength",this.maxLength),this.resize||this._input.css("resize","none"),this.disabled&&this.setDisabled(this.disabled)),e.rendered=!0,e.value&&e.setValue(e.value),this},_doChange:function(t,e){if(!e||!e.synthetic){var i=$(t.target).val(),s=this.value;this.trigger("changed:before",this,i,s,t),t.isDefaultPrevented()||(this.value=i,this.trigger("changed:after",this,i,s,t))}},onInputChanged:function(t,e){this._doChange(t,e)},onKeyDown:function(t){this.trigger("keydown:before",this,t),t.isDefaultPrevented()||(t.keyCode===Common.UI.Keys.RETURN&&t.stopPropagation(),t.keyCode==Common.UI.Keys.ESC&&this.setValue(this.value),t.keyCode==Common.UI.Keys.ESC&&this.trigger("inputleave",this))},setDisabled:function(t){t=!!t,this.disabled=t,$(this.el).toggleClass("disabled",t),t?this._input.attr("disabled",!0):this._input.removeAttr("disabled")},isDisabled:function(){return this.disabled},setValue:function(t){this.value=t,this.rendered&&this._input.val(t)},getValue:function(){return this.value},focus:function(){this._input.focus()}})})),define("common/main/lib/view/ShortcutsDialog",["common/main/lib/view/AdvancedSettingsWindow"],(function(){"use strict";Common.Views.ShortcutsDialog=Common.Views.AdvancedSettingsWindow.extend(_.extend({options:{contentWidth:550,separator:!1},initialize:function(t){_.extend(this.options,{id:"shortcuts-gialog",title:this.txtTitle,contentStyle:"padding: 16px 16px 0;",contentTemplate:_.template(['<div id="header-row">','<input id="search-input" type="text" spellcheck="false" class="form-control" placeholder="<%= scope.txtSearch %>...">','<label id="reset-all-btn" class="link"><%= scope.txtRestoreAll %></label>',"</div>",'<div id="actions-list"></div>','<div id="action-description">',"<b><%= scope.txtDescription %>: </b>",'<span id="action-description-text"></span>',"</div>"].join(""))({scope:this}),buttons:[]},t),this.handler=t.handler,this.api=t.api,this._state={searchValue:""};const e=window.DE||window.PE||window.SSE||window.PDFE||window.VE;this._shortcutsController=e.getController("Common.Controllers.Shortcuts"),Common.Views.AdvancedSettingsWindow.prototype.initialize.call(this,this.options)},render:function(){Common.Views.AdvancedSettingsWindow.prototype.render.call(this),this.actionsList=new Common.UI.ListView({el:$("#actions-list",this.$window),emptyText:this.txtEmpty,store:new Common.UI.DataViewStore,itemTemplate:_.template(['<div id="<%= id %>" class="list-item">','<div class="action-name"><%= action.name %></div>','<div class="action-keys">',"<% _.each(_.filter(shortcuts, function(shortcut) { return !shortcut.ascShortcut.asc_IsHidden() }), function(shortcut, shortcutIndex) { %>",'<div class="action-keys-item">',"<% _.each(shortcut.keys, function(key, keyIndex) { %>","<% if (keyIndex != 0) { %>",'<div class="action-keys-item-plus">+</div>',"<% } %>",'<div class="action-keys-item-key"><%= key %></div>',"<% }); %>",'<div class="action-keys-item-comma">,</div>',"</div>","<% }); %>","</div>","<% if (action.isLocked) { %>",'<button type="button" class="btn-toolbar">','<i class="icon options__icon toolbar__icon btn-lock icon-lock">&nbsp;</i>',"</button>","<% } else { %>",'<button type="button" class="action-edit btn-toolbar">','<i class="icon options__icon toolbar__icon btn-edit">&nbsp;</i>',"</button>","<% } %>","</div>"].join("")),tabindex:1}),this.actionsList.on("item:select",_.bind(this.onSelectActionItem,this)),this.actionsList.on("item:click",_.bind(this.onClickActionItem,this)),this.actionsList.on("item:dblclick",_.bind(this.onEditActionItem,this)),this.actionsList.on("entervalue",_.bind((function(t,e){this.onEditActionItem(t,null,e)}),this)),this.searchInput=this.$window.find("#search-input"),this.searchInput.on("input",_.bind(this.onInputSearch,this)),this.resetAllBtn=new Common.UI.Button({el:this.$window.find("#reset-all-btn")}),this.resetAllBtn.on("click",_.bind(this.onResetAll,this)),Common.NotificationCenter.on("shortcuts:update",_.bind((function(){this._setDefaults(),this.shortcutsEditDialog&&this.shortcutsEditDialog.renderShortcutsWarning()}),this)),this._setDefaults()},getFocusedComponents:function(){return[this.searchInput,this.resetAllBtn,this.actionsList]},getDefaultFocusableComponent:function(){return this.actionsList},_setDefaults:function(){this._updateActionsList()},_getActionsMap:function(){return this._shortcutsController.getActionsMap()},_updateActionsList:function(){const t=this.actionsList.store.findIndex((function(t){return t.get("selected")})),e=this.actionsList.scroller.getScrollTop();this._state.searchValue?this._filterActionsList():this.actionsList.store.reset(_.values(this._getActionsMap())),this.actionsList.scroller.scrollTop(e),-1!=t&&this.actionsList.selectByIndex(t)},_filterActionsList:function(){let t;const e=this,i=_.values(this._getActionsMap());t=e._state.searchValue?i.filter((function(t){return(t.action.name||"").toLowerCase().includes(e._state.searchValue)})):i,this.actionsList.store.reset(t)},onSelectActionItem:function(t,e,i,s){const n=i?i.get("action").description:"";this.$window.find("#action-description-text").text(n)},onClickActionItem:function(t,e,i,s){($(s.target).hasClass("action-edit")||$(s.target).parent().hasClass("action-edit"))&&this.onEditActionItem(t,e,i)},onEditActionItem:function(t,e,i){if(i.get("action").isLocked)return;const s=this;this.shortcutsEditDialog=new Common.Views.ShortcutsEditDialog({action:i.get("action")}),this.shortcutsEditDialog.show(),this.shortcutsEditDialog.on("close",(function(){s.shortcutsEditDialog=null,s.actionsList.focus()}))},onInputSearch:function(t){this._state.searchValue=$(t.target).val().toLowerCase().trim(),this._filterActionsList(),this.onSelectActionItem(null,null,null)},onResetAll:function(){const t=this;Common.UI.warning({title:this.txtRestoreToDefault,msg:this.txtRestoreDescription+"<br/>"+this.txtRestoreContinue,buttons:["ok","cancel"],width:400,callback:function(e){"ok"==e&&t._shortcutsController.resetAllShortcuts()}})},onDlgBtnClick:function(t){let e="object"==typeof t?t.currentTarget.attributes.result.value:t;"ok"==e&&this.handler&&this.handler.call(this,e,"ok"==e?null:void 0),this.close()},onPrimary:function(){return this.onDlgBtnClick("ok"),!1},txtTitle:"Keyboard Shortcuts",txtDescription:"Description",txtEmpty:"No matches found. Adjust your search.",txtSearch:"Search",txtRestoreAll:"Restore All to Defaults",txtRestoreToDefault:"Restore to default",txtRestoreDescription:"All shortcuts settings will be restored to deafult.",txtRestoreContinue:"Do you want to continue?"},Common.Views.ShortcutsDialog||{}))})),define("common/main/lib/view/ShortcutsEditDialog",["common/main/lib/view/AdvancedSettingsWindow"],(function(){"use strict";Common.Views.ShortcutsEditDialog=Common.Views.AdvancedSettingsWindow.extend(_.extend({options:{height:"auto",contentWidth:268,contentHeight:"auto",separator:!1},initialize:function(t){_.extend(this.options,{id:"shortcut-edit-gialog",title:this.txtTitle,contentStyle:"padding: 16px 16px 0;",contentTemplate:_.template(['<div class="settings-panel active">','<label id="action-label">',"<span><%= scope.txtAction %>: </span>",'<span id="action-label-name"><%= options.action.name %></span>',"</label>",'<div id="shortcuts-list"></div>','<div id="buttons-row">','<label id="new-shortcut-btn" class="link"><%= scope.txtNewShortcut %></label>','<label id="reset-btn" class="link"><%= scope.txtRestoreToDefault %></label>',"</div>","</div>"].join(""))({scope:this,options:t})},t);const e=window.DE||window.PE||window.SSE||window.PDFE||window.VE;this._shortcutsController=e.getController("Common.Controllers.Shortcuts"),this._prevKeysForActiveInput=[],Common.Views.AdvancedSettingsWindow.prototype.initialize.call(this,this.options)},render:function(){Common.Views.AdvancedSettingsWindow.prototype.render.call(this),this.newShortcutsBtn=this.$window.find("#new-shortcut-btn"),this.newShortcutsBtn.on("click",_.bind(this.onAddShortcut,this)),this.resetBtn=this.$window.find("#reset-btn"),this.resetBtn.on("click",_.bind(this.onReset,this)),this.scrollerOptions={el:this.$window.find("#shortcuts-list"),wheelSpeed:8,alwaysVisibleY:!0},this.scroller=new Common.UI.Scroller(this.scrollerOptions),this._setDefaults()},getFocusedComponents:function(){const t=[];return this.shortcutsCollection.each((function(e){e.get("removeBtn")&&t.push(e.get("keysInput"),e.get("removeBtn"))})),t.concat(this.getFooterButtons())},getDefaultFocusableComponent:function(){const t=this.shortcutsCollection.find((function(t){return t.get("removeBtn")}));return t?t.get("keysInput"):this.getFooterButtons()[0]},_setDefaults:function(){this.shortcutsCollection=new Backbone.Collection([]),this.shortcutsCollection.on("reset",(function(t,e){this._renderShortcutsList(e.previousModels)}),this),this.shortcutsCollection.on("add",(function(t,e){const i=e.filter((function(e){return e!=t}));this._renderShortcutsList(i)}),this),this.shortcutsCollection.on("remove",(function(t,e){const i=e.toArray();i.push(t),this._renderShortcutsList(i)}),this),this.shortcutsCollection.on("add remove reset change:keys",this.renderShortcutsWarning,this);let t=_.filter(this._getOriginalShortcuts(),(function(t){return!t.ascShortcut.asc_IsHidden()}));t=t.map((function(t){const e=new Asc.CAscShortcut;return e.asc_FromJson(t.ascShortcut.asc_ToJson()),{keys:t.keys,ascShortcut:e}})),this.shortcutsCollection.reset(t),0==this.shortcutsCollection.length&&this.onAddShortcut()},_getActionsMap:function(){return this._shortcutsController.getActionsMap()},_getOriginalShortcuts:function(){return this._getActionsMap()[this.options.action.type].shortcuts},_isDefaultShortcut:function(t){const e=t.asc_GetShortcutIndex();return _.some(Asc.c_oAscDefaultShortcuts[t.asc_GetType()],(function(t){return e==t.asc_GetShortcutIndex()}))},_findAssignedActions:function(t,e){const i=t.asc_GetShortcutIndex(),s=[],n=_.values(this._getActionsMap());for(let t=0;t<n.length;t++){const a={action:n[t].action,shortcuts:n[t].shortcuts};e&&e.actionType===a.action.type&&(a.shortcuts=e.shortcuts);const o=_.find(a.shortcuts,(function(t){return t.ascShortcut.asc_GetShortcutIndex()==i&&!t.ascShortcut.asc_IsHidden()}));o&&s.push({action:a.action,shortcut:o})}return s},_getDefaultShortcuts:function(){const t=this;return Asc.c_oAscDefaultShortcuts[this.options.action.type].map((function(e){const i=new Asc.CAscShortcut;return i.asc_FromJson(e.asc_ToJson()),i.asc_SetIsHidden(!1),{keys:t._shortcutsController._getAscShortcutKeys(i),ascShortcut:i}}))},_renderShortcutsList:function(t){const e=this;this.$window.find("#shortcuts-list").empty(),this.shortcutsCollection.each((function(t,i){const s=t.get("ascShortcut"),n=s.asc_IsLocked(),a=t.get("keys").join(" + "),o=$('<div class="item '+(0==i?"first":"")+'"><div class="keys-input"></div>'+(n?'<i class="lock-info-icon icon toolbar__icon btn-menu-about">&nbsp;</i>':'<button type="button" class="btn-toolbar remove-btn"><i class="icon toolbar__icon btn-cc-remove">&nbsp;</i></button>')+"</div>");e.$window.find("#shortcuts-list").append(o);const l=new Common.UI.InputField({el:o.find(".keys-input"),value:a,editable:!1,placeHolder:e.txtInputPlaceholder,disabled:n});let r;n?o.find(".lock-info-icon").tooltip({title:e.txtCantBeEdited,placement:"cursor",zIndex:parseInt(e.$window.css("z-index"))+10}):r=new Common.UI.Button({el:o.find(".remove-btn")}),t.set({keysInput:l,removeBtn:r});const c=o.find(".keys-input input");c.on("keydown",(function(i){const n=[Common.UI.Keys.F1,Common.UI.Keys.F2,Common.UI.Keys.F3,Common.UI.Keys.F4,Common.UI.Keys.F5,Common.UI.Keys.F6,Common.UI.Keys.F7,Common.UI.Keys.F8,Common.UI.Keys.F9,Common.UI.Keys.F10,Common.UI.Keys.F11,Common.UI.Keys.F12,Common.UI.Keys.INSERT,Common.UI.Keys.HOME,Common.UI.Keys.PAGEUP,Common.UI.Keys.DELETE,Common.UI.Keys.END,Common.UI.Keys.PAGEDOWN,Common.UI.Keys.LEFT,Common.UI.Keys.UP,Common.UI.Keys.RIGHT,Common.UI.Keys.DOWN],a=[Common.UI.Keys.ESC,Common.UI.Keys.TAB];if(Common.Utils.isMac||a.push(91),a.includes(i.keyCode))return void(i.keyCode==Common.UI.Keys.TAB&&e._prevKeysForActiveInput.length&&(t.set("keys",e._prevKeysForActiveInput),o.find("input").val(e._prevKeysForActiveInput.join(" + "))));if(i.stopPropagation(),i.preventDefault(),!(n.includes(i.keyCode)||i.ctrlKey||i.shiftKey||i.altKey||i.metaKey&&Common.Utils.isMac))return;const l=[];if(i.ctrlKey&&l.push("Ctrl"),i.shiftKey&&l.push("Shift"),i.altKey&&l.push("Alt"),i.metaKey&&Common.Utils.isMac&&l.push(""),[Common.UI.Keys.CTRL,Common.UI.Keys.SHIFT,Common.UI.Keys.ALT,91].includes(i.keyCode))s.asc_SetKeyCode(null);else{const t=window.DE||window.PE||window.SSE||window.PDFE||window.VE;l.push(t.getController("Common.Controllers.Shortcuts").keyCodeToKeyName(i.keyCode)),s.asc_SetKeyCode(i.keyCode)}s.asc_SetIsCtrl(!!i.ctrlKey),s.asc_SetIsShift(!!i.shiftKey),s.asc_SetIsAlt(!!i.altKey),s.asc_SetIsCommand(!!i.metaKey&&Common.Utils.isMac),t.set("keys",l),o.find("input").val(l.join(" + "))}));const d=function(e){const i=["Ctrl","Shift","Alt",""],s=t.get("keys");if(!_.some(s,(function(t){return!_.contains(i,t)}))&&e&&e.length){const i=s.filter((function(t){return!_.contains(e,t)}));t.set("keys",i),o.find("input").val(i.join(" + "))}};c.on("keyup",(function(i){const s={[Common.UI.Keys.CTRL]:"Ctrl",[Common.UI.Keys.ALT]:"Alt",[Common.UI.Keys.SHIFT]:"Shift",91:""}[i.keyCode];d(s?[s]:[]),s||(e._prevKeysForActiveInput=t.get("keys"))})),c.on("focusin",(function(){e._prevKeysForActiveInput=t.get("keys")})),c.on("focusout",(function(){e._prevKeysForActiveInput=[],d(t.get("keys"))})),o.find(".remove-btn").on("click",(function(){const i=e.shortcutsCollection.findIndex((function(e){return e==t}));e.shortcutsCollection.remove(t),0==e.shortcutsCollection.length&&e.onAddShortcut();let s=i<e.shortcutsCollection.length?i:i-1;e.shortcutsCollection.at(s).get("removeBtn")?e.shortcutsCollection.at(s).get("removeBtn").focus():e.getFooterButtons()[0].focus()}))})),this.fixHeight(!0),this.scroller.update(this.scrollerOptions),Common.UI.FocusManager.remove(this,0,2*t.length+2),Common.UI.FocusManager.add(this,this.getFocusedComponents())},renderShortcutsWarning:function(){const t=this;let e=!1;this.shortcutsCollection.each((function(i){const s=i.get("ascShortcut"),n=[],a=t._findAssignedActions(s,{actionType:t.options.action.type,shortcuts:t.shortcutsCollection.toJSON().slice(0,_.indexOf(t.shortcutsCollection.models,i))}),o=!t._isDefaultShortcut(s)&&_.some(a,(function(t){return t.action.isLocked||t.shortcut.ascShortcut.asc_IsLocked()}));e=e||o;for(let t=0;t<a.length;t++){const e=a[t].action,i=a[t].shortcut.ascShortcut;(e.isLocked||i.asc_IsLocked())==o&&n.push(""+e.name+"")}let l=null;1===n.length?l=o?"txtInputWarnOneLocked":"txtInputWarnOne":n.length>1&&(l=o?"txtInputWarnManyLocked":"txtInputWarnMany"),i.get("keysInput").showWarning(l?[t[l].replace("%1",n.join(", "))]:null)})),this.getFooterButtons()[0].setDisabled(e)},onAddShortcut:function(){const t=this.shortcutsCollection.at(this.shortcutsCollection.length-1);t&&!t.get("keys").length||this.shortcutsCollection.add({keys:[],ascShortcut:new Asc.CAscShortcut(this.options.action.type)}),this.$window.find("#shortcuts-list .item input").last().focus()},onReset:function(){const t=this;Common.UI.warning({title:this.txtRestoreToDefault,msg:this.txtRestoreDescription.replace("%1",t.options.action.name)+"<br/>"+this.txtRestoreContinue,buttons:["ok","cancel"],width:400,callback:function(e){if("ok"==e){const e=t._getDefaultShortcuts();t.shortcutsCollection.reset(e)}}})},onDlgBtnClick:function(t){if("ok"==("object"==typeof t?t.currentTarget.attributes.result.value:t)){const t={},e=[];(this.shortcutsCollection.toJSON()||[]).forEach((function(i){if(!i.keys.length)return;let s=i.ascShortcut.asc_GetShortcutIndex();t[s]||(t[s]=!0,e.push({keys:i.keys,ascShortcut:i.ascShortcut}))})),this._shortcutsController.updateShortcutsForAction(this.options.action.type,e)}this.close()},onPrimary:function(){return this.onDlgBtnClick("ok"),!1},txtTitle:"Edit shortcut",txtAction:"Action",txtInputPlaceholder:"Type desired shortcut",txtInputWarnOne:"The shortcut used by action %1",txtInputWarnOneLocked:"The shortcut used by action %1 and cant be changed",txtInputWarnMany:"The shortcut used by actions %1",txtInputWarnManyLocked:"The shortcut used by actions %1 and cant be changed",txtNewShortcut:"New shortcut",txtRestoreToDefault:"Restore to default",txtTypeDesiredShortcut:"Type desired shortcut",txtRestoreDescription:"All shortcuts for action %1 will be restored to deafult.",txtRestoreContinue:"Do you want to continue?",txtCantBeEdited:"This shortcut cant be edited"},Common.Views.ShortcutsEditDialog||{}))})),define("pdfeditor/main/app/controller/DocumentHolderExt",[],(function(){"use strict";if(window.PDFE&&window.PDFE.Controllers&&window.PDFE.Controllers.DocumentHolder){let t=window.PDFE.Controllers.DocumentHolder.prototype;t.checkEditorOffsets=function(){if(_.isUndefined(this._XY)){let t=this.documentHolder.cmpEl;this._XY=[Common.Utils.getOffset(t).left-$(window).scrollLeft(),Common.Utils.getOffset(t).top-$(window).scrollTop()],this._Width=t.width(),this._Height=t.height(),this._BodyWidth=$("body").width()}},t.setEvents=function(){this.addListeners({DocumentHolder:{createdelayedelements:this.createDelayedElements,"equation:callback":this.equationCallback},FileMenu:{"settings:apply":_.bind(this.applySettings,this)}}),this.api&&(this.api.asc_registerCallback("asc_onContextMenu",_.bind(this.onContextMenu,this)),this.api.asc_registerCallback("asc_onMouseMoveStart",_.bind(this.onMouseMoveStart,this)),this.api.asc_registerCallback("asc_onMouseMoveEnd",_.bind(this.onMouseMoveEnd,this)),this.api.asc_registerCallback("asc_onMouseMove",_.bind(this.onMouseMove,this)),!0===this.mode.isEdit&&(this.api.asc_registerCallback("asc_onHideEyedropper",_.bind(this.hideEyedropper,this)),this.api.asc_registerCallback("asc_onShowPDFFormsActions",_.bind(this.onShowFormsPDFActions,this)),this.api.asc_registerCallback("asc_onHidePdfFormsActions",_.bind(this.onHidePdfFormsActions,this)),this.mode.canComments&&(this.api.asc_registerCallback("asc_onShowAnnotTextPrTrack",_.bind(this.onShowTextBar,this)),this.api.asc_registerCallback("asc_onHideAnnotTextPrTrack",_.bind(this.onHideTextBar,this)),this.api.asc_registerCallback("asc_onShowTextSelectTrack",_.bind(this.onShowAnnotBar,this)),this.api.asc_registerCallback("asc_onHideTextSelectTrack",_.bind(this.onHideAnnotBar,this)),this.api.asc_registerCallback("asc_onShowAnnotSelectTrack",_.bind(this.onShowAnnotSelectBar,this)),this.api.asc_registerCallback("asc_onHideAnnotSelectTrack",_.bind(this.onHideAnnotSelectBar,this)))),this.mode.isRestrictedEdit&&(this.api.asc_registerCallback("asc_onShowContentControlsActions",_.bind(this.onShowContentControlsActions,this)),this.api.asc_registerCallback("asc_onHideContentControlsActions",_.bind(this.onHideContentControlsActions,this)),Common.Gateway.on("insertimage",_.bind(this.insertImage,this)),Common.NotificationCenter.on("storage:image-load",_.bind(this.openImageFromStorage,this)),Common.NotificationCenter.on("storage:image-insert",_.bind(this.insertImageFromStorage,this))),this.api.asc_registerCallback("asc_onCoAuthoringDisconnect",_.bind(this.onCoAuthoringDisconnect,this)),Common.NotificationCenter.on("api:disconnect",_.bind(this.onCoAuthoringDisconnect,this)),this.api.asc_registerCallback("asc_onShowForeignCursorLabel",_.bind(this.onShowForeignCursorLabel,this)),this.api.asc_registerCallback("asc_onHideForeignCursorLabel",_.bind(this.onHideForeignCursorLabel,this)),this.api.asc_registerCallback("asc_onFocusObject",_.bind(this.onFocusObject,this)),this.api.asc_registerCallback("onPluginContextMenu",_.bind(this.onPluginContextMenu,this)))},t.createDelayedElements=function(t,e){var i=this;t=i.documentHolder;"pdf"===e?(t.menuViewCopyPage.on("click",_.bind(i.onCutCopyPaste,i)),t.menuPDFViewCopy.on("click",_.bind(i.onCutCopyPaste,i)),t.menuAddComment.on("click",_.bind(i.addComment,i)),t.menuRemoveComment.on("click",_.bind(i.removeComment,i))):"forms"===e?(t.menuPDFFormsUndo.on("click",_.bind(i.onUndo,i)),t.menuPDFFormsRedo.on("click",_.bind(i.onRedo,i)),t.menuPDFFormsClear.on("click",_.bind(i.onClear,i)),t.menuPDFFormsCut.on("click",_.bind(i.onCutCopyPaste,i)),t.menuPDFFormsCopy.on("click",_.bind(i.onCutCopyPaste,i)),t.menuPDFFormsPaste.on("click",_.bind(i.onCutCopyPaste,i))):"edit"===e&&(t.menuPDFEditCopy.on("click",_.bind(i.onCutCopyPaste,i)),t.menuEditAddComment.on("click",_.bind(i.addComment,i)),t.menuEditRemoveComment.on("click",_.bind(i.removeComment,i)),t.menuParaCopy.on("click",_.bind(i.onCutCopyPaste,i)),t.menuParaPaste.on("click",_.bind(i.onCutCopyPaste,i)),t.menuParaCut.on("click",_.bind(i.onCutCopyPaste,i)),t.menuImgCopy.on("click",_.bind(i.onCutCopyPaste,i)),t.menuImgPaste.on("click",_.bind(i.onCutCopyPaste,i)),t.menuImgCut.on("click",_.bind(i.onCutCopyPaste,i)),t.menuTableCopy.on("click",_.bind(i.onCutCopyPaste,i)),t.menuTablePaste.on("click",_.bind(i.onCutCopyPaste,i)),t.menuTableCut.on("click",_.bind(i.onCutCopyPaste,i)),t.menuAddHyperlinkPara.on("click",_.bind(i.addHyperlink,i)),t.menuAddHyperlinkTable.on("click",_.bind(i.addHyperlink,i)),t.menuEditHyperlinkPara.on("click",_.bind(i.editHyperlink,i)),t.menuEditHyperlinkTable.on("click",_.bind(i.editHyperlink,i)),t.menuRemoveHyperlinkPara.on("click",_.bind(i.removeHyperlink,i)),t.menuRemoveHyperlinkTable.on("click",_.bind(i.removeHyperlink,i)),t.menuChartEdit.on("click",_.bind(i.editChartClick,i,void 0)),t.menuImgSaveAsPicture.on("click",_.bind(i.saveAsPicture,i)),t.menuTableSaveAsPicture.on("click",_.bind(i.saveAsPicture,i)),t.menuAddCommentPara.on("click",_.bind(i.addComment,i)),t.menuAddCommentTable.on("click",_.bind(i.addComment,i)),t.menuAddCommentImg.on("click",_.bind(i.addComment,i)),t.mnuTableMerge.on("click",_.bind(i.onTableMerge,i)),t.mnuTableSplit.on("click",_.bind(i.onTableSplit,i)),t.menuTableCellAlign.menu.on("item:click",_.bind(i.tableCellsVAlign,i)),t.menuTableDistRows.on("click",_.bind(i.onTableDistRows,i)),t.menuTableDistCols.on("click",_.bind(i.onTableDistCols,i)),t.menuTableAdvanced.on("click",_.bind(i.onTableAdvanced,i)),t.menuImageAdvanced.on("click",_.bind(i.onImageAdvanced,i)),t.menuImgOriginalSize.on("click",_.bind(i.onImgOriginalSize,i)),t.menuImgShapeRotate.menu.items[0].on("click",_.bind(i.onImgRotate,i)),t.menuImgShapeRotate.menu.items[1].on("click",_.bind(i.onImgRotate,i)),t.menuImgShapeRotate.menu.items[3].on("click",_.bind(i.onImgFlip,i)),t.menuImgShapeRotate.menu.items[4].on("click",_.bind(i.onImgFlip,i)),t.menuImgCrop.menu.on("item:click",_.bind(i.onImgCrop,i)),t.menuImgResetCrop.on("click",_.bind(i.onImgResetCrop,i)),t.menuImgEditPoints.on("click",_.bind(i.onImgEditPoints,i)),t.menuShapeAdvanced.on("click",_.bind(i.onShapeAdvanced,i)),t.menuParagraphAdvanced.on("click",_.bind(i.onParagraphAdvanced,i)),t.menuChartAdvanced.on("click",_.bind(i.onChartAdvanced,i)),t.mnuGroupImg.on("click",_.bind(i.onGroupImg,i)),t.mnuUnGroupImg.on("click",_.bind(i.onUnGroupImg,i)),t.mnuArrangeFront.on("click",_.bind(i.onArrangeFront,i)),t.mnuArrangeBack.on("click",_.bind(i.onArrangeBack,i)),t.mnuArrangeForward.on("click",_.bind(i.onArrangeForward,i)),t.mnuArrangeBackward.on("click",_.bind(i.onArrangeBackward,i)),t.menuImgShapeAlign.menu.on("item:click",_.bind(i.onImgShapeAlign,i)),t.menuShapesMerge.menu.on("item:click",_.bind(i.onShapesMerge,i)),t.menuParagraphVAlign.menu.on("item:click",_.bind(i.onParagraphVAlign,i)),t.menuParagraphDirection.menu.on("item:click",_.bind(i.onParagraphDirection,i)),t.menuTableSelectText.menu.on("item:click",_.bind(i.tableSelectText,i)),t.menuTableInsertText.menu.on("item:click",_.bind(i.tableInsertText,i)),t.menuTableDeleteText.menu.on("item:click",_.bind(i.tableDeleteText,i)),t.menuTableEquationSettings.menu.on("item:click",_.bind(i.convertEquation,i)),t.menuParagraphEquation.menu.on("item:click",_.bind(i.convertEquation,i)),t.mnuNewPageBefore.on("click",_.bind(i.onNewPage,i)),t.mnuNewPageAfter.on("click",_.bind(i.onNewPage,i)),t.mnuDeletePage.on("click",_.bind(i.onDeletePage,i)),t.mnuRotatePageRight.on("click",_.bind(i.onRotatePage,i,90)),t.mnuRotatePageLeft.on("click",_.bind(i.onRotatePage,i,-90)),t.mnuCopyPage.on("click",_.bind(i.onCutCopyPaste,i)),t.mnuCutPage.on("click",_.bind(i.onCutCopyPaste,i)),t.mnuPastePageBefore.on("click",_.bind(i.onCutCopyPaste,i)),t.mnuPastePageAfter.on("click",_.bind(i.onCutCopyPaste,i)),t.menuChartElement.on("item:click",_.bind(i.onChartElement,i)),t.menuChartElement.menu.items.forEach((t=>{t.menu&&t.menu.items.forEach((t=>{t.on("click",(function(){i.onChartElement(t.menu,t)}))}))})),t.menuImgReplace.menu.on("item:click",_.bind(i.onImgReplace,i)))},t.applyEditorMode=function(){this.mode&&this.mode.isPDFEdit&&this._state.initEditorEvents&&Common.Controllers.LaunchController.isScriptLoaded()&&(this.initExternalEditors(),this.documentHolder.createDelayedElementsPDFEditor(),this._state.initEditorEvents=!1,this.api.asc_registerCallback("asc_onShowMathTrack",_.bind(this.onShowMathTrack,this)),this.api.asc_registerCallback("asc_onHideMathTrack",_.bind(this.onHideMathTrack,this)),this.api.asc_registerCallback("asc_onDialogAddHyperlink",_.bind(this.onDialogAddHyperlink,this)),this.api.asc_registerCallback("asc_ChangeCropState",_.bind(this.onChangeCropState,this)),this.api.asc_registerCallback("asc_doubleClickOnChart",_.bind(this.onDoubleClickOnChart,this)),this.api.asc_registerCallback("asc_onSingleChartSelectionChanged",_.bind(this.onSingleChartSelectionChanged,this)),this.api.asc_registerPlaceholderCallback(AscCommon.PlaceholderButtonType.Image,_.bind(this.onInsertImage,this)),this.api.asc_registerPlaceholderCallback(AscCommon.PlaceholderButtonType.ImageUrl,_.bind(this.onInsertImageUrl,this))),this.mode&&(this.mode.isPDFEdit?this.onHideTextBar():(this.onHideMathTrack(),this.onHideChartElementButton()))},t.fillViewMenuProps=function(t){var e=this.documentHolder;e.viewPDFModeMenu||e.createDelayedElementsPDFViewer();var i={};return t&&_.each(t,(function(t,e){var s=t.get_ObjectType(),n=t.get_ObjectValue();Asc.c_oAscTypeSelectElement.Annot==s?(i.annotProps={},i.annotProps.value=n):Asc.c_oAscTypeSelectElement.PdfPage==s&&(i.pageProps={},i.pageProps.value=n,i.pageProps.locked=!!n&&n.asc_getDeleteLock())})),{menu_to_show:e.viewPDFModeMenu,menu_props:i}},t.fillPDFEditMenuProps=function(t){var e=this.documentHolder;if(e.editPDFModeMenu||e.createDelayedElementsPDFEditor(),!t||!_.isArray(t)||t.length<1)return{menu_to_show:e.editPDFModeMenu,menu_props:{}};var i={},s=null;return _.each(t,(function(t,n){var a=t.get_ObjectType(),o=t.get_ObjectValue();Asc.c_oAscTypeSelectElement.Image==a?(s=e.pictureMenu,i.imgProps={},i.imgProps.value=o,i.imgProps.locked=!!o&&o.get_Locked()):Asc.c_oAscTypeSelectElement.Table==a?(s=e.tableMenu,i.tableProps={},i.tableProps.value=o,i.tableProps.locked=!!o&&o.get_Locked()):Asc.c_oAscTypeSelectElement.Hyperlink==a?(i.hyperProps={},i.hyperProps.value=o):Asc.c_oAscTypeSelectElement.Shape==a?(i.shapeProps={},i.shapeProps.value=o,i.shapeProps.locked=!!o&&o.get_Locked(),o.get_FromChart()&&(i.shapeProps.isChart=!0),s=i.paraProps&&i.paraProps.value&&o.asc_getCanEditText()?e.textMenu:e.pictureMenu):Asc.c_oAscTypeSelectElement.Chart==a?(s=e.pictureMenu,i.chartProps={},i.chartProps.value=o,i.chartProps.locked=!!o&&o.get_Locked()):Asc.c_oAscTypeSelectElement.Paragraph==a?(i.paraProps={},i.paraProps.value=o,i.paraProps.locked=!!o&&o.get_Locked(),i.shapeProps&&i.shapeProps.value&&i.shapeProps.value.asc_getCanEditText()&&(s=e.textMenu)):Asc.c_oAscTypeSelectElement.Math==a?(i.mathProps={},i.mathProps.value=o,e._currentMathObj=o):Asc.c_oAscTypeSelectElement.Annot==a?(s=e.editPDFModeMenu,i.annotProps={},i.annotProps.value=o):Asc.c_oAscTypeSelectElement.PdfPage==a&&(i.pageProps={},i.pageProps.value=o,i.pageProps.locked=!!o&&o.asc_getDeleteLock())})),null===s&&(_.isUndefined(i.paraProps)||(s=e.textMenu)),{menu_to_show:s,menu_props:i}},t.fillFormsMenuProps=function(t){if(t&&_.isArray(t)){var e=this.documentHolder;e.formsPDFMenu||e.createDelayedElementsPDFForms();for(var i={},s=!0,n=0;n<t.length;n++){var a=t[n].get_ObjectType(),o=t[n].get_ObjectValue();if(Asc.c_oAscTypeSelectElement.Image==a){i.imgProps={},i.imgProps.value=o,i.imgProps.locked=!!o&&o.get_Locked();var l=this.api.asc_IsContentControl()?this.api.asc_GetContentControlProperties():null,r=l?l.get_Lock():Asc.c_oAscSdtLockType.Unlocked;i.imgProps.content_locked=r==Asc.c_oAscSdtLockType.SdtContentLocked||r==Asc.c_oAscSdtLockType.ContentLocked,s=!1}else Asc.c_oAscTypeSelectElement.Paragraph==a?(i.paraProps={},i.paraProps.value=o,i.paraProps.locked=!!o&&o.get_Locked(),s=!1):Asc.c_oAscTypeSelectElement.Header==a&&(i.headerProps={},i.headerProps.locked=!!o&&o.get_Locked())}return s?null:{menu_to_show:e.formsPDFMenu,menu_props:i}}},t.onShowTextBar=function(t){if(!this.mode||!this.mode.isPDFEdit&&this.mode.isEdit)if(this.checkEditorOffsets(),this.lastTextBarBounds=t,t[3]<0||t[1]>this._Height)this.onHideTextBar();else{var e=this,i=e.documentHolder,s=i.cmpEl.find("#text-bar-container");if(s.length<1){e.textBarBtns=[],s=i.createTextBar(e.textBarBtns),i.cmpEl.append(s),i.cmbFontSize.options.menuAlignEl=i.cmbFontName.options.menuAlignEl=i.cmpEl;var n=function(t){s.addClass("has-open-menu")},a=function(t){s.removeClass("has-open-menu")};e.textBarBtns.forEach((function(t){t&&t.menu&&(t.menu.on("show:before",n),t.menu.on("hide:after",a))})),this.api.asc_registerCallback("asc_onFontSize",_.bind(this.onApiFontSize,this)),this.api.asc_registerCallback("asc_onBold",_.bind(this.onApiBold,this)),this.api.asc_registerCallback("asc_onItalic",_.bind(this.onApiItalic,this)),this.api.asc_registerCallback("asc_onUnderline",_.bind(this.onApiUnderline,this)),this.api.asc_registerCallback("asc_onStrikeout",_.bind(this.onApiStrikeout,this)),this.api.asc_registerCallback("asc_onVerticalAlign",_.bind(this.onApiVerticalAlign,this)),Common.NotificationCenter.on("fonts:change",_.bind(this.onApiChangeFont,this)),this.api.asc_registerCallback("asc_onTextColor",_.bind(this.onApiTextColor,this)),this.api.asc_registerCallback("asc_onPrAlign",_.bind(this.onApiParagraphAlign,this)),this.api.asc_registerCallback("asc_onTextDirection",_.bind(this.onApiTextDirection,this)),i.btnBold.on("click",_.bind(this.onBold,this)),i.btnItalic.on("click",_.bind(this.onItalic,this)),i.btnTextUnderline.on("click",_.bind(this.onTextUnderline,this)),i.btnTextStrikeout.on("click",_.bind(this.onTextStrikeout,this)),i.btnSuperscript.on("click",_.bind(this.onSuperscript,this)),i.btnSubscript.on("click",_.bind(this.onSubscript,this)),i.btnFontColor.on("click",_.bind(this.onBtnFontColor,this)),i.btnFontColor.on("color:select",_.bind(this.onSelectFontColor,this)),i.cmbFontSize.on("selected",_.bind(this.onFontSizeSelect,this)),i.cmbFontSize.on("changed:before",_.bind(this.onFontSizeChanged,this,!0)),i.cmbFontSize.on("changed:after",_.bind(this.onFontSizeChanged,this,!1)),i.cmbFontSize.on("show:after",_.bind(this.onComboOpen,this,!0)),i.cmbFontSize.on("hide:after",_.bind(this.onHideMenus,this)),i.cmbFontSize.on("combo:blur",_.bind(this.onComboBlur,this)),i.cmbFontSize.on("combo:focusin",_.bind(this.onComboOpen,this,!1)),i.cmbFontName.on("selected",_.bind(this.onFontNameSelect,this)),i.cmbFontName.on("show:after",_.bind(this.onComboOpen,this,!0)),i.cmbFontName.on("hide:after",_.bind(this.onHideMenus,this)),i.cmbFontName.on("combo:blur",_.bind(this.onComboBlur,this)),i.cmbFontName.on("combo:focusin",_.bind(this.onComboOpen,this,!1)),i.btnHorizontalAlign.menu.on("item:click",_.bind(this.onMenuHorizontalAlignSelect,this)),i.btnTextDir.menu.on("item:click",_.bind(this.onTextDirClick,this)),this.api.UpdateInterfaceState()}var o=[(t[0]+t[2])/2-s.outerWidth()/2,t[1]-s.outerHeight()-10];o[0]<0&&(o[0]=0),o[1]<0&&(o[1]=t[3]>e._Height?0:t[3]+10),o[1]=Math.min(e._Height-s.outerHeight(),Math.max(0,o[1])),s.css({left:o[0],top:o[1]});var l=e._Height-o[1]-s.outerHeight(),r=e._XY[1]+o[1],c=l<220&&l<.9*r?"bl-tl":"tl-bl";Common.UI.isRTL()&&(c="bl-tl"===c?"br-tr":"tr-br"),e.textBarBtns.forEach((function(t){t&&t.menu&&(t.menu.menuAlign=c)})),s.is(":visible")||s.show(),e.disableTextBar()}},t.onHideTextBar=function(){if(this.documentHolder&&this.documentHolder.cmpEl){var t=this.documentHolder.cmpEl.find("#text-bar-container");t.is(":visible")&&t.hide()}},t.disableTextBar=function(){var t=this.documentHolder.cmpEl.find("#text-bar-container"),e=this._isDisabled;t.length>0&&t.is(":visible")&&this.textBarBtns.forEach((function(t){t&&t.setDisabled(!!e)}))},t.onApiChangeFont=function(t){this.mode.isPDFAnnotate&&this.mode.isEdit&&(this._state.fontname=t,!Common.Utils.ModalWindow.isVisible()&&this.documentHolder.cmbFontName.onApiChangeFont(t))},t.onApiFontSize=function(t){this.mode.isPDFAnnotate&&this.mode.isEdit&&this._state.fontsize!==t&&(this.documentHolder.cmbFontSize.setValue(t),this._state.fontsize=t)},t.onApiBold=function(t){this.mode.isPDFAnnotate&&this.mode.isEdit&&this._state.bold!==t&&(this.documentHolder.btnBold.toggle(!0===t,!0),this._state.bold=t)},t.onApiItalic=function(t){this.mode.isPDFAnnotate&&this.mode.isEdit&&this._state.italic!==t&&(this.documentHolder.btnItalic.toggle(!0===t,!0),this._state.italic=t)},t.onApiUnderline=function(t){this.mode.isPDFAnnotate&&this.mode.isEdit&&this._state.underline!==t&&(this.documentHolder.btnTextUnderline.toggle(!0===t,!0),this._state.underline=t)},t.onApiStrikeout=function(t){this.mode.isPDFAnnotate&&this.mode.isEdit&&this._state.strike!==t&&(this.documentHolder.btnTextStrikeout.toggle(!0===t,!0),this._state.strike=t)},t.onApiVerticalAlign=function(t){this.mode.isPDFAnnotate&&this.mode.isEdit&&this._state.valign!==t&&(this.documentHolder.btnSuperscript.toggle(t==Asc.vertalign_SuperScript,!0),this.documentHolder.btnSubscript.toggle(t==Asc.vertalign_SubScript,!0),this._state.valign=t)},t.onApiTextColor=function(t){if(this.mode.isPDFAnnotate&&this.mode.isEdit){var e,i=this.documentHolder.mnuFontColorPicker;t&&(e=t.get_type()==Asc.c_oAscColor.COLOR_TYPE_SCHEME?{color:Common.Utils.ThemeColor.getHexColor(t.get_r(),t.get_g(),t.get_b()),effectValue:t.get_value()}:Common.Utils.ThemeColor.getHexColor(t.get_r(),t.get_g(),t.get_b()));var s=typeof e;(s!==typeof this._state.clrtext||"object"==s&&(e.effectValue!==this._state.clrtext.effectValue||this._state.clrtext.color.indexOf(e.color)<0)||"object"!=s&&this._state.clrtext.indexOf(e)<0)&&(Common.Utils.ThemeColor.selectPickerColorByEffect(e,i),this._state.clrtext=e),this._state.clrtext_asccolor=t}},t.onApiParagraphAlign=function(t){if(this.mode.isPDFAnnotate&&this.mode.isEdit&&this._state.pralign!==t){this._state.pralign=t;var e,i=-1,s=this.documentHolder.btnHorizontalAlign;switch(t){case 0:i=2,e="btn-align-right";break;case 1:i=0,e="btn-align-left";break;case 2:i=1,e="btn-align-center";break;case 3:i=3,e="btn-align-just";break;default:i=-255,e="btn-align-left"}i<0?-255==i&&s.menu.clearAll(!0):s.menu.items[i].setChecked(!0),s.rendered&&s.$icon&&(s.$icon.removeClass(s.options.icls).addClass(e),s.options.icls=e)}},t.onApiTextDirection=function(t){if(this.mode.isPDFAnnotate&&this.mode.isEdit){var e=this.documentHolder,i=e.btnTextDir.options.dirRtl,s=!!t;i!==s&&(e.btnTextDir.changeIcon({next:s?"btn-rtl":"btn-ltr",curr:i?"btn-rtl":"btn-ltr"}),e.btnTextDir.options.dirRtl=!!t)}},t.onBold=function(t,e){this._state.bold=void 0,this.api&&this.api.put_TextPrBold(t.pressed),Common.NotificationCenter.trigger("edit:complete",this.documentHolder)},t.onItalic=function(t,e){this._state.italic=void 0,this.api&&this.api.put_TextPrItalic(t.pressed),Common.NotificationCenter.trigger("edit:complete",this.documentHolder)},t.onTextUnderline=function(t,e){this._state.underline=void 0,this.api&&this.api.put_TextPrUnderline(t.pressed),Common.NotificationCenter.trigger("edit:complete",this.documentHolder)},t.onTextStrikeout=function(t,e){this._state.strike=void 0,this.api&&this.api.put_TextPrStrikeout(t.pressed),Common.NotificationCenter.trigger("edit:complete",this.documentHolder)},t.onSuperscript=function(t,e){this.documentHolder.btnSubscript.pressed||(this._state.valign=void 0,this.api&&this.api.put_TextPrBaseline(t.pressed?Asc.vertalign_SuperScript:Asc.vertalign_Baseline),Common.NotificationCenter.trigger("edit:complete",this.documentHolder))},t.onSubscript=function(t,e){this.documentHolder.btnSuperscript.pressed||(this._state.valign=void 0,this.api&&this.api.put_TextPrBaseline(t.pressed?Asc.vertalign_SubScript:Asc.vertalign_Baseline),Common.NotificationCenter.trigger("edit:complete",this.documentHolder))},t.onSelectFontColor=function(t,e){this._state.clrtext=this._state.clrtext_asccolor=void 0,this.documentHolder.btnFontColor.currentColor=e,this.documentHolder.btnFontColor.setColor("object"==typeof e?e.color:e),this.documentHolder.mnuFontColorPicker.currentColor=e,this.api&&this.api.put_TextColor(Common.Utils.ThemeColor.getRgbColor(e))},t.onBtnFontColor=function(){this.documentHolder.mnuFontColorPicker.trigger("select",this.documentHolder.mnuFontColorPicker,this.documentHolder.mnuFontColorPicker.currentColor||this.documentHolder.btnFontColor.currentColor)},t.onComboBlur=function(){Common.NotificationCenter.trigger("edit:complete",this.documentHolder)},t.onHideMenus=function(t){Common.NotificationCenter.trigger("edit:complete",this.documentHolder)},t.onFontNameSelect=function(t,e){this.api&&(e.isNewFont?!Common.Utils.ModalWindow.isVisible()&&Common.UI.warning({width:500,msg:this.documentHolder.confirmAddFontName,buttons:["yes","no"],primary:"yes",callback:_.bind((function(t){"yes"==t?this.api.put_TextPrFontName(e.name):this.documentHolder.cmbFontName.setValue(this.api.get_TextProps().get_TextPr().get_FontFamily().get_Name()),Common.NotificationCenter.trigger("edit:complete",this.documentHolder)}),this)}):this.api.put_TextPrFontName(e.name)),Common.NotificationCenter.trigger("edit:complete",this.documentHolder)},t.onComboOpen=function(t,e,i,s){s&&s.fromKeyDown||_.delay((function(){var i=$("input",e.cmpEl).select();t?i.focus():e.isMenuOpen()||i.one("mouseup",(function(t){t.preventDefault()}))}),10)},t.onFontSizeSelect=function(t,e){this._state.fontsize=void 0,this.api&&this.api.put_TextPrFontSize(e.value),Common.NotificationCenter.trigger("edit:complete",this.documentHolder)},t.onFontSizeChanged=function(t,e,i,s){var n,a=this;if(t){if(!e.store.findWhere({displayValue:i.value})&&!(n=/^\+?(\d*(\.|,).?\d+)$|^\+?(\d+(\.|,)?\d*)$/.exec(i.value)))return n=this._getApiTextSize(),setTimeout((function(){Common.UI.warning({msg:a.documentHolder.textFontSizeErr,callback:function(){_.defer((function(t){$("input",e.cmpEl).focus()}))}})}),1),e.setRawValue(n),s.preventDefault(),!1}else n=(n=Common.Utils.String.parseFloat(i.value))>300?300:n<1?1:Math.floor(2*(n+.4))/2,e.setRawValue(n),this._state.fontsize=void 0,this.api&&this.api.put_TextPrFontSize(n),Common.NotificationCenter.trigger("edit:complete",this.documentHolder)},t.onTextDirClick=function(t,e){this.api&&this.api.asc_setRtlTextDirection(!!e.value),Common.NotificationCenter.trigger("edit:complete",this.documentHolder)},t.onMenuHorizontalAlignSelect=function(t,e){this._state.pralign=void 0;var i=this.documentHolder.btnHorizontalAlign;i.$icon.removeClass(i.options.icls),i.options.icls=e.checked?e.options.icls:"btn-align-left",i.$icon.addClass(i.options.icls),this.api&&e.checked&&this.api.put_PrAlign(e.value),Common.NotificationCenter.trigger("edit:complete",this.documentHolder)},t._getApiTextSize=function(){var t=12,e=this.api.get_TextProps();return e&&e.get_TextPr&&(t=e.get_TextPr().get_FontSize()),t},t.onShowAnnotBar=function(t,e){if(!this.mode||this.mode.isEdit)if(this.checkEditorOffsets(),this.lastAnnotBarBounds=t,void 0!==e&&(this.lastAnnotBarOnTop=e),t[3]<0||t[1]>this._Height||!Common.Utils.InternalSettings.get("pdfe-settings-annot-bar"))this.onHideAnnotBar();else{var i=this,s=i.documentHolder,n=s.cmpEl.find("#annot-bar-container");if(n.length<1){i.annotBarBtns=[],n=s.createAnnotBar(i.annotBarBtns),s.cmpEl.append(n);var a=function(t){n.addClass("has-open-menu")},o=function(t){n.removeClass("has-open-menu")};i.annotBarBtns.forEach((function(t){t&&t.menu&&(t.menu.on("show:before",a),t.menu.on("hide:after",o))})),s.btnCopy.on("click",_.bind(this.onCutCopyPaste,this,{value:"copy",isFromBar:!0})),s.btnAddComment.on("click",_.bind(this.addComment,this,{isFromBar:!0})),i.mode.isEditTextSupport&&(i.mode.isPDFAnnotate&&i.mode.canPDFEdit||i.mode.isPDFEdit)?s.btnEditText.on("click",_.bind(this.editText,this)):s.btnEditText.cmpEl.parent().hide().prev(".separator").hide(),this.api.UpdateInterfaceState()}var l=[(t[0]+t[2])/2-n.outerWidth()/2,i.lastAnnotBarOnTop?t[1]-n.outerHeight()-10:t[3]+10];l[0]<0&&(l[0]=0),l[1]=Math.min(i._Height-n.outerHeight(),Math.max(0,l[1])),n.css({left:l[0],top:l[1]});var r=i._Height-l[1]-n.outerHeight(),c=i._XY[1]+l[1],d=r<220&&r<.9*c?"bl-tl":"tl-bl";Common.UI.isRTL()&&(d="bl-tl"===d?"br-tr":"tr-br"),i.annotBarBtns.forEach((function(t){t&&t.menu&&(t.menu.menuAlign=d)})),n.is(":visible")||n.show(),i.disableAnnotBar()}},t.onHideAnnotBar=function(){if(this.documentHolder&&this.documentHolder.cmpEl){var t=this.documentHolder.cmpEl.find("#annot-bar-container");t.is(":visible")&&t.hide()}},t.disableAnnotBar=function(){var t=this.documentHolder.cmpEl.find("#annot-bar-container"),e=this._isDisabled;t.length>0&&t.is(":visible")&&(this.annotBarBtns.forEach((function(t){t&&t.setDisabled(!!e)})),this.documentHolder.btnCopy&&this.documentHolder.btnCopy.setDisabled(!this.api.can_CopyCut()||!!e))},t.onShowAnnotSelectBar=function(t,e){if(!this.mode||this.mode.isEdit)if(this.checkEditorOffsets(),this.lastAnnotSelBarBounds=t,void 0!==e&&(this.lastAnnotSelBarOnTop=e),t[3]<0||t[1]>this._Height||!Common.Utils.InternalSettings.get("pdfe-settings-annot-sel-bar"))this.onHideAnnotSelectBar();else{var i=this,s=i.documentHolder,n=s.cmpEl.find("#annot-sel-bar-container");if(n.length<1){i.annotSelectBarBtns=[],n=s.createAnnotSelectBar(i.annotSelectBarBtns),s.cmpEl.append(n);var a=function(t){n.addClass("has-open-menu")},o=function(t){n.removeClass("has-open-menu")};i.annotSelectBarBtns.forEach((function(t){t&&t.menu&&(t.menu.on("show:before",a),t.menu.on("hide:after",o))})),s.btnRemAnnot.on("click",_.bind(this.removeComment,this)),s.btnAddAnnotComment.on("click",_.bind(this.addComment,this,{isFromSelBar:!0})),s.mnuStrokeHighlightColorPicker.on("select",_.bind(this.onSelectStrokeColor,this,s.btnStrokeHighlightColor)),s.mnuStrokeColorPicker.on("select",_.bind(this.onSelectStrokeColor,this,s.btnStrokeColor)),s.btnStrokeColor.menu.on("show:after",_.bind(this.onStrokeShowAfter,this)),s.btnStrokeHighlightColor.menu.on("show:after",_.bind(this.onStrokeShowAfter,this)),this.api.UpdateInterfaceState()}var l=this.api.getSelectedElements(),r=AscPDF.ANNOTATIONS_TYPES.Highlight;l&&_.isArray(l)&&_.each(l,(function(t,e){l[e].get_ObjectType()==Asc.c_oAscTypeSelectElement.Annot&&(r=l[e].get_ObjectValue().asc_getType())})),s.btnStrokeHighlightColor.setVisible(r===AscPDF.ANNOTATIONS_TYPES.Highlight),s.btnStrokeColor.setVisible(r!==AscPDF.ANNOTATIONS_TYPES.Highlight);var c=this.api.GetAnnotStrokeColor(),d=r===AscPDF.ANNOTATIONS_TYPES.Highlight?s.btnStrokeHighlightColor:s.btnStrokeColor;c=Common.Utils.ThemeColor.getHexColor(c.r,c.g,c.b),d.currentColor=c,d.setColor(d.currentColor),d.getPicker().select(d.currentColor,!0);var h=[(t[0]+t[2])/2-n.outerWidth()/2,i.lastAnnotSelBarOnTop?t[1]-n.outerHeight()-10:t[3]+10];h[0]<0&&(h[0]=0),h[1]=Math.min(i._Height-n.outerHeight(),Math.max(0,h[1]));var p=this.getApplication().getController("Common.Controllers.Comments").getPopover();if(p&&p.isVisible()){t={left:p.getLeft(),right:p.getLeft()+p.getWidth(),top:p.getTop(),bottom:p.getTop()+p.getHeight()};var m=h[0]+n.outerWidth(),u=h[1]+n.outerHeight();(m>t.left&&m<t.right||h[0]>t.left&&h[0]<t.right)&&(h[1]>t.top&&h[1]<t.bottom||u>t.top&&u<t.bottom)&&(h[0]=Common.UI.isRTL()?t.right:t.left-n.outerWidth())}n.css({left:h[0],top:h[1]});var g=i._Height-h[1]-n.outerHeight(),b=i._XY[1]+h[1],f=g<220&&g<.9*b?"bl-tl":"tl-bl";Common.UI.isRTL()&&(f="bl-tl"===f?"br-tr":"tr-br"),i.annotSelectBarBtns.forEach((function(t){t&&t.menu&&(t.menu.menuAlign=f)})),n.is(":visible")||n.show(),i.disableAnnotSelectBar()}},t.onHideAnnotSelectBar=function(){if(this.documentHolder&&this.documentHolder.cmpEl){var t=this.documentHolder.cmpEl.find("#annot-sel-bar-container");t.is(":visible")&&t.hide()}},t.disableAnnotSelectBar=function(){var t=this.documentHolder.cmpEl.find("#annot-sel-bar-container"),e=this._isDisabled;t.length>0&&t.is(":visible")&&this.annotSelectBarBtns.forEach((function(t){t&&t.setDisabled(!!e)}))},t.onShowMathTrack=function(t){if(!this.mode||this.mode.isPDFEdit&&this.mode.isEdit)if(this.lastMathTrackBounds=t,Common.Controllers.LaunchController.isScriptLoaded())if(t[3]<0||Common.Utils.InternalSettings.get("pdfe-equation-toolbar-hide"))this.onHideMathTrack();else{var e=this,i=e.documentHolder,s=i.cmpEl.find("#equation-container");if(s.length<1){var n=e.getApplication().getCollection("EquationGroups"),a='<div id="equation-container" style="position: absolute;">';e.getApplication().getController("InsTab").onMathTypes(e.getApplication().getController("Toolbar")._equationTemp),e.equationBtns=[];for(var o=0;o<n.length;++o)a+='<span id="id-document-holder-btn-equation-'+o+'"></span>';a+='<div class="separator"></div>',a+='<span id="id-document-holder-btn-equation-settings"></span>',a+="</div>",s=$(a),i.cmpEl.append(s);var l=function(t){var i=t.options.value,s=n.at(i);new Common.UI.DataViewSimple({el:$("#id-document-holder-btn-equation-menu-"+i,t.cmpEl),parentMenu:t,store:s.get("groupStore"),scrollAlwaysVisible:!0,showLast:!1,restoreHeight:450,itemTemplate:_.template('<div class="item-equation" style="" ><div class="equation-icon" style="background-position:<%= posX %>px <%= posY %>px;width:<%= width %>px;height:<%= height %>px;" id="<%= id %>"></div></div>')}).on("item:click",(function(t,i,s,n){e.api&&s&&e.api.asc_AddMath(s.get("data").equationType)})),t.off("show:before",l)},r=function(t){s.addClass("has-open-menu")},c=function(t){s.removeClass("has-open-menu")};for(o=0;o<n.length;++o){var d=n.at(o),h=new Common.UI.Button({parentEl:$("#id-document-holder-btn-equation-"+o,i.cmpEl),cls:"btn-toolbar no-caret",iconCls:"svgicon "+d.get("groupIcon"),hint:d.get("groupName"),menu:new Common.UI.Menu({value:o,items:[{template:_.template('<div id="id-document-holder-btn-equation-menu-'+o+'" class="menu-shape margin-left-5" style="width:'+(d.get("groupWidth")+8)+"px; "+d.get("groupHeightStr")+'"></div>')}]})});h.menu.on("show:before",l),h.menu.on("show:before",r),h.menu.on("hide:after",c),e.equationBtns.push(h)}e.equationSettingsBtn=new Common.UI.Button({parentEl:$("#id-document-holder-btn-equation-settings",i.cmpEl),cls:"btn-toolbar no-caret",iconCls:"toolbar__icon btn-more-vertical",hint:e.documentHolder.advancedEquationText,menu:e.documentHolder.createEquationMenu("popuptbeqinput","tl-bl")}),e.equationSettingsBtn.menu.options.initMenu=function(){var t=e.api.asc_GetMathInputType(),i=e.equationSettingsBtn.menu,s=Common.Utils.InternalSettings.get("pdfe-equation-toolbar-hide");i.items[5].setChecked(t===Asc.c_oAscMathInputType.Unicode),i.items[6].setChecked(t===Asc.c_oAscMathInputType.LaTeX),i.items[8].options.isToolbarHide=s,i.items[8].setCaption(s?e.documentHolder.showEqToolbar:e.documentHolder.hideEqToolbar,!0)},e.equationSettingsBtn.menu.on("item:click",_.bind(e.convertEquation,e)),e.equationSettingsBtn.menu.on("show:before",(function(t){r(),t.options.initMenu()})),e.equationSettingsBtn.menu.on("hide:after",c)}var p=[(t[0]+t[2])/2-s.outerWidth()/2,t[1]-s.outerHeight()-10];p[0]<0&&(p[0]=0),p[1]<0&&(p[1]=t[3]+10),p[1]=Math.min(e._Height-s.outerHeight(),Math.max(0,p[1])),s.css({left:p[0],top:p[1]}),e.checkEditorOffsets();var m=e._Height-p[1]-s.outerHeight(),u=e._XY[1]+p[1],g=m<220&&m<.9*u?"bl-tl":"tl-bl";Common.UI.isRTL()&&(g="bl-tl"===g?"br-tr":"tr-br"),e.equationBtns.forEach((function(t){t&&(t.menu.menuAlign=g)})),e.equationSettingsBtn.menu.menuAlign=g,s.is(":visible")?e.equationSettingsBtn.menu.isVisible()&&(e.equationSettingsBtn.menu.options.initMenu(),e.equationSettingsBtn.menu.alignPosition()):s.show(),e.disableEquationBar()}else this.showMathTrackOnLoad=!0},t.onHideMathTrack=function(){if(this.documentHolder&&this.documentHolder.cmpEl)if(Common.Controllers.LaunchController.isScriptLoaded()){var t=this.documentHolder.cmpEl.find("#equation-container");t.is(":visible")&&t.hide()}else this.showMathTrackOnLoad=!1},t.disableEquationBar=function(){var t=this.documentHolder.cmpEl.find("#equation-container"),e=this._isDisabled||this._state.equationLocked;t.length>0&&t.is(":visible")&&(this.equationBtns.forEach((function(t){t&&t.setDisabled(!!e)})),this.equationSettingsBtn.setDisabled(!!e))},t.convertEquation=function(t,e,i){this.api&&("input"==e.options.type?(this.api.asc_SetMathInputType(e.value),Common.localStorage.setBool("pdfe-equation-input-latex",e.value===Asc.c_oAscMathInputType.LaTeX)):"view"==e.options.type?this.api.asc_ConvertMathView(e.value.linear,e.value.all):"hide"==e.options.type&&(e.options.isToolbarHide=!e.options.isToolbarHide,Common.Utils.InternalSettings.set("pdfe-equation-toolbar-hide",e.options.isToolbarHide),Common.localStorage.setBool("pdfe-equation-toolbar-hide",e.options.isToolbarHide),e.options.isToolbarHide?this.onHideMathTrack():this.onShowMathTrack(this.lastMathTrackBounds)))},t.onMouseMove=function(t){var e=this,i=(e.documentHolder.cmpEl,e.screenTip);if(this.checkEditorOffsets(),t){var s,n,a=t.get_Type();if(a==Asc.c_oAscMouseMoveDataTypes.Hyperlink||a==Asc.c_oAscMouseMoveDataTypes.Eyedropper||a==Asc.c_oAscMouseMoveDataTypes.Form){if(e.isTooltipHiding)return void(e.mouseMoveData=t);if(a==Asc.c_oAscMouseMoveDataTypes.Hyperlink){var o=t.get_Hyperlink();if(!o)return;(n=_.isEmpty(o.get_ToolTip())?o.get_Value():o.get_ToolTip()).length>256&&(n=n.substr(0,256)+"...")}else if(a==Asc.c_oAscMouseMoveDataTypes.Form)(n=t.get_FormHelpText()).length>1e3&&(n=n.substr(0,1e3)+"...");else if(a==Asc.c_oAscMouseMoveDataTypes.Eyedropper){if(e.eyedropperTip.isTipVisible&&(e.eyedropperTip.isTipVisible=!1,e.eyedropperTip.toolTip.hide()),!e.eyedropperTip.toolTip){var l=$('<div id="tip-container-eyedroppertip" style="position: absolute; z-index: 10000;"></div>');e.documentHolder.cmpEl.append(l),e.eyedropperTip.toolTip=new Common.UI.Tooltip({owner:l,html:!0,cls:"eyedropper-tooltip"})}var r=t.get_EyedropperColor().asc_getColor(),c=r.get_r(),d=r.get_g(),h=r.get_b(),p=Common.Utils.ThemeColor.getHexColor(c,d,h);if(!e.eyedropperTip.eyedropperColor){var m=$(document.createElement("div"));m.addClass("eyedropper-color"),m.appendTo(document.body),e.eyedropperTip.eyedropperColor=m,$("#id_main_view").on("mouseleave",_.bind(e.hideEyedropper,e))}return e.eyedropperTip.eyedropperColor.css({backgroundColor:"#"+p,left:t.get_X()+e._XY[0]+23+"px",top:t.get_Y()+e._XY[1]-53+"px"}),e.eyedropperTip.isVisible=!0,e.eyedropperTip.tipInterval&&clearInterval(e.eyedropperTip.tipInterval),e.eyedropperTip.tipInterval=setInterval((function(){clearInterval(e.eyedropperTip.tipInterval),e.eyedropperTip.isVisible&&(n="<div>RGB ("+c+","+d+","+h+")</div><div>"+t.get_EyedropperColor().asc_getName()+"</div>",e.eyedropperTip.toolTip.setTitle(n),e.eyedropperTip.isTipVisible=!0,e.eyedropperTip.toolTip.show([-1e4,-1e4]),e.eyedropperTip.tipWidth=e.eyedropperTip.toolTip.getBSTip().$tip.width(),(s=[t.get_X(),t.get_Y()])[1]+=e._XY[1]-57,s[0]+=e._XY[0]+58,s[0]+e.eyedropperTip.tipWidth>e._BodyWidth&&(s[0]=s[0]-e.eyedropperTip.tipWidth-40),e.eyedropperTip.toolTip.getBSTip().$tip.css({top:s[1]+"px",left:s[0]+"px"}))}),800),void(e.eyedropperTip.isHidden=!1)}var u=!1;i.isHidden=!1,n=Common.Utils.String.htmlEncode(n),(i.tipType!==a||i.tipLength!==n.length||i.strTip.indexOf(n)<0||o&&i.noCtrl!==o.get_NoCtrl())&&(i.toolTip.setTitle(a!=Asc.c_oAscMouseMoveDataTypes.Hyperlink||o.get_NoCtrl()?n:n+"<br><b>"+Common.Utils.String.platformKey("Ctrl",e.documentHolder.txtPressLink)+"</b>"),i.tipLength=n.length,i.strTip=n,i.tipType=a,i.noCtrl=!!o&&o.get_NoCtrl(),u=!0),(s=[t.get_X(),t.get_Y()])[1]+=e._XY[1]-15,s[0]+=e._XY[0]+5,i.isVisible&&!u||(i.isVisible=!0,i.toolTip.show([-1e4,-1e4])),u&&(i.tipHeight=i.toolTip.getBSTip().$tip.height(),i.tipWidth=i.toolTip.getBSTip().$tip.width()),u=!1,s[0]+i.tipWidth>e._BodyWidth&&(s[0]=e._BodyWidth-i.tipWidth,u=!0),s[1]-i.tipHeight<0?s[1]=u?s[1]+30:0:s[1]-=i.tipHeight,i.toolTip.getBSTip().$tip.css({top:s[1]+"px",left:s[0]+"px"})}else if(t.get_Type()==Asc.c_oAscMouseMoveDataTypes.LockedObject&&e.mode.isEdit&&e.isUserVisible(t.get_UserId())){var g;e.usertipcount>=e.usertips.length&&((g=$(document.createElement("div"))).addClass("username-tip"),g.css({height:e._TtHeight+"px","line-height":e._TtHeight+"px",position:"absolute",zIndex:"900",visibility:"visible"}),$(document.body).append(g),e.userTooltip&&(g.on("mouseover",e.wrapEvents.userTipMousover),g.on("mouseout",e.wrapEvents.userTipMousout)),e.usertips.push(g)),g=e.usertips[e.usertipcount],e.usertipcount++,n=e.getUserName(t.get_UserId());var b=(s=[t.get_X()+e._XY[0],t.get_Y()+e._XY[1]])[0];s[0]=e._BodyWidth-s[0],s[1]-=2==t.get_LockedObjectType()?e._TtHeight:0,s[1]>e._XY[1]&&s[1]+e._TtHeight<e._XY[1]+e._Height?(g.text(n),g.css({visibility:"visible",top:s[1]+"px",right:s[0]+"px","max-width":b+"px"})):g.css({visibility:"hidden"})}}},t.onCutCopyPaste=function(t,e){var i=this;i.api&&(("cut"==t.value?i.api.Cut():"copy"==t.value?i.api.Copy():i.api.Paste("paste-before"==t.value))||Common.localStorage.getBool("pdfe-hide-copywarning")||new Common.Views.CopyWarningDialog({handler:function(t){t&&Common.localStorage.setItem("pdfe-hide-copywarning",1),i.editComplete()}}).show(),t.isFromBar&&i.api.SetShowTextSelectPanel(!1));i.editComplete()},t.onUndo=function(){this.api&&this.api.Undo()},t.onRedo=function(){this.api&&this.api.Redo()},t.onClear=function(){if(this.api){var t=this.api.asc_IsContentControl()?this.api.asc_GetContentControlProperties():null;t&&this.api.asc_ClearContentControl(t.get_InternalId())}},t.onPrintSelection=function(t){if(this.api){var e=new Asc.asc_CAdjustPrint;e.asc_setPrintType(Asc.c_oAscPrintType.Selection);var i=new Asc.asc_CDownloadOptions(null,Common.Utils.isChrome||Common.Utils.isOpera||Common.Utils.isGecko&&Common.Utils.firefoxVersion>86);i.asc_setAdvancedOptions(e),this.api.asc_Print(i),this.editComplete(),Common.component.Analytics.trackEvent("DocumentHolder","Print Selection")}},t.onSignatureClick=function(t){var e=t.cmpEl.attr("data-value");switch(t.value){case 0:Common.NotificationCenter.trigger("protect:sign",e);break;case 1:this.api.asc_ViewCertificate(e);break;case 2:var i=this.documentHolder._docProtection;Common.NotificationCenter.trigger("protect:signature","visible",this._isDisabled||i.isReadOnly||i.isFormsOnly||i.isCommentsOnly,e);break;case 3:var s=this;Common.UI.warning({title:this.documentHolder.notcriticalErrorTitle,msg:this.documentHolder.txtRemoveWarning,buttons:["ok","cancel"],primary:"ok",callback:function(t){"ok"==t&&s.api.asc_RemoveSignature(e)}})}},t.saveAsPicture=function(){this.api&&this.api.asc_SaveDrawingAsPicture()},t.onPluginContextMenu=function(t){t&&t.length>0&&this.documentHolder&&this.documentHolder.currentMenu&&this.documentHolder.currentMenu.isVisible()&&this.documentHolder.updateCustomItems(this.documentHolder.currentMenu,t)},t.onHidePdfFormsActions=function(){this.listControlMenuPdf&&this.listControlMenuPdf.isVisible()&&this.listControlMenuPdf.hide();var t=this.documentHolder.cmpEl.find("#calendar-control-container-pdf");t.is(":visible")&&t.hide()},t.onShowFormsPDFActions=function(t,e,i){var s=this;switch(t.type){case AscPDF.FIELD_TYPES.combobox:setTimeout((function(){s.onShowListActionsPDF(t,e,i)}),1);break;case AscPDF.FIELD_TYPES.text:setTimeout((function(){s.onShowDateActionsPDF(t,e,i)}),1)}},t.onShowListActionsPDF=function(t){var e=this.documentHolder.cmpEl,i=this.listControlMenuPdf,s=i?e.find(Common.Utils.String.format("#menu-container-{0}",i.id)):null,n=this;n._listObjPdf=t,this._fromShowContentControls=!0,Common.UI.Menu.Manager.hideAll(),i||(this.listControlMenuPdf=i=new Common.UI.Menu({maxHeight:207,menuAlign:"tr-bl",items:[]}),i.on("item:click",(function(t,e){setTimeout((function(){-1!==e.value&&n.api.asc_SelectPDFFormListItem(e.value)}),1)})),(!s||s.length<1)&&(s=$(Common.Utils.String.format('<div id="menu-container-{0}" style="position: absolute; z-index: 10000;"><div class="dropdown-toggle" data-toggle="dropdown"></div></div>',i.id)),e.append(s)),i.render(s),i.cmpEl.attr({tabindex:"-1"}),i.on("hide:after",(function(){n.listControlMenuPdf.removeAll(),n._fromShowContentControls||n.api.asc_UncheckContentControlButtons()})));for(var a=t.getOptions(),o=a.length,l=0;l<o;l++)i.addItem(new Common.UI.MenuItem({caption:Array.isArray(a[l])?a[l][0]:a[l],value:l,template:_.template(['<a id="<%= id %>" style="<%= style %>" tabindex="-1" type="menuitem">',"<%= Common.Utils.String.htmlEncode(caption) %>","</a>"].join(""))}));var r=t.getPagePos(),c=AscPDF.GetGlobalCoordsByPageCoords(r.x+r.w,r.y+r.h,t.getPage(),!0);s.css({left:c.X,top:c.Y}),s.attr("data-value","prevent-canvas-click"),this._preventClick=!0,i.show(),_.delay((function(){i.cmpEl.focus()}),10),this._fromShowContentControls=!1},t.onShowDateActionsPDF=function(t,e,i){var s=this.documentHolder.cmpEl,n=s.find("#calendar-control-container-pdf"),a=this;this._dateObjPdf=t,n.length<1&&(n=$('<div id="calendar-control-container-pdf" style="position: absolute;z-index: 1000;"><div id="id-document-calendar-control-pdf" style="position: fixed; left: -1000px; top: -1000px;"></div></div>'),s.append(n)),Common.UI.Menu.Manager.hideAll();var o=t.getPagePos(),l=AscPDF.GetGlobalCoordsByPageCoords(o.x+o.w,o.y+o.h,t.getPage(),!0);n.css({left:l.X,top:l.Y}),n.show(),this.cmpCalendarPdf||(this.cmpCalendarPdf=new Common.UI.Calendar({el:s.find("#id-document-calendar-control-pdf"),enableKeyEvents:!0,firstday:1}),this.cmpCalendarPdf.on("date:click",(function(t,e){var i=new AscCommon.CSdtDatePickerPr;i.put_FullDate(new Date(e)),a.api.asc_SetTextFormDatePickerDate(i),n.hide()})),this.cmpCalendarPdf.on("calendar:keydown",(function(t,e){e.keyCode==Common.UI.Keys.ESC&&n.hide()})),$(document).on("mousedown",(function(t){"canvas"!==t.target.localName&&n.is(":visible")&&0==n.find(t.target).length&&n.hide()})));var r=this._dateObjPdf?this._dateObjPdf.asc_GetValue():void 0;r&&(r=new Date(r),("[object Date]"!==Object.prototype.toString.call(r)||isNaN(r))&&(r=void 0)),!r&&(r=new Date),this.cmpCalendarPdf.setDate(r);var c=Common.Utils.getOffset(n),d=Common.Utils.innerWidth(),h=Common.Utils.innerHeight()-10,p=this.cmpCalendarPdf.cmpEl.outerWidth(),m=this.cmpCalendarPdf.cmpEl.outerHeight(),u=c.left-p,g=c.top;g+m>h&&(g=h-m,u-=22),g<0&&(g=0),u+p>d&&(u=d-p),this.cmpCalendarPdf.cmpEl.css({left:u,top:g}),this._preventClick=!0},t.onShowContentControlsActions=function(t,e,i){if(!this._isDisabled){switch(t.type){case Asc.c_oAscContentControlSpecificType.DateTime:this.onShowDateActions(t,e,i);break;case Asc.c_oAscContentControlSpecificType.Picture:if(t.pr&&t.pr.get_Lock){var s=t.pr.get_Lock();if(s==Asc.c_oAscSdtLockType.SdtContentLocked||s==Asc.c_oAscSdtLockType.ContentLocked)return}this.onShowImageActions(t,e,i);break;case Asc.c_oAscContentControlSpecificType.DropDownList:case Asc.c_oAscContentControlSpecificType.ComboBox:this.onShowListActions(t,e,i)}}},t.onHideContentControlsActions=function(){this.listControlMenu&&this.listControlMenu.isVisible()&&this.listControlMenu.hide();var t=this.documentHolder.cmpEl.find("#calendar-control-container");t.is(":visible")&&t.hide()},t.onShowImageActions=function(t,e,i){var s=this.documentHolder.cmpEl,n=this.imageControlMenu,a=n?s.find(Common.Utils.String.format("#menu-container-{0}",n.id)):null,o=this;this.internalFormObj=t?t.pr:null,this._fromShowContentControls=!0,Common.UI.Menu.Manager.hideAll(),n||(this.imageControlMenu=n=new Common.UI.Menu({maxHeight:207,menuAlign:"tl-bl",items:[{caption:this.documentHolder.mniImageFromFile,value:"file"},{caption:this.documentHolder.mniImageFromUrl,value:"url"},{caption:this.documentHolder.mniImageFromStorage,value:"storage",visible:this.mode.canRequestInsertImage||this.mode.fileChoiceUrl&&this.mode.fileChoiceUrl.indexOf("{documentType}")>-1}]}),n.on("item:click",(function(t,e){setTimeout((function(){o.onImageSelect(t,e)}),1),setTimeout((function(){o.api.asc_UncheckContentControlButtons()}),500)})),(!a||a.length<1)&&(a=$(Common.Utils.String.format('<div id="menu-container-{0}" style="position: absolute; z-index: 10000;"><div class="dropdown-toggle" data-toggle="dropdown"></div></div>',n.id)),s.append(a)),n.render(a),n.cmpEl.attr({tabindex:"-1"}),n.on("hide:after",(function(){o._fromShowContentControls||o.api.asc_UncheckContentControlButtons()}))),a.css({left:e,top:i}),a.attr("data-value","prevent-canvas-click"),this._preventClick=!0,n.show(),_.delay((function(){n.cmpEl.focus()}),10),this._fromShowContentControls=!1},t.onImageSelect=function(t,e){if("url"==e.value){var i=this;new Common.Views.ImageFromUrlDialog({handler:function(t,e){if("ok"==t&&i.api){var s=e.replace(/ /g,"");_.isEmpty(s)||i.setImageUrl(s)}}}).show()}else if("storage"==e.value)Common.NotificationCenter.trigger("storage:image-load","control");else{if(this._isFromFile)return;this._isFromFile=!0,this.api.asc_addImage(this.internalFormObj),this._isFromFile=!1}},t.openImageFromStorage=function(t){var e=this;this.mode.canRequestInsertImage?Common.Gateway.requestInsertImage(t):new Common.Views.SelectFileDlg({fileChoiceUrl:this.mode.fileChoiceUrl.replace("{fileExt}","").replace("{documentType}","ImagesOnly")}).on("selectfile",(function(i,s){s&&(s.c=t),!s.images&&(s.images=[{fileType:s.fileType,url:s.url}]),s.url=null,e.insertImage(s)})).show()},t.setImageUrl=function(t,e){this.api.asc_SetContentControlPictureUrl(t,this.internalFormObj?this.internalFormObj.get_InternalId():null,e)},t.insertImage=function(t){if(t&&(t.url||t.images)){t.url&&console.log("Obsolete: The 'url' parameter of the 'insertImage' method is deprecated. Please use 'images' parameter instead.");var e=[];if(t.images&&t.images.length>0)for(var i=0;i<t.images.length;i++)t.images[i]&&t.images[i].url&&e.push(t.images[i].url);else t.url&&e.push(t.url);t._urls=e}Common.NotificationCenter.trigger("storage:image-insert",t)},t.insertImageFromStorage=function(t){t&&t._urls&&"control"==t.c&&this.setImageUrl(t._urls[0],t.token)},t.onShowListActions=function(t,e,i){var s=t.type,n=t.pr,a=s==Asc.c_oAscContentControlSpecificType.ComboBox?n.get_ComboBoxPr():n.get_DropDownListPr(),o=n.get_FormPr(),l=this.documentHolder.cmpEl,r=this.listControlMenu,c=r?l.find(Common.Utils.String.format("#menu-container-{0}",r.id)):null,d=this;if(this._listObj=n,this._fromShowContentControls=!0,Common.UI.Menu.Manager.hideAll(),r||(this.listControlMenu=r=new Common.UI.Menu({maxHeight:207,menuAlign:"tr-bl",items:[]}),r.on("item:click",(function(t,e){setTimeout((function(){-1!==e.value&&d.api.asc_SelectContentControlListItem(e.value,d._listObj.get_InternalId())}),1)})),(!c||c.length<1)&&(c=$(Common.Utils.String.format('<div id="menu-container-{0}" style="position: absolute; z-index: 10000;"><div class="dropdown-toggle" data-toggle="dropdown"></div></div>',r.id)),l.append(c)),r.render(c),r.cmpEl.attr({tabindex:"-1"}),r.on("hide:after",(function(){d.listControlMenu.removeAll(),d._fromShowContentControls||d.api.asc_UncheckContentControlButtons()}))),a){var h=a.get_ItemsCount();if(o&&(!o.get_Required()||h<1)){var p=n.get_PlaceholderText();r.addItem(new Common.UI.MenuItem({caption:""!==p.trim()?p:this.documentHolder.txtEmpty,value:"",template:_.template(['<a id="<%= id %>" tabindex="-1" type="menuitem" style="<% if (options.value=="") { %> opacity: 0.6 <% } %>">',"<%= Common.Utils.String.htmlEncode(caption) %>","</a>"].join(""))}))}for(var m=0;m<h;m++)(""!==a.get_ItemValue(m)||!o)&&r.addItem(new Common.UI.MenuItem({caption:a.get_ItemDisplayText(m),value:a.get_ItemValue(m),template:_.template(['<a id="<%= id %>" style="<%= style %>" tabindex="-1" type="menuitem">',"<%= Common.Utils.String.htmlEncode(caption) %>","</a>"].join(""))}));!o&&r.items.length<1&&r.addItem(new Common.UI.MenuItem({caption:this.documentHolder.txtEmpty,value:-1}))}c.css({left:e,top:i}),c.attr("data-value","prevent-canvas-click"),this._preventClick=!0,r.show(),_.delay((function(){r.cmpEl.focus()}),10),this._fromShowContentControls=!1},t.onShowDateActions=function(t,e,i){var s=t.pr,n=s.get_DateTimePr(),a=this.documentHolder.cmpEl,o=a.find("#calendar-control-container"),l=this;this._dateObj=s,o.length<1&&(o=$('<div id="calendar-control-container" style="position: absolute;z-index: 1000;"><div id="id-document-calendar-control" style="position: fixed; left: -1000px; top: -1000px;"></div></div>'),a.append(o)),Common.UI.Menu.Manager.hideAll(),o.css({left:e,top:i}),o.show(),this.cmpCalendar||(this.cmpCalendar=new Common.UI.Calendar({el:a.find("#id-document-calendar-control"),enableKeyEvents:!0,firstday:1}),this.cmpCalendar.on("date:click",(function(t,e){var i=l._dateObj.get_DateTimePr();i.put_FullDate(new Date(e)),l.api.asc_SetContentControlDatePickerDate(i),o.hide(),l.api.asc_UncheckContentControlButtons()})),this.cmpCalendar.on("calendar:keydown",(function(t,e){e.keyCode==Common.UI.Keys.ESC&&(o.hide(),l.api.asc_UncheckContentControlButtons())})),$(document).on("mousedown",(function(t){"canvas"!==t.target.localName&&o.is(":visible")&&0==o.find(t.target).length&&(o.hide(),l.api.asc_UncheckContentControlButtons())})));var r=n?n.get_FullDate():void 0;this.cmpCalendar.setDate(r?new Date(r):new Date);var c=Common.Utils.getOffset(o),d=Common.Utils.innerWidth(),h=Common.Utils.innerHeight()-10,p=this.cmpCalendar.cmpEl.outerWidth(),m=this.cmpCalendar.cmpEl.outerHeight(),u=c.left-p,g=c.top;g+m>h&&(g=h-m,u-=22),g<0&&(g=0),u+p>d&&(u=d-p),this.cmpCalendar.cmpEl.css({left:u,top:g}),this._preventClick=!0},t.addHyperlink=function(t){var e,i=this;if(i.api){for(var s=[],n=0;n<i.api.getCountPages();n++)s.push({displayValue:n+1,value:n});(e=new PDFE.Views.HyperlinkSettingsDialog({api:i.api,appOptions:i.mode,handler:function(t,e){"ok"==e&&i.api.add_Hyperlink(t.getSettings()),i.editComplete()},slides:s})).show(),e.setSettings(t.hyperProps.value),Common.component.Analytics.trackEvent("DocumentHolder","Add Hyperlink")}},t.editHyperlink=function(t,e){var i,s=this;if(s.api){for(var n=[],a=0;a<s.api.getCountPages();a++)n.push({displayValue:a+1,value:a});(i=new PDFE.Views.HyperlinkSettingsDialog({api:s.api,appOptions:s.mode,handler:function(t,e){"ok"==e&&s.api.change_Hyperlink(i.getSettings()),s.editComplete()},slides:n})).show(),i.setSettings(t.hyperProps.value),Common.component.Analytics.trackEvent("DocumentHolder","Edit Hyperlink")}},t.removeHyperlink=function(t){this.api&&this.api.remove_Hyperlink(),this.editComplete(),Common.component.Analytics.trackEvent("DocumentHolder","Remove Hyperlink")},t.onInsertImageUrl=function(t,e,i,s){var n=this;new Common.Views.ImageFromUrlDialog({handler:function(t,i){if("ok"==t&&n.api){var s=i.replace(/ /g,"");if(!_.isEmpty(s)){var a=new Asc.asc_CImgProperty;a.put_ImageUrl(s),n.api.ImgApply(a,e)}}n.editComplete()}}).show()},t.onImgReplace=function(t,e,i){var s=this;1==e.value?s.onInsertImageUrl(!1):2==e.value?Common.NotificationCenter.trigger("storage:image-load","change"):setTimeout((function(){s.api.ChangeImageFromFile()}),10)},t.onTableMerge=function(){this.api&&this.api.MergeCells()},t.onTableSplit=function(){var t=this;t.api&&new Common.Views.InsertTableDialog({split:!0,handler:function(e,i){"ok"==e&&(t.api&&t.api.SplitCell(i.columns,i.rows),Common.component.Analytics.trackEvent("DocumentHolder","Table Split")),t.editComplete()}}).show()},t.tableCellsVAlign=function(t,e,i){if(this.api){var s=new Asc.CTableProp;s.put_CellsVAlign(e.value),this.api.tblApply(s)}this.editComplete(),Common.component.Analytics.trackEvent("DocumentHolder","Table Cell Align")},t.onTableDistRows=function(){this.api&&this.api.asc_DistributeTableCells(!1),this.editComplete()},t.onTableDistCols=function(){this.api&&this.api.asc_DistributeTableCells(!0),this.editComplete()},t.onTableAdvanced=function(t,e){var i=this;if(i.api){var s=i.api.getSelectedElements();if(s&&s.length>0)for(var n,a,o=s.length-1;o>=0;o--)if(n=s[o].get_ObjectType(),a=s[o].get_ObjectValue(),Asc.c_oAscTypeSelectElement.Table==n){new PDFE.Views.TableSettingsAdvanced({tableProps:a,slideSize:{width:i.api.get_PageWidth(),height:i.api.get_PageHeight()},handler:function(t,e){"ok"==t&&i.api&&i.api.tblApply(e.tableProps),i.editComplete(),Common.component.Analytics.trackEvent("DocumentHolder","Table Settings Advanced")}}).show();break}}},t.onImageAdvanced=function(t){var e=this;if(e.api){var i=e.api.getSelectedElements();if(i&&i.length>0)for(var s,n,a=i.length-1;a>=0;a--)if(s=i[a].get_ObjectType(),n=i[a].get_ObjectValue(),Asc.c_oAscTypeSelectElement.Image==s){var o;e.documentHolder.menuImgOriginalSize.isDisabled()||(o=e.api.asc_getCropOriginalImageSize())&&(o={width:o.get_ImageWidth(),height:o.get_ImageHeight()}),new PDFE.Views.ImageSettingsAdvanced({imageProps:n,sizeOriginal:o,slideSize:{width:e.api.get_PageWidth(),height:e.api.get_PageHeight()},handler:function(t,i){"ok"==t&&e.api&&e.api.ImgApply(i.imageProps),e.editComplete(),Common.component.Analytics.trackEvent("DocumentHolder","Image Settings Advanced")}}).show();break}}},t.onImgOriginalSize=function(t){var e=this;if(e.api){var i=e.api.asc_getCropOriginalImageSize();if(i){var s=new Asc.asc_CImgProperty;s.put_Width(i.get_ImageWidth()),s.put_Height(i.get_ImageHeight()),s.put_Rot(0),e.api.ImgApply(s)}e.editComplete(),Common.component.Analytics.trackEvent("DocumentHolder","Set Image Original Size")}},t.onImgRotate=function(t){var e=new Asc.asc_CShapeProperty;e.asc_putRotAdd(3.14159265358979*(1==t.value?90:270)/180),this.api.ShapeApply(e),this.editComplete()},t.onImgFlip=function(t){var e=new Asc.asc_CShapeProperty;1==t.value?e.asc_putFlipHInvert(!0):e.asc_putFlipVInvert(!0),this.api.ShapeApply(e),this.editComplete()},t.onImgCrop=function(t,e){1==e.value?this.api.asc_cropFill():2==e.value?this.api.asc_cropFit():e.checked?this.api.asc_startEditCrop():this.api.asc_endEditCrop(),this.editComplete()},t.onImgResetCrop=function(){if(this.api){var t=new Asc.asc_CImgProperty;t.put_ResetCrop(!0)}this.api.ImgApply(t),this.editComplete()},t.onImgEditPoints=function(t){this.api&&this.api.asc_editPointsGeometry()},t.onShapeAdvanced=function(t){var e=this;if(e.api){var i=e.api.getSelectedElements();if(i&&i.length>0)for(var s,n,a=i.length-1;a>=0;a--)if(s=i[a].get_ObjectType(),n=i[a].get_ObjectValue(),Asc.c_oAscTypeSelectElement.Shape==s){new PDFE.Views.ShapeSettingsAdvanced({shapeProps:n,slideSize:{width:e.api.get_PageWidth(),height:e.api.get_PageHeight()},handler:function(t,i){"ok"==t&&e.api&&e.api.ShapeApply(i.shapeProps),e.editComplete(),Common.component.Analytics.trackEvent("DocumentHolder","Image Shape Advanced")}}).show();break}}},t.onChartAdvanced=function(t,e){var i=this;if(i.api){var s=i.api.getSelectedElements();if(s&&s.length>0)for(var n,a,o=s.length-1;o>=0;o--)if(n=s[o].get_ObjectType(),a=s[o].get_ObjectValue(),Asc.c_oAscTypeSelectElement.Chart==n){new PDFE.Views.ChartSettingsAdvanced({chartProps:a,slideSize:PDFE.getController("Toolbar").currentPageSize,chartSettings:i.api.asc_getChartSettings(),api:i.api,handler:function(t,e){"ok"==t&&i.api&&i.api.ChartApply(e.chartProps),i.editComplete(),Common.component.Analytics.trackEvent("DocumentHolder","Chart Settings Advanced")}}).show();break}}},t.onParagraphAdvanced=function(t){var e=this;if(e.api){var i=e.api.getSelectedElements();if(i&&i.length>0)for(var s,n,a=i.length-1;a>=0;a--)if(s=i[a].get_ObjectType(),n=i[a].get_ObjectValue(),Asc.c_oAscTypeSelectElement.Paragraph==s){new PDFE.Views.ParagraphSettingsAdvanced({paragraphProps:n,api:e.api,handler:function(t,i){"ok"==t&&e.api&&e.api.paraApply(i.paragraphProps),e.editComplete(),Common.component.Analytics.trackEvent("DocumentHolder","Image Paragraph Advanced")}}).show();break}}},t.onGroupImg=function(t){this.api&&this.api.groupShapes(),this.editComplete(),Common.component.Analytics.trackEvent("DocumentHolder","Group Image")},t.onUnGroupImg=function(t){this.api&&this.api.unGroupShapes(),this.editComplete(),Common.component.Analytics.trackEvent("DocumentHolder","UnGroup Image")},t.onArrangeFront=function(t){this.api&&this.api.shapes_bringToFront(),this.editComplete(),Common.component.Analytics.trackEvent("DocumentHolder","Bring To Front")},t.onArrangeBack=function(t){this.api&&this.api.shapes_bringToBack(),this.editComplete(),Common.component.Analytics.trackEvent("DocumentHolder","Bring To Back")},t.onArrangeForward=function(t){this.api&&this.api.shapes_bringForward(),this.editComplete(),Common.component.Analytics.trackEvent("DocumentHolder","Send Forward")},t.onArrangeBackward=function(t){this.api&&this.api.shapes_bringBackward(),this.editComplete(),Common.component.Analytics.trackEvent("DocumentHolder","Send Backward")},t.onImgShapeAlign=function(t,e){var i=this;if(i.api){var s=i.api.asc_getSelectedDrawingObjectsCount()<2||Common.Utils.InternalSettings.get("pdfe-align-to-slide");s=s?Asc.c_oAscObjectsAlignType.Page:Asc.c_oAscObjectsAlignType.Selected,e.value<6?(i.api.put_ShapesAlign(e.value,s),Common.component.Analytics.trackEvent("DocumentHolder","Shape Align")):6==e.value?(i.api.DistributeHorizontally(s),Common.component.Analytics.trackEvent("DocumentHolder","Distribute Horizontally")):7==e.value&&(i.api.DistributeVertically(s),Common.component.Analytics.trackEvent("DocumentHolder","Distribute Vertically")),i.editComplete()}},t.onShapesMerge=function(t,e,i){e&&e.value&&(this.api.asc_mergeSelectedShapes(e.value),Common.component.Analytics.trackEvent("DocumentHolder","Shapes Merge")),this.editComplete()},t.onParagraphVAlign=function(t,e){var i=this;if(i.api){var s=new Asc.asc_CShapeProperty;s.put_VerticalTextAlign(e.value),i.api.ShapeApply(s)}i.editComplete(),Common.component.Analytics.trackEvent("DocumentHolder","Text Vertical Align")},t.onParagraphDirection=function(t,e){var i=this;if(i.api){var s=new Asc.asc_CShapeProperty;s.put_Vert(e.options.direction),i.api.ShapeApply(s)}i.editComplete(),Common.component.Analytics.trackEvent("DocumentHolder","Text Direction")},t.tableSelectText=function(t,e){if(this.api)switch(e.value){case 0:this.api.selectRow();break;case 1:this.api.selectColumn();break;case 2:this.api.selectCell();break;case 3:this.api.selectTable()}},t.tableInsertText=function(t,e){if(this.api)switch(e.value){case 0:this.api.addColumnLeft();break;case 1:this.api.addColumnRight();break;case 2:this.api.addRowAbove();break;case 3:this.api.addRowBelow()}},t.tableDeleteText=function(t,e){if(this.api)switch(e.value){case 0:this.api.remRow();break;case 1:this.api.remColumn();break;case 2:this.api.remTable()}},t.onNewPage=function(t){this.api&&this.api.asc_AddPage(t.value?Math.min.apply(null,this.api.getSelectedPages()):Math.max.apply(null,this.api.getSelectedPages())+1),Common.NotificationCenter.trigger("edit:complete",this.documentHolder)},t.onDeletePage=function(){this.api&&this.api.asc_RemovePage(),Common.NotificationCenter.trigger("edit:complete",this.documentHolder)},t.onRotatePage=function(t,e){this.api&&this.api.asc_RotatePage(t),Common.NotificationCenter.trigger("edit:complete",this.documentHolder)},t.removeComment=function(t,e,i){this.api&&this.api.asc_remove(),this.editComplete()},t.equationCallback=function(t){t&&this.api.asc_SetMathProps(t),this.editComplete()},t.onChangeCropState=function(t){this.documentHolder.menuImgCrop&&this.documentHolder.menuImgCrop.menu.items[0].setChecked(t,!0)},t.onDialogAddHyperlink=function(){var t,e,i,s=this;if(s.api&&s.mode.isEdit&&!s._isDisabled&&!PDFE.getController("LeftMenu").leftMenu.menuFile.isVisible()){var n=function(t,n){"ok"==n&&(e=t.getSettings(),!1!==i?s.api.add_Hyperlink(e):s.api.change_Hyperlink(e)),s.editComplete()};i=s.api.can_AddHyperlink();for(var a=[],o=0;o<s.api.getCountPages();o++)a.push({displayValue:o+1,value:o});if(!1!==i)t=new PDFE.Views.HyperlinkSettingsDialog({api:s.api,appOptions:s.mode,handler:n,slides:a}),(e=new Asc.CHyperlinkProperty).put_Text(i),t.show(),t.setSettings(e);else{var l=s.api.getSelectedElements();l&&_.isArray(l)&&_.each(l,(function(t,i){l[i].get_ObjectType()==Asc.c_oAscTypeSelectElement.Hyperlink&&(e=l[i].get_ObjectValue())})),e&&((t=new PDFE.Views.HyperlinkSettingsDialog({api:s.api,appOptions:s.mode,handler:n,slides:a})).show(),t.setSettings(e))}}Common.component.Analytics.trackEvent("DocumentHolder","Add Hyperlink")},t.onShowForeignCursorLabel=function(t,e,i,s){if(this.isUserVisible(t)){for(var n,a=this,o=0;o<a.fastcoauthtips.length;o++)if(a.fastcoauthtips[o].attr("userid")==t){n=a.fastcoauthtips[o];break}n||((n=$(document.createElement("div"))).addClass("username-tip"),n.attr("userid",t),n.css({height:a._TtHeight+"px","line-height":a._TtHeight+"px",position:"absolute",zIndex:"900",display:"none","pointer-events":"none","background-color":"#"+Common.Utils.ThemeColor.getHexColor(s.get_r(),s.get_g(),s.get_b())}),n.text(a.getUserName(t)),a.documentHolder.cmpEl.append(n),a.fastcoauthtips.push(n),n.fadeIn(150)),n.css({top:i-a._TtHeight+"px",left:e+"px"})}},t.onHideForeignCursorLabel=function(t){for(var e=this,i=0;i<e.fastcoauthtips.length;i++)if(e.fastcoauthtips[i].attr("userid")==t){var s=e.fastcoauthtips[i];e.fastcoauthtips[i].fadeOut(150,(function(){s.remove()})),e.fastcoauthtips.splice(i,1);break}},t.onSelectStrokeColor=function(t,e,i){var s=i[0]+i[1],n=i[2]+i[3],a=i[4]+i[5];this.api.SetAnnotStrokeColor(parseInt(s,16),parseInt(n,16),parseInt(a,16))||(i=this.api.GetAnnotStrokeColor(),i=Common.Utils.ThemeColor.getHexColor(i.r,i.g,i.b)),t.currentColor=i,t.setColor(t.currentColor),e.select(t.currentColor,!0)},t.onSetStrokeOpacity=function(t,e){var i=this.api.GetAnnotOpacity(),s=i;"up"===e?(i%10>.1?i=10*Math.ceil(i/10):i+=10,i=Math.min(100,i)):(i%10>.1?i=10*Math.floor(i/10):i-=10,i=Math.max(0,i)),this.api.SetAnnotOpacity(i)||(i=s),t.setValue(i+"%")},t.onStrokeShowAfter=function(t){t.sizePicker||(t.sizePicker=new Common.UI.UpDownPicker({el:t.cmpEl.find(".custom-scale"),caption:this.documentHolder.txtOpacity,minWidth:40}),t.sizePicker.on("click",_.bind(this.onSetStrokeOpacity,this,t.sizePicker))),t.sizePicker.setValue(this.api.GetAnnotOpacity()+"%")},t.applySettings=function(){!Common.Utils.InternalSettings.get("pdfe-settings-annot-bar")&&this.onHideAnnotBar()},t.initExternalEditors=function(){var t=this,e=this.getApplication().getController("Common.Controllers.ExternalDiagramEditor").getView("Common.Views.ExternalDiagramEditor");e&&(e.on("internalmessage",_.bind((function(t,i){i.data.command;var s=i.data.data;this.api&&(e.isEditMode()?this.api.asc_editChartDrawingObject(s):this.api.asc_addChartDrawingObject(s,e.getPlaceholder()))}),this)),e.on("hide",_.bind((function(e,i){this.api&&(this.api.asc_onCloseFrameEditor(),this.api.asc_enableKeyEvents(!0)),setTimeout((function(){t.editComplete()}),10)}),this)))},t.onDoubleClickOnChart=function(t){if(Common.Controllers.LaunchController.isScriptLoaded()&&this.mode&&this.mode.isEdit&&this.mode.isPDFEdit&&!this._isDisabled){var e=this.getApplication().getController("Common.Controllers.ExternalDiagramEditor").getView("Common.Views.ExternalDiagramEditor");if(e&&t){let i,s;if(this._state.currentChartRect){this.checkEditorOffsets(),e.setSize(e.initConfig.initwidth,e.initConfig.initheight);let t=e.getWidth()||e.initConfig.initwidth,n=e.getHeight()||e.initConfig.initheight,a=this._state.currentChartRect.asc_getX(),o=this._state.currentChartRect.asc_getY(),l=this._state.currentChartRect.asc_getWidth(),r=this._state.currentChartRect.asc_getHeight();s=this._XY[1]+o+r,s+n>Common.Utils.innerHeight()&&(s=this._XY[1]+o-n,s<0&&(s=Common.Utils.innerHeight()-n)),i=this._XY[0]+a-(t-l)/2,i+t>Common.Utils.innerWidth()&&(i=Common.Utils.innerWidth()-t)}e.setEditMode(!0),e.show(i,s),e.setChartData(t)}}},t.editChartClick=function(){Common.Controllers.LaunchController.isScriptLoaded()&&this.api.asc_editChartInFrameEditor()};const e=Asc.c_oAscChartTypeSettings,i={[e.barNormal]:["axes","axisTitles","chartTitle","dataLabels","dataTable","errorBars","gridLines","legend","trendLines"],[e.barStacked]:["axes","axisTitles","chartTitle","dataLabels","dataTable","errorBars","gridLines","legend"],[e.barStackedPer]:["axes","axisTitles","chartTitle","dataLabels","dataTable","errorBars","gridLines","legend"],[e.barNormal3d]:["axes","axisTitles","chartTitle","dataLabels","dataTable","gridLines","legend"],[e.barStacked3d]:["axes","axisTitles","chartTitle","dataLabels","dataTable","gridLines","legend"],[e.barStackedPer3d]:["axes","axisTitles","chartTitle","dataLabels","dataTable","gridLines","legend"],[e.barNormal3dPerspective]:["axes","axisTitles","chartTitle","dataLabels","dataTable","gridLines","legend"],[e.lineNormal]:["axes","axisTitles","chartTitle","dataLabels","dataTable","errorBars","gridLines","legend","trendLines","upDownBars"],[e.lineStacked]:["axes","axisTitles","chartTitle","dataLabels","dataTable","errorBars","gridLines","legend","upDownBars"],[e.lineStackedPer]:["axes","axisTitles","chartTitle","dataLabels","dataTable","errorBars","gridLines","legend","trendLines","upDownBars"],[e.lineNormalMarker]:["axes","axisTitles","chartTitle","dataLabels","dataTable","errorBars","gridLines","legend","trendLines","upDownBars"],[e.lineStackedMarker]:["axes","axisTitles","chartTitle","dataLabels","dataTable","errorBars","gridLines","legend","upDownBars"],[e.lineStackedPerMarker]:["axes","axisTitles","chartTitle","dataLabels","dataTable","errorBars","gridLines","legend","upDownBars"],[e.line3d]:["axes","axisTitles","chartTitle","dataLabels","dataTable","gridLines","legend"],[e.pie]:["chartTitle","dataLabels","legend"],[e.pie3d]:["chartTitle","dataLabels","legend"],[e.hBarNormal]:["axes","axisTitles","chartTitle","dataLabels","dataTable","errorBars","gridLines","legend","trendLines"],[e.hBarStacked]:["axes","axisTitles","chartTitle","dataLabels","dataTable","errorBars","gridLines","legend"],[e.hBarStackedPer]:["axes","axisTitles","chartTitle","dataLabels","dataTable","errorBars","gridLines","legend"],[e.hBarNormal3d]:["axes","axisTitles","chartTitle","dataLabels","dataTable","gridLines","legend"],[e.hBarStacked3d]:["axes","axisTitles","chartTitle","dataLabels","dataTable","gridLines","legend"],[e.hBarStackedPer3d]:["axes","axisTitles","chartTitle","dataLabels","dataTable","gridLines","legend"],[e.areaNormal]:["axes","axisTitles","chartTitle","dataLabels","dataTable","errorBars","gridLines","legend"],[e.areaStacked]:["axes","axisTitles","chartTitle","dataLabels","dataTable","errorBars","gridLines","legend"],[e.areaStackedPer]:["axes","axisTitles","chartTitle","dataLabels","dataTable","errorBars","gridLines","legend"],[e.doughnut]:["chartTitle","dataLabels","legend"],[e.stock]:["axes","axisTitles","chartTitle","dataLabels","dataTable","errorBars","gridLines","legend","trendLines","upDownBars"],[e.scatter]:["axes","axisTitles","chartTitle","dataLabels","errorBars","gridLines","legend","trendLines"],[e.scatterLine]:["axes","axisTitles","chartTitle","dataLabels","errorBars","gridLines","legend","trendLines"],[e.scatterLineMarker]:["axes","axisTitles","chartTitle","dataLabels","errorBars","gridLines","legend","trendLines"],[e.scatterMarker]:["axes","axisTitles","chartTitle","dataLabels","errorBars","gridLines","legend","trendLines"],[e.scatterNone]:["axes","axisTitles","chartTitle","dataLabels","errorBars","gridLines","legend","trendLines"],[e.scatterSmooth]:["axes","axisTitles","chartTitle","dataTable","errorBars","gridLines","legend","trendLines"],[e.scatterSmoothMarker]:["axes","axisTitles","chartTitle","dataTable","errorBars","gridLines","legend","trendLines"],[e.surfaceNormal]:["axes","axisTitles","chartTitle","gridLines","legend"],[e.surfaceWireframe]:["axes","axisTitles","chartTitle","gridLines","legend"],[e.contourNormal]:["axes","axisTitles","chartTitle","gridLines","legend"],[e.contourWireframe]:["axes","axisTitles","chartTitle","gridLines","legend"],[e.comboCustom]:["axes","axisTitles","chartTitle","dataLabels","dataTable","errorBars","gridLines","legend","trendLines"],[e.comboBarLine]:["axes","axisTitles","chartTitle","dataLabels","dataTable","errorBars","gridLines","legend","trendLines"],[e.comboBarLineSecondary]:["axes","axisTitles","chartTitle","dataLabels","dataTable","errorBars","gridLines","legend","trendLines"],[e.comboAreaBar]:["axes","axisTitles","chartTitle","dataLabels","dataTable","errorBars","gridLines","legend"],[e.radar]:["axes","chartTitle","dataLabels","gridLines","legend"],[e.radarMarker]:["axes","chartTitle","dataLabels","gridLines","legend"],[e.radarFilled]:["axes","chartTitle","dataLabels","gridLines","legend"],[e.unknown]:["axes","axisTitles","chartTitle","dataLabels","dataTable","errorBars","gridLines","legend","trendLines","upDownBars"]};t.onChartElement=function(t,i){var s=this.chartProps,n=s.getHorAxesProps&&s.getHorAxesProps()[0],a=s.getHorAxesProps&&s.getHorAxesProps()[1],o=s.getVertAxesProps&&s.getVertAxesProps()[0],l=s.getVertAxesProps&&s.getVertAxesProps()[1],r=s.getDepthAxesProps&&s.getDepthAxesProps()[0],c=n&&(1===n.getGridlines()||3===n.getGridlines()),d=n&&(2===n.getGridlines()||3===n.getGridlines()),h=o&&(1===o.getGridlines()||3===o.getGridlines()),p=o&&(2===o.getGridlines()||3===o.getGridlines());const m=i.value,u=s.getType(),g=[e.radar,e.radarMarker,e.radarFilled].includes(u),b=[e.hBarNormal,e.hBarStacked,e.hBarStackedPer,e.hBarNormal3d,e.hBarStacked3d,e.hBarStackedPer3d].includes(u),f=[e.scatter,e.scatterLine,e.scatterLineMarker,e.scatterMarker,e.scatterNone,e.scatterSmooth,e.scatterSmoothMarker,e.surfaceNormal].includes(u),C=[e.comboCustom].includes(u);switch(m){case"bShowHorAxis":b?s.setDisplayAxes(o&&o.getShow(),l&&l.getShow(),i.checked,a&&a.getShow(),r&&r.getShow()):f?s.setDisplayAxes(l&&l.getShow(),a&&a.getShow(),i.checked,o&&o.getShow(),r&&r.getShow()):C?s.setDisplayAxes(i.checked,l&&l.getShow(),o&&o.getShow(),a&&a.getShow(),r&&r.getShow()):s.setDisplayAxes(i.checked,a&&a.getShow(),o&&o.getShow(),l&&l.getShow(),r&&r.getShow());break;case"bShowVertAxis":b?s.setDisplayAxes(i.checked,l&&l.getShow(),n&&n.getShow(),a&&a.getShow(),r&&r.getShow()):f?s.setDisplayAxes(l&&l.getShow(),a&&a.getShow(),n&&n.getShow(),i.checked,r&&r.getShow()):C?s.setDisplayAxes(n&&n.getShow(),l&&l.getShow(),i.checked,a&&a.getShow(),r&&r.getShow()):s.setDisplayAxes(n&&n.getShow(),a&&a.getShow(),i.checked,l&&l.getShow(),r&&r.getShow());break;case"bShowHorAxSec":C?s.setDisplayAxes(n&&n.getShow(),l&&l.getShow(),o&&o.getShow(),i.checked,r&&r.getShow()):s.setDisplayAxes(n&&n.getShow(),i.checked,o&&o.getShow(),l&&l.getShow(),r&&r.getShow());break;case"bShowVertAxSec":C?s.setDisplayAxes(n&&n.getShow(),i.checked,o&&o.getShow(),a&&a.getShow(),r&&r.getShow()):s.setDisplayAxes(n&&n.getShow(),a&&a.getShow(),o&&o.getShow(),i.checked,r&&r.getShow());break;case"bShowDepthAxes":s.setDisplayAxes(n&&n.getShow(),a&&a.getShow(),o&&o.getShow(),l&&l.getShow(),i.checked);break;case"bShowHorAxTitle":b?s.setDisplayAxisTitles(o&&1===o.getLabel(),l&&1===l.getLabel(),i.checked,a&&1===a.getLabel(),r&&1===r.getLabel()):f?s.setDisplayAxisTitles(a&&1===a.getLabel(),l&&1===l.getLabel(),i.checked,o&&1===o.getLabel(),r&&1===r.getLabel()):C?s.setDisplayAxisTitles(i.checked,l&&1===l.getLabel(),o&&1===o.getLabel(),a&&1===a.getLabel(),r&&1===r.getLabel()):s.setDisplayAxisTitles(i.checked,a&&1===a.getLabel(),o&&1===o.getLabel(),l&&1===l.getLabel(),r&&1===r.getLabel());break;case"bShowVertAxTitle":b?s.setDisplayAxisTitles(i.checked,l&&1===l.getLabel(),n&&1===n.getLabel(),a&&1===a.getLabel(),r&&1===r.getLabel()):f?s.setDisplayAxisTitles(a&&1===a.getLabel(),l&&1===l.getLabel(),n&&1===n.getLabel(),i.checked,r&&1===r.getLabel()):C?s.setDisplayAxisTitles(n&&1===n.getLabel(),l&&1===l.getLabel(),i.checked,a&&1===a.getLabel(),r&&1===r.getLabel()):s.setDisplayAxisTitles(n&&1===n.getLabel(),a&&1===a.getLabel(),i.checked,l&&1===l.getLabel(),r&&1===r.getLabel());break;case"bShowHorAxTitleSec":C?s.setDisplayAxisTitles(n&&1===n.getLabel(),l&&1===l.getLabel(),o&&1===o.getLabel(),i.checked,r&&1===r.getLabel()):s.setDisplayAxisTitles(n&&1===n.getLabel(),i.checked,o&&1===o.getLabel(),l&&1===l.getLabel(),r&&1===r.getLabel());break;case"bShowVertAxisTitleSec":C?s.setDisplayAxisTitles(n&&1===n.getLabel(),i.checked,o&&1===o.getLabel(),a&&1===a.getLabel(),r&&1===r.getLabel()):s.setDisplayAxisTitles(n&&1===n.getLabel(),a&&1===a.getLabel(),o&&1===o.getLabel(),i.checked,r&&1===r.getLabel());break;case"bShowDepthAxisTitle":s.setDisplayAxes(n&&1===n.getLabel(),a&&1===a.getLabel(),o&&1===o.getLabel(),l&&1===l.getLabel(),i.checked);break;case"bShowChartTitleNone":s.setDisplayChartTitle(!1,!1);break;case"bShowChartTitle":s.setDisplayChartTitle(!0,!1);break;case"bOverlayTitle":s.setDisplayChartTitle(!0,!0);break;case"CenterData":s.setDisplayDataLabels(!0,Asc.c_oAscChartDataLabelsPos.ctr);break;case"InnerBottomData":s.setDisplayDataLabels(!0,Asc.c_oAscChartDataLabelsPos.inBase);break;case"InnerTopData":s.setDisplayDataLabels(!0,Asc.c_oAscChartDataLabelsPos.inEnd);break;case"OuterTopData":s.setDisplayDataLabels(!0,Asc.c_oAscChartDataLabelsPos.outEnd);break;case"TopData":s.setDisplayDataLabels(!0,Asc.c_oAscChartDataLabelsPos.t);break;case"LeftData":s.setDisplayDataLabels(!0,Asc.c_oAscChartDataLabelsPos.l);break;case"RightData":s.setDisplayDataLabels(!0,Asc.c_oAscChartDataLabelsPos.r);break;case"BottomData":s.setDisplayDataLabels(!0,Asc.c_oAscChartDataLabelsPos.b);break;case"FitWidthData":s.setDisplayDataLabels(!0,Asc.c_oAscChartDataLabelsPos.bestFit);break;case"bShowDataLabels":s.setDisplayDataLabels(!1,!1);break;case"standardError":s.setDisplayErrorBars(!0,4);break;case"percentage":s.setDisplayErrorBars(!0,2);break;case"standardDeviation":s.setDisplayErrorBars(!0,3);break;case"bShowHorMajor":b?s.setDisplayGridlines(c,i.checked,d,p):s.setDisplayGridlines(i.checked,c,p,d);break;case"bShowVerMajor":b||g?s.setDisplayGridlines(i.checked,h,d,p):s.setDisplayGridlines(h,i.checked,p,d);break;case"bShowHorMinor":b?s.setDisplayGridlines(c,h,d,i.checked):s.setDisplayGridlines(h,c,i.checked,d);break;case"bShowVerMinor":b||g?s.setDisplayGridlines(c,h,i.checked,p):s.setDisplayGridlines(h,c,p,i.checked);break;case"NoneLegend":s.setDisplayLegend(!1,Asc.c_oAscChartLegendShowSettings.none);break;case"LeftLegend":s.setDisplayLegend(!0,Asc.c_oAscChartLegendShowSettings.left);break;case"TopLegend":s.setDisplayLegend(!0,Asc.c_oAscChartLegendShowSettings.top);break;case"RightLegend":s.setDisplayLegend(!0,Asc.c_oAscChartLegendShowSettings.right);break;case"BottomLegend":s.setDisplayLegend(!0,Asc.c_oAscChartLegendShowSettings.bottom);break;case"LeftOverlay":s.setDisplayLegend(!0,Asc.c_oAscChartLegendShowSettings.leftOverlay);break;case"RightOverlay":s.setDisplayLegend(!0,Asc.c_oAscChartLegendShowSettings.rightOverlay);break;case"trendLineNone":s.setDisplayTrendlines(!1,!1,0,0);break;case"trendLineLinear":s.setDisplayTrendlines(!0,1,0,0);break;case"trendLineExponential":s.setDisplayTrendlines(!0,0,0,0);break;case"trendLineForecast":s.setDisplayTrendlines(!0,1,2,0);break;case"trendLineMovingAverage":s.setDisplayTrendlines(!0,3,0,0);break;case"bShowUpDownBars":s.setDisplayUpDownBars(!0);break;case"bShowUpDownNone":s.setDisplayUpDownBars(!1)}},t.updateChartElementMenu=function(t,s){const n=s.getType(),a=s.getHorAxesProps&&s.getHorAxesProps(),o=s.getVertAxesProps&&s.getVertAxesProps(),l=s.getDepthAxesProps&&s.getDepthAxesProps(),r=s.getDataLabelsPos&&s.getDataLabelsPos(),c=s.getTitle&&s.getTitle(),d=s.getLegendPos&&s.getLegendPos(),h=Asc.c_oAscGridLinesSettings.major,p=Asc.c_oAscGridLinesSettings.minor,m=Asc.c_oAscGridLinesSettings.majorMinor,u=[e.comboCustom,e.comboBarLine,e.comboBarLineSecondary,e.comboAreaBar].includes(n),g=[e.radar,e.radarMarker,e.radarFilled].includes(n),b=[e.barNormal,e.barStacked,e.barStackedPer,e.hBarNormal,e.hBarStacked,e.hBarStackedPer],f=[e.barNormal,e.barStacked,e.barStackedPer,e.pie,e.pie3d,e.hBarNormal,e.hBarStacked,e.hBarStackedPer],C=[e.barNormal,e.pie,e.pie3d,e.hBarNormal],x=[e.lineNormal,e.lineStacked,e.lineStackedPer,e.lineNormalMarker,e.lineStackedMarker,e.lineStackedPerMarker,e.stock,e.scatter,e.scatterLine,e.scatterLineMarker,e.scatterSmooth,e.scatterSmoothMarker],v=[e.pie,e.pie3d],y=u?s.getSeries&&s.getSeries()[0]&&s.getSeries()[0].asc_getChartType():n,_=b.includes(y),A=f.includes(y),S=C.includes(y),w=x.includes(y),T=v.includes(y),P=t.items[0].menu;P.items[0].setVisible(!g),P.items[0].setChecked(!g&&a&&a[0]&&a[0].getShow()),P.items[1].setChecked(o&&o[0]&&o[0].getShow()),P.items[4].setVisible(l&&l[0]),P.items[4].setChecked(l&&l[0]&&l[0].getShow()),u?(P.items[2].setVisible(a&&a[1]),P.items[2].setChecked(a&&a[1]&&a[1].getShow()),P.items[3].setVisible(o&&o[1]),P.items[3].setChecked(o&&o[1]&&o[1].getShow())):(P.items[2].setVisible(!1),P.items[3].setVisible(!1));const k=t.items[1].menu;k.items[0].setChecked(a&&a[0]&&a[0].getLabel()===Asc.c_oAscChartHorAxisLabelShowSettings.noOverlay),k.items[1].setChecked(o&&o[0]&&o[0].getLabel()===Asc.c_oAscChartVertAxisLabelShowSettings.rotated),k.items[4].setVisible(l&&l[0]),k.items[4].setChecked(l&&l[0]&&l[0].getLabel()===Asc.c_oAscChartVertAxisLabelShowSettings.rotated),u?(k.items[2].setVisible(a&&a[1]),k.items[2].setChecked(a&&a[1]&&a[1].getLabel()===Asc.c_oAscChartHorAxisLabelShowSettings.noOverlay),k.items[3].setVisible(o&&o[1]),k.items[3].setChecked(o&&o[1]&&o[1].getLabel()===Asc.c_oAscChartVertAxisLabelShowSettings.rotated)):(k.items[2].setVisible(!1),k.items[3].setVisible(!1));const I=t.items[2].menu;I.items[0].setChecked(c===Asc.c_oAscChartTitleShowSettings.none),I.items[1].setChecked(c===Asc.c_oAscChartTitleShowSettings.noOverlay),I.items[2].setChecked(c===Asc.c_oAscChartTitleShowSettings.overlay);const D=t.items[3].menu;D.items[0].setChecked(r===Asc.c_oAscChartDataLabelsPos.none),D.items[1].setChecked(r===Asc.c_oAscChartDataLabelsPos.ctr),D.items[2].setChecked(_&&r===Asc.c_oAscChartDataLabelsPos.inBase),D.items[3].setChecked(A&&r===Asc.c_oAscChartDataLabelsPos.inEnd),D.items[4].setChecked(S&&r===Asc.c_oAscChartDataLabelsPos.outEnd),D.items[5].setChecked(w&&r===Asc.c_oAscChartDataLabelsPos.t),D.items[6].setChecked(w&&r===Asc.c_oAscChartDataLabelsPos.l),D.items[7].setChecked(w&&r===Asc.c_oAscChartDataLabelsPos.r),D.items[8].setChecked(w&&r===Asc.c_oAscChartDataLabelsPos.b),D.items[9].setChecked(T&&r===Asc.c_oAscChartDataLabelsPos.bestFit),void 0!==r&&(D.items[2].setVisible(_),D.items[3].setVisible(A),D.items[4].setVisible(S),D.items[5].setVisible(w),D.items[6].setVisible(w),D.items[7].setVisible(w),D.items[8].setVisible(w),D.items[9].setVisible(T));const F=t.items[5].menu;F.items[0].setVisible(!0),F.items[2].setVisible(!0),g?(F.items[0].setVisible(!1),F.items[0].setChecked(!1),F.items[1].setChecked(o&&o[0]&&(o[0].getGridlines()===h||o[0].getGridlines()===m)),F.items[2].setChecked(!1),F.items[2].setVisible(!1),F.items[3].setChecked(o&&o[0]&&(o[0].getGridlines()===p||o[0].getGridlines()===m))):n!==Asc.c_oAscChartTypeSettings.pie&&n!==Asc.c_oAscChartTypeSettings.pie3d&&(F.items[0].setChecked(o&&o[0]&&(o[0].getGridlines()===h||o[0].getGridlines()===m)),F.items[1].setChecked(a&&a[0]&&(a[0].getGridlines()===h||a[0].getGridlines()===m)),F.items[2].setChecked(o&&o[0]&&(o[0].getGridlines()===p||o[0].getGridlines()===m)),F.items[3].setChecked(a&&a[0]&&(a[0].getGridlines()===p||a[0].getGridlines()===m)));const M=t.items[6].menu;M.items[0].setChecked(d===Asc.c_oAscChartLegendShowSettings.top),M.items[1].setChecked(d===Asc.c_oAscChartLegendShowSettings.left),M.items[2].setChecked(d===Asc.c_oAscChartLegendShowSettings.right),M.items[3].setChecked(d===Asc.c_oAscChartLegendShowSettings.bottom),M.items[4].setChecked(d===Asc.c_oAscChartLegendShowSettings.leftOverlay),M.items[5].setChecked(d===Asc.c_oAscChartLegendShowSettings.rightOverlay);const V=i[n]||[];t.items.forEach((function(t){t.setVisible(V.includes(t.value))}))},t.onSingleChartSelectionChanged=function(t){if(this.mode&&this.mode.isPDFEdit&&this.mode.isEdit){var e=this,i=e.documentHolder,s=i.cmpEl.find("#chart-element-container");if(e._state.currentChartRect=t,e.getCurrentChartProps=function(){var t=e.api.getSelectedElements();if(t&&t.length>0)for(var i,s,n=t.length-1;n>=0;n--)if(i=t[n].get_ObjectType(),s=t[n].get_ObjectValue(),i===Asc.c_oAscTypeSelectElement.Chart)return s.get_ChartProperties();return null},e.chartProps=e.getCurrentChartProps(),s.length<1&&(s=$('<div id="chart-element-container" style="position: absolute; z-index: 990;"><div id="id-document-holder-btn-chart-element"></div></div>'),i.cmpEl.append(s)),e.isRtlSheet=!!e.api&&Common.UI.isRTL(),e.chartProps){e.btnChartElement||(e.btnChartElement=new Common.UI.Button({parentEl:$("#id-document-holder-btn-chart-element"),cls:"btn-toolbar",iconCls:"toolbar__icon btn-chart-elements",hint:e.documentHolder.btnChart,menu:e.documentHolder.menuChartElement.menu}),e.btnChartElement.on("click",(function(){e.chartProps=e.getCurrentChartProps(),e.chartProps&&e.updateChartElementMenu(e.documentHolder.menuChartElement.menu,e.chartProps)}))),e._XY=void 0,e.checkEditorOffsets();var n,a=t.asc_getX(),o=t.asc_getY(),l=t.asc_getWidth(),r=t.asc_getHeight(),c=o,d=a-(40===s.width()?50:42),h=a+l+7;if(e.isRtlSheet)if(d>=0)n=d+15;else{if(!(h+50<=e._Width))return void s.hide();n=h+15}else if(h+50<=e._Width+18)n=h;else{if(!(d>=0))return void s.hide();n=d}if(c<0&&(c=0),o<0)if(o+r<20)return void s.hide();s.css({left:n+"px",top:c+"px"}).show(),e.disableChartElementButton()}else s.hide()}},t.onHideChartElementButton=function(){if(this.documentHolder&&this.documentHolder.cmpEl){var t=this.documentHolder.cmpEl.find("#chart-element-container");t.is(":visible")&&t.hide()}},t.disableChartElementButton=function(){var t=this.documentHolder.cmpEl.find("#chart-element-container"),e=this._isDisabled||this._state.chartLocked;t.length>0&&t.is(":visible")&&this.btnChartElement.setDisabled(!!e)},t.onInsertImage=function(t,e,i){this.documentHolder&&this.mode&&this.mode.isPDFEdit&&this.mode.isEdit&&!this._isDisabled&&(this.api&&this.api.asc_addImage(t),this.editComplete())},t.onInsertImageUrl=function(t,e,i){if(this.documentHolder&&this.mode&&this.mode.isPDFEdit&&this.mode.isEdit&&!this._isDisabled){var s=this;new Common.Views.ImageFromUrlDialog({handler:function(e,i){if("ok"==e&&s.api){var n=i.replace(/ /g,"");_.isEmpty(n)||s.api.AddImageUrl([n],void 0,void 0,t)}s.editComplete()}}).show()}}}})),define("pdfeditor/main/app/view/FileMenuPanels",[],(function(){"use strict";!PDFE.Views.FileMenuPanels&&(PDFE.Views.FileMenuPanels={}),PDFE.Views.FileMenuPanels.ViewSaveAs=Common.UI.BaseView.extend({el:"#panel-saveas",menu:void 0,formats:[[{name:"DOCX",imgCls:"docx",type:Asc.c_oAscFileType.DOCX},{name:"PDF",imgCls:"pdf",type:Asc.c_oAscFileType.PDF},{name:"ODT",imgCls:"odt",type:Asc.c_oAscFileType.ODT}],[{name:"DOTX",imgCls:"dotx",type:Asc.c_oAscFileType.DOTX},{name:"PDFA",imgCls:"pdfa",type:Asc.c_oAscFileType.PDFA},{name:"OTT",imgCls:"ott",type:Asc.c_oAscFileType.OTT}],[{name:"RTF",imgCls:"rtf",type:Asc.c_oAscFileType.RTF},{name:"TXT",imgCls:"txt",type:Asc.c_oAscFileType.TXT},{name:"FB2",imgCls:"fb2",type:Asc.c_oAscFileType.FB2},{name:"EPUB",imgCls:"epub",type:Asc.c_oAscFileType.EPUB},{name:"HTML (Zipped)",imgCls:"html",type:Asc.c_oAscFileType.HTML}],[{name:"JPG",imgCls:"jpg",type:Asc.c_oAscFileType.JPG},{name:"PNG",imgCls:"png",type:Asc.c_oAscFileType.PNG}]],template:_.template(['<div class="content-container">','<div class="header"><%= header %></div>','<div class="format-items">',"<% _.each(rows, function(row) { %>","<% _.each(row, function(item) { %>",'<div class="format-item float-left"><div class="btn-doc-format" format="<%= item.type %>" data-hint="2" data-hint-direction="left-top" data-hint-offset="4, 4">','<div class ="svg-format-<%= item.imgCls %>"></div>',"</div></div>","<% }) %>",'<div class="divider"></div>',"<% }) %>","</div>","</div>"].join("")),initialize:function(t){Common.UI.BaseView.prototype.initialize.call(this,arguments),this.menu=t.menu,this.fileType=t.fileType,this.mode=t.mode,Common.NotificationCenter.on({"window:resize":_.bind((function(){var t=Common.Utils.innerWidth()>=this.maxWidth;this.isDivided!==t&&(this.$el.find(".divider").css("width",t?"100%":"0"),this.isDivided=t)}),this)})},render:function(){/^pdf$/.test(this.fileType)?((!this.mode||!this.mode.isForm)&&this.formats[0].splice(1,1,{name:"PDF",imgCls:"pdf",type:""}),this.formats[1].splice(1,1)):/^xps|oxps$/.test(this.fileType)?this.formats[0].push({name:this.fileType.toUpperCase(),imgCls:this.fileType,type:""}):/^djvu$/.test(this.fileType)&&(this.formats=[[{name:"DJVU",imgCls:"djvu",type:""},{name:"PDF",imgCls:"pdf",type:Asc.c_oAscFileType.PDF}]]),this.$el.html(this.template({rows:this.formats,fileType:(this.fileType||"docx").toLowerCase(),header:Common.Locale.get("btnDownloadCaption",{name:"PDFE.Views.FileMenu",default:this.textDownloadAs})})),$(".btn-doc-format",this.el).on("click",_.bind(this.onFormatClick,this)),_.isUndefined(this.scroller)&&(this.scroller=new Common.UI.Scroller({el:this.$el,suppressScrollX:!0,alwaysVisibleY:!0}));var t=0;return this.formats.forEach(_.bind((function(e,i){var s=e.length;s>t&&(t=s)}),this)),this.maxWidth=$("#file-menu-panel .panel-menu").outerWidth()+20+10+94*t,Common.Utils.innerWidth()>=this.maxWidth&&(this.$el.find(".divider").css("width","100%"),this.isDivided=!0),this},show:function(){Common.UI.BaseView.prototype.show.call(this,arguments),this.scroller&&this.scroller.update()},onFormatClick:function(t){var e=t.currentTarget.attributes.format;!_.isUndefined(e)&&this.menu&&this.menu.fireEvent("saveas:format",[this.menu,e.value?parseInt(e.value):void 0])},textDownloadAs:"Download as"}),PDFE.Views.FileMenuPanels.ViewSaveCopy=Common.UI.BaseView.extend({el:"#panel-savecopy",menu:void 0,formats:[[{name:"DOCX",imgCls:"docx",type:Asc.c_oAscFileType.DOCX,ext:".docx"},{name:"PDF",imgCls:"pdf",type:Asc.c_oAscFileType.PDF,ext:".pdf"},{name:"ODT",imgCls:"odt",type:Asc.c_oAscFileType.ODT,ext:".odt"}],[{name:"DOTX",imgCls:"dotx",type:Asc.c_oAscFileType.DOTX,ext:".dotx"},{name:"PDFA",imgCls:"pdfa",type:Asc.c_oAscFileType.PDFA,ext:".pdf"},{name:"OTT",imgCls:"ott",type:Asc.c_oAscFileType.OTT,ext:".ott"}],[{name:"RTF",imgCls:"rtf",type:Asc.c_oAscFileType.RTF,ext:".rtf"},{name:"TXT",imgCls:"txt",type:Asc.c_oAscFileType.TXT,ext:".txt"},{name:"FB2",imgCls:"fb2",type:Asc.c_oAscFileType.FB2,ext:".fb2"},{name:"EPUB",imgCls:"epub",type:Asc.c_oAscFileType.EPUB,ext:".epub"},{name:"HTML (Zipped)",imgCls:"html",type:Asc.c_oAscFileType.HTML,ext:".html"}],[{name:"JPG",imgCls:"jpg",type:Asc.c_oAscFileType.JPG,ext:".zip"},{name:"PNG",imgCls:"png",type:Asc.c_oAscFileType.PNG,ext:".zip"}]],template:_.template(['<div class="content-container">','<div class="header"><%= header %></div>','<div class="format-items">',"<% _.each(rows, function(row) { %>","<% _.each(row, function(item) { %>",'<div class="format-item float-left"><div class="btn-doc-format" format="<%= item.type %>" format-ext="<%= item.ext %>" data-hint="2" data-hint-direction="left-top" data-hint-offset="4, 4">','<div class ="svg-format-<%= item.imgCls %>"></div>',"</div></div>","<% }) %>",'<div class="divider"></div>',"<% }) %>","</div>","</div>"].join("")),initialize:function(t){Common.UI.BaseView.prototype.initialize.call(this,arguments),this.menu=t.menu,this.fileType=t.fileType,this.mode=t.mode,Common.NotificationCenter.on({"window:resize":_.bind((function(){var t=Common.Utils.innerWidth()>=this.maxWidth;this.isDivided!==t&&(this.$el.find(".divider").css("width",t?"100%":"0"),this.isDivided=t)}),this)})},render:function(){/^pdf$/.test(this.fileType)?((!this.mode||!this.mode.isForm)&&this.formats[0].splice(1,1,{name:"PDF",imgCls:"pdf",type:"",ext:!0}),this.formats[1].splice(1,1)):/^xps|oxps$/.test(this.fileType)?this.formats[0].push({name:this.fileType.toUpperCase(),imgCls:this.fileType,type:"",ext:!0}):/^djvu$/.test(this.fileType)&&(this.formats=[[{name:"DJVU",imgCls:"djvu",type:"",ext:!0},{name:"PDF",imgCls:"pdf",type:Asc.c_oAscFileType.PDF,ext:".pdf"}]]),this.$el.html(this.template({rows:this.formats,fileType:(this.fileType||"docx").toLowerCase(),header:Common.Locale.get("btnSaveCopyAsCaption",{name:"PDFE.Views.FileMenu",default:this.textSaveCopyAs})})),$(".btn-doc-format",this.el).on("click",_.bind(this.onFormatClick,this)),_.isUndefined(this.scroller)&&(this.scroller=new Common.UI.Scroller({el:this.$el,suppressScrollX:!0,alwaysVisibleY:!0}));var t=0;return this.formats.forEach(_.bind((function(e,i){var s=e.length;s>t&&(t=s)}),this)),this.maxWidth=$("#file-menu-panel .panel-menu").outerWidth()+20+10+94*t,Common.Utils.innerWidth()>=this.maxWidth&&(this.$el.find(".divider").css("width","100%"),this.isDivided=!0),this},show:function(){Common.UI.BaseView.prototype.show.call(this,arguments),this.scroller&&this.scroller.update()},onFormatClick:function(t){var e=t.currentTarget.attributes.format,i=t.currentTarget.attributes["format-ext"];_.isUndefined(e)||_.isUndefined(i)||!this.menu||this.menu.fireEvent("saveas:format",[this.menu,e.value?parseInt(e.value):void 0,i.value])},textSaveCopyAs:"Save Copy as"}),PDFE.Views.FileMenuPanels.Settings=Common.UI.BaseView.extend(_.extend({el:"#panel-settings",menu:void 0,template:_.template(['<div class="flex-settings">','<div class="header"><%= scope.txtAdvancedSettings %></div>',"<table><tbody>",'<tr class="editsave">','<td colspan="2" class="group-name top"><label><%= scope.txtEditingSaving %></label></td>',"</tr>",'<tr class="autosave">','<td colspan="2"><span id="fms-chb-autosave"></span></td>',"</tr>",'<tr class="forcesave">','<td colspan="2"><span id="fms-chb-forcesave"></span></td>',"</tr>",'<tr class ="editsave divider-group"></tr>','<tr class="collaboration">','<td colspan="2" class="group-name"><label><%= scope.txtCollaboration %></label></td>',"</tr>",'<tr class="coauth changes-mode">','<td colspan="2" class="subgroup-name"><label><%= scope.strCoAuthMode %></label></td>',"</tr>",'<tr class="coauth changes-mode">','<td colspan="2"><div style="display: flex;" role="radiogroup" aria-owns="fms-rb-coauth-mode-strict"><div id="fms-rb-coauth-mode-fast"></div>','<span style ="display: flex; flex-direction: column;"><label><%= scope.strFast %></label>','<label class="comment-text"><%= scope.txtFastTip %></label></span></div>',"</td>","</tr>",'<tr class="coauth changes-mode">','<td colspan="2"><div style="display: flex;"><div id="fms-rb-coauth-mode-strict"></div>','<span style ="display: flex; flex-direction: column;"><label><%= scope.strStrict %></label>','<label class="comment-text"><%= scope.txtStrictTip %></label></span>',"</div></td>","</tr>",'<tr class ="divider-subgroup coauth changes-mode"></tr>','<tr class="coauth changes-show">','<td colspan="2" class="subgroup-name"><label><%= scope.strShowChanges %></label></td>',"</tr>",'<tr class="coauth changes-show">','<td colspan="2" role="radiogroup" aria-owns="fms-rb-show-changes-all fms-rb-show-changes-last"><div id="fms-rb-show-changes-none"></div></td>',"</tr>",'<tr class="coauth changes-show">','<td colspan="2"><div id="fms-rb-show-changes-all"></div></td>',"</tr>",'<tr class="coauth changes-show">','<td colspan="2"><div id="fms-rb-show-changes-last"></div></td>',"</tr>",'<tr class="divider coauth changes-show"></tr>','<tr class="live-viewer">','<td colspan="2"><div id="fms-chb-live-viewer"></div></td>',"</tr>",'<tr class="divider live-viewer"></tr>','<tr class="comments">','<td colspan="2"><div id="fms-chb-live-comment"></div></td>',"</tr>",'<tr class="comments">','<td colspan="2"><div id="fms-chb-resolved-comment"></div></td>',"</tr>",'<tr class ="collaboration divider-group"></tr>','<tr class="appearance">','<td colspan="2" class="group-name"><label><%= scope.txtAppearance %></label></td>',"</tr>",'<tr class="themes">',"<td><label><%= scope.strTheme %></label></td>","<td>",'<div><div id="fms-cmb-theme"></div>','<div id="fms-chb-dark-mode"></div></div></td>',"</tr>",'<tr class="tab-style">',"<td><label><%= scope.strTabStyle %></label></td>",'<td><div id="fms-cmb-tab-style"></div></td>',"</tr>",'<tr class="tab-background">','<td colspan="2"><div id="fms-chb-tab-background"></div></td>',"</tr>",'<tr class ="collaboration divider-group"></tr>',"<tr>",'<td colspan="2" class="group-name"><label><%= scope.txtWorkspace %></label></td>',"</tr>","<tr>",'<td colspan="2"><div id="fms-chb-scrn-reader"></div></td>',"</tr>","<tr>",'<td colspan="2"><div id="fms-chb-use-alt-key"></div></td>',"</tr>",'<tr class="edit">','<td colspan="2"><div id="fms-chb-annotation-bar"></div></td>',"</tr>",'<tr class="edit quick-access">','<td colspan="2"><button type="button" class="btn btn-text-default" id="fms-btn-customize-quick-access" style="width:auto;display:inline-block;padding-right:10px;padding-left:10px;" data-hint="2" data-hint-direction="bottom" data-hint-offset="medium"><%= scope.txtCustomizeQuickAccess %></button></div></td>',"</tr>",'<tr class="edit-pdf">',"<td><label><%= scope.strUnit %></label></td>",'<td><span id="fms-cmb-unit"></span></td>',"</tr>","<tr>","<td><label><%= scope.strZoom %></label></td>",'<td><div id="fms-cmb-zoom" class="input-group-nr"></div></td>',"</tr>","<tr>","<td><label><%= scope.strFontRender %></label></td>",'<td><span id="fms-cmb-font-render"></span></td>',"</tr>","<tr>",'<td><label><%= scope.strKeyboardShortcuts %><span class="new-hint"><%= Common.UI.SynchronizeTip.prototype.textNew.toUpperCase() %></span></label></td>','<td colspan="2"><button type="button" class="btn btn-text-default" id="fms-btn-keyboard-shortcuts" style="width:auto; display: inline-block;padding-right: 10px;padding-left: 10px;" data-hint="2" data-hint-direction="bottom" data-hint-offset="medium"><%= scope.txtCustomize %></button></div></td>',"</tr>",'<tr class ="divider-group"></tr>','<tr class="fms-btn-apply">','<td style="padding-top:15px; padding-bottom: 15px;"><button class="btn normal dlg-btn primary" data-hint="2" data-hint-direction="bottom" data-hint-offset="medium"><%= scope.okButtonText %></button></td>',"<td></td>","</tr>","</tbody></table>","</div>",'<div class="fms-flex-apply hidden">','<table style="margin: 10px 20px;"><tbody>',"<tr>",'<td><button class="btn normal dlg-btn primary" data-hint="2" data-hint-direction="bottom" data-hint-offset="big"><%= scope.okButtonText %></button></td>',"<td></td>","</tr>","</tbody></table>","</div>"].join("")),initialize:function(t){Common.UI.BaseView.prototype.initialize.call(this,arguments),this.menu=t.menu},render:function(t){var e=this,i=$(this.template({scope:this}));this.chUseAltKey=new Common.UI.CheckBox({el:i.findById("#fms-chb-use-alt-key"),labelText:Common.Utils.isMac?this.txtUseOptionKey:this.txtUseAltKey,dataHint:"2",dataHintDirection:"left",dataHintOffset:"small"}),(Common.Utils.isIE||Common.Utils.isMac&&Common.Utils.isGecko)&&this.chUseAltKey.$el.parent().parent().hide(),this.chUseAnnotateBar=new Common.UI.CheckBox({el:i.findById("#fms-chb-annotation-bar"),labelText:this.txtUseAnnotateBar,dataHint:"2",dataHintDirection:"left",dataHintOffset:"small"}),this.chScreenReader=new Common.UI.CheckBox({el:i.findById("#fms-chb-scrn-reader"),labelText:this.txtScreenReader,dataHint:"2",dataHintDirection:"left",dataHintOffset:"small"}),this.chLiveComment=new Common.UI.CheckBox({el:i.findById("#fms-chb-live-comment"),labelText:this.strShowComments,dataHint:"2",dataHintDirection:"left",dataHintOffset:"small"}).on("change",(function(t,i,s,n){e.chResolvedComment.setDisabled("checked"!==t.getValue())})),this.chResolvedComment=new Common.UI.CheckBox({el:i.findById("#fms-chb-resolved-comment"),labelText:this.strShowResolvedComments,dataHint:"2",dataHintDirection:"left",dataHintOffset:"small"}),this.chAutosave=new Common.UI.CheckBox({el:i.findById("#fms-chb-autosave"),labelText:this.textAutoSave,dataHint:"2",dataHintDirection:"left",dataHintOffset:"small"}).on("change",(function(t,i,s,n){"checked"!==t.getValue()&&e.rbCoAuthModeFast.getValue()&&(e.rbCoAuthModeStrict.setValue(!0),e.onChangeCoAuthMode(e.rbCoAuthModeFast.getValue()?1:0))})),this.chForcesave=new Common.UI.CheckBox({el:i.findById("#fms-chb-forcesave"),labelText:this.textForceSave,dataHint:"2",dataHintDirection:"left",dataHintOffset:"small"}),this.cmbZoom=new Common.UI.ComboBox({el:i.findById("#fms-cmb-zoom"),style:"width: 160px;",editable:!1,restoreMenuHeightAndTop:!0,cls:"input-group-nr",restoreMenuHeight:!1,menuStyle:"min-width:100%; max-height: 157px;",data:[{value:-3,displayValue:this.txtLastUsed},{value:-1,displayValue:this.txtFitPage},{value:-2,displayValue:this.txtFitWidth},{value:50,displayValue:"50%"},{value:60,displayValue:"60%"},{value:70,displayValue:"70%"},{value:80,displayValue:"80%"},{value:90,displayValue:"90%"},{value:100,displayValue:"100%"},{value:110,displayValue:"110%"},{value:120,displayValue:"120%"},{value:150,displayValue:"150%"},{value:175,displayValue:"175%"},{value:200,displayValue:"200%"},{value:300,displayValue:"300%"},{value:400,displayValue:"400%"},{value:500,displayValue:"500%"}],dataHint:"2",dataHintDirection:"bottom",dataHintOffset:"big"}),this.rbCoAuthModeFast=new Common.UI.RadioBox({el:i.findById("#fms-rb-coauth-mode-fast"),name:"coauth-mode",dataHint:"2",dataHintDirection:"left",dataHintOffset:"small",ariaLabel:this.strFast+" "+this.txtFastTip}),this.rbCoAuthModeFast.on("change",(function(t,i,s){i&&(e.chAutosave.setValue(1),e.onChangeCoAuthMode(1))})),this.rbCoAuthModeFast.$el.parent().on("click",(function(){e.rbCoAuthModeFast.setValue(!0)})),this.rbCoAuthModeStrict=new Common.UI.RadioBox({el:i.findById("#fms-rb-coauth-mode-strict"),name:"coauth-mode",dataHint:"2",dataHintDirection:"left",dataHintOffset:"small",ariaLabel:this.strStrict+" "+this.txtStrictTip}),this.rbCoAuthModeStrict.on("change",(function(t,i,s){i&&e.onChangeCoAuthMode(0)})),this.rbCoAuthModeStrict.$el.parent().on("click",(function(){e.rbCoAuthModeStrict.setValue(!0)})),this.rbShowChangesNone=new Common.UI.RadioBox({el:i.findById("#fms-rb-show-changes-none"),name:"show-changes",labelText:this.txtNone,dataHint:"2",dataHintDirection:"left",dataHintOffset:"small"}),this.rbShowChangesAll=new Common.UI.RadioBox({el:i.findById("#fms-rb-show-changes-all"),name:"show-changes",labelText:this.txtAll,dataHint:"2",dataHintDirection:"left",dataHintOffset:"small"}),this.rbShowChangesLast=new Common.UI.RadioBox({el:i.findById("#fms-rb-show-changes-last"),name:"show-changes",labelText:this.txtLast,dataHint:"2",dataHintDirection:"left",dataHintOffset:"small"}),this.chLiveViewer=new Common.UI.CheckBox({el:i.findById("#fms-chb-live-viewer"),labelText:this.strShowOthersChanges,dataHint:"2",dataHintDirection:"left",dataHintOffset:"small"});var s=_.template(["<% _.each(items, function(item) { %>",'<li id="<%= item.id %>" data-value="<%= item.value %>" <% if (item.value === "custom") { %> class="border-top" <% } %> ><a tabindex="-1" type="menuitem" <% if (typeof(item.checked) !== "undefined" && item.checked) { %> class="checked" <% } %> ><%= scope.getDisplayValue(item) %></a></li>',"<% }); %>"].join(""));return this.cmbFontRender=new Common.UI.ComboBox({el:i.find("#fms-cmb-font-render"),style:"width: 160px;",editable:!1,restoreMenuHeightAndTop:!0,menuStyle:"min-width:100%;",cls:"input-group-nr",itemsTemplate:s,data:[{value:0,displayValue:this.txtWin},{value:1,displayValue:this.txtMac},{value:2,displayValue:this.txtNative},{value:"custom",displayValue:this.txtCacheMode}],dataHint:"2",dataHintDirection:"bottom",dataHintOffset:"big"}),this.cmbFontRender.on("selected",_.bind(this.onFontRenderSelected,this)),this.btnKeyboardMacros=new Common.UI.Button({el:i.findById("#fms-btn-keyboard-shortcuts")}),this.btnKeyboardMacros.on("click",_.bind(this.onClickKeyboardShortcut,this)),this.cmbUnit=new Common.UI.ComboBox({el:i.findById("#fms-cmb-unit"),style:"width: 160px;",editable:!1,restoreMenuHeightAndTop:!0,menuStyle:"min-width:100%;",cls:"input-group-nr",data:[{value:Common.Utils.Metric.c_MetricUnits.cm,displayValue:this.txtCm},{value:Common.Utils.Metric.c_MetricUnits.pt,displayValue:this.txtPt},{value:Common.Utils.Metric.c_MetricUnits.inch,displayValue:this.txtInch}],dataHint:"2",dataHintDirection:"bottom",dataHintOffset:"big"}),this.btnCustomizeQuickAccess=new Common.UI.Button({el:i.findById("#fms-btn-customize-quick-access")}),this.btnCustomizeQuickAccess.on("click",_.bind(this.customizeQuickAccess,this)),this.cmbTheme=new Common.UI.ComboBox({el:i.findById("#fms-cmb-theme"),style:"width: 160px;",menuStyle:"min-width:100%;",editable:!1,restoreMenuHeightAndTop:!0,cls:"input-group-nr",dataHint:"2",dataHintDirection:"bottom",dataHintOffset:"big"}).on("selected",(function(t,i){e.chDarkMode.setDisabled(!Common.UI.Themes.isDarkTheme(i.value))})),this.chDarkMode=new Common.UI.CheckBox({el:i.findById("#fms-chb-dark-mode"),labelText:this.txtDarkMode,dataHint:"2",dataHintDirection:"left",dataHintOffset:"small"}),i.find(".btn.primary").each((function(t,i){new Common.UI.Button({el:$(i)}).on("click",_.bind(e.applySettings,e))})),this.cmbTabStyle=new Common.UI.ComboBox({el:i.findById("#fms-cmb-tab-style"),style:"width: 160px;",menuStyle:"min-width:100%;",editable:!1,restoreMenuHeightAndTop:!0,cls:"input-group-nr",data:[{value:"fill",displayValue:this.textFill},{value:"line",displayValue:this.textLine}],dataHint:"2",dataHintDirection:"bottom",dataHintOffset:"big"}).on("selected",(function(t,i){e._isTabStyleChanged=!0})),this.chTabBack=new Common.UI.CheckBox({el:i.findById("#fms-chb-tab-background"),labelText:this.txtTabBack,dataHint:"2",dataHintDirection:"left",dataHintOffset:"small"}),this.pnlSettings=i.find(".flex-settings").addBack().filter(".flex-settings"),this.pnlApply=i.find(".fms-flex-apply").addBack().filter(".fms-flex-apply"),this.pnlTable=this.pnlSettings.find("table"),this.trApply=i.find(".fms-btn-apply"),this.$el=$(t).html(i),_.isUndefined(this.scroller)&&(this.scroller=new Common.UI.Scroller({el:this.pnlSettings,suppressScrollX:!0,alwaysVisibleY:!0})),Common.NotificationCenter.on({"window:resize":function(){e.isVisible()&&e.updateScroller()}}),this},show:function(){Common.UI.BaseView.prototype.show.call(this,arguments),this.updateSettings(),this.updateScroller()},updateScroller:function(){if(this.scroller){Common.UI.Menu.Manager.hideAll();var t=this.$el.height()<this.pnlTable.parent().height()+25+this.pnlApply.height();this.pnlApply.toggleClass("hidden",!t),this.trApply.toggleClass("hidden",t),this.pnlSettings.css("overflow",t?"hidden":"visible"),this.scroller.update(),this.pnlSettings.toggleClass("bordered",this.scroller.isVisible()),this.cmbZoom.options.menuAlignEl=t?this.pnlSettings:null,this.cmbUnit.options.menuAlignEl=t?this.pnlSettings:null,this.cmbFontRender.options.menuAlignEl=t?this.pnlSettings:null,this.cmbTheme.options.menuAlignEl=t?this.pnlSettings:null,this.cmbTabStyle.options.menuAlignEl=t?this.pnlSettings:null}},setMode:function(t){this.mode=t;var e=Common.Utils.InternalSettings.get("pdfe-settings-coauthmode"),i=t.isEdit&&(t.isPDFAnnotate||t.isPDFEdit)&&t.canSaveToFile;$("tr.edit",this.el)[t.isEdit?"show":"hide"](),$("tr.edit-pdf",this.el)[t.isPDFEdit?"show":"hide"](),$("tr.autosave",this.el)[!i||!t.canChangeCoAuthoring&&e?"hide":"show"](),$("tr.forcesave",this.el)[t.canForcesave&&i?"show":"hide"](),$("tr.editsave",this.el)[i&&(t.canChangeCoAuthoring||!e||t.canForcesave)?"show":"hide"](),this.mode.isDesktopApp&&this.mode.isOffline&&this.chAutosave.setCaption(this.textAutoRecover),$("tr.collaboration",this.el)[t.canCoAuthoring&&t.isEdit?"show":"hide"](),$("tr.coauth.changes-mode",this.el)[!t.isOffline&&t.canCoAuthoring&&t.canChangeCoAuthoring&&i?"show":"hide"](),$("tr.coauth.changes-show",this.el)[!t.isOffline&&t.canCoAuthoring&&i?"show":"hide"](),$("tr.live-viewer",this.el)[t.canLiveView&&!t.isOffline&&t.canChangeCoAuthoring?"show":"hide"](),$("tr.comments",this.el)[t.canCoAuthoring&&t.isEdit?"show":"hide"](),$("tr.tab-background",this.el)[!Common.Utils.isIE&&Common.UI.FeaturesManager.canChange("tabBackground",!0)?"show":"hide"](),$("tr.tab-style",this.el)[Common.Utils.isIE||Common.Controllers.Desktop.isWinXp()||!Common.UI.FeaturesManager.canChange("tabStyle",!0)?"hide":"show"](),$("tr.quick-print",this.el)[!t.canQuickPrint||t.compactHeader&&t.isEdit?"hide":"show"](),Common.UI.Themes.available()||$("tr.themes, tr.themes + tr.divider",this.el).hide(),$("tr.appearance",this.el)[Common.Utils.isIE?"hide":"show"](),t.compactHeader&&$("tr.quick-access",this.el).hide()},setApi:function(t){return this.api=t,this},updateSettings:function(){this.chUseAltKey.setValue(Common.Utils.InternalSettings.get("pdfe-settings-show-alt-hints")),this.chScreenReader.setValue(Common.Utils.InternalSettings.get("app-settings-screen-reader")),this.chUseAnnotateBar.setValue(Common.Utils.InternalSettings.get("pdfe-settings-annot-bar"));var t=Common.Utils.InternalSettings.get("pdfe-settings-zoom");t=null!==t?parseInt(t):this.mode.customization&&this.mode.customization.zoom?parseInt(this.mode.customization.zoom):100;var e=this.cmbZoom.store.findWhere({value:t});this.cmbZoom.setValue(e?parseInt(e.get("value")):t>0?t+"%":100),this.chLiveComment.setValue(Common.Utils.InternalSettings.get("pdfe-settings-livecomment")),this.chResolvedComment.setValue(Common.Utils.InternalSettings.get("pdfe-settings-resolvedcomment"));var i=Common.Utils.InternalSettings.get("pdfe-settings-coauthmode");this.rbCoAuthModeFast.setValue(i),this.rbCoAuthModeStrict.setValue(!i),this.fillShowChanges(i),this.chLiveViewer.setValue(Common.Utils.InternalSettings.get("pdfe-settings-coauthmode")),t=Common.Utils.InternalSettings.get(i?"pdfe-settings-showchanges-fast":"pdfe-settings-showchanges-strict"),this.rbShowChangesNone.setValue("none"==t),this.rbShowChangesLast.setValue("last"==t),this.rbShowChangesAll.setValue("all"==t),t=Common.Utils.InternalSettings.get("pdfe-settings-fontrender"),e=this.cmbFontRender.store.findWhere({value:parseInt(t)}),this.cmbFontRender.setValue(e?e.get("value"):0),this._fontRender=this.cmbFontRender.getValue(),t=Common.Utils.InternalSettings.get("pdfe-settings-cachemode"),(e=this.cmbFontRender.store.findWhere({value:"custom"}))&&t&&e.set("checked",!!t),e&&t&&this.cmbFontRender.cmpEl.find("#"+e.get("id")+" a").addClass("checked"),t=Common.Utils.InternalSettings.get("pdfe-settings-unit"),e=this.cmbUnit.store.findWhere({value:t}),this.cmbUnit.setValue(e?parseInt(e.get("value")):Common.Utils.Metric.getDefaultMetric()),this._oldUnits=this.cmbUnit.getValue(),t=Common.Utils.InternalSettings.get("pdfe-settings-autosave"),this.chAutosave.setValue(1==t),this.mode.canForcesave&&this.chForcesave.setValue(Common.Utils.InternalSettings.get("pdfe-settings-forcesave"));var s=[];for(var n in Common.UI.Themes.map())s.push({value:n,displayValue:Common.UI.Themes.get(n).text,themeType:Common.UI.Themes.get(n).type});s.length&&(this.cmbTheme.setData(s),e=this.cmbTheme.store.findWhere({value:Common.UI.Themes.currentThemeId()}),this.cmbTheme.setValue(e?e.get("value"):Common.UI.Themes.defaultThemeId())),this.chDarkMode.setValue(Common.UI.Themes.isContentThemeDark()),this.chDarkMode.setDisabled(!Common.UI.Themes.isDarkTheme()),this.chTabBack.setValue("toolbar"===Common.Utils.InternalSettings.get("settings-tab-background")),t=Common.Utils.InternalSettings.get("settings-tab-style"),e=this.cmbTabStyle.store.findWhere({value:t}),this.cmbTabStyle.setValue(e?e.get("value"):"fill"),Common.localStorage.getItem("help-tip-customize-shortcuts")&&$(".new-hint",this.el).addClass("hidden")},applySettings:function(){var t=(this.mode.isPDFAnnotate||this.mode.isPDFEdit)&&this.mode.canSaveToFile;Common.UI.Themes.setTheme(this.cmbTheme.getValue()),this.chDarkMode.isDisabled()||this.chDarkMode.isChecked()===Common.UI.Themes.isContentThemeDark()||Common.UI.Themes.toggleContentTheme(),Common.localStorage.setItem("pdfe-settings-show-alt-hints",this.chUseAltKey.isChecked()?1:0),Common.Utils.InternalSettings.set("pdfe-settings-show-alt-hints",Common.localStorage.getBool("pdfe-settings-show-alt-hints")),Common.localStorage.setItem("pdfe-settings-zoom",this.cmbZoom.getValue()),Common.localStorage.setItem("app-settings-screen-reader",this.chScreenReader.isChecked()?1:0),Common.localStorage.setItem("pdfe-settings-annot-bar",this.chUseAnnotateBar.isChecked()?1:0),Common.Utils.InternalSettings.set("pdfe-settings-annot-bar",Common.localStorage.getBool("pdfe-settings-annot-bar")),Common.Utils.InternalSettings.set("pdfe-settings-livecomment",this.chLiveComment.isChecked()),Common.Utils.InternalSettings.set("pdfe-settings-resolvedcomment",this.chResolvedComment.isChecked()),this.mode.isEdit&&!this.mode.isOffline&&this.mode.canCoAuthoring&&t?(this.mode.canChangeCoAuthoring&&Common.localStorage.setItem("pdfe-settings-coauthmode",this.rbCoAuthModeFast.getValue()?1:0),Common.localStorage.setItem(this.rbCoAuthModeFast.getValue()?"pdfe-settings-showchanges-fast":"pdfe-settings-showchanges-strict",this.rbShowChangesNone.getValue()?"none":this.rbShowChangesLast.getValue()?"last":"all")):this.mode.canLiveView&&!this.mode.isOffline&&this.mode.canChangeCoAuthoring&&Common.localStorage.setItem("pdfe-settings-view-coauthmode",this.chLiveViewer.isChecked()?1:0),Common.localStorage.setItem("pdfe-settings-fontrender",this.cmbFontRender.getValue());var e=this.cmbFontRender.store.findWhere({value:"custom"});Common.localStorage.setItem("pdfe-settings-cachemode",e&&!e.get("checked")?0:1),!this.mode.isEdit||!this.mode.canChangeCoAuthoring&&Common.Utils.InternalSettings.get("pdfe-settings-coauthmode")||Common.localStorage.setItem("pdfe-settings-autosave",this.chAutosave.isChecked()?1:0),this.mode.canForcesave&&Common.localStorage.setItem("pdfe-settings-forcesave",this.chForcesave.isChecked()?1:0),Common.localStorage.setItem("pdfe-settings-unit",this.cmbUnit.getValue()),!Common.Utils.isIE&&Common.UI.FeaturesManager.canChange("tabBackground",!0)&&Common.UI.TabStyler.setBackground(this.chTabBack.isChecked()?"toolbar":"header"),!Common.Utils.isIE&&Common.UI.FeaturesManager.canChange("tabStyle",!0)&&this._isTabStyleChanged&&(Common.UI.TabStyler.setStyle(this.cmbTabStyle.getValue()),Common.localStorage.setBool("settings-tab-style-newtheme",!0),this._isTabStyleChanged=!1),Common.localStorage.save(),this.menu&&(this.menu.fireEvent("settings:apply",[this.menu]),this._oldUnits!==this.cmbUnit.getValue()&&Common.NotificationCenter.trigger("settings:unitschanged",this))},fillShowChanges:function(t){t?this.rbShowChangesLast.$el.parent().hide():this.rbShowChangesLast.$el.parent().show()},onChangeCoAuthMode:function(t){this.fillShowChanges(1==t),this.rbShowChangesNone.setValue(1==t),this.rbShowChangesLast.setValue(0==t)},onFontRenderSelected:function(t,e){if("custom"==e.value){var i=t.store.findWhere({value:"custom"});i&&i.set("checked",!e.checked),t.cmpEl.find("#"+e.id+" a").toggleClass("checked",!e.checked),t.setValue(this._fontRender)}this._fontRender=t.getValue()},onClickKeyboardShortcut:function(){new Common.Views.ShortcutsDialog({api:this.api}).show(),Common.localStorage.setItem("help-tip-customize-shortcuts",1)},customizeQuickAccess:function(){this.dlgQuickAccess&&this.dlgQuickAccess.isVisible()||(this.dlgQuickAccess=new Common.Views.CustomizeQuickAccessDialog({showSave:this.mode.showSaveButton&&Common.UI.LayoutManager.isElementVisible("header-save"),showPrint:this.mode.canPrint&&this.mode.twoLevelHeader,showQuickPrint:this.mode.canQuickPrint&&this.mode.twoLevelHeader,mode:this.mode,props:{save:Common.localStorage.getBool("pdfe-quick-access-save",!0),print:Common.localStorage.getBool("pdfe-quick-access-print",!0),quickPrint:Common.localStorage.getBool("pdfe-quick-access-quick-print",!0),undo:Common.localStorage.getBool("pdfe-quick-access-undo",!0),redo:Common.localStorage.getBool("pdfe-quick-access-redo",!0)}}),this.dlgQuickAccess.show())},strZoom:"Default Zoom Value",strShowChanges:"Real-time Collaboration Changes",txtAll:"View All",txtNone:"View Nothing",txtLast:"View Last",okButtonText:"Apply",txtWin:"as Windows",txtMac:"as OS X",txtNative:"Native",strFontRender:"Font Hinting",strKeyboardShortcuts:"Keyboard Shortcuts",txtCustomize:"Customize",textAutoSave:"Autosave",strCoAuthMode:"Co-editing mode",strFast:"Fast",strStrict:"Strict",textAutoRecover:"Autorecover",txtFitPage:"Fit to Page",txtFitWidth:"Fit to Width",textForceSave:"Save to Server",txtCacheMode:"Default cache mode",strTheme:"Theme",txtDarkMode:"Turn on document dark mode",txtEditingSaving:"Editing and saving",txtCollaboration:"Collaboration",txtWorkspace:"Workspace",txtHieroglyphs:"Hieroglyphs",txtUseAltKey:"Use Alt key to navigate the user interface using the keyboard",txtUseOptionKey:"Use F6 to navigate the user interface using the keyboard",strShowComments:"Show comments in text",strShowResolvedComments:"Show resolved comments",txtFastTip:"Real-time co-editing. All changes are saved automatically",txtStrictTip:"Use the 'Save' button to sync the changes you and others make",strShowOthersChanges:"Show changes from other users",txtAdvancedSettings:"Advanced Settings",txtQuickPrint:"Show the Quick Print button in the editor header",txtQuickPrintTip:"The document will be printed on the last selected or default printer",txtLastUsed:"Last used",txtScreenReader:"Turn on screen reader support",strUnit:"Unit of Measurement",txtInch:"Inch",txtCm:"Centimeter",txtPt:"Point",txtUseAnnotateBar:"Use the mini toolbar when selecting text",txtCustomizeQuickAccess:"Customize quick access",txtTabBack:"Use toolbar color as tabs background",strTabStyle:"Tab style",textFill:"Fill",textLine:"Line",txtAppearance:"Appearance"},PDFE.Views.FileMenuPanels.Settings||{})),PDFE.Views.FileMenuPanels.CreateNew=Common.UI.BaseView.extend(_.extend({el:"#panel-createnew",menu:void 0,events:function(){return{"click .blank-document":_.bind(this._onBlankDocument,this),"click .thumb-list .thumb-wrap":_.bind(this._onDocumentTemplate,this)}},template:_.template(['<div class="header"><%= scope.txtCreateNew %></div>','<div class="thumb-list">',"<% if (blank) { %> ",'<div class="blank-document" data-hint="2" data-hint-direction="left-top" data-hint-offset="14, 22">','<div class="blank-document-btn">','<div class="btn-blank-format"><div class ="svg-format-blank"></div></div>',"</div>",'<div class="title"><%= scope.txtBlank %></div>',"</div>","<% } %>","<% _.each(docs, function(item, index) { %>",'<div class="thumb-wrap" template="<%= item.url %>" data-hint="2" data-hint-direction="left-top" data-hint-offset="14, 22">','<div class="thumb" ',"<% if (!_.isEmpty(item.image)) {%> ",' style="background-image: url(<%= item.image %>);">'," <%} else {print(\"><div class='btn-blank-format'><div class='svg-file-template'></div></div>\") } %>","</div>",'<div class="title"><%= Common.Utils.String.htmlEncode(item.title || item.name || "") %></div>',"</div>","<% }) %>","</div>"].join("")),initialize:function(t){Common.UI.BaseView.prototype.initialize.call(this,arguments),this.menu=t.menu,this.docs=t.docs,this.blank=!!t.blank},render:function(){this.$el.html(this.template({scope:this,docs:this.docs,blank:this.blank}));var t=(this.blank?[{title:this.txtBlank}]:[]).concat(this.docs),e=this.$el.find(".thumb-wrap, .blank-document");return _.each(e,(function(e,i){$(e).find(".title").tooltip({title:t[i].title,placement:"cursor"})})),_.isUndefined(this.scroller)&&(this.scroller=new Common.UI.Scroller({el:this.$el,suppressScrollX:!0,alwaysVisibleY:!0})),this},show:function(){Common.UI.BaseView.prototype.show.call(this,arguments),this.scroller&&this.scroller.update()},_onBlankDocument:function(){this.menu&&this.menu.fireEvent("create:new",[this.menu,"blank"])},_onDocumentTemplate:function(t){this.menu&&this.menu.fireEvent("create:new",[this.menu,t.currentTarget.attributes.template.value])},txtBlank:"Blank document",txtCreateNew:"Create New"},PDFE.Views.FileMenuPanels.CreateNew||{})),PDFE.Views.FileMenuPanels.DocumentInfo=Common.UI.BaseView.extend(_.extend({el:"#panel-info",menu:void 0,initialize:function(t){Common.UI.BaseView.prototype.initialize.call(this,arguments),this.rendered=!1,this.template=_.template(['<div class="flex-settings">','<table class="main">','<tbody><td class="header">'+this.txtDocumentInfo+"</td></tbody>","<tbody>","<tr>",'<td class="title"><label>'+this.txtCommon+"</label></td>","</tr>","<tr>",'<td class="left"><label>'+this.txtPlacement+"</label></td>",'<td class="right"><label id="id-info-placement">-</label></td>',"</tr>","<tr>",'<td class="left"><label>'+this.txtOwner+"</label></td>",'<td class="right"><label id="id-info-owner">-</label></td>',"</tr>","<tr>",'<td class="left"><label>'+this.txtUploaded+"</label></td>",'<td class="right"><label id="id-info-uploaded">-</label></td>',"</tr>","<tr></tr>","<tr>",'<td class="left"><label>'+this.txtModifyDate+"</label></td>",'<td class="right"><label id="id-info-modify-date"></label></td>',"</tr>","<tr>",'<td class="left"><label>'+this.txtModifyBy+"</label></td>",'<td class="right"><label id="id-info-modify-by"></label></td>',"</tr>",'<tr class="docx-info">','<td class="left"><label>'+this.txtTitle+"</label></td>",'<td class="right"><div id="id-info-title"></div></td>',"</tr>",'<tr class="docx-info">','<td class="left"><label>'+this.txtTags+"</label></td>",'<td class="right"><div id="id-info-tags"></div></td>',"</tr>",'<tr class="docx-info">','<td class="left"><label>'+this.txtSubject+"</label></td>",'<td class="right"><div id="id-info-subject"></div></td>',"</tr>",'<tr class="docx-info">','<td class="left"><label>'+this.txtComment+"</label></td>",'<td class="right"><div id="id-info-comment"></div></td>',"</tr>",'<tr class="pdf-info">','<td class="left"><label>'+this.txtTitle+"</label></td>",'<td class="right"><label id="id-lbl-info-title"></label></td>',"</tr>",'<tr class="pdf-info">','<td class="left"><label>'+this.txtSubject+"</label></td>",'<td class="right"><label id="id-lbl-info-subject"></label></td>',"</tr>","<tr>",'<td class="left"><label>'+this.txtCreated+"</label></td>",'<td class="right"><label id="id-info-date"></label></td>',"</tr>","<tr>",'<td class="left"><label>'+this.txtAppName+"</label></td>",'<td class="right"><label id="id-info-appname"></label></td>',"</tr>",'<tr class="pdf-info">','<td class="left"><label>'+this.txtAuthor+"</label></td>",'<td class="right"><label id="id-lbl-info-author"></label></td>',"</tr>",'<tr class="pdf-info">','<td class="left"><label>'+this.txtPdfProducer+"</label></td>",'<td class="right"><label id="id-info-pdf-produce"></label></td>',"</tr>",'<tr class="pdf-info">','<td class="left"><label>'+this.txtPdfVer+"</label></td>",'<td class="right"><label id="id-info-pdf-ver"></label></td>',"</tr>",'<tr class="pdf-info">','<td class="left"><label>'+this.txtPdfTagged+"</label></td>",'<td class="right"><label id="id-info-pdf-tagged"></label></td>',"</tr>",'<tr class="pdf-info">','<td class="left"><label>'+this.txtFastWV+"</label></td>",'<td class="right"><label id="id-info-fast-wv"></label></td>',"</tr>",'<tr class="docx-info">','<td class="left" style="vertical-align: top;"><label style="margin-top: 3px;">'+this.txtAuthor+"</label></td>",'<td class="right" style="vertical-align: top;"><div id="id-info-author">',"<table>","<tr>",'<td><div id="id-info-add-author"><input type="text" spellcheck="false" class="form-control" placeholder="'+this.txtAddAuthor+'"></div></td>',"</tr>","</table>","</div></td>","</tr>","</tbody>","<tbody>","<tr>",'<td class="title"><label>'+this.txtStatistics+"</label></td>","</tr>",,"<tr>",'<td class="left"><label>'+this.txtPages+"</label></td>",'<td class="right"><label id="id-info-pages"></label></td>',"</tr>","<tr>",'<td class="left"><label>'+this.txtParagraphs+"</label></td>",'<td class="right"><label id="id-info-paragraphs"></label></td>',"</tr>","<tr>",'<td class="left"><label>'+this.txtWords+"</label></td>",'<td class="right"><label id="id-info-words"></label></td>',"</tr>","<tr>",'<td class="left"><label>'+this.txtSymbols+"</label></td>",'<td class="right"><label id="id-info-symbols"></label></td>',"</tr>","<tr>",'<td class="left"><label>'+this.txtSpaces+"</label></td>",'<td class="right"><label id="id-info-spaces"></label></td>',"</tr>",'<tr class="pdf-info">','<td class="left"><label>'+this.txtPageSize+"</label></td>",'<td class="right"><label id="id-info-page-size"></label></td>',"</tr>","</tbody>","</table>","</div>"].join("")),this.infoObj={PageCount:0,WordsCount:0,ParagraphCount:0,SymbolsCount:0,SymbolsWSCount:0},this.menu=t.menu,this.coreProps=null,this.authors=[],this._state={_locked:!1,disableEditing:!1}},render:function(t){var e=this,i=$(e.template({scope:e}));this.lblPlacement=i.findById("#id-info-placement"),this.lblOwner=i.findById("#id-info-owner"),this.lblUploaded=i.findById("#id-info-uploaded"),this.lblStatPages=i.findById("#id-info-pages"),this.lblStatWords=i.findById("#id-info-words"),this.lblStatParagraphs=i.findById("#id-info-paragraphs"),this.lblStatSymbols=i.findById("#id-info-symbols"),this.lblStatSpaces=i.findById("#id-info-spaces"),this.lblPageSize=i.findById("#id-info-pages-size");var s=function(t,e){if(e.keyCode===Common.UI.Keys.ESC){var i=t._input.val(),s=t.getValue();i!==s&&(t.setValue(s),e.stopPropagation())}};return this.inputTitle=new Common.UI.InputField({el:i.findById("#id-info-title"),style:"width: 200px;",placeHolder:this.txtAddText,validateOnBlur:!1,dataHint:"2",dataHintDirection:"left",dataHintOffset:"small"}).on("keydown:before",s),this.inputTags=new Common.UI.InputField({el:i.findById("#id-info-tags"),style:"width: 200px;",placeHolder:this.txtAddText,validateOnBlur:!1,dataHint:"2",dataHintDirection:"left",dataHintOffset:"small"}).on("keydown:before",s),this.inputSubject=new Common.UI.InputField({el:i.findById("#id-info-subject"),style:"width: 200px;",placeHolder:this.txtAddText,validateOnBlur:!1,dataHint:"2",dataHintDirection:"left",dataHintOffset:"small"}).on("keydown:before",s),this.inputComment=new Common.UI.InputField({el:i.findById("#id-info-comment"),style:"width: 200px;",placeHolder:this.txtAddText,validateOnBlur:!1,dataHint:"2",dataHintDirection:"left",dataHintOffset:"small"}).on("keydown:before",s),this.lblModifyDate=i.findById("#id-info-modify-date"),this.lblModifyBy=i.findById("#id-info-modify-by"),this.lblDate=i.findById("#id-info-date"),this.lblApplication=i.findById("#id-info-appname"),this.tblAuthor=i.findById("#id-info-author table"),this.trAuthor=i.findById("#id-info-add-author").closest("tr"),this.authorTpl='<tr><td><div style="display: inline-block;width: 200px;"><input type="text" spellcheck="false" class="form-control" readonly="true" value="{0}"></div><div class="tool close img-commonctrl img-colored" data-hint="2" data-hint-direction="right" data-hint-offset="small"></div></td></tr>',this.tblAuthor.on("click",(function(t){var s=i.find(t.target);if(s.hasClass("close")&&!s.hasClass("disabled")){var n=s.closest("tr"),a=e.tblAuthor.find("tr").index(n);n.remove(),e.authors.splice(a,1),e.updateScroller(!0)}})),this.inputAuthor=new Common.UI.InputField({el:i.findById("#id-info-add-author"),style:"width: 200px;",validateOnBlur:!1,placeHolder:this.txtAddAuthor,dataHint:"2",dataHintDirection:"left",dataHintOffset:"small"}).on("changed:after",(function(t,i,s,n){if(i!=s){var a=i.trim();if(a&&a!==s.trim()){var o=n&&n.relatedTarget&&"fminfo-btn-apply"==n.relatedTarget.id;a.split(/\s*[,;]\s*/).forEach((function(t){var i=t.trim();if(i&&(e.authors.push(t),!o)){var s=$(Common.Utils.String.format(e.authorTpl,Common.Utils.String.htmlEncode(i)));e.trAuthor.before(s),e.updateScroller()}})),!o&&e.inputAuthor.setValue("")}}})).on("keydown:before",s),this.lblPageSize=i.findById("#id-info-page-size"),this.lblPdfTitle=i.findById("#id-lbl-info-title"),this.lblPdfSubject=i.findById("#id-lbl-info-subject"),this.lblPdfAuthor=i.findById("#id-lbl-info-author"),this.lblPdfVer=i.findById("#id-info-pdf-ver"),this.lblPdfTagged=i.findById("#id-info-pdf-tagged"),this.lblPdfProducer=i.findById("#id-info-pdf-produce"),this.lblFastWV=i.findById("#id-info-fast-wv"),this.pnlApply=i.findById("#fms-flex-apply"),this.rendered=!0,this.updateInfo(this.doc),this.$el=$(t).html(i),_.isUndefined(this.scroller)&&(this.scroller=new Common.UI.Scroller({el:this.$el,suppressScrollX:!0,alwaysVisibleY:!0})),Common.NotificationCenter.on({"window:resize":function(){e.isVisible()&&e.updateScroller()}}),this},show:function(){Common.UI.BaseView.prototype.show.call(this,arguments),this.updateStatisticInfo(),this.updateFileInfo(),this.scroller&&this.scroller.scrollTop(0),this.updateScroller()},hide:function(){Common.UI.BaseView.prototype.hide.call(this,arguments),this.stopUpdatingStatisticInfo()},updateScroller:function(t){this.scroller&&this.scroller.update(t?{}:void 0)},updateInfo:function(t){if(this.doc=t,this.rendered){var e=!1;if((t=t||{}).info)t.info.folder&&this.lblPlacement.text(t.info.folder),e=this._ShowHideInfoItem(this.lblPlacement,void 0!==t.info.folder&&null!==t.info.folder)||e,(n=t.info.owner)&&this.lblOwner.text(n),e=this._ShowHideInfoItem(this.lblOwner,!!n)||e,(n=t.info.uploaded)&&this.lblUploaded.text(n),e=this._ShowHideInfoItem(this.lblUploaded,!!n)||e;else this._ShowHideDocInfo(!1);$("tr.divider.general",this.el)[e?"show":"hide"]();var i=this.api?this.api.asc_getPdfProps():null,s=this.api?this.api.asc_getAppProps():null;if(s?($(".pdf-info",this.el).hide(),s=(s.asc_getApplication()||"")+(s.asc_getAppVersion()?" ":"")+(s.asc_getAppVersion()||""),this.lblApplication.text(s)):i&&($(".docx-info",this.el).hide(),s=i&&i.Creator||"",this.lblApplication.text(s)),this._ShowHideInfoItem(this.lblApplication,!!s),this.coreProps=this.api?this.api.asc_getCoreProps():null,this.coreProps){var n;if(n=this.coreProps.asc_getCreated()){var a=(this.mode.lang||"en").replace("_","-").toLowerCase();try{a=="ar-SA".toLowerCase()&&(a+="-u-nu-latn-ca-gregory"),this.lblDate.text(n.toLocaleString(a,{year:"numeric",month:"2-digit",day:"2-digit"})+" "+n.toLocaleString(a,{timeStyle:"short"}))}catch(t){a="en",this.lblDate.text(n.toLocaleString(a,{year:"numeric",month:"2-digit",day:"2-digit"})+" "+n.toLocaleString(a,{timeStyle:"short"}))}}this._ShowHideInfoItem(this.lblDate,!!n)}else i&&this.updatePdfInfo(i)}},updateFileInfo:function(){if(this.rendered){var t,e=this,i=this.api?this.api.asc_getCoreProps():null;if(this.coreProps=i,i){var s=!1;if(t=i.asc_getModified()){var n=(this.mode.lang||"en").replace("_","-").toLowerCase();try{n=="ar-SA".toLowerCase()&&(n+="-u-nu-latn-ca-gregory"),this.lblModifyDate.text(t.toLocaleString(n,{year:"numeric",month:"2-digit",day:"2-digit"})+" "+t.toLocaleString(n,{timeStyle:"short"}))}catch(e){n="en",this.lblModifyDate.text(t.toLocaleString(n,{year:"numeric",month:"2-digit",day:"2-digit"})+" "+t.toLocaleString(n,{timeStyle:"short"}))}}s=this._ShowHideInfoItem(this.lblModifyDate,!!t)||s,(t=i.asc_getLastModifiedBy())&&this.lblModifyBy.text(AscCommon.UserInfoParser.getParsedName(t)),s=this._ShowHideInfoItem(this.lblModifyBy,!!t)||s,$("tr.divider.modify",this.el)[s?"show":"hide"](),t=i.asc_getTitle(),this.inputTitle.setValue(t||""),t=i.asc_getKeywords(),this.inputTags.setValue(t||""),t=i.asc_getSubject(),this.inputSubject.setValue(t||""),t=i.asc_getDescription(),this.inputComment.setValue(t||""),this.inputAuthor.setValue(""),this.tblAuthor.find("tr:not(:last-of-type)").remove(),this.authors=[],(t=i.asc_getCreator())&&t.split(/\s*[,;]\s*/).forEach((function(t){var i=$(Common.Utils.String.format(e.authorTpl,Common.Utils.String.htmlEncode(t)));e.trAuthor.before(i),e.authors.push(t)})),this.tblAuthor.find(".close").toggleClass("hidden",!this.mode.isPDFEdit),this._ShowHideInfoItem(this.tblAuthor,this.mode.isPDFEdit||!!this.authors.length)}this.SetDisabled()}},updatePdfInfo:function(t){if(this.rendered){var e;if(t){if(e=t.CreationDate){e=new Date(e);var i=(this.mode.lang||"en").replace("_","-").toLowerCase();try{i=="ar-SA".toLowerCase()&&(i+="-u-nu-latn-ca-gregory"),this.lblDate.text(e.toLocaleString(i,{year:"numeric",month:"2-digit",day:"2-digit"})+" "+e.toLocaleString(i,{timeStyle:"short"}))}catch(t){i="en",this.lblDate.text(e.toLocaleString(i,{year:"numeric",month:"2-digit",day:"2-digit"})+" "+e.toLocaleString(i,{timeStyle:"short"}))}}this._ShowHideInfoItem(this.lblDate,!!e);var s=!1;if(e=t.ModDate){e=new Date(e);i=(this.mode.lang||"en").replace("_","-").toLowerCase();try{i=="ar-SA".toLowerCase()&&(i+="-u-nu-latn-ca-gregory"),this.lblModifyDate.text(e.toLocaleString(i,{year:"numeric",month:"2-digit",day:"2-digit"})+" "+e.toLocaleString(i,{timeStyle:"short"}))}catch(t){i="en",this.lblModifyDate.text(e.toLocaleString(i,{year:"numeric",month:"2-digit",day:"2-digit"})+" "+e.toLocaleString(i,{timeStyle:"short"}))}}if(s=this._ShowHideInfoItem(this.lblModifyDate,!!e)||s,s=this._ShowHideInfoItem(this.lblModifyBy,!1)||s,$("tr.divider.modify",this.el)[s?"show":"hide"](),t.PageWidth&&t.PageHeight&&"number"==typeof t.PageWidth&&"number"==typeof t.PageHeight){var n=t.PageWidth,a=t.PageHeight;switch(Common.Utils.Metric.getCurrentMetric()){case Common.Utils.Metric.c_MetricUnits.cm:n=parseFloat((25.4*n/72e3).toFixed(2)),a=parseFloat((25.4*a/72e3).toFixed(2));break;case Common.Utils.Metric.c_MetricUnits.pt:n=parseFloat((n/100).toFixed(2)),a=parseFloat((a/100).toFixed(2));break;case Common.Utils.Metric.c_MetricUnits.inch:n=parseFloat((n/7200).toFixed(2)),a=parseFloat((a/7200).toFixed(2))}var o=Common.UI.isRTL()?'<span dir="ltr"><span dir="ltr">'+Common.Utils.Metric.getCurrentMetricName()+' </span><span dir="ltr">'+a+' x </span><span dir="ltr">'+Common.Utils.Metric.getCurrentMetricName()+' </span><span dir="ltr">'+n+"</span></span>":n+" "+Common.Utils.Metric.getCurrentMetricName()+" x "+a+" "+Common.Utils.Metric.getCurrentMetricName();this.lblPageSize.html(o),this._ShowHideInfoItem(this.lblPageSize,!0)}else this._ShowHideInfoItem(this.lblPageSize,!1);(e=t.Title)&&this.lblPdfTitle.text(e),s=this._ShowHideInfoItem(this.lblPdfTitle,!!e),(e=t.Subject)&&this.lblPdfSubject.text(e),s=this._ShowHideInfoItem(this.lblPdfSubject,!!e)||s,$("tr.divider.pdf-title",this.el)[s?"show":"hide"](),(e=t.Author)&&this.lblPdfAuthor.text(e),this._ShowHideInfoItem(this.lblPdfAuthor,!!e),(e=t.Version)&&this.lblPdfVer.text(e),this._ShowHideInfoItem(this.lblPdfVer,!!e),void 0!==(e=t.Tagged)&&this.lblPdfTagged.text(!0===e?this.txtYes:this.txtNo),this._ShowHideInfoItem(this.lblPdfTagged,void 0!==e),(e=t.Producer)&&this.lblPdfProducer.text(e),this._ShowHideInfoItem(this.lblPdfProducer,!!e),void 0!==(e=t.FastWebView)&&this.lblFastWV.text(!0===e?this.txtYes:this.txtNo),this._ShowHideInfoItem(this.lblFastWV,void 0!==e)}}},_ShowHideInfoItem:function(t,e){return t.closest("tr")[e?"show":"hide"](),e},_ShowHideDocInfo:function(t){this._ShowHideInfoItem(this.lblPlacement,t),this._ShowHideInfoItem(this.lblOwner,t),this._ShowHideInfoItem(this.lblUploaded,t)},updateStatisticInfo:function(){this.api&&this.doc&&this.api.startGetDocInfo()},stopUpdatingStatisticInfo:function(){this.api&&this.api.stopGetDocInfo()},setApi:function(t){return this.api=t,this.api.asc_registerCallback("asc_onGetDocInfoStart",_.bind(this._onGetDocInfoStart,this)),this.api.asc_registerCallback("asc_onGetDocInfoStop",_.bind(this._onGetDocInfoEnd,this)),this.api.asc_registerCallback("asc_onDocInfo",_.bind(this._onDocInfo,this)),this.api.asc_registerCallback("asc_onGetDocInfoEnd",_.bind(this._onGetDocInfoEnd,this)),this.api.asc_registerCallback("asc_onLockCore",_.bind(this.onLockCore,this)),this.updateInfo(this.doc),this},setMode:function(t){this.mode=t;var e=!1;return this.inputAuthor.setVisible(e),this.pnlApply.toggleClass("hidden",!0),this.tblAuthor.find(".close").toggleClass("hidden",!0),this.inputTitle._input.attr("placeholder",""),this.inputTags._input.attr("placeholder",""),this.inputSubject._input.attr("placeholder",""),this.inputComment._input.attr("placeholder",""),this.inputAuthor._input.attr("placeholder",""),this.SetDisabled(),this},setPreviewMode:function(t){this._state.disableEditing=t},_onGetDocInfoStart:function(){var t=this;this.infoObj={PageCount:0,WordsCount:0,ParagraphCount:0,SymbolsCount:0,SymbolsWSCount:0},this.timerLoading=setTimeout((function(){t.lblStatPages.text(t.txtLoading),t.lblStatWords.text(t.txtLoading),t.lblStatParagraphs.text(t.txtLoading),t.lblStatSymbols.text(t.txtLoading),t.lblStatSpaces.text(t.txtLoading)}),2e3)},_onDocInfo:function(t){if(t&&(clearTimeout(this.timerLoading),t.get_PageCount()>-1&&(this.infoObj.PageCount=t.get_PageCount()),t.get_WordsCount()>-1&&(this.infoObj.WordsCount=t.get_WordsCount()),t.get_ParagraphCount()>-1&&(this.infoObj.ParagraphCount=t.get_ParagraphCount()),t.get_SymbolsCount()>-1&&(this.infoObj.SymbolsCount=t.get_SymbolsCount()),t.get_SymbolsWSCount()>-1&&(this.infoObj.SymbolsWSCount=t.get_SymbolsWSCount()),!this.timerDocInfo)){var e=this;this.timerDocInfo=setInterval((function(){e.fillDocInfo()}),300),this.fillDocInfo()}},_onGetDocInfoEnd:function(){clearTimeout(this.timerLoading),clearInterval(this.timerDocInfo),this.timerLoading=this.timerDocInfo=void 0,this.fillDocInfo()},fillDocInfo:function(){this.lblStatPages.text(this.infoObj.PageCount),this.lblStatWords.text(this.infoObj.WordsCount),this.lblStatParagraphs.text(this.infoObj.ParagraphCount),this.lblStatSymbols.text(this.infoObj.SymbolsCount),this.lblStatSpaces.text(this.infoObj.SymbolsWSCount)},onDocumentName:function(t){},onLockCore:function(t){this._state._locked=t,this.updateFileInfo()},SetDisabled:function(){var t=!this.mode.isEdit||this._state._locked||this._state.disableEditing;this.inputTitle.setDisabled(t),this.inputTags.setDisabled(t),this.inputSubject.setDisabled(t),this.inputComment.setDisabled(t),this.inputAuthor.setDisabled(t),this.tblAuthor.find(".close").toggleClass("disabled",this._state._locked),this.tblAuthor.toggleClass("disabled",t)},applySettings:function(){this.coreProps&&this.api&&(this.coreProps.asc_putTitle(this.inputTitle.getValue()),this.coreProps.asc_putKeywords(this.inputTags.getValue()),this.coreProps.asc_putSubject(this.inputSubject.getValue()),this.coreProps.asc_putDescription(this.inputComment.getValue()),this.coreProps.asc_putCreator(this.authors.join(";")),this.api.asc_setCoreProps(this.coreProps)),this.menu.hide()},txtPlacement:"Location",txtOwner:"Owner",txtUploaded:"Uploaded",txtPages:"Pages",txtWords:"Words",txtParagraphs:"Paragraphs",txtSymbols:"Symbols",txtSpaces:"Symbols with spaces",txtLoading:"Loading...",txtAppName:"Application",txtEditTime:"Total Editing time",txtTitle:"Title",txtTags:"Tags",txtSubject:"Subject",txtComment:"Comment",txtModifyDate:"Last Modified",txtModifyBy:"Last Modified By",txtCreated:"Created",txtAuthor:"Author",txtAddAuthor:"Add Author",txtAddText:"Add Text",txtMinutes:"min",okButtonText:"Apply",txtPageSize:"Page Size",txtPdfVer:"PDF Version",txtPdfTagged:"Tagged PDF",txtFastWV:"Fast Web View",txtYes:"Yes",txtNo:"No",txtPdfProducer:"PDF Producer",txtDocumentInfo:"Document Info",txtCommon:"Common"},PDFE.Views.FileMenuPanels.DocumentInfo||{})),PDFE.Views.FileMenuPanels.DocumentRights=Common.UI.BaseView.extend(_.extend({el:"#panel-rights",menu:void 0,initialize:function(t){Common.UI.BaseView.prototype.initialize.call(this,arguments),this.rendered=!1,this.template=_.template(['<div class="header">'+this.txtAccessRights+"</div>",'<table class="main">','<tr class="rights">','<td class="left" style="vertical-align: top;"><label>'+this.txtRights+"</label></td>",'<td class="right"><div id="id-info-rights"></div></td>',"</tr>",'<tr class="edit-rights">','<td class="left"></td><td class="right"><button id="id-info-btn-edit" class="btn normal dlg-btn primary auto margin-right-10">'+this.txtBtnAccessRights+"</button></td>","</tr>","</table>"].join("")),this.templateRights=_.template(["<table>","<% _.each(users, function(item) { %>","<tr>",'<td><span class="userLink img-commonctrl  <% if (item.isLink) { %>sharedLink<% } %>"></span><span><%= Common.Utils.String.htmlEncode(item.user) %></span></td>',"<td><%= Common.Utils.String.htmlEncode(item.permissions) %></td>","</tr>","<% }); %>","</table>"].join("")),this.menu=t.menu},render:function(t){var e=$(this.template());return this.cntRights=e.findById("#id-info-rights"),this.btnEditRights=new Common.UI.Button({el:e.elementById("#id-info-btn-edit")}),this.btnEditRights.on("click",_.bind(this.changeAccessRights,this)),this.rendered=!0,this.updateInfo(this.doc),Common.NotificationCenter.on("collaboration:sharingupdate",this.updateSharingSettings.bind(this)),Common.NotificationCenter.on("collaboration:sharingdeny",this.onLostEditRights.bind(this)),this.$el=$(t).html(e),_.isUndefined(this.scroller)&&(this.scroller=new Common.UI.Scroller({el:this.$el,suppressScrollX:!0,alwaysVisibleY:!0})),this},show:function(){Common.UI.BaseView.prototype.show.call(this,arguments),this.scroller&&this.scroller.update()},hide:function(){Common.UI.BaseView.prototype.hide.call(this,arguments)},updateInfo:function(t){this.doc=t,this.rendered&&((t=t||{}).info?(t.info.sharingSettings&&this.cntRights.html(this.templateRights({users:t.info.sharingSettings})),this._ShowHideInfoItem("rights",void 0!==t.info.sharingSettings&&null!==t.info.sharingSettings&&t.info.sharingSettings.length>0),this._ShowHideInfoItem("edit-rights",(!!this.sharingSettingsUrl&&this.sharingSettingsUrl.length||this.mode.canRequestSharingSettings)&&!0!==this._readonlyRights)):this._ShowHideDocInfo(!1))},_ShowHideInfoItem:function(t,e){$("tr."+t,this.el)[e?"show":"hide"]()},_ShowHideDocInfo:function(t){this._ShowHideInfoItem("rights",t),this._ShowHideInfoItem("edit-rights",t)},setApi:function(t){return this.api=t,this},setMode:function(t){return this.mode=t,this.sharingSettingsUrl=t.sharingSettingsUrl,this},changeAccessRights:function(t,e,i){Common.NotificationCenter.trigger("collaboration:sharing")},updateSharingSettings:function(t){this._ShowHideInfoItem("rights",void 0!==this.doc.info.sharingSettings&&null!==this.doc.info.sharingSettings&&this.doc.info.sharingSettings.length>0),this.cntRights.html(this.templateRights({users:this.doc.info.sharingSettings}))},onLostEditRights:function(){this._readonlyRights=!0,this.rendered&&this._ShowHideInfoItem("edit-rights",!1)},txtRights:"Persons who have rights",txtBtnAccessRights:"Change access rights",txtAccessRights:"Access Rights"},PDFE.Views.FileMenuPanels.DocumentRights||{})),PDFE.Views.FileMenuPanels.Help=Common.UI.BaseView.extend({el:"#panel-help",menu:void 0,template:_.template(['<div style="width:100%; height:100%; position: relative;">','<div id="id-help-contents" style="position: absolute; width:220px; top: 0; bottom: 0;" class="no-padding"></div>','<div id="id-help-frame" class="no-padding"></div>',"</div>"].join("")),initialize:function(t){Common.UI.BaseView.prototype.initialize.call(this,arguments),this.menu=t.menu,this.urlPref="resources/help/en/",this.openUrl=null,this.en_data=[{src:"ProgramInterface/ProgramInterface.htm",name:"Introducing Document Editor user interface",headername:"Program Interface"},{src:"ProgramInterface/FileTab.htm",name:"File tab"},{src:"ProgramInterface/HomeTab.htm",name:"Home Tab"},{src:"ProgramInterface/InsertTab.htm",name:"Insert tab"},{src:"ProgramInterface/LayoutTab.htm",name:"Layout tab"},{src:"ProgramInterface/ReviewTab.htm",name:"Review tab"},{src:"ProgramInterface/PluginsTab.htm",name:"Plugins tab"},{src:"UsageInstructions/ChangeColorScheme.htm",name:"Change color scheme",headername:"Basic operations"},{src:"UsageInstructions/CopyPasteUndoRedo.htm",name:"Copy/paste text passages, undo/redo your actions"},{src:"UsageInstructions/OpenCreateNew.htm",name:"Create a new document or open an existing one"},{src:"UsageInstructions/SetPageParameters.htm",name:"Set page parameters",headername:"Page formatting"},{src:"UsageInstructions/NonprintingCharacters.htm",name:"Show/hide nonprinting characters"},{src:"UsageInstructions/SectionBreaks.htm",name:"Insert section breaks"},{src:"UsageInstructions/InsertHeadersFooters.htm",name:"Insert headers and footers"},{src:"UsageInstructions/InsertPageNumbers.htm",name:"Insert page numbers"},{src:"UsageInstructions/InsertFootnotes.htm",name:"Insert footnotes"},{src:"UsageInstructions/AlignText.htm",name:"Align your text in a paragraph",headername:"Paragraph formatting"},{src:"UsageInstructions/BackgroundColor.htm",name:"Select background color for a paragraph"},{src:"UsageInstructions/ParagraphIndents.htm",name:"Change paragraph indents"},{src:"UsageInstructions/LineSpacing.htm",name:"Set paragraph line spacing"},{src:"UsageInstructions/PageBreaks.htm",name:"Insert page breaks"},{src:"UsageInstructions/AddBorders.htm",name:"Add borders"},{src:"UsageInstructions/SetTabStops.htm",name:"Set tab stops"},{src:"UsageInstructions/CreateLists.htm",name:"Create lists"},{src:"UsageInstructions/FormattingPresets.htm",name:"Apply formatting styles",headername:"Text formatting"},{src:"UsageInstructions/FontTypeSizeColor.htm",name:"Set font type, size, and color"},{src:"UsageInstructions/DecorationStyles.htm",name:"Apply font decoration styles"},{src:"UsageInstructions/CopyClearFormatting.htm",name:"Copy/clear text formatting"},{src:"UsageInstructions/AddHyperlinks.htm",name:"Add hyperlinks"},{src:"UsageInstructions/InsertDropCap.htm",name:"Insert a drop cap"},{src:"UsageInstructions/InsertTables.htm",name:"Insert tables",headername:"Operations on objects"},{src:"UsageInstructions/InsertImages.htm",name:"Insert images"},{src:"UsageInstructions/InsertAutoshapes.htm",name:"Insert autoshapes"},{src:"UsageInstructions/InsertCharts.htm",name:"Insert charts"},{src:"UsageInstructions/InsertTextObjects.htm",name:"Insert text objects"},{src:"UsageInstructions/AlignArrangeObjects.htm",name:"Align and arrange objects on a page"},{src:"UsageInstructions/ChangeWrappingStyle.htm",name:"Change wrapping style"},{src:"UsageInstructions/UseMailMerge.htm",name:"Use mail merge",headername:"Mail Merge"},{src:"UsageInstructions/InsertEquation.htm",name:"Insert equations",headername:"Math equations"},{src:"HelpfulHints/CollaborativeEditing.htm",name:"Collaborative document editing",headername:"Document co-editing"},{src:"HelpfulHints/Review.htm",name:"Document Review"},{src:"UsageInstructions/ViewDocInfo.htm",name:"View document information",headername:"Tools and settings"},{src:"UsageInstructions/SavePrintDownload.htm",name:"Save/download/print your document"},{src:"HelpfulHints/AdvancedSettings.htm",name:"Advanced settings of Document Editor"},{src:"HelpfulHints/Navigation.htm",name:"View settings and navigation tools"},{src:"HelpfulHints/Search.htm",name:"Search and replace function"},{src:"HelpfulHints/SpellChecking.htm",name:"Spell-checking"},{src:"HelpfulHints/About.htm",name:"About Document Editor",headername:"Helpful hints"},{src:"HelpfulHints/SupportedFormats.htm",name:"Supported formats of electronic documents"},{src:"HelpfulHints/KeyboardShortcuts.htm",name:"Keyboard shortcuts"}],Common.Utils.isIE&&(window.onhelp=function(){return!1})},render:function(){var t=this;return this.$el.html(this.template()),this.viewHelpPicker=new Common.UI.DataView({el:$("#id-help-contents"),store:new Common.UI.DataViewStore([]),keyMoveDirection:"vertical",itemTemplate:_.template(['<div id="<%= id %>" class="help-item-wrap">','<div class="caption"><%= name %></div>',"</div>"].join(""))}),this.viewHelpPicker.on("item:add",(function(t,e,i){i.has("headername")&&$(e.el).before('<div class="header-name">'+i.get("headername")+"</div>")})),this.viewHelpPicker.on("item:select",(function(e,i,s){t.onSelectItem(s.get("src"))})),this.iFrame=document.createElement("iframe"),this.iFrame.src="",this.iFrame.align="top",this.iFrame.frameBorder="0",this.iFrame.width="100%",this.iFrame.height="100%",(Common.Utils.isChrome||Common.Utils.isOpera||Common.Utils.isGecko&&Common.Utils.firefoxVersion>86)&&(this.iFrame.onload=function(){try{t.findUrl(t.iFrame.contentWindow.location.href)}catch(t){}}),Common.Gateway.on("internalcommand",(function(e){"help:hyperlink"==e.type&&t.findUrl(e.data)})),$("#id-help-frame").append(this.iFrame),this},setLangConfig:function(t){var e=this,i=this.viewHelpPicker.store;if(t){t=t.split(/[\-\_]/)[0];var s={dataType:"json",error:function(){e.urlPref.indexOf("resources/help/en/")<0?(e.urlPref="resources/help/en/",i.url="resources/help/en/Contents.json",i.fetch(s)):(e.urlPref="resources/help/en/",i.reset(e.en_data))},success:function(){var t=e.openUrl?i.find((function(t){return e.openUrl.indexOf(t.get("src"))>=0})):i.at(0);t&&(e.viewHelpPicker.selectRecord(t,!0),e.viewHelpPicker.scrollToRecord(t)),e.onSelectItem(e.openUrl?e.openUrl:t.get("src"))}};Common.Controllers.Desktop.isActive()?Common.Controllers.Desktop.isHelpAvailable()?(e.urlPref=Common.Controllers.Desktop.helpUrl()+"/",i.url=e.urlPref+"Contents.json",i.fetch(s)):(e.noHelpContents=!0,e.iFrame.src="../../common/main/resources/help/download.html"):(i.url="resources/help/"+t+"/Contents.json",i.fetch(s),this.urlPref="resources/help/"+t+"/")}},show:function(t){Common.UI.BaseView.prototype.show.call(this),this._scrollerInited||(this.viewHelpPicker.scroller.update(),this._scrollerInited=!0),t&&(this.viewHelpPicker.store.length>0?(this.findUrl(t),this.onSelectItem(t)):this.openUrl=t)},onSelectItem:function(t){this.iFrame.src=this.urlPref+t},findUrl:function(t){var e=this.viewHelpPicker.store.find((function(e){return t.indexOf(e.get("src"))>=0}));e&&(this.viewHelpPicker.selectRecord(e,!0),this.viewHelpPicker.scrollToRecord(e))}}),PDFE.Views.FileMenuPanels.ProtectDoc=Common.UI.BaseView.extend(_.extend({el:"#panel-protect",menu:void 0,template:_.template(['<label id="id-fms-lbl-protect-header"><%= scope.strProtect %></label>','<div id="id-fms-password">','<label class="header"><%= scope.strEncrypt %></label>','<div class="encrypt-block">','<div class="description"><%= scope.txtProtectDocument %></div>','<div id="fms-btn-add-pwd"></div>',"</div>",'<div class="encrypted-block">','<div class="description"><%= scope.txtEncrypted %></div>','<div class="buttons">','<div id="fms-btn-change-pwd"></div>','<div id="fms-btn-delete-pwd" class="margin-left-16"></div>',"</div>","</div>","</div>",'<div id="id-fms-signature">','<label class="header"><%= scope.strSignature %></label>','<div class="add-signature-block">','<div class="description"><%= scope.txtAddSignature %></div>','<div id="fms-btn-invisible-sign"></div>',"</div>",'<div class="added-signature-block">','<div class="description"><%= scope.txtAddedSignature %></div>',"</div>",'<div id="id-fms-signature-view"></div>',"</div>"].join("")),initialize:function(t){Common.UI.BaseView.prototype.initialize.call(this,arguments),this.menu=t.menu;this.templateSignature=_.template(['<div class="<% if (!hasSigned) { %>hidden<% } %>"">','<div class="signature-tip"><%= tipText %></div>','<div class="buttons">','<label class="link signature-view-link margin-right-20" data-hint="2" data-hint-direction="bottom" data-hint-offset="medium">'+this.txtView+"</label>",'<label class="link signature-edit-link <% if (!hasSigned) { %>hidden<% } %>" data-hint="2" data-hint-direction="bottom" data-hint-offset="medium">'+this.txtEdit+"</label>","</div>","</div>"].join(""))},render:function(){this.$el.html(this.template({scope:this}));var t=PDFE.getController("Common.Controllers.Protection").getView();return this.btnAddPwd=t.getButton("add-password"),this.btnAddPwd.render(this.$el.find("#fms-btn-add-pwd")),this.btnAddPwd.on("click",_.bind(this.closeMenu,this)),this.btnChangePwd=t.getButton("change-password"),this.btnChangePwd.render(this.$el.find("#fms-btn-change-pwd")),this.btnChangePwd.on("click",_.bind(this.closeMenu,this)),this.btnDeletePwd=t.getButton("del-password"),this.btnDeletePwd.render(this.$el.find("#fms-btn-delete-pwd")),this.btnDeletePwd.on("click",_.bind(this.closeMenu,this)),this.cntPassword=$("#id-fms-password"),this.cntEncryptBlock=this.$el.find(".encrypt-block"),this.cntEncryptedBlock=this.$el.find(".encrypted-block"),this.btnAddInvisibleSign=t.getButton("signature"),this.btnAddInvisibleSign.render(this.$el.find("#fms-btn-invisible-sign")),this.btnAddInvisibleSign.on("click",_.bind(this.closeMenu,this)),this.cntSignature=$("#id-fms-signature"),this.cntSignatureView=$("#id-fms-signature-view"),this.cntAddSignature=this.$el.find(".add-signature-block"),this.cntAddedSignature=this.$el.find(".added-signature-block"),_.isUndefined(this.scroller)&&(this.scroller=new Common.UI.Scroller({el:this.$el,suppressScrollX:!0,alwaysVisibleY:!0})),this.$el.on("click",".signature-edit-link",_.bind(this.onEdit,this)),this.$el.on("click",".signature-view-link",_.bind(this.onView,this)),this},show:function(){Common.UI.BaseView.prototype.show.call(this,arguments),this.updateSignatures(),this.updateEncrypt(),this.scroller&&this.scroller.update()},setMode:function(t){this.mode=t,this.cntSignature.toggleClass("hidden",!this.mode.isSignatureSupport),this.cntPassword.toggleClass("hidden",!this.mode.isPasswordSupport)},setApi:function(t){return this.api=t,this},closeMenu:function(){this.menu&&this.menu.hide()},onEdit:function(){this.menu&&this.menu.hide();var t=this;Common.UI.warning({title:this.notcriticalErrorTitle,msg:this.txtEditWarning,buttons:["ok","cancel"],primary:"ok",callback:function(e){"ok"==e&&t.api.asc_RemoveAllSignatures()}})},onView:function(){this.menu&&this.menu.hide()},updateSignatures:function(){var t=this.api.asc_getSignatures(),e=!1,i=!1;_.each(t,(function(t,s){0==t.asc_getValid()?e=!0:i=!0}));var s=i?this.txtSignedInvalid:e?this.txtSigned:"";this.cntSignatureView.html(this.templateSignature({tipText:s,hasSigned:e||i}));var n=this.btnAddInvisibleSign.$el.find("button").hasClass("hidden");this.cntAddSignature.toggleClass("hidden",n),this.cntAddedSignature.toggleClass("hidden",!n)},updateEncrypt:function(){var t=this.btnAddPwd.$el.find("button").hasClass("hidden");this.cntEncryptBlock.toggleClass("hidden",t),this.cntEncryptedBlock.toggleClass("hidden",!t)},strProtect:"Protect Document",strSignature:"With Signature",txtView:"View signatures",txtEdit:"Edit document",txtSigned:"Valid signatures has been added to the document. The document is protected from editing.",txtSignedInvalid:"Some of the digital signatures in document are invalid or could not be verified. The document is protected from editing.",notcriticalErrorTitle:"Warning",txtEditWarning:"Editing will remove the signatures from the document.<br>Are you sure you want to continue?",strEncrypt:"With Password",txtProtectDocument:"Encrypt this document with a password",txtEncrypted:"A password is required to open this document",txtAddSignature:"Ensure the integrity of the document by adding an<br>invisible digital signature",txtAddedSignature:"Valid signatures have been added to the document.<br>The document is protected from editing."},PDFE.Views.FileMenuPanels.ProtectDoc||{})),PDFE.Views.PrintWithPreview=Common.UI.BaseView.extend(_.extend({el:"#panel-print",menu:void 0,template:_.template(['<div style="width:100%; height:100%; position: relative;">','<div id="id-print-settings" class="no-padding">','<div class="print-settings">','<div class="flex-settings ps-container oo settings-container">','<div class="main-header"><%= scope.txtPrint %></div>','<table style="width: 100%;">',"<tbody>",'<tr><td><label class="font-weight-bold"><%= scope.txtPrinter %></label></td></tr>','<tr><td class="padding-large"><div id="print-combo-printer" style="width: 248px;"></div></td></tr>','<tr><td><label class="font-weight-bold"><%= scope.txtColorPrinting %></label></td></tr>','<tr><td class="padding-large"><div id="print-combo-color-printing" style="width: 248px;"></div></td></tr>','<tr><td><label class="font-weight-bold"><%= scope.txtPrintRange %></label></td></tr>','<tr><td class="padding-large"><div id="print-combo-range" style="width: 248px;"></div></td></tr>','<tr><td class="padding-large">','<table style="width: 100%;"><tbody>','<tr><td class="padding-large"><%= scope.txtPages %>:</td><td class="padding-large" style="width: 100%;"><div id="print-txt-pages" class="padding-left-5" style="width: 100%;"></div></td></tr>','<tr><td><%= scope.txtCopies %>:</td><td style="width: 100%;"><div id="print-txt-copies" class="padding-left-5" style="width: 60px;"></div></td></tr>',"</tbody></table>","</td></tr>",'<tr><td><label class="font-weight-bold"><%= scope.txtPrintSides %></label></td></tr>','<tr><td class="padding-large"><div id="print-combo-sides" style="width: 248px;"></div></td></tr>','<tr><td><label class="font-weight-bold"><%= scope.txtPageSize %></label></td></tr>','<tr><td class="padding-large"><div id="print-combo-pages" style="width: 248px;"></div></td></tr>','<tr><td><label class="font-weight-bold"><%= scope.txtPageOrientation %></label></td></tr>','<tr><td class="padding-large"><div id="print-combo-orient" style="width: 150px;"></div></td></tr>','<tr><td><label class="font-weight-bold"><%= scope.txtMargins %></label></td></tr>','<tr><td class="padding-large"><div id="print-combo-margins" style="width: 248px;"></div></td></tr>','<tr><td class="padding-large"><label id="print-btn-system-dialog" data-hint="2" data-hint-direction="bottom" data-hint-offset="medium"><span class="link"><%= scope.txtPrintUsingSystemDialog %></span></label></td></tr>','<tr class="fms-btn-apply"><td>','<div class="footer justify">','<button id="print-btn-print" class="btn normal dlg-btn primary margin-right-8" result="print" style="width: 96px;" data-hint="2" data-hint-direction="bottom" data-hint-offset="big"><%= scope.txtPrint %></button>','<button id="print-btn-print-pdf" class="btn normal dlg-btn" result="pdf" style="min-width: 96px;width: auto;" data-hint="2" data-hint-direction="bottom" data-hint-offset="big"><%= scope.txtPrintPdf %></button>',"</div>","</td></tr>","</tbody>","</table>","</div>","</div>","</div>",'<div id="print-preview-box" class="no-padding">','<div id="print-preview"></div>','<div id="print-navigation">',"<% if (!isRTL) { %>",'<div id="print-prev-page"></div>','<div id="print-next-page"></div>',"<% } else { %>",'<div id="print-next-page"></div>','<div id="print-prev-page"></div>',"<% } %>",'<div class="page-number margin-left-10">',"<label><%= scope.txtPage %></label>",'<div id="print-number-page" class="margin-left-4"></div>','<label id="print-count-page" class="margin-left-4"><%= scope.txtOf %></label>',"</div>","</div>","</div>","</div>"].join("")),initialize:function(t){Common.UI.BaseView.prototype.initialize.call(this,arguments),this.menu=t.menu,this._defaultPaperSizeList=[{value:0,displayValue:["US Letter","21,59","27,94","cm"],caption:"US Letter",size:[215.9,279.4]},{value:1,displayValue:["US Legal","21,59","35,56","cm"],caption:"US Legal",size:[215.9,355.6]},{value:2,displayValue:["A4","21","29,7","cm"],caption:"A4",size:[210,297]},{value:3,displayValue:["A5","14,8","21","cm"],caption:"A5",size:[148,210]},{value:4,displayValue:["B5","17,6","25","cm"],caption:"B5",size:[176,250]},{value:5,displayValue:["Envelope #10","10,48","24,13","cm"],caption:"Envelope #10",size:[104.8,241.3]},{value:6,displayValue:["Envelope DL","11","22","cm"],caption:"Envelope DL",size:[110,220]},{value:7,displayValue:["Tabloid","27,94","43,18","cm"],caption:"Tabloid",size:[279.4,431.8]},{value:8,displayValue:["A3","29,7","42","cm"],caption:"A3",size:[297,420]},{value:9,displayValue:["Tabloid Oversize","29,69","45,72","cm"],caption:"Tabloid Oversize",size:[296.9,457.2]},{value:10,displayValue:["ROC 16K","19,68","27,3","cm"],caption:"ROC 16K",size:[196.8,273]},{value:11,displayValue:["Envelope Choukei 3","12","23,5","cm"],caption:"Envelope Choukei 3",size:[120,235]},{value:12,displayValue:["Super B/A3","30,5","48,7","cm"],caption:"Super B/A3",size:[305,487]},{value:13,displayValue:["A4","84,1","118,9","cm"],caption:"A0",size:[841,1189]},{value:14,displayValue:["A4","59,4","84,1","cm"],caption:"A1",size:[594,841]},{value:16,displayValue:["A4","42","59,4","cm"],caption:"A2",size:[420,594]},{value:17,displayValue:["A4","10,5","14,8","cm"],caption:"A6",size:[105,148]}],this._initSettings=!0,this._originalPageSize=void 0,this._colorPrinting=""},render:function(t){var e=this,i=$(this.template({scope:this,isRTL:Common.UI.isRTL()}));this.cmbPrinter=new Common.UI.ComboBox({el:i.findById("#print-combo-printer"),menuStyle:"width: 248px; max-height: 280px;",editable:!1,takeFocusOnClose:!0,cls:"input-group-nr",placeHolder:this.txtPrinterNotSelected,itemsTemplate:_.template(["<% if (items.length > 0) { %>","<% _.each(items, function(item) { %>",'<li id="<%= item.id %>" data-value="<%= item.value %>"><a tabindex="-1" type="menuitem" <% if (typeof(item.checked) !== "undefined" && item.checked) { %> class="checked" <% } %> ><%= scope.getDisplayValue(item) %></a></li>',"<% }); %>","<% } %>","<% if(scope.options.isWatingForPrinters) { %>",'<li><a id="print-waiting-for-printers" class="text-dropdown-item" onclick="event.stopPropagation();">'+this.txtWaitingForPrinters+'<div class="spiner-image"></div></a></li>',"<% } else if(items.length == 0) {%>",'<li><a class="text-dropdown-item" onclick="event.stopPropagation();">'+this.txtPrintersNotFound+"</a></li>","<% } %>"].join("")),isWatingForPrinters:!0,data:[],dataHint:"2",dataHintDirection:"bottom",dataHintOffset:"big"}),this.cmbPrinter.on("selected",_.bind(this.onPrinterSelected,this)),this.cmbColorPrinting=new Common.UI.ComboBox({el:i.findById("#print-combo-color-printing"),menuStyle:"width: 248px; max-height: 280px;",editable:!1,takeFocusOnClose:!0,cls:"input-group-nr",disabled:!0,data:[{value:"color",displayValue:this.txtColorPrinting},{value:"black-and-white",displayValue:this.txtBlackAndWhitePrinting}],dataHint:"2",dataHintDirection:"bottom",dataHintOffset:"big"}),this.cmbColorPrinting.on("selected",_.bind((function(t,e){this._colorPrinting=e.value}),this)),this.cmbColorPrinting.setValue("black-and-white"),this._colorPrinting="black-and-white",this.cmbRange=new Common.UI.ComboBox({el:i.findById("#print-combo-range"),menuStyle:"min-width: 248px;max-height: 280px;",editable:!1,takeFocusOnClose:!0,cls:"input-group-nr",data:[{value:"all",displayValue:this.txtAllPages},{value:"current",displayValue:this.txtCurrentPage},{value:-1,displayValue:this.txtCustomPages}],dataHint:"2",dataHintDirection:"bottom",dataHintOffset:"big"}),this.cmbRange.setValue("all"),this.inputPages=new Common.UI.InputField({el:i.findById("#print-txt-pages"),allowBlank:!0,validateOnChange:!0,validateOnBlur:!1,maskExp:/[0-9,\-]/,dataHint:"2",dataHintDirection:"left",dataHintOffset:"small"}),this.spnCopies=new Common.UI.MetricSpinner({el:i.findById("#print-txt-copies"),step:1,width:60,defaultUnit:"",value:1,maxValue:32767,minValue:1,allowDecimal:!1,maskExp:/[0-9]/,dataHint:"2",dataHintDirection:"bottom",dataHintOffset:"big"}),this.cmbSides=new Common.UI.ComboBox({el:i.findById("#print-combo-sides"),menuStyle:"width:100%;",editable:!1,takeFocusOnClose:!0,cls:"input-group-nr",data:[{value:"one",displayValue:this.txtOneSide,descValue:this.txtOneSideDesc},{value:"both-long",displayValue:this.txtBothSides,descValue:this.txtBothSidesLongDesc},{value:"both-short",displayValue:this.txtBothSides,descValue:this.txtBothSidesShortDesc}],itemsTemplate:_.template(["<% _.each(items, function(item) { %>",'<li id="<%= item.id %>" data-value="<%- item.value %>"><a tabindex="-1" type="menuitem" style ="display: flex; flex-direction: column;">','<label><%= scope.getDisplayValue(item) %></label><label class="comment-text"><%= item.descValue %></label></a></li>',"<% }); %>"].join("")),dataHint:"2",dataHintDirection:"bottom",dataHintOffset:"big"}),this.cmbSides.setValue("one");var s=Common.UI.isRTL()?_.template(["<% _.each(items, function(item) { %>",'<li id="<%= item.id %>" data-value="<%- item.value %>"><a tabindex="-1" type="menuitem" dir="ltr">','<% if (typeof item.displayValue === "string") { %>',"<%= item.displayValue %>","<% } else { %>",'(<span dir="rtl"><%= item.displayValue[2] %> <%= item.displayValue[3] %></span>',"<span> x </span>",'<span dir="rtl"><%= item.displayValue[1] %> <%= item.displayValue[3] %></span>)',"<span> <%= item.displayValue[0] %></span>","<% } %>","</a></li>","<% }); %>"].join("")):_.template(["<% _.each(items, function(item) { %>",'<li id="<%= item.id %>" data-value="<%- item.value %>"><a tabindex="-1" type="menuitem">','<% if (typeof item.displayValue === "string") { %>',"<%= item.displayValue %>","<% } else { %>","<%= item.displayValue[0] %>"," (<%= item.displayValue[1] %> <%= item.displayValue[3] %> x"," <%= item.displayValue[2] %> <%= item.displayValue[3] %>)","<% } %>","</a></li>","<% }); %>"].join("")),n=_.template(['<div class="input-group combobox input-group-nr <%= cls %>" id="<%= id %>" style="<%= style %>">','<div class="form-control" style="padding-top:3px; line-height: 14px; cursor: pointer; width: 248px; <%= style %>"',Common.UI.isRTL()?'dir="rtl"':"","></div>",'<div style="display: table-cell;"></div>','<button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown"><span class="caret"></span></button>','<ul class="dropdown-menu <%= menuCls %>" style="<%= menuStyle %>" role="menu">'].concat(s).concat(["</ul>","</div>"]).join(""));return this.cmbPaperSize=new Common.UI.ComboBoxCustom({el:i.findById("#print-combo-pages"),menuStyle:"max-height: 280px; width: 248px;",editable:!1,takeFocusOnClose:!0,template:n,itemsTemplate:s,data:[].concat(this._defaultPaperSizeList,[{value:-1,displayValue:this.txtCustom,caption:this.txtCustom,size:[]}]),dataHint:"2",dataHintDirection:"bottom",dataHintOffset:"big",updateFormControl:function(t,e){var i=$(this.el).find(".form-control");if(t||e){var s=e||t.get("displayValue");"string"==typeof s?i[0].innerHTML=s:Common.UI.isRTL()?i[0].innerHTML='<span dir="ltr">(<span dir="rtl">'+s[2]+" "+s[3]+'</span><span> x </span><span dir="rtl">'+s[1]+" "+s[3]+"</span>)<span> "+s[0]+"</span></span>":i[0].innerHTML=s[0]+" ("+s[1]+" "+s[3]+" x "+s[2]+" "+s[3]+")"}else i[0].innerHTML=""}}),this.cmbPaperOrientation=new Common.UI.ComboBox({el:i.findById("#print-combo-orient"),menuStyle:"min-width: 150px;",editable:!1,takeFocusOnClose:!0,cls:"input-group-nr",data:[{value:Asc.c_oAscPageOrientation.PagePortrait,displayValue:this.txtPortrait},{value:Asc.c_oAscPageOrientation.PageLandscape,displayValue:this.txtLandscape}],dataHint:"2",dataHintDirection:"bottom",dataHintOffset:"big"}),this.cmbPaperMargins=new Common.UI.ComboBox({el:i.findById("#print-combo-margins"),menuStyle:"max-height: 280px; min-width: 248px;",editable:!1,takeFocusOnClose:!0,cls:"input-group-nr",data:[{value:0,displayValue:this.textMarginsNormal,size:/^(ca|us)$/i.test(Common.Utils.InternalSettings.get("pdfe-config-region"))?[25.4,25.4,25.4,25.4]:[20,30,20,15]},{value:2,displayValue:this.textMarginsNarrow,size:[12.7,12.7,12.7,12.7]},{value:3,displayValue:this.textMarginsModerate,size:[25.4,19.1,25.4,19.1]},{value:4,displayValue:this.textMarginsWide,size:[25.4,50.8,25.4,50.8]},{value:-1,displayValue:this.txtCustom,size:null}],itemsTemplate:_.template(["<% _.each(items, function(item) { %>",'<li id="<%= item.id %>" data-value="<%- item.value %>"><a tabindex="-1" type="menuitem">',"<div><b><%= scope.getDisplayValue(item) %></b></div>",'<% if (item.size !== null) { %><div class="margin-right-20" style="display: inline-block;min-width: 80px;"><label style="display: block;">'+this.txtTop+': <%= parseFloat(Common.Utils.Metric.fnRecalcFromMM(item.size[0]).toFixed(2)) %> <%= Common.Utils.Metric.getCurrentMetricName() %></label><label style="display: block;">'+this.txtLeft+': <%= parseFloat(Common.Utils.Metric.fnRecalcFromMM(item.size[1]).toFixed(2)) %> <%= Common.Utils.Metric.getCurrentMetricName() %></label></div><div style="display: inline-block;"><label style="display: block;">'+this.txtBottom+': <%= parseFloat(Common.Utils.Metric.fnRecalcFromMM(item.size[2]).toFixed(2)) %> <%= Common.Utils.Metric.getCurrentMetricName() %></label><label style="display: block;">'+this.txtRight+": <%= parseFloat(Common.Utils.Metric.fnRecalcFromMM(item.size[3]).toFixed(2)) %> <%= Common.Utils.Metric.getCurrentMetricName() %></label></div><% } %>","<% }); %>"].join("")),dataHint:"2",dataHintDirection:"bottom",dataHintOffset:"big"}),this.pnlSettings=i.find(".flex-settings").addBack().filter(".flex-settings"),this.pnlTable=$(this.pnlSettings.find("table")[0]),this.trApply=i.find(".fms-btn-apply"),this.btnPrintSystemDialog=i.find("#print-btn-system-dialog > span"),this.btnPrint=new Common.UI.Button({el:i.findById("#print-btn-print"),disabled:!0}),this.btnPrintPdf=new Common.UI.Button({el:i.findById("#print-btn-print-pdf")}),this.btnPrevPage=new Common.UI.Button({parentEl:i.findById("#print-prev-page"),cls:"btn-prev-page",iconCls:"arrow",scaling:!1,dataHint:"2",dataHintDirection:"top"}),this.btnNextPage=new Common.UI.Button({parentEl:i.findById("#print-next-page"),cls:"btn-next-page",iconCls:"arrow",scaling:!1,dataHint:"2",dataHintDirection:"top"}),this.countOfPages=i.findById("#print-count-page"),this.txtNumberPage=new Common.UI.InputField({el:i.findById("#print-number-page"),allowBlank:!0,validateOnChange:!0,style:"width: 50px;",maskExp:/[0-9]/,validation:function(t){return!!(/(^[0-9]+$)/.test(t)&&void 0!==(t=parseInt(t))&&t>0&&t<=e.pageCount)||e.txtPageNumInvalid},dataHint:"2",dataHintDirection:"left",dataHintOffset:"small"}),this.$el=$(t).html(i),this.$previewBox=$("#print-preview-box"),_.isUndefined(this.scroller)&&(this.scroller=new Common.UI.Scroller({el:this.pnlSettings,suppressScrollX:!0,alwaysVisibleY:!0})),Common.NotificationCenter.on({"window:resize":function(){e.isVisible()&&e.updateScroller()}}),this.updateMetricUnit(),this.fireEvent("render:after",this),this},show:function(){Common.UI.BaseView.prototype.show.call(this,arguments),this._initSettings&&(this.updateMetricUnit(),this._initSettings=!1),this.updateScroller(),this.fireEvent("show",this)},updateCmbPrinter:function(t,e,i){const s=(e||[]).map((function(t){return{value:t.name,displayValue:t.name,paperSupported:t.paper_supported,isDuplexSupported:t.duplex_supported,colorSupported:!!t.color_supported}}));this.cmbPrinter.options.isWatingForPrinters=i,this.cmbPrinter.setData(s);let n=this.cmbPrinter.getValue();if(!n&&_.some(s,(function(e){return e.value==t}))&&(n=t),n){const t=n!=this.cmbPrinter.getValue();this.cmbPrinter.setValue(n),t&&this.cmbPrinter.trigger("selected",this,this.cmbPrinter.getSelectedRecord())}},setCmbColorPrintingDisabled:function(t){t?this.cmbColorPrinting.setValue("black-and-white"):this.cmbColorPrinting.setValue(this._colorPrinting),this.cmbColorPrinting.setDisabled(t)},setCmbSidesOptions:function(t){var e=this.cmbSides.getValue(),i=[{value:"one",displayValue:this.txtOneSide,descValue:this.txtOneSideDesc}];t?i.push({value:"both-long",displayValue:this.txtBothSides,descValue:this.txtBothSidesLongDesc},{value:"both-short",displayValue:this.txtBothSides,descValue:this.txtBothSidesShortDesc}):"one"!=e&&(e="one"),this.cmbSides.setData(i),this.cmbSides.setValue(e)},setCmbPaperSizeOptions:function(t){var e=[];(e=t&&t.length>0?t.map((function(t,e){return{value:e,displayValue:[t.name,t.width/10,t.height/10,"cm"],caption:t.name,size:[t.width,t.height]}})):[].concat(this._defaultPaperSizeList)).push({value:-1,displayValue:this.txtCustom,caption:this.txtCustom,size:[]});var i=this.cmbPaperSize.store.findWhere({value:this.cmbPaperSize.getValue()}),s=null;function n(t,e,i){return _.find(t,(function(t){return Math.abs(t.size[0]-e)<.1&&Math.abs(t.size[1]-i)<.1}))}if(i&&(s=n(e,Math.round(i.get("size")[0]),Math.round(i.get("size")[1]))),!s)if(i)s={custom:!0,value:[this.txtCustom,parseFloat(Common.Utils.Metric.fnRecalcFromMM(i.get("size")[0]).toFixed(2)),parseFloat(Common.Utils.Metric.fnRecalcFromMM(i.get("size")[1]).toFixed(2)),Common.Utils.Metric.getCurrentMetricName()]};else{const t=this._originalPageSize?this._originalPageSize.w:210,i=this._originalPageSize?this._originalPageSize.h:297;s||(s=n(e,t,i)),s||(s={custom:!0,value:[this.txtCustom,parseFloat(Common.Utils.Metric.fnRecalcFromMM(t).toFixed(2)),parseFloat(Common.Utils.Metric.fnRecalcFromMM(i).toFixed(2)),Common.Utils.Metric.getCurrentMetricName()]}),!s&&e[0]&&(s=e[0])}this.cmbPaperSize.setData(e),this.updatePaperSizeMetricUnit(),s?s.custom?this.cmbPaperSize.setValue(void 0,s.value):(this.cmbPaperSize.setValue(s.value),this.cmbPaperSize.isDisabled||this.cmbPaperSize.trigger("selected",this,this.cmbPaperSize.getSelectedRecord())):this.cmbPaperSize.setValue(null)},updateScroller:function(){if(this.scroller){Common.UI.Menu.Manager.hideAll();var t=this.$el.height()<this.pnlTable.height()+25+this.$el.find(".main-header").outerHeight(!0);this.pnlSettings.css("overflow",t?"hidden":"visible"),this.scroller.update()}},setMode:function(t){this.mode=t},setApi:function(t){},onPrinterSelected:function(t,e){this.setCmbSidesOptions(!e||e.isDuplexSupported),this.setCmbPaperSizeOptions(e?e.paperSupported:null),this.setCmbColorPrintingDisabled(!e||!e.colorSupported),this.btnPrint.setDisabled(!e)},updateMetricUnit:function(){this.updatePaperSizeMetricUnit(),this.cmbPaperMargins.onResetItems()},updatePaperSizeMetricUnit:function(){if(this.cmbPaperSize){for(var t=this.cmbPaperSize.store,e=0;e<t.length-1;e++){var i=t.at(e),s=i.get("size"),n=s[0],a=s[1];i.set("displayValue",[i.get("caption"),parseFloat(Common.Utils.Metric.fnRecalcFromMM(n).toFixed(2)),parseFloat(Common.Utils.Metric.fnRecalcFromMM(a).toFixed(2)),Common.Utils.Metric.getCurrentMetricName()])}this.cmbPaperSize.onResetItems()}},isVisible:function(){return(this.$el||$(this.el)).is(":visible")},setRange:function(t){this.cmbRange.setValue(t)},getRange:function(){return this.cmbRange.getValue()},updateCountOfPages:function(t){this.countOfPages.text(Common.Utils.String.format(this.txtOf,t)),this.pageCount=t},updateCurrentPage:function(t){this.txtNumberPage.setValue(t+1)},setOriginalPageSize:function(t,e){this._originalPageSize={w:t,h:e}},txtPrint:"Print",txtPrintPdf:"Print to PDF",txtPrinter:"Printer",txtPrinterNotSelected:"Printer not selected",txtPrintersNotFound:"Printers not found",txtWaitingForPrinters:"Waiting for printers",txtColorPrinting:"Color printing",txtBlackAndWhitePrinting:"Black and white printing",txtPrintUsingSystemDialog:"Print using the system dialog",txtPrintRange:"Print range",txtCurrentPage:"Current page",txtAllPages:"All pages",txtSelection:"Selection",txtCustomPages:"Custom print",txtPageSize:"Page size",txtPageOrientation:"Page orientation",txtPortrait:"Portrait",txtLandscape:"Landscape",txtCustom:"Custom",txtMargins:"Margins",txtTop:"Top",txtBottom:"Bottom",txtLeft:"Left",txtRight:"Right",txtPage:"Page",txtOf:"of {0}",txtPageNumInvalid:"Page number invalid",txtPages:"Pages",textMarginsLast:"Last Custom",textMarginsNormal:"Normal",textMarginsNarrow:"Narrow",textMarginsModerate:"Moderate",textMarginsWide:"Wide",txtCopies:"Copies",txtPrintSides:"Print sides",txtOneSide:"Print one sided",txtOneSideDesc:"Only print on one side of the page",txtBothSides:"Print on both sides",txtBothSidesLongDesc:"Flip pages on long edge",txtBothSidesShortDesc:"Flip pages on short edge"},PDFE.Views.PrintWithPreview||{}))})),define("pdfeditor/main/app/view/DocumentHolderExt",[],(function(){"use strict";if(window.PDFE&&window.PDFE.Views&&window.PDFE.Views.DocumentHolder){let t=window.PDFE.Views.DocumentHolder.prototype;t.createDelayedElementsPDFViewer=function(){var t=this;t.menuPDFViewCopy||(t.menuPDFViewCopy=new Common.UI.MenuItem({iconCls:"menu__icon btn-copy",caption:t.textCopy,value:"copy"}),t.menuAddComment=new Common.UI.MenuItem({iconCls:"menu__icon btn-add-comment",caption:t.addCommentText}),t.menuRemoveComment=new Common.UI.MenuItem({iconCls:"menu__icon btn-cc-remove",caption:t.removeCommentText}),this.viewPDFModeMenu=new Common.UI.Menu({cls:"shifted-right",initMenu:function(e){var i=void 0!==e.pageProps&&e.pageProps.locked;t.menuPDFViewCopy.setDisabled(!(t.api&&t.api.can_CopyCut())),t.menuAddComment.setVisible(t.mode&&t.mode.canComments),t.menuAddComment.setDisabled(i),t.menuRemoveComment.setVisible(e&&e.annotProps&&e.annotProps.value),t.menuRemoveComment.setDisabled(i)},items:[t.menuPDFViewCopy,t.menuAddComment,t.menuRemoveComment]}).on("hide:after",(function(e,i,s){t.clearCustomItems(e),t.currentMenu=null,t.suppressEditComplete?t.suppressEditComplete=!1:s||t.fireEvent("editcomplete",t)})),t.menuViewCopyPage=new Common.UI.MenuItem({iconCls:"menu__icon btn-copy",caption:t.textCopy,value:"copy"}),this.viewPageMenu=new Common.UI.Menu({cls:"shifted-right",initMenu:function(e){e?t.options.eventProps=e:e=t.options.eventProps,e&&t.menuViewCopyPage.setDisabled(!0!==e.isPageSelect)},items:[t.menuViewCopyPage]}).on("hide:after",(function(e,i,s){t.clearCustomItems(e),t.currentMenu=null,t.suppressEditComplete?t.suppressEditComplete=!1:s||t.fireEvent("editcomplete",t)})),this.fireEvent("createdelayedelements",[this,"pdf"]))},t.createDelayedElementsPDFEditor=function(){var t=this;if(!t.menuPDFEditCopy){t.menuPDFEditCopy=new Common.UI.MenuItem({iconCls:"menu__icon btn-copy",caption:t.textCopy,value:"copy"}),t.menuEditAddComment=new Common.UI.MenuItem({iconCls:"menu__icon btn-add-comment",caption:t.addCommentText}),t.menuEditRemoveComment=new Common.UI.MenuItem({iconCls:"menu__icon btn-cc-remove",caption:t.removeCommentText}),this.editPDFModeMenu=new Common.UI.Menu({cls:"shifted-right",initMenu:function(e){var i=void 0!==e.pageProps&&e.pageProps.locked;t.menuPDFEditCopy.setDisabled(!(t.api&&t.api.can_CopyCut())),t.menuEditAddComment.setVisible(t.mode&&t.mode.canComments),t.menuEditAddComment.setDisabled(i),t.menuEditRemoveComment.setVisible(e&&e.annotProps&&e.annotProps.value),t.menuEditRemoveComment.setDisabled(i)},items:[t.menuPDFEditCopy,t.menuEditAddComment,t.menuEditRemoveComment]}).on("hide:after",(function(e,i,s){t.clearCustomItems(e),t.currentMenu=null,t.suppressEditComplete?t.suppressEditComplete=!1:s||t.fireEvent("editcomplete",t)})),t.mnuTableMerge=new Common.UI.MenuItem({iconCls:"menu__icon btn-merge-cells",caption:t.mergeCellsText}),t.mnuTableSplit=new Common.UI.MenuItem({caption:t.splitCellsText}),t.menuTableCellAlign=new Common.UI.MenuItem({iconCls:"menu__icon btn-align-top",caption:t.cellAlignText,menu:new Common.UI.Menu({cls:"shifted-right",menuAlign:"tl-tr",items:[t.menuTableCellTop=new Common.UI.MenuItem({iconCls:"menu__icon btn-align-top",caption:t.textShapeAlignTop,checkable:!0,checkmark:!1,toggleGroup:"popuptablecellalign",value:Asc.c_oAscVertAlignJc.Top}),t.menuTableCellCenter=new Common.UI.MenuItem({iconCls:"menu__icon btn-align-middle",caption:t.textShapeAlignMiddle,checkable:!0,checkmark:!1,toggleGroup:"popuptablecellalign",value:Asc.c_oAscVertAlignJc.Center}),t.menuTableCellBottom=new Common.UI.MenuItem({iconCls:"menu__icon btn-align-bottom",caption:t.textShapeAlignBottom,checkable:!0,checkmark:!1,toggleGroup:"popuptablecellalign",value:Asc.c_oAscVertAlignJc.Bottom})]})}),t.menuTableSaveAsPicture=new Common.UI.MenuItem({caption:t.textSaveAsPicture});var e=new Common.UI.MenuItem({caption:"--"});t.menuTableDistRows=new Common.UI.MenuItem({caption:t.textDistributeRows}),t.menuTableDistCols=new Common.UI.MenuItem({caption:t.textDistributeCols}),t.menuTableSelectText=new Common.UI.MenuItem({caption:t.selectText,menu:new Common.UI.Menu({cls:"shifted-right",menuAlign:"tl-tr",items:[new Common.UI.MenuItem({caption:t.rowText,value:0}),new Common.UI.MenuItem({caption:t.columnText,value:1}),new Common.UI.MenuItem({caption:t.cellText,value:2}),new Common.UI.MenuItem({caption:t.tableText,value:3})]})}),t.menuTableInsertText=new Common.UI.MenuItem({iconCls:"menu__icon btn-addcell",caption:t.insertText,menu:new Common.UI.Menu({cls:"shifted-right",menuAlign:"tl-tr",style:"width: 100px",items:[new Common.UI.MenuItem({caption:t.insertColumnLeftText,value:0}),new Common.UI.MenuItem({caption:t.insertColumnRightText,value:1}),new Common.UI.MenuItem({caption:t.insertRowAboveText,value:2}),new Common.UI.MenuItem({caption:t.insertRowBelowText,value:3})]})}),t.menuTableDeleteText=new Common.UI.MenuItem({iconCls:"menu__icon btn-delcell",caption:t.deleteText,menu:new Common.UI.Menu({cls:"shifted-right",menuAlign:"tl-tr",items:[new Common.UI.MenuItem({caption:t.rowText,value:0}),new Common.UI.MenuItem({caption:t.columnText,value:1}),new Common.UI.MenuItem({caption:t.tableText,value:2})]})}),t.menuTableAdvanced=new Common.UI.MenuItem({iconCls:"menu__icon btn-menu-table",caption:t.advancedTableText});var i=new Common.UI.MenuItem({caption:"--"});t.menuAddHyperlinkTable=new Common.UI.MenuItem({iconCls:"menu__icon btn-inserthyperlink",caption:t.hyperlinkText}),t.menuEditHyperlinkTable=new Common.UI.MenuItem({caption:t.editHyperlinkText}),t.menuRemoveHyperlinkTable=new Common.UI.MenuItem({caption:t.removeHyperlinkText});var s=new Common.UI.MenuItem({iconCls:"menu__icon btn-inserthyperlink",caption:t.hyperlinkText,menu:new Common.UI.Menu({cls:"shifted-right",menuAlign:"tl-tr",items:[t.menuEditHyperlinkTable,t.menuRemoveHyperlinkTable]})});t.menuAddCommentTable=new Common.UI.MenuItem({iconCls:"menu__icon btn-add-comment",caption:t.addCommentText}),t.menuAddCommentTable.hide(),t.menuTableCopy=new Common.UI.MenuItem({iconCls:"menu__icon btn-copy",caption:t.textCopy,value:"copy"}),t.menuTablePaste=new Common.UI.MenuItem({iconCls:"menu__icon btn-paste",caption:t.textPaste,value:"paste"}),t.menuTableCut=new Common.UI.MenuItem({iconCls:"menu__icon btn-cut",caption:t.textCut,value:"cut"});var n=new Common.UI.MenuItem({caption:"--"}),a=new Common.UI.MenuItem({caption:"--"});t.menuTableEquationSettings=new Common.UI.MenuItem({caption:t.advancedEquationText,iconCls:"menu__icon btn-equation",menu:t.createEquationMenu("popuptableeqinput","tl-tr")}),t.tableMenu=new Common.UI.Menu({cls:"shifted-right",restoreHeightAndTop:!0,scrollToCheckedItem:!1,initMenu:function(o){if(!_.isUndefined(o.tableProps)){for(var l=o.mathProps&&o.mathProps.value,r=4;r<16;r++)t.tableMenu.items[r].setVisible(!l);var c=o.tableProps.value.get_CellsVAlign(),d="";switch(c){case Asc.c_oAscVertAlignJc.Top:d="menu__icon btn-align-top";break;case Asc.c_oAscVertAlignJc.Center:d="menu__icon btn-align-middle";break;case Asc.c_oAscVertAlignJc.Bottom:d="menu__icon btn-align-bottom"}t.menuTableCellAlign.setIconCls(d),t.menuTableCellTop.setChecked(c==Asc.c_oAscVertAlignJc.Top),t.menuTableCellCenter.setChecked(c==Asc.c_oAscVertAlignJc.Center),t.menuTableCellBottom.setChecked(c==Asc.c_oAscVertAlignJc.Bottom),t.api&&(t.mnuTableMerge.setDisabled(o.tableProps.locked||!t.api.CheckBeforeMergeCells()),t.mnuTableSplit.setDisabled(o.tableProps.locked||!t.api.CheckBeforeSplitCells())),t.menuTableDistRows.setDisabled(o.tableProps.locked),t.menuTableDistCols.setDisabled(o.tableProps.locked),t.tableMenu.items[5].setDisabled(o.tableProps.locked),t.tableMenu.items[6].setDisabled(o.tableProps.locked),t.menuTableCellAlign.setDisabled(o.tableProps.locked),t.menuTableSaveAsPicture.setVisible(!l),e.setVisible(!l),t.menuTableAdvanced.setVisible(!l),t.menuTableAdvanced.setDisabled(o.tableProps.locked),i.setVisible(t.menuTableAdvanced.isVisible());var h=t.api&&t.api.can_CopyCut();t.menuTableCopy.setDisabled(!h),t.menuTableCut.setDisabled(o.tableProps.locked||!h),t.menuTablePaste.setDisabled(o.tableProps.locked);var p=null;t.api&&(p=t.api.can_AddHyperlink()),t.menuAddHyperlinkTable.setVisible(!_.isUndefined(o.paraProps)&&_.isUndefined(o.hyperProps)&&!1!==p),s.setVisible(!_.isUndefined(o.paraProps)&&!_.isUndefined(o.hyperProps)),t.menuEditHyperlinkTable.hyperProps=o.hyperProps,!1!==p&&(t.menuAddHyperlinkTable.hyperProps={},t.menuAddHyperlinkTable.hyperProps.value=new Asc.CHyperlinkProperty,t.menuAddHyperlinkTable.hyperProps.value.put_Text(p)),_.isUndefined(o.paraProps)||(t.menuAddHyperlinkTable.setDisabled(o.paraProps.locked),s.setDisabled(o.paraProps.locked),t._currentParaObjDisabled=o.paraProps.locked),t.menuAddCommentTable.setVisible(t.mode&&t.mode.canComments);var m=0;if(l?m=t.addEquationMenu(t.tableMenu,4):t.clearEquationMenu(t.tableMenu,4),n.setVisible(m>0),t.menuTableEquationSettings.setVisible(l),a.setVisible(l),l){var u=t.api.asc_GetMathInputType(),g=Common.Utils.InternalSettings.get("pdfe-equation-toolbar-hide");t.menuTableEquationSettings.menu.items[5].setChecked(u===Asc.c_oAscMathInputType.Unicode),t.menuTableEquationSettings.menu.items[6].setChecked(u===Asc.c_oAscMathInputType.LaTeX),t.menuTableEquationSettings.menu.items[8].options.isToolbarHide=g,t.menuTableEquationSettings.menu.items[8].setCaption(g?t.showEqToolbar:t.hideEqToolbar)}}},items:[t.menuTableCut,t.menuTableCopy,t.menuTablePaste,{caption:"--"},t.menuTableSelectText,t.menuTableInsertText,t.menuTableDeleteText,{caption:"--"},t.mnuTableMerge,t.mnuTableSplit,{caption:"--"},t.menuTableDistRows,t.menuTableDistCols,{caption:"--"},t.menuTableCellAlign,{caption:"--"},n,t.menuTableSaveAsPicture,e,t.menuTableAdvanced,i,t.menuTableEquationSettings,a,t.menuAddCommentTable,t.menuAddHyperlinkTable,s]}).on("hide:after",(function(e,i,s){t.clearCustomItems(e),t.currentMenu=null,t.suppressEditComplete?t.suppressEditComplete=!1:s||t.fireEvent("editcomplete",t)})),t.menuImageAdvanced=new Common.UI.MenuItem({iconCls:"menu__icon btn-menu-image",caption:t.advancedImageText}),t.menuShapeAdvanced=new Common.UI.MenuItem({iconCls:"menu__icon btn-menu-shape",caption:t.advancedShapeText});var o=new Common.UI.MenuItem({caption:"--"});t.mnuGroupImg=new Common.UI.MenuItem({caption:this.txtGroup,iconCls:"menu__icon btn-shape-group"}),t.mnuUnGroupImg=new Common.UI.MenuItem({caption:this.txtUngroup,iconCls:"menu__icon btn-shape-ungroup"}),t.mnuArrangeFront=new Common.UI.MenuItem({caption:this.textArrangeFront,iconCls:"menu__icon btn-arrange-front"}),t.mnuArrangeBack=new Common.UI.MenuItem({caption:this.textArrangeBack,iconCls:"menu__icon btn-arrange-back"}),t.mnuArrangeForward=new Common.UI.MenuItem({caption:this.textArrangeForward,iconCls:"menu__icon btn-arrange-forward"}),t.mnuArrangeBackward=new Common.UI.MenuItem({caption:this.textArrangeBackward,iconCls:"menu__icon btn-arrange-backward"});var l=new Common.UI.MenuItem({caption:t.txtArrange,menu:new Common.UI.Menu({cls:"shifted-right",menuAlign:"tl-tr",items:[t.mnuArrangeFront,t.mnuArrangeBack,t.mnuArrangeForward,t.mnuArrangeBackward]})});t.menuImgShapeAlign=new Common.UI.MenuItem({caption:t.txtAlign,menu:new Common.UI.Menu({cls:"shifted-right",menuAlign:"tl-tr",items:[new Common.UI.MenuItem({caption:t.textShapeAlignLeft,iconCls:"menu__icon btn-shape-align-left",value:Asc.c_oAscAlignShapeType.ALIGN_LEFT}),new Common.UI.MenuItem({caption:t.textShapeAlignCenter,iconCls:"menu__icon btn-shape-align-center",value:Asc.c_oAscAlignShapeType.ALIGN_CENTER}),new Common.UI.MenuItem({caption:t.textShapeAlignRight,iconCls:"menu__icon btn-shape-align-right",value:Asc.c_oAscAlignShapeType.ALIGN_RIGHT}),new Common.UI.MenuItem({caption:t.textShapeAlignTop,iconCls:"menu__icon btn-shape-align-top",value:Asc.c_oAscAlignShapeType.ALIGN_TOP}),new Common.UI.MenuItem({caption:t.textShapeAlignMiddle,iconCls:"menu__icon btn-shape-align-middle",value:Asc.c_oAscAlignShapeType.ALIGN_MIDDLE}),new Common.UI.MenuItem({caption:t.textShapeAlignBottom,iconCls:"menu__icon btn-shape-align-bottom",value:Asc.c_oAscAlignShapeType.ALIGN_BOTTOM}),{caption:"--"},new Common.UI.MenuItem({caption:t.txtDistribHor,iconCls:"menu__icon btn-shape-distribute-hor",value:6}),new Common.UI.MenuItem({caption:t.txtDistribVert,iconCls:"menu__icon btn-shape-distribute-vert",value:7})]})});var r=PDFE.getController("Toolbar").getView("Toolbar");t.menuShapesMerge=new Common.UI.MenuItem({iconCls:"menu__icon btn-combine-shapes",caption:t.textShapesMerge,menu:new Common.UI.Menu({cls:"shifted-right",menuAlign:"tl-tr",items:[new Common.UI.MenuItem({caption:r.textShapesUnion,iconCls:"menu__icon btn-union-shapes",value:"unite"}),new Common.UI.MenuItem({caption:r.textShapesCombine,iconCls:"menu__icon btn-combine-shapes",value:"exclude"}),new Common.UI.MenuItem({caption:r.textShapesFragment,iconCls:"menu__icon btn-fragment-shapes",value:"divide"}),new Common.UI.MenuItem({caption:r.textShapesIntersect,iconCls:"menu__icon btn-intersect-shapes",value:"intersect"}),new Common.UI.MenuItem({caption:r.textShapesSubstract,iconCls:"menu__icon btn-substract-shapes",value:"subtract"})]})}),t.menuChartElement=new Common.UI.MenuItem({menu:new Common.UI.Menu({items:[{caption:t.textAxes,value:"axes",disabled:!1,menu:new Common.UI.Menu({cls:"shifted-right",menuAlign:"tl-tr",items:[{caption:t.textHorAxis,value:"bShowHorAxis",stopPropagation:!0,checkable:!0},{caption:t.textVertAxis,value:"bShowVertAxis",stopPropagation:!0,checkable:!0},{caption:t.textHorAxisSec,value:"bShowHorAxSec",stopPropagation:!0,checkable:!0},{caption:t.textVertAxisSec,value:"bShowVertAxSec",stopPropagation:!0,checkable:!0},{caption:t.DepthAxis,value:"bShowDepthAxes",stopPropagation:!0,checkable:!0}]})},{caption:t.textAxisTitles,value:"axisTitles",disabled:!1,menu:new Common.UI.Menu({cls:"shifted-right",menuAlign:"tl-tr",items:[{caption:t.textHorAxis,value:"bShowHorAxTitle",stopPropagation:!0,checkable:!0},{caption:t.textVertAxis,value:"bShowVertAxTitle",stopPropagation:!0,checkable:!0},{caption:t.textHorAxisSec,value:"bShowHorAxTitleSec",stopPropagation:!0,checkable:!0},{caption:t.textVertAxisSec,value:"bShowVertAxisTitleSec",stopPropagation:!0,checkable:!0},{caption:t.DepthAxis,value:"bShowDepthAxesTitle",stopPropagation:!0,checkable:!0}]})},{caption:t.textChartTitle,value:"chartTitle",disabled:!1,menu:new Common.UI.Menu({cls:"shifted-right",menuAlign:"tl-tr",items:[{caption:t.textNone,value:"bShowChartTitleNone",stopPropagation:!0,toggleGroup:"chartTitle",checkable:!0},{caption:t.textNoOverlay,value:"bShowChartTitle",stopPropagation:!0,toggleGroup:"chartTitle",checkable:!0},{caption:t.textOverlay,value:"bOverlayTitle",stopPropagation:!0,toggleGroup:"chartTitle",checkable:!0}]})},{caption:t.textDataLabels,value:"dataLabels",disabled:!1,menu:new Common.UI.Menu({cls:"shifted-right",menuAlign:"tl-tr",items:[{caption:t.textNone,value:"bShowDataLabels",stopPropagation:!0,toggleGroup:"dataLabels",checkable:!0},{caption:t.textCenter,value:"CenterData",stopPropagation:!0,toggleGroup:"dataLabels",checkable:!0},{caption:t.textInnerBottom,value:"InnerBottomData",stopPropagation:!0,toggleGroup:"dataLabels",checkable:!0},{caption:t.textInnerTop,value:"InnerTopData",stopPropagation:!0,toggleGroup:"dataLabels",checkable:!0},{caption:t.textOuterTop,value:"OuterTopData",stopPropagation:!0,toggleGroup:"dataLabels",checkable:!0},{caption:t.textTop,value:"TopData",stopPropagation:!0,toggleGroup:"dataLabels",checkable:!0},{caption:t.textLeft,value:"LeftData",stopPropagation:!0,toggleGroup:"dataLabels",checkable:!0},{caption:t.textRight,value:"RightData",stopPropagation:!0,toggleGroup:"dataLabels",checkable:!0},{caption:t.textBottom,value:"BottomData",stopPropagation:!0,toggleGroup:"dataLabels",checkable:!0},{caption:t.textFit,value:"FitWidthData",stopPropagation:!0,toggleGroup:"dataLabels",checkable:!0}]})},{caption:t.textErrorBars,value:"errorBars",disabled:!1,menu:new Common.UI.Menu({cls:"shifted-right",menuAlign:"tl-tr",items:[{caption:t.textStandardError,value:"standardError",stopPropagation:!0,disabled:!1},{caption:t.txtPercentage,value:"percentage",stopPropagation:!0,disabled:!1},{caption:t.textStandardDeviation,value:"standardDeviation",stopPropagation:!0,disabled:!1}]})},{caption:t.textGridLines,value:"gridLines",disabled:!1,menu:new Common.UI.Menu({cls:"shifted-right",menuAlign:"tl-tr",items:[{caption:t.textHorizontalMajor,value:"bShowHorMajor",stopPropagation:!0,checkable:!0},{caption:t.textVerticalMajor,value:"bShowVerMajor",stopPropagation:!0,checkable:!0},{caption:t.textHorizontalMinor,value:"bShowHorMinor",stopPropagation:!0,checkable:!0},{caption:t.textVerticalMinor,value:"bShowVerMinor",stopPropagation:!0,checkable:!0}]})},{caption:t.textLegendPos,value:"legend",disabled:!1,menu:new Common.UI.Menu({cls:"shifted-right",menuAlign:"tl-tr",items:[{caption:t.textNone,value:"NoneLegend",stopPropagation:!0,toggleGroup:"legend",checkable:!0},{caption:t.textTop,value:"TopLegend",stopPropagation:!0,toggleGroup:"legend",checkable:!0},{caption:t.textLeft,value:"LeftLegend",stopPropagation:!0,toggleGroup:"legend",checkable:!0},{caption:t.textRight,value:"RightLegend",stopPropagation:!0,toggleGroup:"legend",checkable:!0},{caption:t.textBottom,value:"BottomLegend",stopPropagation:!0,toggleGroup:"legend",checkable:!0},{caption:t.textLeftOverlay,value:"LeftOverlay",stopPropagation:!0,toggleGroup:"legend",checkable:!0},{caption:t.textRightOverlay,value:"RightOverlay",stopPropagation:!0,toggleGroup:"legend",checkable:!0}]})},{caption:t.textTrendline,value:"trendLines",disabled:!1,menu:new Common.UI.Menu({cls:"shifted-right",menuAlign:"tl-tr",items:[{caption:t.textNone,stopPropagation:!0,value:"trendLineNone"},{caption:t.textLinear,stopPropagation:!0,value:"trendLineLinear"},{caption:t.textExponential,stopPropagation:!0,value:"trendLineExponential"},{caption:t.textLinearForecast,stopPropagation:!0,value:"trendLineForecast"},{caption:t.textMovingAverage,stopPropagation:!0,value:"trendLineMovingAverage"}]})},{caption:t.textUpDownBars,value:"upDownBars",disabled:!1,menu:new Common.UI.Menu({cls:"shifted-right",menuAlign:"tl-tr",items:[{caption:t.textNone,stopPropagation:!0,value:"bShowUpDownNone"},{caption:t.textShowUpDown,stopPropagation:!0,value:"bShowUpDownBars"}]})}]})});var c=new Common.UI.MenuItem({caption:"--"});t.menuImgOriginalSize=new Common.UI.MenuItem({caption:t.originalSizeText}),t.menuImgReplace=new Common.UI.MenuItem({caption:t.textReplace,menu:new Common.UI.Menu({cls:"shifted-right",menuAlign:"tl-tr",items:[new Common.UI.MenuItem({caption:this.textFromFile,value:0}),new Common.UI.MenuItem({caption:this.textFromUrl,value:1}),new Common.UI.MenuItem({caption:this.textFromStorage,value:2})]})}),t.menuImgShapeRotate=new Common.UI.MenuItem({caption:t.textRotate,menu:new Common.UI.Menu({cls:"shifted-right",menuAlign:"tl-tr",items:[new Common.UI.MenuItem({iconCls:"menu__icon btn-rotate-90",caption:t.textRotate90,value:1}),new Common.UI.MenuItem({iconCls:"menu__icon btn-rotate-270",caption:t.textRotate270,value:0}),{caption:"--"},new Common.UI.MenuItem({iconCls:"menu__icon btn-flip-hor",caption:t.textFlipH,value:1}),new Common.UI.MenuItem({iconCls:"menu__icon btn-flip-vert",caption:t.textFlipV,value:0})]})}),t.menuImgCrop=new Common.UI.MenuItem({caption:t.textCrop,menu:new Common.UI.Menu({cls:"shifted-right",menuAlign:"tl-tr",items:[new Common.UI.MenuItem({caption:t.textCrop,checkable:!0,allowDepress:!0,value:0}),new Common.UI.MenuItem({caption:t.textCropFill,value:1}),new Common.UI.MenuItem({caption:t.textCropFit,value:2})]})}),t.menuImgResetCrop=new Common.UI.MenuItem({caption:t.textResetCrop,iconCls:"menu__icon btn-reset"}),t.menuImgSaveAsPicture=new Common.UI.MenuItem({caption:t.textSaveAsPicture});var d=new Common.UI.MenuItem({caption:"--"});t.menuAddCommentImg=new Common.UI.MenuItem({iconCls:"menu__icon btn-add-comment",caption:t.addCommentText}),t.menuAddCommentImg.hide(),t.menuImgCopy=new Common.UI.MenuItem({iconCls:"menu__icon btn-copy",caption:t.textCopy,value:"copy"}),t.menuImgPaste=new Common.UI.MenuItem({iconCls:"menu__icon btn-paste",caption:t.textPaste,value:"paste"}),t.menuImgCut=new Common.UI.MenuItem({iconCls:"menu__icon btn-cut",caption:t.textCut,value:"cut"}),t.menuImgEditPoints=new Common.UI.MenuItem({iconCls:"menu__icon btn-edit-points",caption:t.textEditPoints}),t.menuChartEdit=new Common.UI.MenuItem({caption:t.editChartText}),t.menuChartAdvanced=new Common.UI.MenuItem({iconCls:"menu__icon btn-menu-chart",caption:t.advancedChartText}),t.pictureMenu=new Common.UI.Menu({cls:"shifted-right",restoreHeightAndTop:!0,scrollToCheckedItem:!1,initMenu:function(e){t.api&&(t.mnuUnGroupImg.setDisabled(!t.api.canUnGroup()),t.mnuGroupImg.setDisabled(!t.api.canGroup()));var i=(_.isUndefined(e.shapeProps)||e.shapeProps.value.get_FromImage())&&_.isUndefined(e.chartProps),s=void 0!==e.imgProps&&e.imgProps.locked,n=void 0!==e.shapeProps&&e.shapeProps.locked,a=void 0!==e.chartProps&&e.chartProps.locked,r=s||n||a,h=e.imgProps?e.imgProps.value.asc_getPluginGuid():null,p=e.shapeProps&&e.shapeProps.value.get_FromSmartArtInternal(),m=d;t.mnuArrangeFront.setDisabled(p),t.mnuArrangeBack.setDisabled(p),t.mnuArrangeForward.setDisabled(p),t.mnuArrangeBackward.setDisabled(p),t.menuImgShapeRotate.setVisible(_.isUndefined(e.chartProps)&&!(e.shapeProps&&e.shapeProps.isChart)&&null==h),t.menuImgShapeRotate.isVisible()&&(t.menuImgShapeRotate.setDisabled(r||e.shapeProps&&e.shapeProps.value.get_FromSmartArt()),t.menuImgShapeRotate.menu.items[3].setDisabled(p),t.menuImgShapeRotate.menu.items[4].setDisabled(p)),t.menuImgOriginalSize.setVisible(i),t.menuImgOriginalSize.isVisible()&&t.menuImgOriginalSize.setDisabled(r||_.isNull(e.imgProps.value.get_ImageUrl())||_.isUndefined(e.imgProps.value.get_ImageUrl())),t.menuImgReplace.setVisible(i&&null==h),t.menuImgReplace.isVisible()&&t.menuImgReplace.setDisabled(r||null===h),t.menuImgReplace.menu.items[2].setVisible(t.mode.canRequestInsertImage||t.mode.fileChoiceUrl&&t.mode.fileChoiceUrl.indexOf("{documentType}")>-1),t.menuImgCrop.setVisible(t.api.asc_canEditCrop()),t.menuImgCrop.isVisible()&&t.menuImgCrop.setDisabled(r),t.menuImgResetCrop.setVisible(i&&e.imgProps.value.asc_getIsCrop()),t.menuImgResetCrop.isVisible()&&t.menuImgResetCrop.setDisabled(r);var u=t.api&&t.api.asc_canEditGeometry();if(t.menuImgEditPoints.setVisible(u),u&&t.menuImgEditPoints.setDisabled(r),t.menuImageAdvanced.setVisible(i),t.menuShapeAdvanced.setVisible(_.isUndefined(e.imgProps)&&_.isUndefined(e.chartProps)&&!(e.shapeProps&&e.shapeProps.isChart)),t.menuChartEdit.setVisible(_.isUndefined(e.imgProps)&&!_.isUndefined(e.chartProps)&&(_.isUndefined(e.shapeProps)||e.shapeProps.isChart)),t.menuChartAdvanced.setVisible(_.isUndefined(e.imgProps)&&!_.isUndefined(e.chartProps)&&(_.isUndefined(e.shapeProps)||e.shapeProps.isChart)),c.setVisible(t.menuImageAdvanced.isVisible()||t.menuShapeAdvanced.isVisible()||t.menuChartEdit.isVisible()||t.menuChartAdvanced.isVisible()),o.setVisible(t.menuImgCrop.isVisible()||t.menuImgOriginalSize.isVisible()||t.menuImgReplace.isVisible()||t.menuImageAdvanced.isVisible()||t.menuImgEditPoints.isVisible()||t.menuShapeAdvanced.isVisible()||t.menuChartEdit.isVisible()||t.menuChartAdvanced.isVisible()),o.isVisible()&&(m=o),t.menuAddCommentImg.setVisible(t.mode&&t.mode.canComments),!t.menuAddCommentImg.isVisible()&&m.setVisible(!1),t.menuImgShapeAlign.setDisabled(r),!r){var g=t.api.asc_getSelectedDrawingObjectsCount(),b=Common.Utils.InternalSettings.get("pdfe-align-to-slide")||!1;t.menuImgShapeAlign.menu.items[7].setDisabled(2==g&&!b),t.menuImgShapeAlign.menu.items[8].setDisabled(2==g&&!b)}t.menuShapesMerge.setDisabled(r||!t.api.asc_canMergeSelectedShapes()),t.menuShapesMerge.isDisabled()||t.menuShapesMerge.menu.items.forEach((function(e){e.setDisabled(!t.api.asc_canMergeSelectedShapes(e.value))})),t.menuImageAdvanced.setDisabled(r),t.menuShapeAdvanced.setDisabled(r),t.menuChartAdvanced.setDisabled(r),t.menuChartEdit.isVisible()&&t.menuChartEdit.setDisabled(r);var f=t.api&&t.api.can_CopyCut();t.menuImgCopy.setDisabled(!f),t.menuImgCut.setDisabled(r||!f),t.menuImgPaste.setDisabled(r),l.setDisabled(r)},items:[t.menuImgCut,t.menuImgCopy,t.menuImgPaste,{caption:"--"},l,t.menuImgShapeAlign,t.menuShapesMerge,t.menuImgShapeRotate,c,t.menuImgSaveAsPicture,d,t.menuImgCrop,t.menuImgResetCrop,t.menuImgOriginalSize,t.menuImgReplace,t.menuImageAdvanced,t.menuImgEditPoints,t.menuShapeAdvanced,t.menuChartEdit,t.menuChartAdvanced,o,t.menuAddCommentImg]}).on("hide:after",(function(e,i,s){t.clearCustomItems(e),t.currentMenu=null,t.suppressEditComplete?t.suppressEditComplete=!1:s||t.fireEvent("editcomplete",t)})),t.menuParagraphAdvanced=new Common.UI.MenuItem({iconCls:"menu__icon btn-paragraph",caption:t.advancedParagraphText});var h=new Common.UI.MenuItem({caption:"--"});t.menuAddHyperlinkPara=new Common.UI.MenuItem({iconCls:"menu__icon btn-inserthyperlink",caption:t.hyperlinkText}),t.menuEditHyperlinkPara=new Common.UI.MenuItem({caption:t.editHyperlinkText}),t.menuRemoveHyperlinkPara=new Common.UI.MenuItem({caption:t.removeHyperlinkText});var p=new Common.UI.MenuItem({iconCls:"menu__icon btn-inserthyperlink",caption:t.hyperlinkText,menu:new Common.UI.Menu({cls:"shifted-right",menuAlign:"tl-tr",items:[t.menuEditHyperlinkPara,t.menuRemoveHyperlinkPara]})});t.menuParagraphVAlign=new Common.UI.MenuItem({iconCls:"menu__icon btn-align-top",caption:t.vertAlignText,menu:new Common.UI.Menu({cls:"shifted-right",menuAlign:"tl-tr",items:[t.menuParagraphTop=new Common.UI.MenuItem({iconCls:"menu__icon btn-align-top",caption:t.textShapeAlignTop,checkable:!0,checkmark:!1,toggleGroup:"popupparagraphvalign",value:Asc.c_oAscVAlign.Top}),t.menuParagraphCenter=new Common.UI.MenuItem({iconCls:"menu__icon btn-align-middle",caption:t.textShapeAlignMiddle,checkable:!0,checkmark:!1,toggleGroup:"popupparagraphvalign",value:Asc.c_oAscVAlign.Center}),t.menuParagraphBottom=new Common.UI.MenuItem({iconCls:"menu__icon btn-align-bottom",caption:t.textShapeAlignBottom,checkable:!0,checkmark:!1,toggleGroup:"popupparagraphvalign",value:Asc.c_oAscVAlign.Bottom})]})}),t.menuParagraphDirection=new Common.UI.MenuItem({iconCls:"menu__icon btn-text-orient-hor",caption:t.directionText,menu:new Common.UI.Menu({cls:"shifted-right",menuAlign:"tl-tr",items:[t.menuParagraphDirectH=new Common.UI.MenuItem({caption:t.directHText,iconCls:"menu__icon btn-text-orient-hor",checkable:!0,checkmark:!1,checked:!1,toggleGroup:"popupparagraphdirect",direction:Asc.c_oAscVertDrawingText.normal}),t.menuParagraphDirect90=new Common.UI.MenuItem({caption:t.direct90Text,iconCls:"menu__icon btn-text-orient-rdown",checkable:!0,checkmark:!1,checked:!1,toggleGroup:"popupparagraphdirect",direction:Asc.c_oAscVertDrawingText.vert}),t.menuParagraphDirect270=new Common.UI.MenuItem({caption:t.direct270Text,iconCls:"menu__icon btn-text-orient-rup",checkable:!0,checkmark:!1,checked:!1,toggleGroup:"popupparagraphdirect",direction:Asc.c_oAscVertDrawingText.vert270})]})}),t.menuAddCommentPara=new Common.UI.MenuItem({iconCls:"menu__icon btn-add-comment",caption:t.addCommentText}),t.menuAddCommentPara.hide(),t.menuParaCopy=new Common.UI.MenuItem({iconCls:"menu__icon btn-copy",caption:t.textCopy,value:"copy"}),t.menuParaPaste=new Common.UI.MenuItem({iconCls:"menu__icon btn-paste",caption:t.textPaste,value:"paste"}),t.menuParaCut=new Common.UI.MenuItem({iconCls:"menu__icon btn-cut",caption:t.textCut,value:"cut"});var m=new Common.UI.MenuItem({caption:"--"});t.menuParagraphEquation=new Common.UI.MenuItem({caption:t.advancedEquationText,iconCls:"menu__icon btn-equation",menu:t.createEquationMenu("popupparaeqinput","tl-tr")}),t.textMenu=new Common.UI.Menu({cls:"shifted-right",scrollToCheckedItem:!1,initMenu:function(e){var i=e.shapeProps&&!_.isNull(e.shapeProps.value),s=e.chartProps&&!_.isNull(e.chartProps.value)||e.shapeProps&&e.shapeProps.isChart,n=void 0!==e.paraProps&&e.paraProps.locked||i&&e.shapeProps.locked,a=e.mathProps&&e.mathProps.value;if(t._currentParaObjDisabled=n,t.menuParagraphVAlign.setVisible(i&&!s&&!a),t.menuParagraphDirection.setVisible(i&&!s&&!a),i||s){var o=e.shapeProps.value.get_VerticalTextAlign(),l="";switch(o){case Asc.c_oAscVAlign.Top:l="menu__icon btn-align-top";break;case Asc.c_oAscVAlign.Center:l="menu__icon btn-align-middle";break;case Asc.c_oAscVAlign.Bottom:l="menu__icon btn-align-bottom"}t.menuParagraphVAlign.setIconCls(l),t.menuParagraphTop.setChecked(o==Asc.c_oAscVAlign.Top),t.menuParagraphCenter.setChecked(o==Asc.c_oAscVAlign.Center),t.menuParagraphBottom.setChecked(o==Asc.c_oAscVAlign.Bottom);var r=e.shapeProps.value.get_Vert();switch(l="",r){case Asc.c_oAscVertDrawingText.normal:l="menu__icon btn-text-orient-hor";break;case Asc.c_oAscVertDrawingText.vert:l="menu__icon btn-text-orient-rdown";break;case Asc.c_oAscVertDrawingText.vert270:l="menu__icon btn-text-orient-rup"}t.menuParagraphDirection.setIconCls(l),t.menuParagraphDirectH.setChecked(r==Asc.c_oAscVertDrawingText.normal),t.menuParagraphDirect90.setChecked(r==Asc.c_oAscVertDrawingText.vert),t.menuParagraphDirect270.setChecked(r==Asc.c_oAscVertDrawingText.vert270)}else t.menuParagraphVAlign.setIconCls(""),t.menuParagraphDirection.setIconCls("");t.menuParagraphVAlign.setDisabled(n),t.menuParagraphDirection.setDisabled(n);var c=null;t.api&&(c=t.api.can_AddHyperlink()),t.menuAddHyperlinkPara.setVisible(void 0===e.hyperProps&&!1!==c),p.setVisible(void 0!==e.hyperProps),t.menuEditHyperlinkPara.hyperProps=e.hyperProps,!1!==c&&(t.menuAddHyperlinkPara.hyperProps={},t.menuAddHyperlinkPara.hyperProps.value=new Asc.CHyperlinkProperty,t.menuAddHyperlinkPara.hyperProps.value.put_Text(c)),t.menuAddCommentPara.setVisible(t.mode&&t.mode.canComments),h.setVisible(t.menuAddCommentPara.isVisible()||t.menuAddHyperlinkPara.isVisible()||p.isVisible()),t.menuAddHyperlinkPara.setDisabled(n),p.setDisabled(n),t.menuParagraphAdvanced.setDisabled(n);var d=t.api&&t.api.can_CopyCut();t.menuParaCopy.setDisabled(!d),t.menuParaCut.setDisabled(n||!d),t.menuParaPaste.setDisabled(n);var u=0;if(a?u=t.addEquationMenu(t.textMenu,4):t.clearEquationMenu(t.textMenu,4),m.setVisible(a&&u>0),t.menuParagraphEquation.setVisible(a),t.menuParagraphEquation.setDisabled(n),a){var g=t.api.asc_GetMathInputType(),b=Common.Utils.InternalSettings.get("pdfe-equation-toolbar-hide");t.menuParagraphEquation.menu.items[5].setChecked(g===Asc.c_oAscMathInputType.Unicode),t.menuParagraphEquation.menu.items[6].setChecked(g===Asc.c_oAscMathInputType.LaTeX),t.menuParagraphEquation.menu.items[8].options.isToolbarHide=b,t.menuParagraphEquation.menu.items[8].setCaption(b?t.showEqToolbar:t.hideEqToolbar)}},items:[t.menuParaCut,t.menuParaCopy,t.menuParaPaste,m,{caption:"--"},t.menuParagraphVAlign,t.menuParagraphDirection,t.menuParagraphAdvanced,t.menuParagraphEquation,h,t.menuAddCommentPara,t.menuAddHyperlinkPara,p]}).on("hide:after",(function(e,i,s){t.clearCustomItems(e),t.currentMenu=null,t.suppressEditComplete?t.suppressEditComplete=!1:s||t.fireEvent("editcomplete",t)})),t.mnuDeletePage=new Common.UI.MenuItem({iconCls:"menu__icon btn-cc-remove",caption:t.deleteText}),t.mnuNewPageBefore=new Common.UI.MenuItem({caption:t.txtNewPageBefore,value:!0}),t.mnuNewPageAfter=new Common.UI.MenuItem({caption:t.txtNewPageAfter,value:!1}),t.mnuRotatePageRight=new Common.UI.MenuItem({iconCls:"menu__icon btn-rotate-90",caption:t.txtRotateRight}),t.mnuRotatePageLeft=new Common.UI.MenuItem({iconCls:"menu__icon btn-rotate-270",caption:t.txtRotateLeft}),t.mnuCutPage=new Common.UI.MenuItem({iconCls:"menu__icon btn-cut",caption:t.textCut,value:"cut"}),t.mnuCopyPage=new Common.UI.MenuItem({iconCls:"menu__icon btn-copy",caption:t.textCopy,value:"copy"}),t.mnuPastePageBefore=new Common.UI.MenuItem({caption:t.txtPastePageBefore,value:"paste-before"}),t.mnuPastePageAfter=new Common.UI.MenuItem({caption:t.txtPastePageAfter,value:"paste"});var u=new Common.UI.MenuItem({caption:"--"}),g=new Common.UI.MenuItem({caption:"--"}),b=new Common.UI.MenuItem({caption:"--"});t.pageMenu=new Common.UI.Menu({cls:"shifted-right",restoreHeightAndTop:!0,scrollToCheckedItem:!1,initMenu:function(e){if(e?t.options.eventProps=e:e=t.options.eventProps,t.api)for(var i=-1,s=!1,n=!1,a=t.api.getSelectedElements();++i<a.length;)a[i].get_ObjectType()===Asc.c_oAscTypeSelectElement.PdfPage&&(s=a[i].get_ObjectValue().asc_getDeleteLock(),n=a[i].get_ObjectValue().asc_getRotateLock());e&&(t.mnuRotatePageRight.options.value=t.mnuRotatePageLeft.options.value=e.pageNum,t.mnuRotatePageRight.setVisible(!0===e.isPageSelect),t.mnuRotatePageLeft.setVisible(!0===e.isPageSelect),t.mnuDeletePage.setVisible(!0===e.isPageSelect),t.mnuCopyPage.setVisible(!0===e.isPageSelect),t.mnuCutPage.setVisible(!0===e.isPageSelect),g.setVisible(!0===e.isPageSelect),b.setVisible(!0===e.isPageSelect),u.setVisible(!0===e.isPageSelect));var o=t.api.asc_CanRotatePages();t.mnuRotatePageRight.setDisabled(n||s||!o),t.mnuRotatePageLeft.setDisabled(n||s||!o);var l=t.api.asc_CanRemovePages();t.mnuDeletePage.setDisabled(t._pagesCount<2||s||!l),t.mnuCutPage.setDisabled(t._pagesCount<2||s||!l);var r=t.api.asc_CanPastePage();t.mnuPastePageBefore.setDisabled(!r),t.mnuPastePageAfter.setDisabled(!r)},items:[t.mnuCutPage,t.mnuCopyPage,b,t.mnuPastePageBefore,t.mnuPastePageAfter,{caption:"--"},t.mnuNewPageBefore,t.mnuNewPageAfter,g,t.mnuRotatePageRight,t.mnuRotatePageLeft,u,t.mnuDeletePage]}).on("hide:after",(function(e,i,s){t.clearCustomItems(e),t.currentMenu=null,t.suppressEditComplete?t.suppressEditComplete=!1:s||t.fireEvent("editcomplete",t)})),this.fireEvent("createdelayedelements",[this,"edit"])}},t.createDelayedElementsPDFForms=function(){var t=this;t.menuPDFFormsCopy||(t.menuPDFFormsCopy=new Common.UI.MenuItem({iconCls:"menu__icon btn-copy",caption:t.textCopy,value:"copy"}),t.menuPDFFormsPaste=new Common.UI.MenuItem({iconCls:"menu__icon btn-paste",caption:t.textPaste,value:"paste"}),t.menuPDFFormsCut=new Common.UI.MenuItem({iconCls:"menu__icon btn-cut",caption:t.textCut,value:"cut"}),t.menuPDFFormsUndo=new Common.UI.MenuItem({iconCls:"menu__icon btn-undo icon-rtl",caption:t.textUndo}),t.menuPDFFormsRedo=new Common.UI.MenuItem({iconCls:"menu__icon btn-redo icon-rtl",caption:t.textRedo}),t.menuPDFFormsClear=new Common.UI.MenuItem({iconCls:"menu__icon btn-clearstyle",caption:t.textClearField}),t.formsPDFMenu=new Common.UI.Menu({cls:"shifted-right",initMenu:function(e){var i=t.api.can_CopyCut(),s=e.paraProps&&e.paraProps.locked||e.headerProps&&e.headerProps.locked||e.imgProps&&(e.imgProps.locked||e.imgProps.content_locked)||t._isDisabled;t.menuPDFFormsUndo.setDisabled(s||!t.api.asc_getCanUndo()),t.menuPDFFormsRedo.setDisabled(s||!t.api.asc_getCanRedo()),t.menuPDFFormsClear.setDisabled(s||!t.api.asc_IsContentControl()),t.menuPDFFormsCut.setDisabled(s||!i),t.menuPDFFormsCopy.setDisabled(!i),t.menuPDFFormsPaste.setDisabled(s)},items:[t.menuPDFFormsUndo,t.menuPDFFormsRedo,{caption:"--"},t.menuPDFFormsClear,{caption:"--"},t.menuPDFFormsCut,t.menuPDFFormsCopy,t.menuPDFFormsPaste]}).on("hide:after",(function(e,i,s){t.clearCustomItems(e),t.currentMenu=null,t.suppressEditComplete?t.suppressEditComplete=!1:s||t.fireEvent("editcomplete",t)})),this.fireEvent("createdelayedelements",[this,"forms"]))},t.createTextBar=function(t){var e=$('<div id="text-bar-container" style="position: absolute;"><div id="text-bar-fonts" style="display:inline-block;" class="margin-right-2"></div><div id="text-bar-font-size" style="display:inline-block;" class="margin-right-4"></div><div id="text-bar-bold" style="display:inline-block;" class="margin-right-4"></div><div id="text-bar-italic" style="display:inline-block;" class="margin-right-4"></div><div id="text-bar-underline" style="display:inline-block;" class="margin-right-4"></div><div id="text-bar-strikeout" style="display:inline-block;" class="margin-right-4"></div><div id="text-bar-super" style="display:inline-block;" class="margin-right-4"></div><div id="text-bar-sub" style="display:inline-block;" class="margin-right-4"></div><div id="text-bar-textcolor" style="display:inline-block;"></div><div class="separator margin-left-6"></div><div id="text-bar-halign" style="display:inline-block;" class="margin-left-13"></div><div id="text-bar-direction" style="display:inline-block;" class="margin-left-4"></div></div>'),i=PDFE.getController("Toolbar"),s=i.getView("Toolbar");this.cmbFontName=new Common.UI.ComboBoxFonts({el:$("#text-bar-fonts",e),cls:"input-group-nr",style:"width: 100px;",menuCls:"scrollable-menu menu-absolute",menuStyle:"min-width: 100%;max-height: 270px;",restoreMenuHeightAndTop:220,store:new Common.Collections.Fonts,hint:s.tipFontName}),t.push(this.cmbFontName),i.fillFontsStore(this.cmbFontName),this.cmbFontSize=new Common.UI.ComboBox({el:$("#text-bar-font-size",e),cls:"input-group-nr",style:"width: 45px;",menuCls:"scrollable-menu menu-absolute",menuStyle:"min-width: 45px;max-height: 270px;",restoreMenuHeightAndTop:220,hint:s.tipFontSize,data:[{value:8,displayValue:"8"},{value:9,displayValue:"9"},{value:10,displayValue:"10"},{value:11,displayValue:"11"},{value:12,displayValue:"12"},{value:14,displayValue:"14"},{value:16,displayValue:"16"},{value:18,displayValue:"18"},{value:20,displayValue:"20"},{value:22,displayValue:"22"},{value:24,displayValue:"24"},{value:26,displayValue:"26"},{value:28,displayValue:"28"},{value:36,displayValue:"36"},{value:48,displayValue:"48"},{value:72,displayValue:"72"},{value:96,displayValue:"96"}]}),this.cmbFontSize.setValue(""),t.push(this.cmbFontSize),this.btnBold=new Common.UI.Button({parentEl:$("#text-bar-bold",e),cls:"btn-toolbar",iconCls:"toolbar__icon btn-bold",enableToggle:!0,hint:s.textBold}),t.push(this.btnBold),this.btnItalic=new Common.UI.Button({parentEl:$("#text-bar-italic",e),cls:"btn-toolbar",iconCls:"toolbar__icon btn-italic",enableToggle:!0,hint:s.textItalic}),t.push(this.btnItalic),this.btnTextUnderline=new Common.UI.Button({parentEl:$("#text-bar-underline",e),cls:"btn-toolbar",iconCls:"toolbar__icon btn-underline",enableToggle:!0,hint:s.textUnderline}),t.push(this.btnTextUnderline),this.btnTextStrikeout=new Common.UI.Button({parentEl:$("#text-bar-strikeout",e),cls:"btn-toolbar",iconCls:"toolbar__icon btn-strikeout",enableToggle:!0,hint:s.textStrikeout}),t.push(this.btnTextStrikeout),this.btnSuperscript=new Common.UI.Button({parentEl:$("#text-bar-super",e),cls:"btn-toolbar",iconCls:"toolbar__icon btn-superscript",enableToggle:!0,toggleGroup:"superscriptGroup",hint:s.textSuperscript}),t.push(this.btnSuperscript),this.btnSubscript=new Common.UI.Button({parentEl:$("#text-bar-sub",e),cls:"btn-toolbar",iconCls:"toolbar__icon btn-subscript",enableToggle:!0,toggleGroup:"superscriptGroup",hint:s.textSubscript}),t.push(this.btnSubscript);var n=Common.UI.simpleColorsConfig;return this.btnFontColor=new Common.UI.ButtonColored({parentEl:$("#text-bar-textcolor",e),cls:"btn-toolbar",iconCls:"toolbar__icon btn-fontcolor",split:!0,menu:!0,colors:n.colors,color:"000000",dynamiccolors:n.dynamiccolors,themecolors:n.themecolors,effects:n.effects,columns:n.columns,paletteCls:n.cls,paletteWidth:n.paletteWidth,hint:s.tipFontColor}),t.push(this.btnFontColor),this.btnFontColor.setMenu(),this.mnuFontColorPicker=this.btnFontColor.getPicker(),this.btnFontColor.currentColor=this.btnFontColor.color,this.btnTextDir=new Common.UI.Button({parentEl:$("#text-bar-direction",e),cls:"btn-toolbar",iconCls:"toolbar__icon btn-ltr",icls:"btn-ltr",action:"text-direction",dirRtl:!1,hint:s.tipTextDir,menu:new Common.UI.Menu({items:[{caption:s.textDirLtr,value:!1,iconCls:"menu__icon btn-ltr"},{caption:s.textDirRtl,value:!0,iconCls:"menu__icon btn-rtl"}]})}),t.push(this.btnTextDir),this.btnHorizontalAlign=new Common.UI.Button({parentEl:$("#text-bar-halign",e),cls:"btn-toolbar",iconCls:"toolbar__icon btn-align-left",icls:"btn-align-left",hint:s.tipHAligh,menu:new Common.UI.Menu({items:[{caption:s.textAlignLeft,iconCls:"menu__icon btn-align-left",icls:"btn-align-left",checkable:!0,checkmark:!1,toggleGroup:"halignGroup",checked:!0,value:1},{caption:s.textAlignCenter,iconCls:"menu__icon btn-align-center",icls:"btn-align-center",checkable:!0,checkmark:!1,toggleGroup:"halignGroup",value:2},{caption:s.textAlignRight,iconCls:"menu__icon btn-align-right",icls:"btn-align-right",checkable:!0,checkmark:!1,toggleGroup:"halignGroup",value:0}]}),action:"align-horizontal"}),t.push(this.btnHorizontalAlign),e},t.createAnnotBar=function(t){var e=$('<div id="annot-bar-container" style="position: absolute;"><div id="annot-bar-copy" style="display:inline-block;" class=""></div><div class="separator margin-left-6"></div><div id="annot-bar-add-comment" style="display:inline-block;" class="margin-left-13"></div><div id="annot-bar-highlight" style="display:inline-block;" class="margin-left-4"></div><div id="annot-bar-underline" style="display:inline-block;" class="margin-left-4"></div><div id="annot-bar-strikeout" style="display:inline-block;" class="margin-left-4"></div><div class="separator margin-left-6"></div><div id="annot-bar-edit-text" class="margin-left-13" style="display:inline-block;"></div></div>'),i=PDFE.getController("Toolbar").getView("Toolbar");this.btnCopy=new Common.UI.Button({parentEl:$("#annot-bar-copy",e),cls:"btn-toolbar",iconCls:"toolbar__icon btn-copy",hint:i.tipCopy}),t.push(this.btnCopy),this.btnAddComment=new Common.UI.Button({parentEl:$("#annot-bar-add-comment",e),cls:"btn-toolbar",iconCls:"toolbar__icon btn-add-comment",hint:i.tipAddComment}),t.push(this.btnAddComment);var s=Common.UI.simpleColorsConfig;return this.btnUnderline=new Common.UI.ButtonColored({parentEl:$("#annot-bar-underline",e),cls:"btn-toolbar",iconCls:"toolbar__icon btn-underline",enableToggle:!0,allowDepress:!0,split:!0,menu:!0,colorLine:!1,colors:s.colors,color:"3D8A44",additionalItemsAfter:[{caption:"--"},new Common.UI.MenuItem({template:_.template('<div class="custom-scale" data-stopPropagation="true"></div>'),stopPropagation:!0})],dynamiccolors:s.dynamiccolors,themecolors:s.themecolors,effects:s.effects,columns:s.columns,paletteCls:s.cls,paletteWidth:s.paletteWidth,storageSuffix:"-draw",hideColorsSeparator:!0,hint:i.textUnderline,type:AscPDF.ANNOTATIONS_TYPES.Underline}),t.push(this.btnUnderline),this.btnStrikeout=new Common.UI.ButtonColored({parentEl:$("#annot-bar-strikeout",e),cls:"btn-toolbar",iconCls:"toolbar__icon btn-strikeout",enableToggle:!0,allowDepress:!0,split:!0,menu:!0,colorLine:!1,colors:s.colors,color:"D43230",additionalItemsAfter:[{caption:"--"},new Common.UI.MenuItem({template:_.template('<div class="custom-scale" data-stopPropagation="true"></div>'),stopPropagation:!0})],dynamiccolors:s.dynamiccolors,themecolors:s.themecolors,effects:s.effects,columns:s.columns,paletteCls:s.cls,paletteWidth:s.paletteWidth,storageSuffix:"-draw",hideColorsSeparator:!0,hint:i.textStrikeout,type:AscPDF.ANNOTATIONS_TYPES.Strikeout}),t.push(this.btnStrikeout),this.btnHighlight=new Common.UI.ButtonColored({parentEl:$("#annot-bar-highlight",e),cls:"btn-toolbar",iconCls:"toolbar__icon btn-highlight",enableToggle:!0,allowDepress:!0,split:!0,menu:!0,additionalItemsAfter:[{caption:"--"},new Common.UI.MenuItem({template:_.template('<div class="custom-scale" data-stopPropagation="true"></div>'),stopPropagation:!0})],colors:["FFFC54","72F54A","74F9FD","EB51F7","A900F9","EF8B3A","7272FF","FF63A4","1DFF92","03DA18","249B01","C504D2","0633D1","FFF7A0","FF0303","FFFFFF","D3D3D4","969696","606060","000000"],color:"FFFC54",dynamiccolors:s.dynamiccolors,themecolors:s.themecolors,effects:s.effects,columns:s.columns,paletteCls:s.cls,paletteWidth:s.paletteWidth,storageSuffix:"-draw",hideColorsSeparator:!0,hint:i.textHighlight,type:AscPDF.ANNOTATIONS_TYPES.Highlight}),t.push(this.btnHighlight),this.btnEditText=new Common.UI.Button({parentEl:$("#annot-bar-edit-text",e),cls:"btn-toolbar",iconCls:"toolbar__icon btn-magic-wand",caption:this.textRecognize,hint:this.tipRecognize}),t.push(this.btnEditText),this.fireEvent("annotbar:create",[this.btnStrikeout,this.btnUnderline,this.btnHighlight]),e},t.createAnnotSelectBar=function(t){var e=$('<div id="annot-sel-bar-container" style="position: absolute;"><div id="annot-sel-bar-stroke"></div><div id="annot-sel-bar-highlight"></div><div id="annot-sel-bar-add-comment" class="margin-left-4"></div><div class="separator margin-left-6"></div><div id="annot-sel-bar-remove" class="margin-left-13"></div></div>'),i=PDFE.getController("Toolbar").getView("Toolbar");this.btnRemAnnot=new Common.UI.Button({parentEl:$("#annot-sel-bar-remove",e),cls:"btn-toolbar",iconCls:"toolbar__icon btn-cc-remove",hint:this.removeCommentText}),t.push(this.btnRemAnnot),this.btnAddAnnotComment=new Common.UI.Button({parentEl:$("#annot-sel-bar-add-comment",e),cls:"btn-toolbar",iconCls:"toolbar__icon btn-add-comment",hint:i.tipAddComment}),t.push(this.btnAddAnnotComment);var s=Common.UI.simpleColorsConfig;return this.btnStrokeHighlightColor=new Common.UI.ButtonColored({parentEl:$("#annot-sel-bar-highlight",e),cls:"btn-toolbar no-caret no-icon",iconCls:"toolbar__icon",menu:!0,colorLine:"box",colors:["FFFC54","72F54A","74F9FD","EB51F7","A900F9","EF8B3A","7272FF","FF63A4","1DFF92","03DA18","249B01","C504D2","0633D1","FFF7A0","FF0303","FFFFFF","D3D3D4","969696","606060","000000"],color:"FFFC54",additionalItemsAfter:[{caption:"--"},new Common.UI.MenuItem({template:_.template('<div class="custom-scale" data-stopPropagation="true"></div>'),stopPropagation:!0})],dynamiccolors:s.dynamiccolors,themecolors:s.themecolors,effects:s.effects,columns:s.columns,paletteCls:s.cls,paletteWidth:s.paletteWidth,storageSuffix:"-draw",hideColorsSeparator:!0,hint:this.textColor}),t.push(this.btnStrokeHighlightColor),this.btnStrokeHighlightColor.setMenu(),this.mnuStrokeHighlightColorPicker=this.btnStrokeHighlightColor.getPicker(),this.btnStrokeHighlightColor.currentColor=this.btnStrokeHighlightColor.color,this.btnStrokeColor=new Common.UI.ButtonColored({parentEl:$("#annot-sel-bar-stroke",e),cls:"btn-toolbar no-caret no-icon",iconCls:"toolbar__icon",menu:!0,colorLine:"box",colors:s.colors,color:"3D8A44",additionalItemsAfter:[{caption:"--"},new Common.UI.MenuItem({template:_.template('<div class="custom-scale" data-stopPropagation="true"></div>'),stopPropagation:!0})],dynamiccolors:s.dynamiccolors,themecolors:s.themecolors,effects:s.effects,columns:s.columns,paletteCls:s.cls,paletteWidth:s.paletteWidth,storageSuffix:"-draw",hideColorsSeparator:!0,hint:this.textColor}),t.push(this.btnStrokeColor),this.btnStrokeColor.setMenu(),this.mnuStrokeColorPicker=this.btnStrokeColor.getPicker(),this.btnStrokeColor.currentColor=this.btnStrokeColor.color,e}}})),define("pdfeditor/main/app/view/FormsTab",[],(function(){"use strict";Common.enumLock||(Common.enumLock={});var t={requiredNotFilled:"required-not-filled",submit:"submit"};for(var e in t)t.hasOwnProperty(e)&&(Common.enumLock[e]=t[e]);PDFE.Views.FormsTab=Common.UI.BaseView.extend(_.extend(function(){function t(){var t=this;this.btnTextField&&this.btnTextField.on("click",(function(e,i){t.fireEvent("forms:insert",["text"])})),this.btnComboBox&&this.btnComboBox.on("click",(function(e,i){t.fireEvent("forms:insert",["combobox"])})),this.btnDropDown&&this.btnDropDown.on("click",(function(e,i){t.fireEvent("forms:insert",["dropdown"])})),this.btnCheckBox&&this.btnCheckBox.on("click",(function(e,i){t.fireEvent("forms:insert",["checkbox"])})),this.btnRadioBox&&this.btnRadioBox.on("click",(function(e,i){t.fireEvent("forms:insert",["radiobox"])})),this.btnImageField&&this.btnImageField.on("click",(function(e,i){t.fireEvent("forms:insert",["picture"])})),this.btnEmailField&&this.btnEmailField.on("click",(function(e,i){t.fireEvent("forms:insert",["text",{reg:"\\S+@\\S+\\.\\S+",placeholder:"user_name@email.com"}])})),this.btnPhoneField&&this.btnPhoneField.on("click",(function(e,i){t.fireEvent("forms:insert",["text",{mask:"(999)999-9999",placeholder:"(999)999-9999"}])})),this.btnCreditCard&&this.btnCreditCard.on("click",(function(e,i){t.fireEvent("forms:insert",["text",{mask:"9999-9999-9999-9999",placeholder:"9999-9999-9999-9999"}])})),this.btnZipCode&&this.btnZipCode.on("click",(function(e,i){t.fireEvent("forms:insert",["text",{mask:"99999-9999",placeholder:"99999-9999"}])})),this.btnDateTime&&this.btnDateTime.on("click",(function(e,i){t.fireEvent("forms:insert",["datetime"])})),this.btnClear&&this.btnClear.on("click",(function(e,i){t.fireEvent("forms:clear")})),this.btnPrevForm&&this.btnPrevForm.on("click",(function(e,i){t.fireEvent("forms:goto",["prev"])})),this.btnNextForm&&this.btnNextForm.on("click",(function(e,i){t.fireEvent("forms:goto",["next"])})),this.btnSubmit&&this.btnSubmit.on("click",(function(e,i){t.fireEvent("forms:submit")})),this.btnSaveForm&&this.btnSaveForm.on("click",(function(e,i){t.fireEvent("forms:save")}))}return{options:{},initialize:function(t){Common.UI.BaseView.prototype.initialize.call(this),this.toolbar=t.toolbar,this.appConfig=t.config,this.api=t.api,this.paragraphControls=[],this._state={};var e=Common.enumLock;this.btnTextField=new Common.UI.Button({cls:"btn-toolbar x-huge icon-top",iconCls:"toolbar__icon btn-text-field",lock:[e.pageDeleted,e.paragraphLock,e.lostConnect,e.disableOnStart,e.inSmartart,e.inSmartartInternal,e.viewMode],caption:this.capBtnText,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"small"}),this.paragraphControls.push(this.btnTextField),this.btnComboBox=new Common.UI.Button({cls:"btn-toolbar x-huge icon-top",iconCls:"toolbar__icon btn-combo-box",lock:[e.pageDeleted,e.paragraphLock,e.lostConnect,e.disableOnStart,e.inSmartart,e.inSmartartInternal,e.viewMode],caption:this.capBtnComboBox,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"small"}),this.paragraphControls.push(this.btnComboBox),this.btnDropDown=new Common.UI.Button({cls:"btn-toolbar x-huge icon-top",iconCls:"toolbar__icon btn-listbox",lock:[e.pageDeleted,e.paragraphLock,e.lostConnect,e.disableOnStart,e.inSmartart,e.inSmartartInternal,e.viewMode],caption:this.capBtnDropDown,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"small"}),this.paragraphControls.push(this.btnDropDown),this.btnCheckBox=new Common.UI.Button({cls:"btn-toolbar x-huge icon-top",iconCls:"toolbar__icon btn-checkbox",lock:[e.pageDeleted,e.paragraphLock,e.lostConnect,e.disableOnStart,e.inSmartart,e.inSmartartInternal,e.viewMode],caption:this.capBtnCheckBox,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"small"}),this.paragraphControls.push(this.btnCheckBox),this.btnRadioBox=new Common.UI.Button({cls:"btn-toolbar x-huge icon-top",iconCls:"toolbar__icon btn-radio-button",lock:[e.pageDeleted,e.paragraphLock,e.lostConnect,e.disableOnStart,e.inSmartart,e.inSmartartInternal,e.viewMode],caption:this.capBtnRadioBox,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"small"}),this.paragraphControls.push(this.btnRadioBox),this.btnImageField=new Common.UI.Button({cls:"btn-toolbar x-huge icon-top",iconCls:"toolbar__icon btn-insertimage",lock:[e.pageDeleted,e.paragraphLock,e.lostConnect,e.disableOnStart,e.inSmartart,e.inSmartartInternal,e.viewMode],caption:this.capBtnImage,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"small"}),this.paragraphControls.push(this.btnImageField),this.btnEmailField=new Common.UI.Button({cls:"btn-toolbar x-huge icon-top",iconCls:"toolbar__icon btn-email",lock:[e.pageDeleted,e.paragraphLock,e.lostConnect,e.disableOnStart,e.inSmartart,e.inSmartartInternal,e.viewMode],caption:this.capBtnEmail,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"small"}),this.paragraphControls.push(this.btnEmailField),this.btnPhoneField=new Common.UI.Button({cls:"btn-toolbar x-huge icon-top",iconCls:"toolbar__icon btn-phone",lock:[e.pageDeleted,e.paragraphLock,e.lostConnect,e.disableOnStart,e.inSmartart,e.inSmartartInternal,e.viewMode],caption:this.capBtnPhone,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"small"}),this.paragraphControls.push(this.btnPhoneField),this.btnZipCode=new Common.UI.Button({cls:"btn-toolbar x-huge icon-top",iconCls:"toolbar__icon btn-zip-code",lock:[e.pageDeleted,e.paragraphLock,e.lostConnect,e.disableOnStart,e.inSmartart,e.inSmartartInternal,e.viewMode],caption:this.capZipCode,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"small"}),this.paragraphControls.push(this.btnZipCode),this.btnCreditCard=new Common.UI.Button({cls:"btn-toolbar x-huge icon-top",iconCls:"toolbar__icon btn-credit-card",lock:[e.pageDeleted,e.paragraphLock,e.lostConnect,e.disableOnStart,e.inSmartart,e.inSmartartInternal,e.viewMode],caption:this.capCreditCard,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"small"}),this.paragraphControls.push(this.btnCreditCard),this.btnDateTime=new Common.UI.Button({cls:"btn-toolbar x-huge icon-top",iconCls:"toolbar__icon btn-datetime",lock:[e.pageDeleted,e.paragraphLock,e.lostConnect,e.disableOnStart,e.inSmartart,e.inSmartartInternal,e.viewMode],caption:this.capDateTime,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"small"}),this.paragraphControls.push(this.btnDateTime),this.btnClear=new Common.UI.Button({cls:"btn-toolbar x-huge icon-top",iconCls:"toolbar__icon btn-clear-style",caption:this.textClear,lock:[e.pageDeleted,e.lostConnect,e.viewMode,e.disableOnStart],visible:!1,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"small"}),this.paragraphControls.push(this.btnClear),this.btnPrevForm=new Common.UI.Button({cls:"btn-toolbar x-huge icon-top",iconCls:"toolbar__icon btn-previous-field icon-rtl",lock:[e.pageDeleted,e.lostConnect,e.disableOnStart,e.viewMode],caption:this.capBtnPrev,visible:!1,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"small"}),this.paragraphControls.push(this.btnPrevForm),this.btnNextForm=new Common.UI.Button({cls:"btn-toolbar x-huge icon-top",iconCls:"toolbar__icon btn-next-field icon-rtl",lock:[e.pageDeleted,e.lostConnect,e.disableOnStart,e.viewMode],caption:this.capBtnNext,visible:!1,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"small"}),this.paragraphControls.push(this.btnNextForm),Common.UI.LayoutManager.addControls(this.paragraphControls),Common.Utils.lockControls(Common.enumLock.disableOnStart,!0,{array:this.paragraphControls}),this._state={disabled:!1},Common.NotificationCenter.on("app:ready",this.onAppReady.bind(this))},render:function(t){return t&&t.html(this.getPanel()),this},onAppReady:function(e){var i=this;new Promise((function(t,e){t()})).then((function(){e.isEdit&&e.isPDFEdit&&e.canFeatureForms&&(i.btnTextField.updateHint(i.tipTextField),i.btnComboBox.updateHint(i.tipComboBox),i.btnDropDown.updateHint(i.tipDropDown),i.btnCheckBox.updateHint(i.tipCheckBox),i.btnRadioBox.updateHint(i.tipRadioBox),i.btnImageField.updateHint(i.tipImageField),i.btnEmailField.updateHint(i.tipEmailField),i.btnPhoneField.updateHint(i.tipPhoneField),i.btnZipCode.updateHint(i.tipZipCode),i.btnCreditCard.updateHint(i.tipCreditCard),i.btnDateTime.updateHint(i.tipDateTime)),i.btnClear.updateHint(i.textClearFields),i.btnPrevForm.updateHint(i.tipPrevForm),i.btnNextForm.updateHint(i.tipNextForm),t.call(i)}))},getPanel:function(){this.$el=$(_.template('<section class="panel" data-tab="forms" role="tabpanel" aria-labelledby="forms"><div class="group forms-buttons" style="display: none;"><span class="btn-slot text x-huge" id="slot-btn-form-field"></span><span class="btn-slot text x-huge" id="slot-btn-form-combobox"></span><span class="btn-slot text x-huge" id="slot-btn-form-dropdown"></span><span class="btn-slot text x-huge" id="slot-btn-form-checkbox"></span><span class="btn-slot text x-huge" id="slot-btn-form-radiobox"></span><span class="btn-slot text x-huge" id="slot-btn-form-image"></span></div><div class="separator long forms-buttons" style="display: none;"></div><div class="group forms-buttons" style="display: none;"><span class="btn-slot text x-huge" id="slot-btn-form-email"></span><span class="btn-slot text x-huge" id="slot-btn-form-phone"></span><span class="btn-slot text x-huge" id="slot-btn-form-datetime"></span><span class="btn-slot text x-huge" id="slot-btn-form-zipcode"></span><span class="btn-slot text x-huge" id="slot-btn-form-credit"></span></div><div class="separator long fill-buttons" style="display: none;"></div><div class="group no-group-mask" style="display: none;"><span class="btn-slot text x-huge" id="slot-btn-form-prev"></span><span class="btn-slot text x-huge" id="slot-btn-form-next"></span><span class="btn-slot text x-huge" id="slot-btn-form-clear"></span></div></section>')({}));var t=this.$el;return this.btnTextField.render(t.find("#slot-btn-form-field")),this.btnComboBox.render(t.find("#slot-btn-form-combobox")),this.btnDropDown.render(t.find("#slot-btn-form-dropdown")),this.btnCheckBox.render(t.find("#slot-btn-form-checkbox")),this.btnRadioBox.render(t.find("#slot-btn-form-radiobox")),this.btnImageField.render(t.find("#slot-btn-form-image")),this.btnEmailField.render(t.find("#slot-btn-form-email")),this.btnPhoneField.render(t.find("#slot-btn-form-phone")),this.btnZipCode.render(t.find("#slot-btn-form-zipcode")),this.btnCreditCard.render(t.find("#slot-btn-form-credit")),this.btnDateTime.render(t.find("#slot-btn-form-datetime")),t.find(".forms-buttons").show(),this.btnClear.render(t.find("#slot-btn-form-clear")),this.btnPrevForm.render(t.find("#slot-btn-form-prev")),this.btnNextForm.render(t.find("#slot-btn-form-next")),this.$el},show:function(){Common.UI.BaseView.prototype.show.call(this),this.fireEvent("show",this)},getButtons:function(){return this.paragraphControls},setPreviewMode:function(t){this.btnClear.setVisible(t),this.btnPrevForm.setVisible(t),this.btnNextForm.setVisible(t)},SetDisabled:function(t){this._state.disabled=t,this.paragraphControls.forEach((function(e){e&&e.setDisabled(t)}),this)},capBtnText:"Text Field",capBtnComboBox:"Combo Box",capBtnDropDown:"List Box",capBtnCheckBox:"Checkbox",capBtnRadioBox:"Radio Button",capBtnImage:"Image",textClearFields:"Clear All Fields",tipTextField:"Insert text field",tipComboBox:"Insert combo box",tipDropDown:"Insert list box",tipCheckBox:"Insert checkbox",tipRadioBox:"Insert radio button",tipImageField:"Insert image",textClear:"Clear Fields",capBtnPrev:"Previous Field",capBtnNext:"Next Field",capBtnEmail:"Email Address",capBtnPhone:"Phone Number",tipEmailField:"Insert email address",tipPhoneField:"Insert phone number",capZipCode:"Zip Code",capCreditCard:"Credit Card",tipZipCode:"Insert zip code",tipCreditCard:"Insert credit card number",capDateTime:"Date & Time",tipDateTime:"Insert date and time"}}(),PDFE.Views.FormsTab||{}))})),define("text!pdfeditor/main/app/template/FormSettings.template",[],(function(){return'<table cols="1" role="presentation">\n    <tr class="form-name">\n        <td>\n            <label class="header padding-small" id="form-settings-name"><%= scope.textField %></label>\n        </td>\n    </tr>\n    <tr class="form-name">\n        <td class="padding-small">\n            <label class="input-label"><%= scope.textName %></label>\n            <div id="form-combo-name" style="width: 100%;"></div>\n        </td>\n    </tr>\n    <tr class="form-text-combo">\n        <td class="padding-small">\n            <label class="input-label"><%= scope.textPlaceholder %></label>\n            <div id="form-txt-pholder"></div>\n        </td>\n    </tr>\n    <tr>\n        <td class="padding-small">\n            <label class="input-label"><%= scope.textTip %></label>\n            <div id="form-txt-tip"></div>\n        </td>\n    </tr>\n    <tr class="form-text-combo">\n        <td class="padding-small">\n            <label class="input-label"><%= scope.textFormat %></label>\n            <div id="form-combo-format" style="width: 100%;"></div>\n        </td>\n    </tr>\n    <tr class="form-special">\n        <td class="padding-small">\n            <div id="form-combo-special" style="width: 100%;"></div>\n        </td>\n    </tr>\n    <tr class="form-special-mask">\n        <td class="padding-small">\n            <div id="form-txt-mask" style="width: 100%;"></div>\n        </td>\n    </tr>\n    <tr class="form-date">\n        <td class="padding-small">\n            <div id="form-cmb-date-format" style="width: 100%;"></div>\n        </td>\n    </tr>\n    <tr class="form-time">\n        <td class="padding-small">\n            <div id="form-cmb-time-format" style="width: 100%;"></div>\n        </td>\n    </tr>\n    <tr>\n        <td class="padding-small form-button">\n            <label class="input-label"><%= scope.textLayout %></label>\n            <div id="form-combo-btn-layout" style="width: 100%;"></div>\n        </td>\n    </tr>\n    <tr>\n        <td class="padding-small form-button">\n            <label class="input-label"><%= scope.textBehavior %></label>\n            <div id="form-combo-behavior" style="width: 100%;"></div>\n        </td>\n    </tr>\n</table>\n<table cols="2" role="presentation">\n    <tr class="form-list-common">\n        <td colspan="2" class="padding-small">\n            <div class="separator horizontal"></div>\n        </td>\n    </tr>\n    <tr class="form-list-common">\n        <td colspan="2" class="padding-small">\n            <label class="input-label"><%= scope.textValue %></label>\n        </td>\n    </tr>\n    <tr class="form-list-common" style="vertical-align: top;">\n        <td class="padding-small">\n            <div id="form-txt-new-value" style="width:164px;" class="margin-right-5"></div>\n        </td>\n        <td class="padding-small">\n            <div id="form-list-add" class="margin-left-5"></div>\n        </td>\n    </tr>\n    <tr class="form-list-common" style="vertical-align: top;">\n        <td class="padding-large">\n            <div id="form-list-list" style="width:164px; height: 95px;" class="margin-right-5"></div>\n        </td>\n        <td class="padding-large">\n            <div id="form-list-delete" style="margin-bottom: 5px;" class="margin-left-5"></div>\n            <div id="form-list-up" style="margin-bottom: 5px;" class="margin-left-5"></div>\n            <div id="form-list-down" class="margin-left-5"></div>\n        </td>\n    </tr>\n    <tr class="form-combo">\n        <td colspan="2" class="padding-small">\n            <div id="form-chb-custom-text"></div>\n        </td>\n    </tr>\n    <tr class="form-list">\n        <td colspan="2" class="padding-small">\n            <div id="form-chb-multisel"></div>\n        </td>\n    </tr>\n    <tr class="form-list-common">\n        <td colspan="2" class="padding-small">\n            <div id="form-chb-commit"></div>\n        </td>\n    </tr>\n</table>\n<table cols="1" role="presentation">\n    <tr class="form-text">\n        <td class="padding-small">\n            <div class="separator horizontal"></div>\n        </td>\n    </tr>\n    <tr class="form-text">\n        <td class="padding-small">\n            <div id="form-chb-pwd"></div>\n        </td>\n    </tr>\n    <tr class="form-text-combo">\n        <td class="padding-small">\n            <div id="form-chb-autofit"></div>\n        </td>\n    </tr>\n    <tr class="form-text">\n        <td class="padding-small">\n            <div id="form-chb-multiline"></div>\n        </td>\n    </tr>\n    <tr class="form-text">\n        <td class="padding-small">\n            <div id="form-chb-scroll"></div>\n        </td>\n    </tr>\n    <tr class="form-text">\n        <td class="padding-small">\n            <div id="form-chb-max-chars" style="display: inline-block;margin-top: 4px;"></div>\n            <div id="form-spin-max-chars" style="display: inline-block;" class="float-right"></div>\n        </td>\n    </tr>\n    <tr class="form-text">\n        <td class="padding-small">\n            <div id="form-chb-comb" style="display: inline-block;margin-top: 4px;"></div>\n            <div id="form-spin-comb-chars" style="display: inline-block;" class="float-right"></div>\n        </td>\n    </tr>\n</table>\n<table cols="1" role="presentation">\n    <tr class="form-checkbox">\n        <td class="padding-small">\n            <div class="separator horizontal"></div>\n        </td>\n    </tr>\n    <tr class="form-checkbox">\n        <td class="padding-small">\n            <label class="input-label" id="form-settings-lbl-style"><%= scope.textChbStyle %></label>\n            <div id="form-combo-chb-style" style="width: 100%;"></div>\n        </td>\n    </tr>\n    <tr class="form-checkbox">\n        <td class="padding-small">\n            <label class="input-label" id="form-settings-lbl-export"><%= scope.textExport %></label>\n            <div id="form-txt-export"></div>\n        </td>\n    </tr>\n    <tr class="form-checkbox">\n        <td class="padding-small">\n            <div id="form-chb-def-value"></div>\n        </td>\n    </tr>\n    <tr class="form-radiobox">\n        <td class="padding-small">\n            <div id="form-chb-unison"></div>\n        </td>\n    </tr>\n</table>\n<table cols="1" role="presentation">\n    <tr class="form-button">\n        <td class="padding-small">\n            <div class="separator horizontal"></div>\n        </td>\n    </tr>\n    <tr>\n        <td class="padding-small form-button">\n            <label class="input-label"><%= scope.textState %></label>\n            <div id="form-combo-state" style="width: 100%;"></div>\n        </td>\n    </tr>\n    <tr class="form-button-text">\n        <td class="padding-small">\n            <label class="input-label"><%= scope.textLabel %></label>\n            <div id="form-txt-label"></div>\n        </td>\n    </tr>\n</table>\n<table cols="2" class="form-image" style="width: 100%;">\n    <tr>\n        <td style="vertical-align: top">\n            <label class="input-label" style=""><%= scope.textIcon %></label>\n            <div id="form-btn-replace" style="width: 90px;"></div>\n        </td>\n        <td rowspan="2" class="padding-small">\n            <div class="texture-img float-right" style="width: 90px; height: 80px;">\n                <div id="form-icon-img" style="width: 50px;height: 50px;"></div>\n            </div>\n        </td>\n    </tr>\n    <tr>\n        <td class="padding-small" style="vertical-align: bottom">\n            <div id="form-btn-clear" style="width: 90px;"></div>\n        </td>\n    </tr>\n</table>\n<table cols="1" class="form-image" role="presentation">\n    <tr>\n        <td class="padding-small">\n            <div class="separator horizontal"></div>\n        </td>\n    </tr>\n    <tr>\n        <td>\n            <label class="header padding-small"><%= scope.textPlacement %></label>\n        </td>\n    </tr>\n    <tr>\n        <td class="padding-small">\n            <label class="input-label"><%= scope.textScale %></label>\n            <div id="form-combo-scale" style="width: 100%;"></div>\n        </td>\n    </tr>\n    <tr>\n        <td class="padding-small">\n            <label class="input-label"><%= scope.textHowScale %></label>\n            <div id="form-combo-how-scale" style="width: 100%;"></div>\n        </td>\n    </tr>\n    <tr>\n        <td class="padding-large">\n            <div id="form-chb-fit"></div>\n        </td>\n    </tr>\n    <tr>\n        <td class="padding-small">\n            <div id="form-cnt-position" style="width: 100%;">\n                <div class="row">\n                    <div id="form-img-position-preview">\n                        <div id="form-img-example"><%= scope.textImage %></div>\n                    </div>\n                    <div id="form-img-slider-position-y"></div>\n                </div>\n                <div class="row">\n                    <div id="form-img-slider-position-x"></div>\n                    <label id="form-img-slider-value"></label>\n                </div>\n            </div>\n        </td>\n    </tr>\n</table>\n<table cols="2" role="presentation">\n    <tr>\n        <td colspan=2 class="padding-small">\n            <div class="separator horizontal"></div>\n        </td>\n    </tr>\n    <tr>\n        <td>\n            <label class="header padding-small"><%= scope.textBorder %></label>\n        </td>\n    </tr>\n    <tr>\n        <td class="padding-small" width="50%">\n            <label class="input-label"><%= scope.textColor %></label>\n            <div id="form-color-btn"></div>\n        </td>\n        <td class="padding-small" width="50%">\n            <label class="input-label"><%= scope.textThickness %></label>\n            <div id="form-combo-line-width"></div>\n        </td>\n    </tr>\n    <tr>\n        <td class="padding-large" width="50%"></td>\n        <td class="padding-large" width="50%">\n            <label class="input-label"><%= scope.textStyle %></label>\n            <div id="form-combo-line-style"></div>\n        </td>\n    </tr>\n    <tr>\n        <td colspan=2 class="padding-small">\n            <label class="input-label" style="margin-top: 4px;"><%= scope.textBackgroundColor %></label>\n            <div id="form-background-color-btn" style="display: inline-block;" class="float-right"></div>\n        </td>\n    </tr>\n    <tr class="form-not-check">\n        <td colspan=2 class="padding-small">\n            <div class="separator horizontal"></div>\n        </td>\n    </tr>\n    <tr class="form-not-check">\n        <td colspan=2>\n            <label class="header padding-small"><%= scope.textText %></label>\n        </td>\n    </tr>\n    <tr class="form-not-check">\n        <td class="padding-small" width="50%">\n            <label class="input-label" style="margin-top: 4px;"><%= scope.textNumeral %></label>\n        </td>\n        <td class="padding-small" width="50%">\n            <div id="form-combo-numeral"></div>\n        </td>\n    </tr>\n</table>\n<table cols="1" role="presentation">\n    <tr>\n        <td class="padding-small">\n            <div class="separator horizontal"></div>\n        </td>\n    </tr>\n    <tr>\n        <td class="padding-small">\n            <label class="input-label" style="margin-top: 4px;"><%= scope.textOrientation %></label>\n            <div id="form-combo-orient" style="display: inline-block;" class="float-right"></div>\n        </td>\n    </tr>\n    <tr>\n        <td class="padding-small">\n            <div id="form-chb-required"></div>\n        </td>\n    </tr>\n    <tr>\n        <td class="padding-small">\n            <div id="form-chb-readonly"></div>\n        </td>\n    </tr>\n    <tr>\n        <td class="padding-small">\n            <div class="separator horizontal"></div>\n        </td>\n    </tr>\n    <tr>\n        <td class="padding-small">\n            <div id="form-btn-lock"></div>\n        </td>\n    </tr>\n    <tr class="form-text-combo">\n        <td class="padding-small">\n            <div class="separator horizontal"></div>\n        </td>\n    </tr>\n    <tr class="form-text-combo">\n        <td align="center">\n            <label class="link canfocused" id="form-advanced-link" data-hint="1" data-hint-direction="bottom" data-hint-offset="medium"><%= scope.textAdvanced %></label>\n        </td>\n    </tr>\n    <tr class="finish-cell"></tr>\n</table>\n'})),define("pdfeditor/main/app/view/FormSettings",["text!pdfeditor/main/app/template/FormSettings.template"],(function(t){"use strict";PDFE.Views.FormSettings=Common.UI.BaseView.extend(_.extend({el:"#id-form-settings",template:_.template(t),events:{},options:{alias:"FormSettings"},initialize:function(){this._initSettings=!0,this._state={DisabledControls:void 0,LockDelete:void 0,ButtonCaption:{}},this.lockedControls=[],this._locked=!0,this._originalSpecProps=null,this._originalProps=null,this.defFormat={FormatType:AscPDF.FormatType.NONE,decimal:2,separator:AscPDF.SeparatorStyle.COMMA_DOT,negative:AscPDF.NegativeStyle.BLACK_MINUS,symbol:"",location:!0,dateformat:"m/d/yy",timeformat:0,special:AscPDF.SpecialFormatType.PHONE,regexp:"."},this.render()},render:function(){var t=this.$el||$(this.el);t.html(this.template({scope:this})),this.TextComboSettings=t.find(".form-text-combo"),this.ListSettings=t.find(".form-list-common"),this.ListboxOnlySettings=t.find(".form-list"),this.TextSettings=t.find(".form-text"),this.ComboSettings=t.find(".form-combo"),this.CheckSettings=t.find(".form-checkbox"),this.RadioOnlySettings=t.find(".form-radiobox"),this.ButtonSettings=t.find(".form-button"),this.ButtonTextOnlySettings=t.find(".form-button-text"),this.ImageOnlySettings=t.find(".form-image"),this.TextSpecialSettings=t.find(".form-special"),this.MaskSettings=t.find(".form-special-mask"),this.DateSettings=t.find(".form-date"),this.TimeSettings=t.find(".form-time"),this.linkAdvanced=t.find("#form-advanced-link"),this.RequiredSettings=t.find("#form-chb-required").closest("tr"),this.NameSettings=t.find(".form-name"),this.NotCheckSettings=t.find(".form-not-check")},createDelayedElements:function(){this._initSettings=!1;var t=this.$el||$(this.el),e=this;this.labelFormName=t.findById("#form-settings-name"),this.labelStyleName=t.findById("#form-settings-lbl-style"),this.labelExportName=t.findById("#form-settings-lbl-export"),t.findById("#form-advanced-link").on("click",_.bind(this.openAdvancedSettings,this)),this.cmbName=new Common.UI.ComboBox({el:t.findById("#form-combo-name"),cls:"input-group-nr",menuCls:"menu-absolute",menuStyle:"min-width: 195px; max-height: 190px;",menuAlignEl:$(this.el).parent(),restoreMenuHeightAndTop:85,editable:!0,data:[],dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"big"}),this.cmbName.setValue(""),this.lockedControls.push(this.cmbName),this.cmbName.on("selected",this.onNameChanged.bind(this)),this.cmbName.on("changed:after",this.onNameChanged.bind(this)),this.cmbName.on("hide:after",this.onHideMenus.bind(this)),this.cmbNumeral=new Common.UI.ComboBox({el:t.findById("#form-combo-numeral"),editable:!1,cls:"input-group-nr",menuStyle:"min-width:100%;",data:[{value:Asc.c_oNumeralType.arabic,displayValue:this.textArabic},{value:Asc.c_oNumeralType.hindi,displayValue:this.textHindi}],dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"big"}),this.cmbNumeral.setValue(Asc.c_oNumeralType.arabic),this.cmbNumeral.on("selected",this.onNumeralChanged.bind(this)),this.lockedControls.push(this.cmbNumeral),this.cmbOrient=new Common.UI.ComboBox({el:t.findById("#form-combo-orient"),cls:"input-group-nr",menuStyle:"min-width: 100%;",style:"width: 48px;",editable:!1,data:[{displayValue:"0",value:0},{displayValue:"90",value:90},{displayValue:"180",value:180},{displayValue:"270",value:270}],dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"big"}),this.cmbOrient.setValue(0),this.cmbOrient.on("selected",this.onOrientChanged.bind(this)),this.lockedControls.push(this.cmbOrient),this.chRequired=new Common.UI.CheckBox({el:t.findById("#form-chb-required"),labelText:this.textRequired,dataHint:"1",dataHintDirection:"left",dataHintOffset:"small"}),this.chRequired.on("change",this.onChRequired.bind(this)),this.lockedControls.push(this.chRequired),this.chReadonly=new Common.UI.CheckBox({el:t.findById("#form-chb-readonly"),labelText:this.textReadonly,dataHint:"1",dataHintDirection:"left",dataHintOffset:"small"}),this.chReadonly.on("change",this.onChReadonly.bind(this)),this.lockedControls.push(this.chReadonly),this.cmbLineWidth=new Common.UI.ComboBox({el:t.findById("#form-combo-line-width"),cls:"input-group-nr",menuStyle:"min-width: 100%;",editable:!1,data:[{displayValue:this.textThin,value:1},{displayValue:this.textMedium,value:2},{displayValue:this.textThick,value:3}],dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"big"}),this.cmbLineWidth.setValue(1),this.cmbLineWidth.on("selected",this.onLineWidthChanged.bind(this)),this.lockedControls.push(this.cmbLineWidth),this.cmbLineStyle=new Common.UI.ComboBox({el:t.findById("#form-combo-line-style"),cls:"input-group-nr",menuStyle:"min-width: 100%;",editable:!1,data:[{displayValue:this.textSolid,value:AscPDF.BORDER_TYPES.solid},{displayValue:this.textDashed,value:AscPDF.BORDER_TYPES.dashed},{displayValue:this.textUnderline,value:AscPDF.BORDER_TYPES.underline},{displayValue:this.textBeveled,value:AscPDF.BORDER_TYPES.beveled},{displayValue:this.textInset,value:AscPDF.BORDER_TYPES.inset}],dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"big"}),this.cmbLineStyle.setValue(AscPDF.BORDER_TYPES.solid),this.cmbLineStyle.on("selected",this.onLineStyleChanged.bind(this)),this.lockedControls.push(this.cmbLineStyle),this.btnLockForm=new Common.UI.Button({parentEl:t.findById("#form-btn-lock"),cls:"btn-toolbar align-left",iconCls:"toolbar__icon btn-lock",caption:this.textLock,dataHint:"1",dataHintDirection:"left",dataHintOffset:"small"}),this.btnLockForm.on("click",_.bind((function(t){this.api&&!this._noApply&&(this.api.SetFieldLocked(!this._state.LockDelete),this.fireEvent("editcomplete",this))}),this)),this.txtPlaceholder=new Common.UI.InputField({el:t.findById("#form-txt-pholder"),allowBlank:!0,validateOnChange:!1,validateOnBlur:!1,style:"width: 100%;",value:"",dataHint:"1",dataHintDirection:"left",dataHintOffset:"small"}),this.lockedControls.push(this.txtPlaceholder),this.txtPlaceholder.on("changed:after",this.onPlaceholderChanged.bind(this)),this.txtPlaceholder.on("inputleave",(function(){e.fireEvent("editcomplete",e)})),this.txtPlaceholder.cmpEl.on("focus","input.form-control",(function(){setTimeout((function(){e.txtPlaceholder._input&&e.txtPlaceholder._input.select()}),1)})),this.textareaTip=new Common.UI.TextareaField({el:t.findById("#form-txt-tip"),style:"width: 100%; height: 36px;",value:"",dataHint:"1",dataHintDirection:"left",dataHintOffset:"small"}),this.lockedControls.push(this.textareaTip),this.textareaTip.on("changed:after",this.onTipChanged.bind(this)),this.textareaTip.on("inputleave",(function(){e.fireEvent("editcomplete",e)})),this.chAutofit=new Common.UI.CheckBox({el:t.findById("#form-chb-autofit"),labelText:this.textAutofit,dataHint:"1",dataHintDirection:"left",dataHintOffset:"small"}),this.chAutofit.on("change",this.onChAutofit.bind(this)),this.cmbFormat=new Common.UI.ComboBox({el:t.findById("#form-combo-format"),cls:"input-group-nr",menuStyle:"min-width: 100%;",menuAlignEl:$(this.el).parent(),restoreMenuHeightAndTop:85,editable:!1,data:[{displayValue:this.textNone,value:AscPDF.FormatType.NONE},{displayValue:this.textNumber,value:AscPDF.FormatType.NUMBER},{displayValue:this.textPercent,value:AscPDF.FormatType.PERCENTAGE},{displayValue:this.textDate,value:AscPDF.FormatType.DATE},{displayValue:this.textTime,value:AscPDF.FormatType.TIME},{displayValue:this.textSpecial,value:AscPDF.FormatType.SPECIAL},{displayValue:this.textReg,value:AscPDF.FormatType.REGULAR}],dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"big"}),this.lockedControls.push(this.cmbFormat),this.cmbFormat.setValue(AscPDF.FormatType.NONE),this.cmbFormat.on("selected",this.onFormatSelect.bind(this)),this.cmbSpecial=new Common.UI.ComboBox({el:t.findById("#form-combo-special"),cls:"input-group-nr",menuStyle:"min-width: 100%;",menuAlignEl:$(this.el).parent(),restoreMenuHeightAndTop:85,editable:!1,data:[{displayValue:this.textZipCode,value:AscPDF.SpecialFormatType.ZIP_CODE},{displayValue:this.textZipCode4,value:AscPDF.SpecialFormatType.ZIP_PLUS_4},{displayValue:this.textPhone,value:AscPDF.SpecialFormatType.PHONE},{displayValue:this.textSSN,value:AscPDF.SpecialFormatType.SSN},{displayValue:this.textMask,value:-1}],dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"big"}),this.cmbSpecial.setValue(AscPDF.SpecialFormatType.PHONE),this.lockedControls.push(this.cmbSpecial),this.cmbSpecial.on("selected",this.onSpecialChanged.bind(this)),this.txtMask=new Common.UI.InputField({el:t.findById("#form-txt-mask"),allowBlank:!0,validateOnChange:!1,validateOnBlur:!1,style:"width: 100%;",value:"",dataHint:"1",dataHintDirection:"left",dataHintOffset:"small"}),this.lockedControls.push(this.txtMask),this.txtMask.on("changed:after",this.onMaskChanged.bind(this)),this.txtMask.on("inputleave",(function(){e.fireEvent("editcomplete",e)})),this.txtMask.cmpEl.on("focus","input.form-control",(function(){setTimeout((function(){e.txtMask._input&&e.txtMask._input.select()}),1)}));var i=[];this.api.asc_getFieldDateFormatOptions().forEach((function(t){i.push({value:t,displayValue:t})})),this.cmbDateFormat=new Common.UI.ComboBox({el:t.findById("#form-cmb-date-format"),cls:"input-group-nr",menuStyle:"min-width: 100%; max-height: 190px;",menuAlignEl:$(this.el).parent(),restoreMenuHeightAndTop:85,editable:!1,data:i,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"big"}),this.cmbDateFormat.setValue(""),this.lockedControls.push(this.cmbDateFormat),this.cmbDateFormat.on("selected",this.onDateFormatChanged.bind(this)),this.cmbDateFormat.on("hide:after",this.onHideMenus.bind(this)),i=[];var s=this.api.asc_getFieldTimeFormatOptions();for(let t in s)s.hasOwnProperty(t)&&i.push({value:s[t],displayValue:t});this.cmbTimeFormat=new Common.UI.ComboBox({el:t.findById("#form-cmb-time-format"),cls:"input-group-nr",menuStyle:"min-width: 100%; max-height: 190px;",menuAlignEl:$(this.el).parent(),restoreMenuHeightAndTop:85,editable:!1,data:i,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"big"}),this.cmbTimeFormat.setValue(""),this.lockedControls.push(this.cmbTimeFormat),this.cmbTimeFormat.on("selected",this.onTimeFormatChanged.bind(this)),this.cmbTimeFormat.on("hide:after",this.onHideMenus.bind(this)),this.chPwd=new Common.UI.CheckBox({el:t.findById("#form-chb-pwd"),labelText:this.textPassword,dataHint:"1",dataHintDirection:"left",dataHintOffset:"small"}),this.chPwd.on("change",this.onChPwd.bind(this)),this.chMulti=new Common.UI.CheckBox({el:t.findById("#form-chb-multiline"),labelText:this.textMulti,dataHint:"1",dataHintDirection:"left",dataHintOffset:"small"}),this.chMulti.on("change",this.onChMulti.bind(this)),this.chScroll=new Common.UI.CheckBox({el:t.findById("#form-chb-scroll"),labelText:this.textScroll,dataHint:"1",dataHintDirection:"left",dataHintOffset:"small"}),this.chScroll.on("change",this.onChScroll.bind(this)),this.chMaxChars=new Common.UI.CheckBox({el:t.findById("#form-chb-max-chars"),labelText:this.textMaxChars,dataHint:"1",dataHintDirection:"left",dataHintOffset:"small"}),this.chMaxChars.on("change",this.onChMaxCharsChanged.bind(this)),this.lockedControls.push(this.chMaxChars),this.spnMaxChars=new Common.UI.MetricSpinner({el:t.findById("#form-spin-max-chars"),step:1,width:45,defaultUnit:"",value:"10",maxValue:1e6,minValue:1,allowDecimal:!1,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"big"}),this.spnMaxChars.on("change",this.onMaxCharsChange.bind(this)),this.spnMaxChars.on("inputleave",(function(){e.fireEvent("editcomplete",e)})),this.chComb=new Common.UI.CheckBox({el:t.findById("#form-chb-comb"),labelText:this.textComb,dataHint:"1",dataHintDirection:"left",dataHintOffset:"small"}),this.chComb.on("change",this.onChCombChanged.bind(this)),this.lockedControls.push(this.chComb),this.spnCombChars=new Common.UI.MetricSpinner({el:t.findById("#form-spin-comb-chars"),step:1,width:45,defaultUnit:"",value:"10",maxValue:1e6,minValue:1,allowDecimal:!1,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"big"}),this.spnCombChars.on("change",this.onCombCharsChange.bind(this)),this.spnCombChars.on("inputleave",(function(){e.fireEvent("editcomplete",e)})),this.chCustomText=new Common.UI.CheckBox({el:t.findById("#form-chb-custom-text"),labelText:this.textCustomText,dataHint:"1",dataHintDirection:"left",dataHintOffset:"small"}),this.chCustomText.on("change",this.onChCustomText.bind(this)),this.lockedControls.push(this.chCustomText),this.chMultisel=new Common.UI.CheckBox({el:t.findById("#form-chb-multisel"),labelText:this.textMultisel,dataHint:"1",dataHintDirection:"left",dataHintOffset:"small"}),this.chMultisel.on("change",this.onChMultisel.bind(this)),this.lockedControls.push(this.chMultisel),this.txtNewValue=new Common.UI.InputField({el:t.findById("#form-txt-new-value"),allowBlank:!0,validateOnChange:!0,validateOnBlur:!1,style:"width: 100%;",value:"",dataHint:"1",dataHintDirection:"left",dataHintOffset:"small"}).on("changing",(function(t,i){e.btnListAdd.setDisabled(i.length<1||e._state.DisabledControls)})),this.lockedControls.push(this.txtNewValue),this.txtNewValue.on("inputleave",(function(){e.fireEvent("editcomplete",e)})),this.txtNewValue._input.on("keydown",_.bind(this.onNewValueKeydown,this)),this.txtNewValue.cmpEl.on("focus","input.form-control",(function(){setTimeout((function(){e.txtNewValue._input&&e.txtNewValue._input.select()}),1)})),this.list=new Common.UI.ListView({el:t.findById("#form-list-list"),store:new Common.UI.DataViewStore,emptyText:"",template:_.template(['<div class="listview inner" style=""></div>'].join("")),itemTemplate:_.template(['<div id="<%= id %>" class="list-item" style="width: 100%;display:inline-block;">','<div style="width:145px;display: inline-block;vertical-align: middle; overflow: hidden; text-overflow: ellipsis;white-space: pre;"><%= Common.Utils.String.htmlEncode(name) %></div>',"</div>"].join(""))}),this.list.on("item:select",_.bind(this.onSelectItem,this)),this.lockedControls.push(this.list),this.btnListAdd=new Common.UI.Button({parentEl:t.findById("#form-list-add"),cls:"btn-toolbar",iconCls:"toolbar__icon btn-zoomup",hint:this.textTipAdd,dataHint:"1",dataHintDirection:"left",dataHintOffset:"big"}),this.btnListAdd.on("click",_.bind(this.onAddItem,this)),this.btnListDelete=new Common.UI.Button({parentEl:t.findById("#form-list-delete"),cls:"btn-toolbar",iconCls:"toolbar__icon btn-cc-remove",hint:this.textTipDelete,dataHint:"1",dataHintDirection:"left",dataHintOffset:"big"}),this.btnListDelete.on("click",_.bind(this.onDeleteItem,this)),this.lockedControls.push(this.btnListDelete),this.btnListUp=new Common.UI.Button({parentEl:t.findById("#form-list-up"),cls:"btn-toolbar",iconCls:"toolbar__icon btn-arrow-up",hint:this.textTipUp,dataHint:"1",dataHintDirection:"left",dataHintOffset:"big"}),this.btnListUp.on("click",_.bind(this.onMoveItem,this,!0)),this.lockedControls.push(this.btnListUp),this.btnListDown=new Common.UI.Button({parentEl:t.findById("#form-list-down"),cls:"btn-toolbar",iconCls:"toolbar__icon btn-arrow-down",hint:this.textTipDown,dataHint:"1",dataHintDirection:"left",dataHintOffset:"big"}),this.btnListDown.on("click",_.bind(this.onMoveItem,this,!1)),this.lockedControls.push(this.btnListDown),this.chCommit=new Common.UI.CheckBox({el:t.findById("#form-chb-commit"),labelText:this.textCommit,dataHint:"1",dataHintDirection:"left",dataHintOffset:"small"}),this.chCommit.on("change",this.onChCommit.bind(this)),this.lockedControls.push(this.chCommit),this.cmbCheckStyle=new Common.UI.ComboBox({el:t.findById("#form-combo-chb-style"),cls:"input-group-nr",menuStyle:"min-width: 100%;",editable:!1,data:[{displayValue:this.textCheck,value:AscPDF.CHECKBOX_STYLES.check},{displayValue:this.textCross,value:AscPDF.CHECKBOX_STYLES.cross},{displayValue:this.textSquare,value:AscPDF.CHECKBOX_STYLES.square},{displayValue:this.textDiamond,value:AscPDF.CHECKBOX_STYLES.diamond},{displayValue:this.textCircle,value:AscPDF.CHECKBOX_STYLES.circle},{displayValue:this.textStar,value:AscPDF.CHECKBOX_STYLES.star}],dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"big"}),this.cmbCheckStyle.setValue(AscPDF.BORDER_TYPES.check),this.cmbCheckStyle.on("selected",this.onCheckStyleChanged.bind(this)),this.lockedControls.push(this.cmbCheckStyle),this.txtExport=new Common.UI.InputField({el:t.findById("#form-txt-export"),allowBlank:!0,validateOnChange:!1,validateOnBlur:!1,style:"width: 100%;",value:"",dataHint:"1",dataHintDirection:"left",dataHintOffset:"small"}),this.lockedControls.push(this.txtExport),this.txtExport.on("changed:after",this.onExportChanged.bind(this)),this.txtExport.on("inputleave",(function(){e.fireEvent("editcomplete",e)})),this.txtExport.cmpEl.on("focus","input.form-control",(function(){setTimeout((function(){e.txtExport._input&&e.txtExport._input.select()}),1)})),this.chDefValue=new Common.UI.CheckBox({el:t.findById("#form-chb-def-value"),labelText:this.textCheckDefault,dataHint:"1",dataHintDirection:"left",dataHintOffset:"small"}),this.chDefValue.on("change",this.onChDefValue.bind(this)),this.lockedControls.push(this.chDefValue),this.chUnison=new Common.UI.CheckBox({el:t.findById("#form-chb-unison"),labelText:this.textUnison,dataHint:"1",dataHintDirection:"left",dataHintOffset:"small"}),this.chUnison.on("change",this.onChUnison.bind(this)),this.lockedControls.push(this.chUnison),this.cmbLayout=new Common.UI.ComboBox({el:t.findById("#form-combo-btn-layout"),cls:"input-group-nr",menuStyle:"min-width: 100%;",editable:!1,data:[{displayValue:this.textTextOnly,value:AscPDF.Api.Types.position.textOnly},{displayValue:this.textIconOnly,value:AscPDF.Api.Types.position.iconOnly},{displayValue:this.textIconTop,value:AscPDF.Api.Types.position.iconTextV},{displayValue:this.textLabelTop,value:AscPDF.Api.Types.position.textIconV},{displayValue:this.textIconLeft,value:AscPDF.Api.Types.position.iconTextH},{displayValue:this.textLabelLeft,value:AscPDF.Api.Types.position.textIconH},{displayValue:this.textOverlay,value:AscPDF.Api.Types.position.overlay}],dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"big"}),this.cmbLayout.setValue(AscPDF.Api.Types.position.textOnly),this.cmbLayout.on("selected",this.onLayoutChanged.bind(this)),this.lockedControls.push(this.cmbLayout),this.cmbBehavior=new Common.UI.ComboBox({el:t.findById("#form-combo-behavior"),cls:"input-group-nr",menuStyle:"min-width: 100%;",editable:!1,data:[{displayValue:this.textNone,value:AscPDF.BUTTON_HIGHLIGHT_TYPES.none},{displayValue:this.textPush,value:AscPDF.BUTTON_HIGHLIGHT_TYPES.push},{displayValue:this.textOutline,value:AscPDF.BUTTON_HIGHLIGHT_TYPES.outline},{displayValue:this.textInvert,value:AscPDF.BUTTON_HIGHLIGHT_TYPES.invert}],dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"big"}),this.cmbBehavior.setValue(AscPDF.BUTTON_HIGHLIGHT_TYPES.none),this.cmbBehavior.on("selected",this.onBehaviorChanged.bind(this)),this.lockedControls.push(this.cmbBehavior),this.cmbState=new Common.UI.ComboBox({el:t.findById("#form-combo-state"),cls:"input-group-nr",menuStyle:"min-width: 100%;",editable:!1,data:[{displayValue:this.textNormal,value:AscPDF.APPEARANCE_TYPES.normal},{displayValue:this.textDown,value:AscPDF.APPEARANCE_TYPES.mouseDown},{displayValue:this.textHover,value:AscPDF.APPEARANCE_TYPES.rollover}],dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"big"}),this.cmbState.setValue(AscPDF.APPEARANCE_TYPES.normal),this.cmbState.on("selected",this.onStateChanged.bind(this)),this.lockedControls.push(this.cmbState),this.txtLabel=new Common.UI.InputField({el:t.findById("#form-txt-label"),allowBlank:!0,validateOnChange:!1,validateOnBlur:!1,style:"width: 100%;",value:"",dataHint:"1",dataHintDirection:"left",dataHintOffset:"small"}),this.lockedControls.push(this.txtLabel),this.txtLabel.on("changed:after",this.onLabelChanged.bind(this)),this.txtLabel.on("inputleave",(function(){e.fireEvent("editcomplete",e)})),this.txtLabel.cmpEl.on("focus","input.form-control",(function(){setTimeout((function(){e.txtLabel._input&&e.txtLabel._input.select()}),1)})),this.btnSelectImage=new Common.UI.Button({parentEl:t.findById("#form-btn-replace"),cls:"btn-text-menu-default",caption:this.textSelect,style:"width:100%;",menu:new Common.UI.Menu({style:"min-width: 90px;",maxHeight:200,items:[{caption:this.textFromFile,value:0},{caption:this.textFromUrl,value:1},{caption:this.textFromStorage,value:2}]}),dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"big"}),this.lockedControls.push(this.btnSelectImage),this.btnSelectImage.menu.on("item:click",_.bind(this.onImageSelect,this)),this.mode.canRequestInsertImage||this.mode.fileChoiceUrl&&this.mode.fileChoiceUrl.indexOf("{documentType}")>-1?Common.NotificationCenter.on("storage:image-insert",_.bind(this.insertImageFromStorage,this)):this.btnSelectImage.menu.items[2].setVisible(!1),this.btnClear=new Common.UI.Button({parentEl:t.findById("#form-btn-clear"),cls:"btn-text-default",style:"width:100%;",caption:this.textClear,dataHint:"1",dataHintDirection:"left",dataHintOffset:"small"}),this.btnClear.on("click",_.bind(this.onImageClear,this)),this.lockedControls.push(this.btnClear),this.chFit=new Common.UI.CheckBox({el:t.findById("#form-chb-fit"),labelText:this.textFitBounds,dataHint:"1",dataHintDirection:"left",dataHintOffset:"small"}),this.chFit.on("change",this.onChFit.bind(this)),this.lockedControls.push(this.chFit),this.cmbScale=new Common.UI.ComboBox({el:t.findById("#form-combo-scale"),cls:"input-group-nr",menuStyle:"min-width: 100%;",editable:!1,data:[{displayValue:this.textAlways,value:AscPDF.Api.Types.scaleWhen.always},{displayValue:this.textNever,value:AscPDF.Api.Types.scaleWhen.never},{displayValue:this.textTooBig,value:AscPDF.Api.Types.scaleWhen.tooBig},{displayValue:this.textTooSmall,value:AscPDF.Api.Types.scaleWhen.tooSmall}],dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"big"}),this.cmbScale.setValue(AscPDF.Api.Types.scaleWhen.always),this.lockedControls.push(this.cmbScale),this.cmbScale.on("selected",this.onScaleChanged.bind(this)),this.cmbScale.on("changed:after",this.onScaleChanged.bind(this)),this.cmbScale.on("hide:after",this.onHideMenus.bind(this)),this.cmbHowScale=new Common.UI.ComboBox({el:t.findById("#form-combo-how-scale"),cls:"input-group-nr",menuStyle:"min-width: 100%;",editable:!1,data:[{displayValue:this.textProportional,value:AscPDF.Api.Types.scaleHow.proportional},{displayValue:this.textAnamorphic,value:AscPDF.Api.Types.scaleHow.anamorphic}],dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"big"}),this.cmbHowScale.setValue(AscPDF.Api.Types.scaleHow.proportional),this.lockedControls.push(this.cmbHowScale),this.cmbHowScale.on("selected",this.onHowScaleChanged.bind(this)),this.cmbHowScale.on("hide:after",this.onHideMenus.bind(this)),this.imagePositionPreview=t.findById("#form-img-example"),this.imagePositionLabel=t.findById("#form-img-slider-value"),this.imagePositionPreview_offset=this.imagePositionPreview.parent().width()-this.imagePositionPreview.width(),this.sldrPreviewPositionX=new Common.UI.SingleSlider({el:t.findById("#form-img-slider-position-x"),width:116,minValue:0,maxValue:100,value:50}),this.sldrPreviewPositionX.on("change",_.bind(this.onImagePositionChange,this,"x")),this.sldrPreviewPositionX.on("changecomplete",_.bind(this.onImagePositionChangeComplete,this,"x")),this.lockedControls.push(this.sldrPreviewPositionX),this.sldrPreviewPositionY=new Common.UI.SingleSlider({el:t.findById("#form-img-slider-position-y"),width:116,minValue:0,maxValue:100,value:50,direction:"vertical"}),this.sldrPreviewPositionY.on("change",_.bind(this.onImagePositionChange,this,"y")),this.sldrPreviewPositionY.on("changecomplete",_.bind(this.onImagePositionChangeComplete,this,"y")),this.lockedControls.push(this.sldrPreviewPositionY);var n=this.sldrPreviewPositionX.getValue(),a=this.sldrPreviewPositionY.getValue();this.imagePositionLabel.text(n+","+(100-a)),this.UpdateThemeColors()},setApi:function(t){return this.api=t,this},setMode:function(t){this.mode=t},onNameChanged:function(t,e){this.api&&!this._noApply&&(this._state.Name=void 0,this.api.SetFieldName(e.value),this.fireEvent("editcomplete",this))},onChRequired:function(t,e,i,s){this.api&&!this._noApply&&(this.api.SetFieldRequired("checked"===t.getValue()),this.fireEvent("editcomplete",this))},onChReadonly:function(t,e,i,s){this.api&&!this._noApply&&(this.api.SetFieldReadOnly("checked"===t.getValue()),this.fireEvent("editcomplete",this))},onColorBGSelect:function(t,e){if(this.BackgroundColor=e,this._state.BackgroundColor=void 0,this.api)if("transparent"===e)this.api.SetFieldBgColor();else{var i=Common.Utils.ThemeColor.getRgbColor(e);this.api.SetFieldBgColor(i.get_r(),i.get_g(),i.get_b())}this.fireEvent("editcomplete",this)},onNoFillClick:function(t){this.BackgroundColor="transparent",this._state.BackgroundColor=void 0,this.api&&!this._noApply&&(this.api.SetFieldBgColor(),this.fireEvent("editcomplete",this))},onColorPickerSelect:function(t,e){if(this.BorderColor=e,this._state.BorderColor=void 0,this.api&&!this._noApply){if("transparent"==e)this.api.SetFieldStrokeColor();else{var i=Common.Utils.ThemeColor.getRgbColor(e);this.api.SetFieldStrokeColor(i.get_r(),i.get_g(),i.get_b())}this.fireEvent("editcomplete",this)}},onNoBorderClick:function(t){this.BorderColor="transparent",this._state.BorderColor=void 0,this.api&&!this._noApply&&(this.api.SetFieldStrokeColor(),this.fireEvent("editcomplete",this))},onPlaceholderChanged:function(t,e,i,s){this.api&&!this._noApply&&e!==i&&(this.api.SetFieldPlaceholder(e),s.relatedTarget&&("input"==s.relatedTarget.localName||"textarea"==s.relatedTarget.localName)&&/form-control/.test(s.relatedTarget.className)||this.fireEvent("editcomplete",this))},onTipChanged:function(t,e,i,s){this.api&&!this._noApply&&e!==i&&(this.api.SetFieldTooltip(e),s.relatedTarget&&("input"==s.relatedTarget.localName||"textarea"==s.relatedTarget.localName)&&/form-control/.test(s.relatedTarget.className)||this.fireEvent("editcomplete",this))},onLineWidthChanged:function(t,e){this.api&&!this._noApply&&(this._state.StrokeWidth=void 0,this.api.SetFieldStrokeWidth(e.value),this.fireEvent("editcomplete",this))},onOrientChanged:function(t,e){this.api&&!this._noApply&&(this._state.Orient=void 0,this.api.SetFieldRotate(e.value),this.fireEvent("editcomplete",this))},onNumeralChanged:function(t,e){this.api&&!this._noApply&&(this._state.Numeral=void 0,this.api.SetFieldDigitsType(e.value),this.fireEvent("editcomplete",this))},onLineStyleChanged:function(t,e){this.api&&!this._noApply&&(this._state.StrokeStyle=void 0,this.api.SetFieldStrokeStyle(e.value),this.fireEvent("editcomplete",this))},onSelectItem:function(t,e,i){i&&(this.txtNewValue.setValue(i.get("name")),this._state.listValue=i.get("name"),this._state.listIndex=void 0,this.btnListAdd.setDisabled(this.txtNewValue.length<1||this._state.DisabledControls),this.disableListButtons())},onNewValueKeydown:function(t){this.api&&!this._noApply&&t.keyCode==Common.UI.Keys.RETURN&&this.onAddItem()},onAddItem:function(){var t=this.list.store,e=this.txtNewValue.getValue();""!==e&&(t.findWhere({value:e})||(this._state.listValue=e,this._state.listIndex=void 0,this.api.AddListFieldOption([e],t.length)));this.fireEvent("editcomplete",this)},onDeleteItem:function(t,e){var i=this.list.getSelectedRec();i&&(this._state.listIndex=this.list.store.indexOf(i),this._state.listValue=void 0,this.api.RemoveListFieldOption(this._state.listIndex)),this.fireEvent("editcomplete",this)},onMoveItem:function(t){var e=this.list.getSelectedRec();e&&this.api.MoveListFieldOption(this.list.store.indexOf(e),t),this.fireEvent("editcomplete",this)},disableListButtons:function(){var t=this.list.getSelectedRec(),e=t?this.list.store.indexOf(t):-1;this.btnListDelete.setDisabled(e<0||this._state.DisabledControls),this.btnListUp.setDisabled(e<1||this._state.DisabledControls),this.btnListDown.setDisabled(e<0||e>this.list.store.length-2||this._state.DisabledControls)},onChAutofit:function(t,e,i,s){this.api&&!this._noApply&&(this._state.AutoFit=void 0,this.api.SetFieldAutoFit("checked"==t.getValue()),this.fireEvent("editcomplete",this))},onChPwd:function(t,e,i,s){this.api&&!this._noApply&&(this._state.Pwd=void 0,this.api.SetTextFieldPassword("checked"==t.getValue()),this.fireEvent("editcomplete",this))},onChMulti:function(t,e,i,s){this.api&&!this._noApply&&(this._state.Multi=void 0,this.api.SetTextFieldMultiline("checked"==t.getValue()),this.fireEvent("editcomplete",this))},onChScroll:function(t,e,i,s){this.api&&!this._noApply&&(this._state.Scroll=void 0,this.api.SetTextFieldScrollLongText("checked"==t.getValue()),this.fireEvent("editcomplete",this))},onChCustomText:function(t,e,i,s){this.api&&!this._noApply&&(this.api.SetComboboxFieldEditable("checked"==t.getValue()),this.fireEvent("editcomplete",this))},onChMultisel:function(t,e,i,s){this.api&&!this._noApply&&(this.api.SetListboxFieldMultiSelect("checked"==t.getValue()),this.fireEvent("editcomplete",this))},onChCommit:function(t,e,i,s){this.api&&!this._noApply&&(this.api.SetListFieldCommitOnSelChange("checked"==t.getValue()),this.fireEvent("editcomplete",this))},onChMaxCharsChanged:function(t,e,i,s){var n="checked"==t.getValue();this.api&&!this._noApply&&(this.api.SetTextFieldCharLimit(n?10:0),this.fireEvent("editcomplete",this))},onMaxCharsChange:function(t,e,i,s){this.api&&!this._noApply&&this.api.SetTextFieldCharLimit("checked"===this.chMaxChars.getValue()?t.getNumberValue()||10:0)},onChCombChanged:function(t,e,i,s){this.api&&!this._noApply&&(this._state.Comb=void 0,this.api.SetTextFieldComb("checked"===t.getValue()),this.fireEvent("editcomplete",this))},onCombCharsChange:function(t,e,i,s){this.api&&!this._noApply&&this.api.SetTextFieldCharLimit("checked"===this.chComb.getValue()?t.getNumberValue()||10:0)},onExportChanged:function(t,e,i,s){this._state.Export=void 0,this.api&&!this._noApply&&e!==i&&(this.api.SetCheckboxFieldExportValue(e),s.relatedTarget&&("input"==s.relatedTarget.localName||"textarea"==s.relatedTarget.localName)&&/form-control/.test(s.relatedTarget.className)||this.fireEvent("editcomplete",this))},onCheckStyleChanged:function(t,e){this.api&&!this._noApply&&(this._state.ChbStyle=void 0,this.api.SetCheckboxFieldStyle(e.value),this.fireEvent("editcomplete",this))},onChDefValue:function(t,e,i,s){this.api&&!this._noApply&&(this._state.DefValue=void 0,this.api.SetFieldDefaultValue("checked"===t.getValue()?this.txtExport.getValue():void 0),this.fireEvent("editcomplete",this))},onChUnison:function(t,e,i,s){this.api&&!this._noApply&&(this._state.Unison=void 0,this.api.SetRadioFieldInUnison("checked"===t.getValue()),this.fireEvent("editcomplete",this))},onLayoutChanged:function(t,e){this.api&&!this._noApply&&(this._state.Layout=void 0,this.api.SetButtonFieldLayout(e.value),this.fireEvent("editcomplete",this))},onBehaviorChanged:function(t,e){this.api&&!this._noApply&&(this._state.Behavior=void 0,this.api.SetButtonFieldBehavior(e.value),this.fireEvent("editcomplete",this))},onStateChanged:function(t,e){this.api&&!this._noApply&&(this._state.State=e.value,this._originalSpecProps&&(this._originalSpecProps.asc_putCurrentState(e.value),this._state.ButtonLabel=this._state.ButtonCaption[e.value],this.txtLabel.setValue(this._state.ButtonLabel||"")))},onLabelChanged:function(t,e,i,s){this._state.ButtonLabel=void 0,this.api&&!this._noApply&&e!==i&&(this.api.SetButtonFieldLabel(e,this._state.State),s.relatedTarget&&("input"==s.relatedTarget.localName||"textarea"==s.relatedTarget.localName)&&/form-control/.test(s.relatedTarget.className)||this.fireEvent("editcomplete",this))},onImageClear:function(){this.api&&!this._noApply&&(this.api.ClearButtonFieldImage(this._state.State),this.fireEvent("editcomplete",this))},insertImageFromStorage:function(t){t&&t._urls&&"control"==t.c&&this._originalSpecProps&&this._originalSpecProps.put_ImageUrl(t._urls[0],this._state.State)},onImageSelect:function(t,e){if(1==e.value){var i=this;new Common.Views.ImageFromUrlDialog({handler:function(t,e){if("ok"==t&&i._originalSpecProps){var s=e.replace(/ /g,"");_.isEmpty(s)||i._originalSpecProps.put_ImageUrl(s,i._state.State)}i.fireEvent("editcomplete",i)}}).show()}else 2==e.value?Common.NotificationCenter.trigger("storage:image-load","control"):(this._originalSpecProps&&this._originalSpecProps.showFileDialog(this._state.State),this.fireEvent("editcomplete",this))},onChFit:function(t,e,i,s){this.api&&!this._noApply&&(this.api.SetButtonFieldFitBounds("checked"===t.getValue()),this.fireEvent("editcomplete",this))},onScaleChanged:function(t,e){this.api&&!this._noApply&&(this._state.Scale=void 0,this.api.SetButtonFieldScaleWhen(e.value),this.fireEvent("editcomplete",this))},onHowScaleChanged:function(t,e){this.api&&!this._noApply&&(this._state.HowScale=void 0,this.api.SetButtonFieldScaleHow(e.value),this.fireEvent("editcomplete",this))},onImagePositionChange:function(t,e,i,s){var n=this.imagePositionPreview_offset*i/100-1;"x"===t?(this.imagePositionPreview.css({left:n+"px"}),this._state.imgPositionX=i):(this.imagePositionPreview.css({top:n+"px"}),this._state.imgPositionY=i),_.isUndefined(this._state.imgPositionX)?this._state.imgPositionX=50:_.isUndefined(this._state.imgPositionY)&&(this._state.imgPositionY=50),this.imagePositionLabel.text(Math.round(this._state.imgPositionX)+","+Math.round(100-this._state.imgPositionY))},onImagePositionChangeComplete:function(t,e,i,s){"x"===t?this._state.imgPositionX=i:this._state.imgPositionY=i,this.imgPositionApplyFunc(t)},imgPositionApplyFunc:function(t){this.api&&!this._noApply&&(this.api.SetButtonFieldIconPos(this._state.imgPositionX/100,(100-this._state.imgPositionY)/100),this.fireEvent("editcomplete",this))},onFormatSelect:function(t,e){this.api&&!this._noApply&&(this._state.FormatType=void 0,this.defFormat.FormatType=e.value,this.applyFormatSettings(this.defFormat),this.fireEvent("editcomplete",this))},applyFormatSettings:function(t){switch(t.FormatType){case AscPDF.FormatType.NONE:this.api.ClearFieldFormat();break;case AscPDF.FormatType.NUMBER:this.api.SetFieldNumberFormat(t.decimal,t.separator,t.negative,t.symbol,t.location);break;case AscPDF.FormatType.PERCENTAGE:this.api.SetFieldPercentageFormat(t.decimal,t.separator);break;case AscPDF.FormatType.DATE:this.api.SetFieldDateFormat(t.dateformat);break;case AscPDF.FormatType.TIME:this.api.SetFieldTimeFormat(t.timeformat);break;case AscPDF.FormatType.SPECIAL:-1===t.special?this.api.SetFieldMask(t.mask):this.api.SetFieldSpecialFormat(t.special);break;case AscPDF.FormatType.REGULAR:this.api.SetFieldRegularExp(t.regexp)}},onSpecialChanged:function(t,e){this.api&&!this._noApply&&(this._state.SpecialType=void 0,-1===e.value?this.api.SetFieldMask("*"):this.api.SetFieldSpecialFormat(e.value)),this.fireEvent("editcomplete",this)},onMaskChanged:function(t,e,i,s){this.api&&!this._noApply&&e!==i&&(this._state.MaskStr=void 0,this._state.FormatType===AscPDF.FormatType.REGULAR?this.api.SetFieldRegularExp(e):this._state.FormatType===AscPDF.FormatType.SPECIAL&&this.api.SetFieldMask(e),s.relatedTarget&&("input"==s.relatedTarget.localName||"textarea"==s.relatedTarget.localName)&&/form-control/.test(s.relatedTarget.className)||this.fireEvent("editcomplete",this))},onDateFormatChanged:function(t,e){this.api&&!this._noApply&&(this._state.DateFormat=void 0,this.api.SetFieldDateFormat(e.value),this.fireEvent("editcomplete",this))},onTimeFormatChanged:function(t,e){this.api&&!this._noApply&&(this._state.TimeFormat=void 0,this.api.SetFieldTimeFormat(e.value),this.fireEvent("editcomplete",this))},ChangeSettings:function(t,e){if(this._initSettings&&this.createDelayedElements(),t){this._originalProps=t,this._noApply=!0;var i=t.asc_getPropLocked();this._state.LockDelete!==i&&(this._state.LockDelete=i,this.btnLockForm.setCaption(this._state.LockDelete?this.textUnlock:this.textLock)),this.disableControls(this._locked);var s=!1,n=t.asc_getType(),a=t.asc_getFieldProps();this._originalSpecProps=a;var o=this.api.GetAvailableFieldsNames(n);if(!this._state.arrName||this._state.arrName.length!==o.length||_.difference(this._state.arrName,o).length>0){var l=[];o.forEach((function(t){l.push({displayValue:t,value:t})})),this.cmbName.setData(l),this._state.arrName=o,this._state.Name=void 0}i=t.asc_getName(),this._state.Name!==i&&(this.cmbName.setValue(i||""),this._state.Name=i),i=t.asc_getTooltip(),this._state.tip!==i&&(this.textareaTip.setValue(i||""),this._state.tip=i),i=t.asc_getRequired(),this._state.Required!==i&&(this.chRequired.setValue(null!=i?!!i:"indeterminate",!0),this._state.Required=i),i=t.asc_getReadOnly(),this._state.Readonly!==i&&(this.chReadonly.setValue(null!=i?!!i:"indeterminate",!0),this._state.Readonly=i),i=t.asc_getRot(),this._state.Orient!==i&&(this.cmbOrient.setValue(null!=i?i:""),this._state.Orient=i);var r=t.asc_getStroke();r?r.get_type()==Asc.c_oAscColor.COLOR_TYPE_SCHEME?this.BorderColor={color:Common.Utils.ThemeColor.getHexColor(r.get_r(),r.get_g(),r.get_b()),effectValue:r.get_value()}:this.BorderColor=Common.Utils.ThemeColor.getHexColor(r.get_r(),r.get_g(),r.get_b()):this.BorderColor="transparent";var c=typeof this.BorderColor,d=typeof this._state.BorderColor;(c!==d||"object"==c&&(this.BorderColor.effectValue!==this._state.BorderColor.effectValue||this._state.BorderColor.color.indexOf(this.BorderColor.color)<0)||"object"!=c&&this._state.BorderColor.indexOf(this.BorderColor)<0)&&(this.btnColor.setColor(this.BorderColor),this.mnuColorPicker.clearSelection(),this.mnuNoBorder.setChecked("transparent"==this.BorderColor,!0),"transparent"!=this.BorderColor&&this.mnuColorPicker.selectByRGB("object"==typeof this.BorderColor?this.BorderColor.color:this.BorderColor,!0),this._state.BorderColor=this.BorderColor);var h=t.asc_getFill();if(h?h.get_type()===Asc.c_oAscColor.COLOR_TYPE_SCHEME?this.BackgroundColor={color:Common.Utils.ThemeColor.getHexColor(h.get_r(),h.get_g(),h.get_b()),effectValue:h.get_value()}:this.BackgroundColor=Common.Utils.ThemeColor.getHexColor(h.get_r(),h.get_g(),h.get_b()):this.BackgroundColor="transparent",((c=typeof this.BackgroundColor)!==(d=typeof this._state.BackgroundColor)||"object"===c&&(this.BackgroundColor.effectValue!==this._state.BackgroundColor.effectValue||this._state.BackgroundColor.color.indexOf(this.BackgroundColor.color)<0)||"object"!==c&&this._state.BackgroundColor.indexOf(this.BackgroundColor)<0)&&(this.btnBGColor.setColor(this.BackgroundColor),this.mnuBGColorPicker.clearSelection(),this.mnuNoFill.setChecked("transparent"==this.BackgroundColor,!0),"transparent"!==this.BackgroundColor&&this.mnuBGColorPicker.selectByRGB("object"==typeof this.BackgroundColor?this.BackgroundColor.color:this.BackgroundColor,!0),this._state.BackgroundColor=this.BackgroundColor),i=t.asc_getStrokeWidth(),this._state.StokeWidth!==i&&(this.cmbLineWidth.setValue(i,""),this._state.StokeWidth=i),this.cmbLineWidth.setDisabled(this._state.DisabledControls||"transparent"===this._state.BorderColor),i=t.asc_getStrokeStyle(),this._state.StokeStyle!==i&&(this.cmbLineStyle.setValue(i,""),this._state.StokeStyle=i),this.cmbLineStyle.setDisabled(this._state.DisabledControls||"transparent"===this._state.BorderColor),n===AscPDF.FIELD_TYPES.text&&a){this.labelFormName.text(this.textField);var p=a.asc_getComb(),m=a.asc_getMultiline(),u=a.asc_getPassword(),g=a.asc_getScrollLongText(),b=a.asc_getFormat()&&a.asc_getFormat().asc_getType()!==AscPDF.FormatType.NONE,f=!1;this._state.Comb!==p&&(this.chComb.setValue(null!=p?!!p:"indeterminate",!0),this._state.Comb=p,f=!0);var C=(i=a.asc_getCharLimit())&&i>0&&!p;((void 0===i||void 0===this._state.MaxChars)&&this._state.MaxChars!==i||Math.abs(this._state.MaxChars-i)>.1||f)&&(this.spnCombChars.setValue(p&&i&&i>0?i:"",!0),this.chMaxChars.setValue(C),this.spnMaxChars.setValue(C?i:"",!0),this._state.MaxChars=i),this.chComb.setDisabled(m||g||C||u||this._state.DisabledControls),this.spnCombChars.setDisabled(!p||this._state.DisabledControls),this.chMaxChars.setDisabled(p||this._state.DisabledControls),this.spnMaxChars.setDisabled(!C||this._state.DisabledControls),this._state.Multi!==m&&(this.chMulti.setValue(null!=m?!!m:"indeterminate",!0),this._state.Multi=m),this.chMulti.setDisabled(p||u||b||this._state.DisabledControls),this._state.Pwd!==u&&(this.chPwd.setValue(!!u,!0),this._state.Pwd=u),this.chPwd.setDisabled(p||m||this._state.DisabledControls),this._state.Scroll!==g&&(this.chScroll.setValue(null!=g?!!g:"indeterminate",!0),this._state.Scroll=g),this.chScroll.setDisabled(p||this._state.DisabledControls)}if(n===AscPDF.FIELD_TYPES.text||n==AscPDF.FIELD_TYPES.combobox){if(a){i=a.asc_getPlaceholder(),this._state.placeholder!==i&&(this.txtPlaceholder.setValue(i||""),this._state.placeholder=i),i=a.asc_getAutoFit(),this._state.AutoFit!==i&&(this.chAutofit.setValue(null!=i?!!i:"indeterminate",!0),this._state.AutoFit=i),this.chAutofit.setDisabled(p||this._state.DisabledControls);let t=a.asc_getFormat();switch(i=void 0===t?AscPDF.FormatType.NONE:null===t?null:t.asc_getType(),this._state.FormatType!==i&&(this.cmbFormat.setValue(null!=i?i:"",""),this._state.FormatType=i,s=!0),this._state.FormatType){case AscPDF.FormatType.REGULAR:i=t.asc_getRegExp();break;case AscPDF.FormatType.SPECIAL:void 0===(i=t.asc_getFormat())&&(i=-1),this._state.SpecialType!==i&&(this.cmbSpecial.setValue(i,""),this._state.SpecialType=i,s=!0),i=t.asc_getMask();break;case AscPDF.FormatType.DATE:i=t.asc_getFormat(),this._state.DateFormat!==i&&(this.cmbDateFormat.setValue(i,this.txtCustom),this._state.DateFormat=i);break;case AscPDF.FormatType.TIME:i=t.asc_getFormat(),this._state.TimeFormat!==i&&(this.cmbTimeFormat.setValue(i,this.txtCustom),this._state.TimeFormat=i)}this._state.FormatType!==AscPDF.FormatType.REGULAR&&this._state.FormatType!==AscPDF.FormatType.SPECIAL||this._state.MaskStr===i||(this.txtMask.setValue(i||""),this._state.MaskStr=i)}this.cmbFormat.setDisabled(n===AscPDF.FIELD_TYPES.text&&this._state.Multi||this._state.DisabledControls)}if(n==AscPDF.FIELD_TYPES.combobox&&a&&(i=a.asc_getEditable(),this._state.CustomText!==i&&(this.chCustomText.setValue(null!=i?!!i:"indeterminate",!0),this._state.CustomText=i)),n==AscPDF.FIELD_TYPES.listbox&&a&&(i=a.asc_getMultipleSelection(),this._state.Multisel!==i&&(this.chMultisel.setValue(null!=i?!!i:"indeterminate",!0),this._state.Multisel=i)),n==AscPDF.FIELD_TYPES.combobox||n==AscPDF.FIELD_TYPES.listbox){if(this.labelFormName.text(n==AscPDF.FIELD_TYPES.combobox?this.textCombobox:this.textListBox),a){for(var x=a.asc_getOptions(),v=(l=[],0);v<x.length;v++)""!==x[v]&&(i=_.isArray(x[v])&&x[v].length?x[v][0]:x[v],l.push({value:i,name:i}));this.list.store.reset(l);var y=null;l.length>0&&(void 0!==this._state.listValue||void 0!==this._state.listIndex)&&(void 0!==this._state.listIndex&&this._state.listIndex>=this.list.store.length&&(this._state.listIndex=this.list.store.length-1),y=void 0!==this._state.listValue?this.list.store.findWhere({value:this._state.listValue}):this.list.store.at(this._state.listIndex)),y?(this.list.selectRecord(y,this.txtNewValue._input.is(":focus")),this.list.scrollToRecord(y)):this.txtNewValue._input.is(":focus")||(this.txtNewValue.setValue(""),this.btnListAdd.setDisabled(!0),this._state.listValue=this._state.listIndex=void 0),i=a.asc_getCommitOnSelChange(),this._state.Commit!==i&&(this.chCommit.setValue(null!=i?!!i:"indeterminate",!0),this._state.Commit=i)}this.disableListButtons()}if(n===AscPDF.FIELD_TYPES.button&&(this.labelFormName.text(this.textButton),a)){var A=a.asc_getLayout();if(this._state.Layout!==A&&(this.cmbLayout.setValue(A,""),this._state.Layout=A),i=a.asc_getBehavior(),this._state.Behavior!==i&&(this.cmbBehavior.setValue(i,""),this._state.Behavior=i,this.cmbState.setDisabled(i!==AscPDF.BUTTON_HIGHLIGHT_TYPES.push||this._state.DisabledControls)),this._state.Behavior===AscPDF.BUTTON_HIGHLIGHT_TYPES.push?(i=a.asc_getCurrentState(),this._state.State!==i&&(this.cmbState.setValue(i,""),this._state.State=i),this._state.ButtonCaption={},this._state.ButtonCaption[AscPDF.APPEARANCE_TYPES.normal]=a.asc_getNormalCaption(),this._state.ButtonCaption[AscPDF.APPEARANCE_TYPES.mouseDown]=a.asc_getDownCaption(),this._state.ButtonCaption[AscPDF.APPEARANCE_TYPES.rollover]=a.asc_getHoverCaption()):(this._state.State=AscPDF.APPEARANCE_TYPES.normal,this.cmbState.setValue(this._state.State),this._state.ButtonCaption={},this._state.ButtonCaption[this._state.State]=a.asc_getNormalCaption()),A!==AscPDF.Api.Types.position.iconOnly&&this._state.ButtonLabel!==this._state.ButtonCaption[this._state.State]&&(this._state.ButtonLabel=this._state.ButtonCaption[this._state.State],this.txtLabel.setValue(this._state.ButtonLabel||"")),A!==AscPDF.Api.Types.position.textOnly){if(a.put_DivId("form-icon-img"),i=a.asc_getScaleWhen(),this._state.Scale!==i&&(this.cmbScale.setValue(i,""),this._state.Scale=i),i=a.asc_getScaleHow(),this._state.HowScale!==i&&(this.cmbHowScale.setValue(i,""),this._state.HowScale=i),i=a.asc_getIconPos()){var S=100*i.X,w=100-100*i.Y;this._state.imgPositionX!==S&&(this.sldrPreviewPositionX.setValue(S),this._state.imgPositionX=S),this._state.imgPositionY!==w&&(this.sldrPreviewPositionY.setValue(w),this._state.imgPositionY=w),this.imagePositionLabel.text(Math.round(this._state.imgPositionX)+","+Math.round(100-this._state.imgPositionY)),i=this.imagePositionPreview_offset*this._state.imgPositionX/100-1,this.imagePositionPreview.css({left:i+"px"}),i=this.imagePositionPreview_offset*this._state.imgPositionY/100-1,this.imagePositionPreview.css({top:i+"px"})}i=a.asc_getFitBounds(),this._state.Fit!==i&&(this.chFit.setValue(null!=i?!!i:"indeterminate",!0),this._state.Fit=i),this.cmbHowScale.setDisabled(this._state.Scale===AscPDF.Api.Types.scaleWhen.never||this._state.DisabledControls)}}if(n==AscPDF.FIELD_TYPES.checkbox||n==AscPDF.FIELD_TYPES.radiobutton){var T=n==AscPDF.FIELD_TYPES.checkbox;this.labelFormName.text(T?this.textCheckbox:this.textRadiobox),this.labelStyleName.text(T?this.textChbStyle:this.textRadioStyle),this.labelExportName.text(T?this.textExport:this.textRadioChoice),a&&(i=a.asc_getCheckboxStyle(),this._state.ChbStyle!==i&&(this.cmbCheckStyle.setValue(i,""),this._state.ChbStyle=i),i=a.asc_getExportValue(),this._state.Export!==i&&(this.txtExport.setValue(i||""),this._state.Export=i),this.chDefValue.setCaption(T?this.textCheckDefault:this.textRadioDefault),i=a.asc_getDefaultChecked(),this._state.DefValue!==i&&(this.chDefValue.setValue(null!=i?!!i:"indeterminate",!0),this._state.DefValue=i),n==AscPDF.FIELD_TYPES.radiobutton&&(i=a.asc_getRadiosInUnison(),this._state.Unison!==i&&(this.chUnison.setValue(null!=i?!!i:"indeterminate",!0),this._state.Unison=i)))}else i=t.asc_getDigitsType(),this._state.Numeral!==i&&(this.cmbNumeral.setValue(null!=i?i:""),this._state.Numeral=i);this._noApply=!1,(this.type!==n||n===AscPDF.FIELD_TYPES.button||s)&&this.showHideControls(n,a),this.type!==n&&this.fireEvent("updatescroller",this),this.type=n}},UpdateThemeColors:function(){if(!this._initSettings){var t=Common.UI.simpleColorsConfig;this.btnColor||(this.btnColor=new Common.UI.ColorButton({parentEl:(this.$el||$(this.el)).findById("#form-color-btn"),additionalItemsBefore:[this.mnuNoBorder=new Common.UI.MenuItem({style:Common.UI.isRTL()?"padding-right:20px;":"padding-left:20px;",caption:this.textNoBorder,toggleGroup:"form-settings-no-border",checkable:!0}),{caption:"--"}],colors:t.colors,dynamiccolors:t.dynamiccolors,themecolors:t.themecolors,effects:t.effects,columns:t.columns,paletteCls:t.cls,paletteWidth:t.paletteWidth,dataHint:"1",colorHints:!1,dataHintDirection:"bottom",dataHintOffset:"big"}),this.lockedControls.push(this.btnColor),this.mnuNoBorder.on("click",_.bind(this.onNoBorderClick,this)),this.btnColor.on("color:select",this.onColorPickerSelect.bind(this)),this.mnuColorPicker=this.btnColor.getPicker()),this.btnBGColor||(this.btnBGColor=new Common.UI.ColorButton({parentEl:$("#form-background-color-btn"),transparent:!0,color:"transparent",additionalItemsBefore:[this.mnuNoFill=new Common.UI.MenuItem({style:Common.UI.isRTL()?"padding-right:20px;":"padding-left:20px;",caption:this.textNoFill,toggleGroup:"form-settings-no-fill",checkable:!0}),{caption:"--"}],colors:t.colors,dynamiccolors:t.dynamiccolors,themecolors:t.themecolors,effects:t.effects,columns:t.columns,paletteCls:t.cls,paletteWidth:t.paletteWidth,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"big"}),this.lockedControls.push(this.btnBGColor),this.mnuNoFill.on("click",_.bind(this.onNoFillClick,this)),this.btnBGColor.on("color:select",_.bind(this.onColorBGSelect,this)),this.mnuBGColorPicker=this.btnBGColor.getPicker())}},openAdvancedSettings:function(t){if(!this.linkAdvanced.hasClass("disabled")){var e=this;new PDFE.Views.FormatSettingsDialog({api:e.api,handler:function(t,i){i&&e.applyFormatSettings(i),this.fireEvent("editcomplete",this)},props:this._originalSpecProps}).show()}},onHideMenus:function(t,e,i){i||this.fireEvent("editcomplete",this)},setLocked:function(t){this._locked=t},disableControls:function(t){if(!this._initSettings){var e=this;this._state.DisabledControls!==(this._state.LockDelete||t)&&(this._state.DisabledControls=this._state.LockDelete||t,_.each(this.lockedControls,(function(t){t.setDisabled(e._state.DisabledControls)}))),this.btnListAdd.setDisabled(this.txtNewValue.length<1||this._state.DisabledControls);var i=this._state.Comb,s=this._state.Multi,n=this._state.Pwd,a=this._state.Scroll;this.chAutofit.setDisabled(i||this._state.DisabledControls),this.chMulti.setDisabled(i||n||this.type===AscPDF.FIELD_TYPES.text&&this._state.FormatType!==AscPDF.FormatType.NONE||this._state.DisabledControls),this.chScroll.setDisabled(i||this._state.DisabledControls),this.chPwd.setDisabled(i||s||this._state.DisabledControls),this.cmbFormat.setDisabled(this.type===AscPDF.FIELD_TYPES.text&&s||this._state.DisabledControls),this.chComb.setDisabled(s||a||n||"checked"!==this.chMaxChars.getValue()||this._state.DisabledControls),this.spnCombChars.setDisabled(!i||this._state.DisabledControls),this.chMaxChars.setDisabled(i||this._state.DisabledControls),this.spnMaxChars.setDisabled(i||"checked"!==this.chMaxChars.getValue()||this._state.DisabledControls),this.cmbHowScale.setDisabled(this._state.Scale===AscPDF.Api.Types.scaleWhen.never||this._state.DisabledControls),this.cmbState.setDisabled(this._state.Behavior!==AscPDF.BUTTON_HIGHLIGHT_TYPES.push||this._state.DisabledControls),this.linkAdvanced.toggleClass("disabled",t),this.btnLockForm.setDisabled(t)}},showHideControls:function(t,e){var i=t===AscPDF.FIELD_TYPES.combobox,s=t===AscPDF.FIELD_TYPES.text,n=t===AscPDF.FIELD_TYPES.listbox,a=t===AscPDF.FIELD_TYPES.checkbox,o=t===AscPDF.FIELD_TYPES.radiobutton,l=t===AscPDF.FIELD_TYPES.button,r=l&&e.asc_getLayout()!==AscPDF.Api.Types.position.textOnly,c=l&&e.asc_getLayout()!==AscPDF.Api.Types.position.iconOnly;this.NameSettings.toggleClass("hidden",null===t),this.TextComboSettings.toggleClass("hidden",!(i||s)),this.ListSettings.toggleClass("hidden",!(i||n)),this.TextSettings.toggleClass("hidden",!s),this.ComboSettings.toggleClass("hidden",!i),this.ListboxOnlySettings.toggleClass("hidden",!n),this.CheckSettings.toggleClass("hidden",!(a||o)),this.RadioOnlySettings.toggleClass("hidden",!o),this.ButtonSettings.toggleClass("hidden",!l),this.RequiredSettings.toggleClass("hidden",l),this.ImageOnlySettings.toggleClass("hidden",!r),this.ButtonTextOnlySettings.toggleClass("hidden",!c),this.TextSpecialSettings.toggleClass("hidden",!(i||s)||this._state.FormatType!==AscPDF.FormatType.SPECIAL),this.MaskSettings.toggleClass("hidden",!(i||s)||!(this._state.FormatType===AscPDF.FormatType.REGULAR||this._state.FormatType===AscPDF.FormatType.SPECIAL&&-1===this._state.SpecialType)),this.DateSettings.toggleClass("hidden",!(i||s)||this._state.FormatType!==AscPDF.FormatType.DATE),this.TimeSettings.toggleClass("hidden",!(i||s)||this._state.FormatType!==AscPDF.FormatType.TIME),this.NotCheckSettings.toggleClass("hidden",a||o)}},PDFE.Views.FormSettings||{}))})),define("text!pdfeditor/main/app/template/ParagraphSettingsAdvanced.template",[],(function(){return'<div id="id-adv-paragraph-indents" class="settings-panel active">\n    <div class="inner-content">\n        <div>\n            <div class="padding-large" style="display: inline-block;">\n                <label class="input-label"><%= scope.textAlign %></label>\n                <div id="paragraphadv-spin-text-alignment"></div>\n            </div>\n        </div>\n        <div class="padding-very-small"><label class="header"><%= scope.strIndent %></label></div>\n        <div>\n            <div class="padding-large margin-right-3" style="display: inline-block;">\n                <label id="paragraphadv-lbl-indent-left" class="input-label"><%= scope.strIndentsLeftText %></label>\n                <div id="paragraphadv-spin-indent-left"></div>\n            </div>\x3c!--\n         --\x3e<div class="padding-large margin-right-3" style="display: inline-block;">\n                <label id="paragraphadv-lbl-indent-right" class="input-label"><%= scope.strIndentsRightText %></label>\n                <div id="paragraphadv-spin-indent-right"></div>\n            </div>\x3c!--\n         --\x3e<div class="padding-large" style="display: inline-block;vertical-align: top">\n                <div>\n                    <label class="input-label"><%= scope.strIndentsSpecial %></label>\n                </div>\n                <div>\n                    <div id="paragraphadv-spin-special" class="margin-right-3" style="display: inline-block;"></div>\x3c!--\n                 --\x3e<div id="paragraphadv-spin-special-by" style="display: inline-block;"></div>\n                </div>\n            </div>\n        </div>\n        <div class="padding-very-small"><label class="header"><%= scope.strSpacing %></label></div>\n        <div>\n            <div class="margin-right-3" style="display: inline-block;">\n                <label class="input-label"><%= scope.strIndentsSpacingBefore %></label>\n                <div id="paragraphadv-spin-spacing-before"></div>\n            </div>\x3c!--\n         --\x3e<div class="margin-right-3" style="display: inline-block;">\n                <label class="input-label"><%= scope.strIndentsSpacingAfter %></label>\n                <div id="paragraphadv-spin-spacing-after"></div>\n            </div>\x3c!--\n         --\x3e<div style="display: inline-block;vertical-align: top">\n                <div>\n                    <label class="input-label"><%= scope.strIndentsLineSpacing %></label>\n                </div>\n                <div>\n                    <div id="paragraphadv-spin-line-rule" class="margin-right-3" style="display: inline-block;"></div>\x3c!--\n                 --\x3e<div id="paragraphadv-spin-line-height" style="display: inline-block;"></div>\n                </div>\n            </div>\n        </div>\n        <div style="padding-top: 16px;"><label class="header padding-very-small"><%= scope.strDirection %></label></div>\n        <div>\n            <div id="paragraphadv-dir-ltr" class="margin-right-20" style="display: inline-block;"></div><div id="paragraphadv-dir-rtl" class="margin-left-20" style="display: inline-block;"></div>\n        </div>\n        <div class="padding-large" style="padding-top: 16px; display: none;">\n            <div style="border: 1px solid #cbcbcb; width: 350px;">\n                <div id="paragraphadv-indent-preview" style="height: 58px; position: relative;"></div>\n            </div>\n        </div>\n    </div>\n</div>\n<div id="id-adv-paragraph-font" class="settings-panel">\n    <div class="inner-content" style="width: 100%;">\n        <div class="padding-very-small">\n            <label class="header"><%= scope.textEffects %></label>\n        </div>\n        <table cols="2">\n            <tr>\n                <td class="padding-small">\n                    <div id="paragraphadv-checkbox-strike"></div>\n                </td>\n                <td class="padding-small padding-left-40">\n                    <div id="paragraphadv-checkbox-subscript"></div>\n                </td>\n            </tr>\n            <tr>\n                <td class="padding-small">\n                    <div id="paragraphadv-checkbox-double-strike"></div>\n                </td>\n                <td class="padding-small padding-left-40">\n                    <div id="paragraphadv-checkbox-small-caps"></div>\n                </td>\n            </tr>\n            <tr>\n                <td class="padding-large">\n                    <div id="paragraphadv-checkbox-superscript"></div>\n                </td>\n                <td class="padding-large padding-left-40">\n                    <div id="paragraphadv-checkbox-all-caps"></div>\n                </td>\n            </tr>\n        </table>\n        <div class="padding-very-small">\n            <label class="header"><%= scope.textCharacterSpacing %></label>\n        </div>\n        <div class="padding-large">\n            <div style="display: inline-block;">\n                <div id="paragraphadv-spin-spacing"></div>\n            </div>\n        </div>\n        <div class="doc-content-color" style="border: 1px solid #cbcbcb;">\n            <div id="paragraphadv-font-img" style="width: 300px; height: 80px; position: relative; margin: 0 auto;"></div>\n        </div>\n    </div>\n</div>\n<div id="id-adv-paragraph-tabs" class="settings-panel">\n    <div class="inner-content">\n        <div class="padding-large">\n            <label class="input-label"><%= scope.textDefault %></label>\n            <div id="paraadv-spin-default-tab"></div>\n\n        </div>\n        <div>\n            <div class="padding-large margin-right-9" style="display: inline-block;">\n                <label class="input-label"><%= scope.textTabPosition %></label>\n                <div id="paraadv-spin-tab"></div>\n            </div>\n            <div class="padding-large margin-right-9" style=" display: inline-block;">\n                <label class="input-label"><%= scope.textAlign %></label>\n                <div id="paraadv-cmb-align"></div>\n            </div>\n        </div>\n        <div>\n            <div colspan=3 class="padding-large">\n                <div id="paraadv-list-tabs" style="width:348px; height: 116px;"></div>\n            </div>\n        </div>\n        <div>\n            <button type="button" class="btn btn-text-default margin-right-9" id="paraadv-button-add-tab" style="width:108px; display: inline-block;"><%= scope.textSet %></button>\n            <button type="button" class="btn btn-text-default margin-right-9" id="paraadv-button-remove-tab" style="width:108px; display: inline-block;"><%= scope.textRemove %></button>\n            <button type="button" class="btn btn-text-default" id="paraadv-button-remove-all" style="width:108px;display: inline-block;"><%= scope.textRemoveAll %></button>\n        </div>\n    </div>\n</div>'})),define("pdfeditor/main/app/view/ParagraphSettingsAdvanced",["text!pdfeditor/main/app/template/ParagraphSettingsAdvanced.template","common/main/lib/view/AdvancedSettingsWindow"],(function(t){"use strict";PDFE.Views.ParagraphSettingsAdvanced=Common.Views.AdvancedSettingsWindow.extend(_.extend({options:{contentWidth:370,contentHeight:309,toggleGroup:"paragraph-adv-settings-group",storageName:"pdfe-para-settings-adv-category"},initialize:function(e){var i=this;_.extend(this.options,{title:this.textTitle,items:[{panelId:"id-adv-paragraph-indents",panelCaption:this.strParagraphIndents},{panelId:"id-adv-paragraph-font",panelCaption:this.strParagraphFont},{panelId:"id-adv-paragraph-tabs",panelCaption:this.strTabs}],contentTemplate:_.template(t)({scope:this})},e),Common.Views.AdvancedSettingsWindow.prototype.initialize.call(this,this.options),this._changedProps=null,this.checkGroup=0,this._noApply=!0,this._tabListChanged=!1,this.spinners=[],this.FirstLine=void 0,this.Spacing=null,this.api=this.options.api,this._originalProps=new Asc.asc_CParagraphProperty(this.options.paragraphProps),this._arrLineRule=[{displayValue:this.textAuto,defaultValue:1,value:c_paragraphLinerule.LINERULE_AUTO,minValue:.5,step:.01,defaultUnit:""},{displayValue:this.textExact,defaultValue:5,value:c_paragraphLinerule.LINERULE_EXACT,minValue:.03,step:.01,defaultUnit:"cm"}];var s=this._originalProps.get_Spacing().get_LineRule(),n=_.findWhere(this._arrLineRule,{value:s});this.CurLineRuleIdx=this._arrLineRule.indexOf(n),this._arrTextAlignment=[{displayValue:this.textTabLeft,value:c_paragraphTextAlignment.LEFT},{displayValue:this.textTabCenter,value:c_paragraphTextAlignment.CENTERED},{displayValue:this.textTabRight,value:c_paragraphTextAlignment.RIGHT},{displayValue:this.textJustified,value:c_paragraphTextAlignment.JUSTIFIED}],this._arrSpecial=[{displayValue:this.textNoneSpecial,value:c_paragraphSpecial.NONE_SPECIAL,defaultValue:0},{displayValue:this.textFirstLine,value:c_paragraphSpecial.FIRST_LINE,defaultValue:12.7},{displayValue:this.textHanging,value:c_paragraphSpecial.HANGING,defaultValue:12.7}],this._arrTabAlign=[{value:Asc.c_oAscTabType.Left,displayValue:this.textTabLeft},{value:Asc.c_oAscTabType.Center,displayValue:this.textTabCenter},{value:Asc.c_oAscTabType.Right,displayValue:this.textTabRight}],this._arrKeyTabAlign=[],this._arrTabAlign.forEach((function(t){i._arrKeyTabAlign[t.value]=t.displayValue}))},render:function(){Common.Views.AdvancedSettingsWindow.prototype.render.call(this);var t=this;this.cmbTextAlignment=new Common.UI.ComboBox({el:$("#paragraphadv-spin-text-alignment"),cls:"input-group-nr",editable:!1,data:this._arrTextAlignment,style:"width: 173px;",menuStyle:"min-width: 173px;",takeFocusOnClose:!0}),this.cmbTextAlignment.setValue(""),this.cmbTextAlignment.on("selected",_.bind((function(t,e){this._changedProps&&this._changedProps.asc_putJc(e.value>-1?e.value:null)}),this)),this.numIndentsLeft=new Common.UI.MetricSpinner({el:$("#paragraphadv-spin-indent-left"),step:.1,width:85,defaultUnit:"cm",defaultValue:0,value:"0 cm",maxValue:55.87,minValue:0}),this.numIndentsLeft.on("change",_.bind((function(t,e,i,s){var n=t.getNumberValue();this._changedProps&&(null!==this._changedProps.get_Ind()&&void 0!==this._changedProps.get_Ind()||this._changedProps.put_Ind(new Asc.asc_CParagraphInd),this._changedProps.get_Ind().put_Left(Common.Utils.Metric.fnRecalcToMM(n)))}),this)),this.spinners.push(this.numIndentsLeft),this.numIndentsRight=new Common.UI.MetricSpinner({el:$("#paragraphadv-spin-indent-right"),step:.1,width:85,defaultUnit:"cm",defaultValue:0,value:"0 cm",maxValue:55.87,minValue:0}),this.numIndentsRight.on("change",_.bind((function(t,e,i,s){this._changedProps&&(null!==this._changedProps.get_Ind()&&void 0!==this._changedProps.get_Ind()||this._changedProps.put_Ind(new Asc.asc_CParagraphInd),this._changedProps.get_Ind().put_Right(Common.Utils.Metric.fnRecalcToMM(t.getNumberValue())))}),this)),this.spinners.push(this.numIndentsRight),this.lblIndentsLeft=$("#paragraphadv-lbl-indent-left"),this.lblIndentsRight=$("#paragraphadv-lbl-indent-right"),this.cmbSpecial=new Common.UI.ComboBox({el:$("#paragraphadv-spin-special"),cls:"input-group-nr",editable:!1,data:this._arrSpecial,style:"width: 85px;",menuStyle:"min-width: 85px;",takeFocusOnClose:!0}),this.cmbSpecial.setValue(""),this.cmbSpecial.on("selected",_.bind(this.onSpecialSelect,this)),this.numSpecialBy=new Common.UI.MetricSpinner({el:$("#paragraphadv-spin-special-by"),step:.1,width:85,defaultUnit:"cm",defaultValue:0,value:"0 cm",maxValue:55.87,minValue:0}),this.spinners.push(this.numSpecialBy),this.numSpecialBy.on("change",_.bind(this.onFirstLineChange,this)),this.numSpacingBefore=new Common.UI.MetricSpinner({el:$("#paragraphadv-spin-spacing-before"),step:.1,width:85,value:"",defaultUnit:"cm",maxValue:55.88,minValue:0,allowAuto:!0,autoText:this.txtAutoText}),this.numSpacingBefore.on("change",_.bind((function(t,e,i,s){if(null===this.Spacing){var n=this._originalProps?this._originalProps:new Asc.asc_CParagraphProperty;this.Spacing=n.get_Spacing()}var a=t.getNumberValue();this.Spacing.put_Before(a<0?-1:Common.Utils.Metric.fnRecalcToMM(a))}),this)),this.spinners.push(this.numSpacingBefore),this.numSpacingAfter=new Common.UI.MetricSpinner({el:$("#paragraphadv-spin-spacing-after"),step:.1,width:85,value:"",defaultUnit:"cm",maxValue:55.88,minValue:0,allowAuto:!0,autoText:this.txtAutoText}),this.numSpacingAfter.on("change",_.bind((function(t,e,i,s){if(null===this.Spacing){var n=this._originalProps?this._originalProps:new Asc.asc_CParagraphProperty;this.Spacing=n.get_Spacing()}var a=t.getNumberValue();this.Spacing.put_After(a<0?-1:Common.Utils.Metric.fnRecalcToMM(a))}),this)),this.spinners.push(this.numSpacingAfter),this.cmbLineRule=new Common.UI.ComboBox({el:$("#paragraphadv-spin-line-rule"),cls:"input-group-nr",editable:!1,data:this._arrLineRule,style:"width: 85px;",menuStyle:"min-width: 85px;",takeFocusOnClose:!0}),this.cmbLineRule.setValue(""),this.cmbLineRule.on("selected",_.bind(this.onLineRuleSelect,this)),this.numLineHeight=new Common.UI.MetricSpinner({el:$("#paragraphadv-spin-line-height"),step:.01,width:85,value:"",defaultUnit:"",maxValue:132,minValue:.5}),this.spinners.push(this.numLineHeight),this.numLineHeight.on("change",_.bind(this.onNumLineHeightChange,this)),this.rbDirLtr=new Common.UI.RadioBox({el:$("#paragraphadv-dir-ltr"),name:"text-dir",labelText:this.textDirLtr,value:!1}),this.rbDirLtr.on("change",_.bind(this.onTextDirChange,this)),this.rbDirRtl=new Common.UI.RadioBox({el:$("#paragraphadv-dir-rtl"),name:"text-dir",labelText:this.textDirRtl,value:!0}),this.rbDirRtl.on("change",_.bind(this.onTextDirChange,this)),this.chStrike=new Common.UI.CheckBox({el:$("#paragraphadv-checkbox-strike"),labelText:this.strStrike}),this.chStrike.on("change",_.bind(this.onStrikeChange,this)),this.chDoubleStrike=new Common.UI.CheckBox({el:$("#paragraphadv-checkbox-double-strike"),labelText:this.strDoubleStrike}),this.chDoubleStrike.on("change",_.bind(this.onDoubleStrikeChange,this)),this.chSuperscript=new Common.UI.CheckBox({el:$("#paragraphadv-checkbox-superscript"),labelText:this.strSuperscript}),this.chSuperscript.on("change",_.bind(this.onSuperscriptChange,this)),this.chSubscript=new Common.UI.CheckBox({el:$("#paragraphadv-checkbox-subscript"),labelText:this.strSubscript}),this.chSubscript.on("change",_.bind(this.onSubscriptChange,this)),this.chSmallCaps=new Common.UI.CheckBox({el:$("#paragraphadv-checkbox-small-caps"),labelText:this.strSmallCaps}),this.chSmallCaps.on("change",_.bind(this.onSmallCapsChange,this)),this.chAllCaps=new Common.UI.CheckBox({el:$("#paragraphadv-checkbox-all-caps"),labelText:this.strAllCaps}),this.chAllCaps.on("change",_.bind(this.onAllCapsChange,this)),this.numSpacing=new Common.UI.MetricSpinner({el:$("#paragraphadv-spin-spacing"),step:.01,width:100,defaultUnit:"cm",defaultValue:0,value:"0 cm",maxValue:55.87,minValue:-55.87}),this.numSpacing.on("change",_.bind((function(t,e,i,s){if(this._changedProps&&this._changedProps.put_TextSpacing(Common.Utils.Metric.fnRecalcToMM(t.getNumberValue())),this.api&&!this._noApply){var n=this._originalProps?this._originalProps:new Asc.asc_CParagraphProperty;n.put_TextSpacing(Common.Utils.Metric.fnRecalcToMM(t.getNumberValue())),this.api.SetDrawImagePlaceParagraph("paragraphadv-font-img",n)}}),this)),this.spinners.push(this.numSpacing),this.numTab=new Common.UI.MetricSpinner({el:$("#paraadv-spin-tab"),step:.1,width:108,defaultUnit:"cm",value:"1.25 cm",maxValue:55.87,minValue:0}),this.spinners.push(this.numTab),this.numDefaultTab=new Common.UI.MetricSpinner({el:$("#paraadv-spin-default-tab"),step:.1,width:108,defaultUnit:"cm",value:"1.25 cm",maxValue:55.87,minValue:0}),this.numDefaultTab.on("change",_.bind((function(t,e,i,s){this._changedProps&&this._changedProps.put_DefaultTab(parseFloat(Common.Utils.Metric.fnRecalcToMM(t.getNumberValue()).toFixed(1)))}),this)),this.spinners.push(this.numDefaultTab),this.tabList=new Common.UI.ListView({el:$("#paraadv-list-tabs"),emptyText:this.noTabs,store:new Common.UI.DataViewStore,template:_.template(['<div class="listview inner" style=""></div>'].join("")),itemTemplate:_.template(['<div id="<%= id %>" class="list-item" style="width: 100%;display:inline-block;">','<div style="width: 117px;display: inline-block;"><%= value %></div>','<div style="display: inline-block;"><%= displayTabAlign %></div>',"</div>"].join("")),tabindex:1}),this.tabList.store.comparator=function(t){return t.get("tabPos")},this.tabList.on("item:select",_.bind(this.onSelectTab,this));var e=function(){t._noApply||(t._tabListChanged=!0)};this.listenTo(this.tabList.store,"add",e),this.listenTo(this.tabList.store,"remove",e),this.listenTo(this.tabList.store,"reset",e),this.cmbAlign=new Common.UI.ComboBox({el:$("#paraadv-cmb-align"),style:"width: 108px;",menuStyle:"min-width: 108px;",editable:!1,cls:"input-group-nr",data:this._arrTabAlign,takeFocusOnClose:!0}),this.cmbAlign.setValue(Asc.c_oAscTabType.Left),this.btnAddTab=new Common.UI.Button({el:$("#paraadv-button-add-tab")}),this.btnAddTab.on("click",_.bind(this.addTab,this)),this.btnRemoveTab=new Common.UI.Button({el:$("#paraadv-button-remove-tab")}),this.btnRemoveTab.on("click",_.bind(this.removeTab,this)),this.btnRemoveAll=new Common.UI.Button({el:$("#paraadv-button-remove-all")}),this.btnRemoveAll.on("click",_.bind(this.removeAllTabs,this)),this.afterRender()},getFocusedComponents:function(){return this.btnsCategory.concat([this.cmbTextAlignment,this.numIndentsLeft,this.numIndentsRight,this.cmbSpecial,this.numSpecialBy,this.numSpacingBefore,this.numSpacingAfter,this.cmbLineRule,this.numLineHeight,this.rbDirLtr,this.rbDirRtl,this.chStrike,this.chSubscript,this.chDoubleStrike,this.chSmallCaps,this.chSuperscript,this.chAllCaps,this.numSpacing,this.numDefaultTab,this.numTab,this.cmbAlign,this.tabList,this.btnAddTab,this.btnRemoveTab,this.btnRemoveAll]).concat(this.getFooterButtons())},onCategoryClick:function(t,e,i,s){Common.Views.AdvancedSettingsWindow.prototype.onCategoryClick.call(this,t,e);var n=this;setTimeout((function(){switch(e){case 0:n.cmbTextAlignment.focus();break;case 1:n.chStrike.focus(),s&&s instanceof jQuery.Event&&n.api.SetDrawImagePlaceParagraph("paragraphadv-font-img",n._originalProps||new Asc.asc_CParagraphProperty);break;case 2:n.numDefaultTab.focus()}}),10)},onAnimateAfter:function(){1==this.getActiveCategory()&&this.api.SetDrawImagePlaceParagraph("paragraphadv-font-img",this._originalProps||new Asc.asc_CParagraphProperty)},getSettings:function(){return this._tabListChanged&&(null!==this._changedProps.get_Tabs()&&void 0!==this._changedProps.get_Tabs()||this._changedProps.put_Tabs(new Asc.asc_CParagraphTabs),this.tabList.store.each((function(t,e){var i=new Asc.asc_CParagraphTab(Common.Utils.Metric.fnRecalcToMM(t.get("tabPos")),t.get("tabAlign"));this._changedProps.get_Tabs().add_Tab(i)}),this)),null!==this.Spacing&&this._changedProps.asc_putSpacing(this.Spacing),{paragraphProps:this._changedProps}},_setDefaults:function(t){if(t){this._originalProps=new Asc.asc_CParagraphProperty(t),this.FirstLine=null!==t.get_Ind()?t.get_Ind().get_FirstLine():null,this.numIndentsLeft.setValue(null!==t.get_Ind()&&null!==t.get_Ind().get_Left()?Common.Utils.Metric.fnRecalcFromMM(t.get_Ind().get_Left()):"",!0),this.numIndentsRight.setValue(null!==t.get_Ind()&&null!==t.get_Ind().get_Right()?Common.Utils.Metric.fnRecalcFromMM(t.get_Ind().get_Right()):"",!0),this.cmbTextAlignment.setValue(void 0!==t.get_Jc()&&null!==t.get_Jc()?t.get_Jc():""),void 0===this.CurSpecial&&(this.CurSpecial=0===t.get_Ind().get_FirstLine()?c_paragraphSpecial.NONE_SPECIAL:t.get_Ind().get_FirstLine()>0?c_paragraphSpecial.FIRST_LINE:c_paragraphSpecial.HANGING),this.cmbSpecial.setValue(this.CurSpecial),this.numSpecialBy.setValue(null!==this.FirstLine?Math.abs(Common.Utils.Metric.fnRecalcFromMM(this.FirstLine)):"",!0);var e=t.get_Spacing()?t.get_Spacing().get_Before():null;this.numSpacingBefore.setValue(null!==e?e<0?e:Common.Utils.Metric.fnRecalcFromMM(e):"",!0),e=t.get_Spacing()?t.get_Spacing().get_After():null,this.numSpacingAfter.setValue(null!==e?e<0?e:Common.Utils.Metric.fnRecalcFromMM(e):"",!0);var i=t.get_Spacing().get_LineRule();this.cmbLineRule.setValue(null!==i?i:""),null!==t.get_Spacing()&&null!==t.get_Spacing().get_Line()?this.numLineHeight.setValue(i==c_paragraphLinerule.LINERULE_AUTO?t.get_Spacing().get_Line():Common.Utils.Metric.fnRecalcFromMM(t.get_Spacing().get_Line()),!0):this.numLineHeight.setValue("",!0),void 0!==(e=t.asc_getRtlDirection())&&(this.rbDirRtl.setValue(e,!0),this.rbDirLtr.setValue(!e,!0)),this.lblIndentsLeft.text(e?this.strIndentsSpacingBefore:this.strIndentsLeftText),this.lblIndentsRight.text(e?this.strIndentsSpacingAfter:this.strIndentsRightText),this._noApply=!0,this.chStrike.setValue(null!==t.get_Strikeout()&&void 0!==t.get_Strikeout()?t.get_Strikeout():"indeterminate",!0),this.chDoubleStrike.setValue(null!==t.get_DStrikeout()&&void 0!==t.get_DStrikeout()?t.get_DStrikeout():"indeterminate",!0),this.chSubscript.setValue(null!==t.get_Subscript()&&void 0!==t.get_Subscript()?t.get_Subscript():"indeterminate",!0),this.chSuperscript.setValue(null!==t.get_Superscript()&&void 0!==t.get_Superscript()?t.get_Superscript():"indeterminate",!0),this.chSmallCaps.setValue(null!==t.get_SmallCaps()&&void 0!==t.get_SmallCaps()?t.get_SmallCaps():"indeterminate",!0),this.chAllCaps.setValue(null!==t.get_AllCaps()&&void 0!==t.get_AllCaps()?t.get_AllCaps():"indeterminate",!0),this.numSpacing.setValue(null!==t.get_TextSpacing()&&void 0!==t.get_TextSpacing()?Common.Utils.Metric.fnRecalcFromMM(t.get_TextSpacing()):"",!0),this.numDefaultTab.setValue(null!==t.get_DefaultTab()&&void 0!==t.get_DefaultTab()?Common.Utils.Metric.fnRecalcFromMM(parseFloat(t.get_DefaultTab().toFixed(1))):"",!0);var s=this.tabList.store,n=t.get_Tabs();if(n){for(var a=[],o=n.get_Count(),l=0;l<o;l++){var r=n.get_Tab(l),c=Common.Utils.Metric.fnRecalcFromMM(parseFloat(r.get_Pos().toFixed(1))),d=new Common.UI.DataViewModel;d.set({tabPos:c,value:parseFloat(c.toFixed(3))+" "+Common.Utils.Metric.getCurrentMetricName(),tabAlign:r.get_Value(),displayTabAlign:this._arrKeyTabAlign[r.get_Value()]}),a.push(d)}s.reset(a,{silent:!1}),this.tabList.selectByIndex(0)}this._noApply=!1,this._changedProps=new Asc.asc_CParagraphProperty}},updateMetricUnit:function(){if(this.spinners)for(var t=0;t<this.spinners.length;t++){var e=this.spinners[t];e.setDefaultUnit(Common.Utils.Metric.getCurrentMetricName()),"paragraphadv-spin-spacing"==e.el.id||"paragraphadv-spin-spacing-before"==e.el.id||"paragraphadv-spin-spacing-after"==e.el.id?e.setStep(Common.Utils.Metric.getCurrentMetric()==Common.Utils.Metric.c_MetricUnits.pt?1:.01):e.setStep(Common.Utils.Metric.getCurrentMetric()==Common.Utils.Metric.c_MetricUnits.pt?1:.1)}if(this._arrLineRule[1].defaultUnit=Common.Utils.Metric.getCurrentMetricName(),this._arrLineRule[1].minValue=parseFloat(Common.Utils.Metric.fnRecalcFromMM(.3).toFixed(2)),this._arrLineRule[1].step=Common.Utils.Metric.getCurrentMetric()==Common.Utils.Metric.c_MetricUnits.pt?1:.01,null!==this.CurLineRuleIdx){var i=this._arrLineRule[-1!==this.CurLineRuleIdx?this.CurLineRuleIdx:0];this.numLineHeight.setDefaultUnit(i.defaultUnit),this.numLineHeight.setStep(i.step)}},afterRender:function(){if(this.updateMetricUnit(),this._setDefaults(this._originalProps),this.storageName){var t=Common.localStorage.getItem(this.storageName);this.setActiveCategory(null!==t?parseInt(t):0)}},onStrikeChange:function(t,e,i,s){if(this._changedProps&&1!=this.checkGroup&&this._changedProps.put_Strikeout("checked"==t.getValue()),this.checkGroup=0,"checked"==t.getValue()&&(this.checkGroup=1,this.chDoubleStrike.setValue(0),this._changedProps&&this._changedProps.put_DStrikeout(!1),this.checkGroup=0),this.api&&!this._noApply){var n=this._originalProps?this._originalProps:new Asc.asc_CParagraphProperty;n.put_Strikeout("checked"==t.getValue()),n.put_DStrikeout("checked"==this.chDoubleStrike.getValue()),this.api.SetDrawImagePlaceParagraph("paragraphadv-font-img",n)}},onDoubleStrikeChange:function(t,e,i,s){if(this._changedProps&&1!=this.checkGroup&&this._changedProps.put_DStrikeout("checked"==t.getValue()),this.checkGroup=0,"checked"==t.getValue()&&(this.checkGroup=1,this.chStrike.setValue(0),this._changedProps&&this._changedProps.put_Strikeout(!1),this.checkGroup=0),this.api&&!this._noApply){var n=this._originalProps?this._originalProps:new Asc.asc_CParagraphProperty;n.put_DStrikeout("checked"==t.getValue()),n.put_Strikeout("checked"==this.chStrike.getValue()),this.api.SetDrawImagePlaceParagraph("paragraphadv-font-img",n)}},onSuperscriptChange:function(t,e,i,s){if(this._changedProps&&2!=this.checkGroup&&this._changedProps.put_Superscript("checked"==t.getValue()),this.checkGroup=0,"checked"==t.getValue()&&(this.checkGroup=2,this.chSubscript.setValue(0),this._changedProps&&this._changedProps.put_Subscript(!1),this.checkGroup=0),this.api&&!this._noApply){var n=this._originalProps?this._originalProps:new Asc.asc_CParagraphProperty;n.put_Superscript("checked"==t.getValue()),n.put_Subscript("checked"==this.chSubscript.getValue()),this.api.SetDrawImagePlaceParagraph("paragraphadv-font-img",n)}},onSubscriptChange:function(t,e,i,s){if(this._changedProps&&2!=this.checkGroup&&this._changedProps.put_Subscript("checked"==t.getValue()),this.checkGroup=0,"checked"==t.getValue()&&(this.checkGroup=2,this.chSuperscript.setValue(0),this._changedProps&&this._changedProps.put_Superscript(!1),this.checkGroup=0),this.api&&!this._noApply){var n=this._originalProps?this._originalProps:new Asc.asc_CParagraphProperty;n.put_Subscript("checked"==t.getValue()),n.put_Superscript("checked"==this.chSuperscript.getValue()),this.api.SetDrawImagePlaceParagraph("paragraphadv-font-img",n)}},onSmallCapsChange:function(t,e,i,s){if(this._changedProps&&3!=this.checkGroup&&this._changedProps.put_SmallCaps("checked"==t.getValue()),this.checkGroup=0,"checked"==t.getValue()&&(this.checkGroup=3,this.chAllCaps.setValue(0),this._changedProps&&this._changedProps.put_AllCaps(!1),this.checkGroup=0),this.api&&!this._noApply){var n=this._originalProps?this._originalProps:new Asc.asc_CParagraphProperty;n.put_SmallCaps("checked"==t.getValue()),n.put_AllCaps("checked"==this.chAllCaps.getValue()),this.api.SetDrawImagePlaceParagraph("paragraphadv-font-img",n)}},onAllCapsChange:function(t,e,i,s){if(this._changedProps&&3!=this.checkGroup&&this._changedProps.put_AllCaps("checked"==t.getValue()),this.checkGroup=0,"checked"==t.getValue()&&(this.checkGroup=3,this.chSmallCaps.setValue(0),this._changedProps&&this._changedProps.put_SmallCaps(!1),this.checkGroup=0),this.api&&!this._noApply){var n=this._originalProps?this._originalProps:new Asc.asc_CParagraphProperty;n.put_AllCaps("checked"==t.getValue()),n.put_SmallCaps("checked"==this.chSmallCaps.getValue()),this.api.SetDrawImagePlaceParagraph("paragraphadv-font-img",n)}},addTab:function(t,e){var i=this.numTab.getNumberValue(),s=this.cmbAlign.getValue(),n=this._arrKeyTabAlign[s],a=this.tabList.store,o=a.find((function(t){return Math.abs(t.get("tabPos")-i)<.001}));o?(o.set("tabAlign",s),o.set("displayTabAlign",n),this._tabListChanged=!0):((o=new Common.UI.DataViewModel).set({tabPos:i,value:i+" "+Common.Utils.Metric.getCurrentMetricName(),tabAlign:s,displayTabAlign:n}),a.add(o)),this.tabList.selectRecord(o),this.tabList.scrollToRecord(o)},removeTab:function(t,e){var i=this.tabList.getSelectedRec();if(i){var s=this.tabList.store,n=_.indexOf(s.models,i);s.remove(i),n>s.length-1&&(n=s.length-1),s.length>0&&(this.tabList.selectByIndex(n),this.tabList.scrollToRecord(s.at(n)))}},removeAllTabs:function(t,e){this.tabList.store.reset()},onSelectTab:function(t,e,i){if(i){var s={};if(_.isFunction(i.toJSON)){if(!i.get("selected"))return;s=i.toJSON()}else s=i;this.numTab.setValue(s.tabPos),this.cmbAlign.setValue(s.tabAlign)}},onSpecialSelect:function(t,e){if(this.CurSpecial=e.value,this.CurSpecial===c_paragraphSpecial.NONE_SPECIAL&&this.numSpecialBy.setValue(0,!0),this._changedProps){null!==this._changedProps.get_Ind()&&void 0!==this._changedProps.get_Ind()||this._changedProps.put_Ind(new Asc.asc_CParagraphInd);var i=Common.Utils.Metric.fnRecalcToMM(this.numSpecialBy.getNumberValue());0===i&&(this.numSpecialBy.setValue(Common.Utils.Metric.fnRecalcFromMM(this._arrSpecial[e.value].defaultValue),!0),i=this._arrSpecial[e.value].defaultValue),this.CurSpecial===c_paragraphSpecial.HANGING&&(i=-i),this._changedProps.get_Ind().put_FirstLine(i)}},onFirstLineChange:function(t,e,i,s){if(this._changedProps){null!==this._changedProps.get_Ind()&&void 0!==this._changedProps.get_Ind()||this._changedProps.put_Ind(new Asc.asc_CParagraphInd);var n=Common.Utils.Metric.fnRecalcToMM(t.getNumberValue());this.CurSpecial===c_paragraphSpecial.HANGING?n=-n:this.CurSpecial===c_paragraphSpecial.NONE_SPECIAL&&n>0?(this.CurSpecial=c_paragraphSpecial.FIRST_LINE,this.cmbSpecial.setValue(c_paragraphSpecial.FIRST_LINE)):0===n&&(this.CurSpecial=c_paragraphSpecial.NONE_SPECIAL,this.cmbSpecial.setValue(c_paragraphSpecial.NONE_SPECIAL)),this._changedProps.get_Ind().put_FirstLine(n)}},onLineRuleSelect:function(t,e){if(null===this.Spacing){var i=this._originalProps?this._originalProps:new Asc.asc_CParagraphProperty;this.Spacing=i.get_Spacing()}this.Spacing.put_LineRule(e.value);var s=_.findWhere(this._arrLineRule,{value:e.value}),n=this._arrLineRule.indexOf(s);this.CurLineRuleIdx!==n&&(this.numLineHeight.setDefaultUnit(this._arrLineRule[n].defaultUnit),this.numLineHeight.setMinValue(this._arrLineRule[n].minValue),this.numLineHeight.setStep(this._arrLineRule[n].step),this.Spacing.get_LineRule()===c_paragraphLinerule.LINERULE_AUTO?this.numLineHeight.setValue(this._arrLineRule[n].defaultValue):this.numLineHeight.setValue(Common.Utils.Metric.fnRecalcFromMM(this._arrLineRule[n].defaultValue)),this.CurLineRuleIdx=n)},onNumLineHeightChange:function(t,e,i,s){if(""!==this.cmbLineRule.getRawValue()){if(null===this.Spacing){var n=this._originalProps?this._originalProps:new Asc.asc_CParagraphProperty;this.Spacing=n.get_Spacing()}this.Spacing.put_Line(this.cmbLineRule.getValue()==c_paragraphLinerule.LINERULE_AUTO?t.getNumberValue():Common.Utils.Metric.fnRecalcToMM(t.getNumberValue()))}},onTextDirChange:function(t,e,i){e&&this._changedProps&&(this._changedProps.asc_putRtlDirection(t.options.value),this.lblIndentsLeft.text(t.options.value?this.strIndentsSpacingBefore:this.strIndentsLeftText),this.lblIndentsRight.text(t.options.value?this.strIndentsSpacingAfter:this.strIndentsRightText))},textTitle:"Paragraph - Advanced Settings",strIndentsLeftText:"Left",strIndentsRightText:"Right",strParagraphIndents:"Indents & Spacing",strParagraphFont:"Font",textEffects:"Effects",textCharacterSpacing:"Character Spacing",strDoubleStrike:"Double strikethrough",strStrike:"Strikethrough",strSuperscript:"Superscript",strSubscript:"Subscript",strSmallCaps:"Small caps",strAllCaps:"All caps",strTabs:"Tab",textSet:"Specify",textRemove:"Remove",textRemoveAll:"Remove All",textTabLeft:"Left",textTabRight:"Right",textTabCenter:"Center",textAlign:"Alignment",textTabPosition:"Tab Position",textDefault:"Default Tab",noTabs:"The specified tabs will appear in this field",textJustified:"Justified",strIndentsSpecial:"Special",textNoneSpecial:"(none)",textFirstLine:"First line",textHanging:"Hanging",strIndentsSpacingBefore:"Before",strIndentsSpacingAfter:"After",strIndentsLineSpacing:"Line Spacing",txtAutoText:"Auto",textAuto:"Multiple",textExact:"Exactly",strIndent:"Indents",strSpacing:"Spacing"},PDFE.Views.ParagraphSettingsAdvanced||{}))})),define("text!pdfeditor/main/app/template/ImageSettingsAdvanced.template",[],(function(){return'<div id="id-adv-image-general" class="settings-panel active">\n    <div class="inner-content">\n    <table cols="1" width="100%">\n        <tr>\n            <td class="padding-large">\n                <label class="header"><%= scope.textImageName %></label>\n                <div id="image-general-name"></div>\n            </td>\n        </tr>\n    </table>\n    </div>\n</div>\n<div  id="id-adv-image-size" class="settings-panel active">\n    <div class="inner-content">\n        <table cols="4" width="100%">\n            <tr>\n                <td colspan="4" width="88px" class="padding-small">\n                    <label class="header"><%= scope.textSize %></label>\n                </td>\n            </tr>\n            <tr>\n                <td width="78px" class="padding-large">\n                    <label class="input-label"><%= scope.textWidth %></label>\n                    <div id="image-advanced-spin-width"></div>\n                </td>\n                <td width="28px" style="vertical-align: bottom;" class="padding-large">\n                    <div id="image-advanced-button-ratio"></div>\n                </td>\n                <td width="78px" class="padding-large">\n                    <label class="input-label"><%= scope.textHeight %></label>\n                    <div id="image-advanced-spin-height"></div>\n                </td>\n                <td style="vertical-align: bottom;" class="padding-large">\n                    <button type="button" class="btn btn-text-default auto" id="image-advanced-button-original-size" style="min-width:100px;"><%= scope.textOriginalSize %></button>\n                </td>\n            </tr>\n        </table>\n    </div>\n    <div class="inner-content">\n        <table cols="2" style="width: 100%;">\n            <tr>\n                <td colspan="4" width="88px" class="padding-small">\n                    <label class="header"><%= scope.textPosition %></label>\n                </td>\n            </tr>\n            <tr>\n                <td class="padding-small" width="106px">\n                    <label class="input-label"><%= scope.textHorizontal %></label>\n                    <div id="image-advanced-spin-x"></div>\n                </td>\n                <td class="padding-small">\n                    <label class="input-label"><%= scope.textFrom %></label>\n                    <div id="image-advanced-combo-from-x"></div>\n                </td>\n            </tr>\n            <tr>\n                <td class="padding-small">\n                    <label class="input-label"><%= scope.textVertical %></label>\n                    <div id="image-advanced-spin-y"></div>\n                </td>\n                <td class="padding-small">\n                    <label class="input-label"><%= scope.textFrom %></label>\n                    <div id="image-advanced-combo-from-y"></div>\n                </td>\n            </tr>\n        </table>\n    </div>\n</div>\n<div id="id-adv-image-rotate" class="settings-panel active">\n    <div class="inner-content  padding-large">\n        <div style="width: 100%;">\n            <label class="input-label vertical-align-baseline"><%= scope.textAngle %></label>\n            <div id="image-advanced-spin-angle" class="margin-left-5 vertical-align-baseline" style="display: inline-block;"></div>\n        </div>\n    </div>\n    <div class="separator horizontal padding-large"></div>\n    <div class="inner-content  padding-large">\n        <table cols="2">\n            <tr>\n                <td rowspan="2" class="padding-small" style="vertical-align: top;">\n                    <label class="input-label margin-right-15" style="vertical-align: top;"><%= scope.textFlipped %></label>\n                </td>\n                <td class="padding-small">\n                    <div id="image-advanced-checkbox-hor"></div>\n                </td>\n            </tr>\n            <tr>\n                <td class="padding-small">\n                    <div id="image-advanced-checkbox-vert"></div>\n                </td>\n            </tr>\n        </table>\n    </div>\n</div>\n<div id="id-adv-image-alttext" class="settings-panel">\n    <div class="inner-content">\n        <table cols="1" width="100%">\n            <tr>\n                <td class="padding-large">\n                    <label class="header"><%= scope.textAltTitle %></label>\n                    <div id="image-advanced-alt-title"></div>\n                </td>\n            </tr>\n            <tr>\n                <td>\n                    <label class="header"><%= scope.textAltDescription %></label>\n                    <textarea id="image-advanced-alt-description" class="form-control" style="width: 100%; height: 70px;"></textarea>\n                </td>\n            </tr>\n            <tr>\n                <td>\n                    <label><%= scope.textAltTip %></label>\n                </td>\n            </tr>\n        </table>\n    </div>\n</div>'})),define("pdfeditor/main/app/view/ImageSettingsAdvanced",["text!pdfeditor/main/app/template/ImageSettingsAdvanced.template","common/main/lib/view/AdvancedSettingsWindow"],(function(t){"use strict";PDFE.Views.ImageSettingsAdvanced=Common.Views.AdvancedSettingsWindow.extend(_.extend({options:{alias:"ImageSettingsAdvanced",contentWidth:340,contentHeight:257,sizeOriginal:{width:0,height:0},sizeMax:{width:55.88,height:55.88},storageName:"pdfe-img-settings-adv-category"},initialize:function(e){_.extend(this.options,{title:this.textTitle,items:[{panelId:"id-adv-image-general",panelCaption:this.textGeneral},{panelId:"id-adv-image-size",panelCaption:this.textPlacement},{panelId:"id-adv-image-rotate",panelCaption:this.textRotation},{panelId:"id-adv-image-alttext",panelCaption:this.textAlt}],contentTemplate:_.template(t)({scope:this})},e),Common.Views.AdvancedSettingsWindow.prototype.initialize.call(this,this.options),this.spinners=[],this._nRatio=1,this._isDefaultSize=!1,this._originalProps=this.options.imageProps,this.slideSize=this.options.slideSize},render:function(){Common.Views.AdvancedSettingsWindow.prototype.render.call(this);var t=this;this.inputImageName=new Common.UI.InputField({el:$("#image-general-name"),allowBlank:!0,validateOnBlur:!1,style:"width: 100%;"}).on("changed:after",(function(){t.isImgNameChanged=!0})),this.spnWidth=new Common.UI.MetricSpinner({el:$("#image-advanced-spin-width"),step:.1,width:70,defaultUnit:"cm",value:"3 cm",maxValue:55.88,minValue:0}),this.spnWidth.on("change",_.bind((function(t,e,i,s){if(this.btnRatio.pressed){var n=t.getNumberValue(),a=n/this._nRatio;a>this.sizeMax.height&&(n=(a=this.sizeMax.height)*this._nRatio,this.spnWidth.setValue(n,!0)),this.spnHeight.setValue(a,!0)}this._isDefaultSize=!1}),this)),this.spinners.push(this.spnWidth),this.spnHeight=new Common.UI.MetricSpinner({el:$("#image-advanced-spin-height"),step:.1,width:70,defaultUnit:"cm",value:"3 cm",maxValue:55.88,minValue:0}),this.spnHeight.on("change",_.bind((function(t,e,i,s){var n=t.getNumberValue(),a=null;this.btnRatio.pressed&&((a=n*this._nRatio)>this.sizeMax.width&&(n=(a=this.sizeMax.width)/this._nRatio,this.spnHeight.setValue(n,!0)),this.spnWidth.setValue(a,!0)),this._isDefaultSize=!1}),this)),this.spinners.push(this.spnHeight),this.btnOriginalSize=new Common.UI.Button({el:$("#image-advanced-button-original-size")}),this.btnOriginalSize.on("click",_.bind((function(t,e){this.spnAngle.setValue(0),this.spnWidth.setValue(this.sizeOriginal.width,!0),this.spnHeight.setValue(this.sizeOriginal.height,!0),this._nRatio=this.sizeOriginal.width/this.sizeOriginal.height}),this)),this.btnRatio=new Common.UI.Button({parentEl:$("#image-advanced-button-ratio"),cls:"btn-toolbar",iconCls:"toolbar__icon btn-advanced-ratio",style:"margin-bottom: 1px;",enableToggle:!0,hint:this.textKeepRatio}),this.btnRatio.on("click",_.bind((function(t,e){t.pressed&&this.spnHeight.getNumberValue()>0&&(this._nRatio=this.spnWidth.getNumberValue()/this.spnHeight.getNumberValue())}),this)),this.spnX=new Common.UI.MetricSpinner({el:$("#image-advanced-spin-x"),step:.1,width:85,defaultUnit:"cm",defaultValue:0,value:"0 cm",maxValue:55.87,minValue:-55.87}),this.spinners.push(this.spnX),this.spnY=new Common.UI.MetricSpinner({el:$("#image-advanced-spin-y"),step:.1,width:85,defaultUnit:"cm",defaultValue:0,value:"0 cm",maxValue:55.87,minValue:-55.87}),this.spinners.push(this.spnY),this.cmbFromX=new Common.UI.ComboBox({el:$("#image-advanced-combo-from-x"),cls:"input-group-nr",style:"width: 125px;",menuStyle:"min-width: 125px;",data:[{value:"left",displayValue:this.textTopLeftCorner},{value:"center",displayValue:this.textCenter}],editable:!1,takeFocusOnClose:!0}),this.cmbFromY=new Common.UI.ComboBox({el:$("#image-advanced-combo-from-y"),cls:"input-group-nr",style:"width: 125px;",menuStyle:"min-width: 125px;",data:[{value:"left",displayValue:this.textTopLeftCorner},{value:"center",displayValue:this.textCenter}],editable:!1,takeFocusOnClose:!0}),this.spnAngle=new Common.UI.MetricSpinner({el:$("#image-advanced-spin-angle"),step:1,width:80,defaultUnit:"",value:"0 ",maxValue:3600,minValue:-3600}),this.chFlipHor=new Common.UI.CheckBox({el:$("#image-advanced-checkbox-hor"),labelText:this.textHorizontally}),this.chFlipVert=new Common.UI.CheckBox({el:$("#image-advanced-checkbox-vert"),labelText:this.textVertically}),this.inputAltTitle=new Common.UI.InputField({el:$("#image-advanced-alt-title"),allowBlank:!0,validateOnBlur:!1,style:"width: 100%;"}).on("changed:after",(function(){t.isAltTitleChanged=!0})),this.textareaAltDescription=this.$window.find("textarea"),this.textareaAltDescription.keydown((function(e){e.keyCode==Common.UI.Keys.RETURN&&e.stopPropagation(),t.isAltDescChanged=!0})),this.afterRender()},getFocusedComponents:function(){return this.btnsCategory.concat([this.inputImageName,this.spnWidth,this.btnRatio,this.spnHeight,this.btnOriginalSize,this.spnX,this.cmbFromX,this.spnY,this.cmbFromY,this.spnAngle,this.chFlipHor,this.chFlipVert,this.inputAltTitle,this.textareaAltDescription]).concat(this.getFooterButtons())},onCategoryClick:function(t,e){Common.Views.AdvancedSettingsWindow.prototype.onCategoryClick.call(this,t,e);var i=this;setTimeout((function(){switch(e){case 0:i.inputImageName.focus();break;case 1:i.spnWidth.focus();break;case 2:i.spnAngle.focus();break;case 3:i.inputAltTitle.focus()}}),10)},afterRender:function(){if(this.updateMetricUnit(),this._setDefaults(this._originalProps),this.storageName){var t=Common.localStorage.getItem(this.storageName);this.setActiveCategory(null!==t?parseInt(t):0)}},_setDefaults:function(t){if(t){var e=t.asc_getName();if(this.inputImageName.setValue(e||""),this.spnWidth.setMaxValue(this.sizeMax.width),this.spnHeight.setMaxValue(this.sizeMax.height),e=t.get_Width(),this.spnWidth.setValue(void 0!==e?Common.Utils.Metric.fnRecalcFromMM(e).toFixed(2):"",!0),e=t.get_Height(),this.spnHeight.setValue(void 0!==e?Common.Utils.Metric.fnRecalcFromMM(e).toFixed(2):"",!0),this.btnOriginalSize.setDisabled(null===t.get_ImageUrl()||void 0===t.get_ImageUrl()),e=t.asc_getLockAspect(),this.btnRatio.toggle(e),t.get_Height()>0&&(this._nRatio=t.get_Width()/t.get_Height()),this.cmbFromX.setValue("left"),this.cmbFromY.setValue("left"),t.get_Position()){var i={X:t.get_Position().get_X(),Y:t.get_Position().get_Y()};this.spnX.setValue(null!=i.X?Common.Utils.Metric.fnRecalcFromMM(i.X):"",!0),this.spnY.setValue(null!=i.Y?Common.Utils.Metric.fnRecalcFromMM(i.Y):"",!0)}else this.spnX.setValue("",!0),this.spnY.setValue("",!0);e=t.asc_getRot(),this.spnAngle.setValue(null==e||null===e?"":Math.floor(180*e/3.14159265358979+.5),!0),this.chFlipHor.setValue(t.asc_getFlipH()),this.chFlipVert.setValue(t.asc_getFlipV()),e=t.asc_getTitle(),this.inputAltTitle.setValue(e||""),e=t.asc_getDescription(),this.textareaAltDescription.val(e||"");var s=t.asc_getPluginGuid();this.btnsCategory[2].setVisible(null==s)}},getSettings:function(){var t=new Asc.asc_CImgProperty;this.isImgNameChanged&&t.asc_putName(this.inputImageName.getValue()),""!==this.spnHeight.getValue()&&t.put_Height(Common.Utils.Metric.fnRecalcToMM(this.spnHeight.getNumberValue())),""!==this.spnWidth.getValue()&&t.put_Width(Common.Utils.Metric.fnRecalcToMM(this.spnWidth.getNumberValue())),t.asc_putLockAspect(this.btnRatio.pressed),t.put_ResetCrop(this._isDefaultSize);var e=new Asc.CPosition;if(""!==this.spnX.getValue()){var i=Common.Utils.Metric.fnRecalcToMM(this.spnX.getNumberValue());"center"===this.cmbFromX.getValue()&&(i=this.slideSize.width/36e3/2+i),e.put_X(i)}if(""!==this.spnY.getValue()){var s=Common.Utils.Metric.fnRecalcToMM(this.spnY.getNumberValue());"center"===this.cmbFromY.getValue()&&(s=this.slideSize.height/36e3/2+s),e.put_Y(s)}return t.put_Position(e),this.isAltTitleChanged&&t.asc_putTitle(this.inputAltTitle.getValue()),this.isAltDescChanged&&t.asc_putDescription(this.textareaAltDescription.val()),t.asc_putRot(3.14159265358979*this.spnAngle.getNumberValue()/180),t.asc_putFlipH("checked"==this.chFlipHor.getValue()),t.asc_putFlipV("checked"==this.chFlipVert.getValue()),{imageProps:t}},updateMetricUnit:function(){if(this.spinners)for(var t=0;t<this.spinners.length;t++){var e=this.spinners[t];e.setDefaultUnit(Common.Utils.Metric.getCurrentMetricName()),e.setStep(Common.Utils.Metric.getCurrentMetric()==Common.Utils.Metric.c_MetricUnits.pt?1:.1)}this.sizeMax={width:Common.Utils.Metric.fnRecalcFromMM(10*this.options.sizeMax.width),height:Common.Utils.Metric.fnRecalcFromMM(10*this.options.sizeMax.height)},this.options.sizeOriginal&&(this.sizeOriginal={width:Common.Utils.Metric.fnRecalcFromMM(this.options.sizeOriginal.width),height:Common.Utils.Metric.fnRecalcFromMM(this.options.sizeOriginal.height)})},textOriginalSize:"Actual Size",textPosition:"Position",textSize:"Size",textWidth:"Width",textHeight:"Height",textTitle:"Image - Advanced Settings",textKeepRatio:"Constant Proportions",textPlacement:"Placement",textAlt:"Alternative Text",textAltTitle:"Title",textAltDescription:"Description",textAltTip:"The alternative text-based representation of the visual object information, which will be read to the people with vision or cognitive impairments to help them better understand what information there is in the image, autoshape, chart or table.",textRotation:"Rotation",textAngle:"Angle",textFlipped:"Flipped",textHorizontally:"Horizontally",textVertically:"Vertically",textHorizontal:"Horizontal",textVertical:"Vertical",textFrom:"From",textTopLeftCorner:"Top Left Corner",textCenter:"Center",textGeneral:"General",textImageName:"Image name"},PDFE.Views.ImageSettingsAdvanced||{}))})),void 0===Common)Common={};var c_oHyperlinkType={InternalLink:0,WebLink:1};define("pdfeditor/main/app/view/HyperlinkSettingsDialog",[],(function(){"use strict";PDFE.Views.HyperlinkSettingsDialog=Common.UI.Window.extend(_.extend({options:{width:350,style:"min-width: 230px;",cls:"modal-dlg",id:"window-hyperlink-settings",buttons:["ok","cancel"]},initialize:function(t){_.extend(this.options,{title:this.textTitle},t||{}),this.template=['<div class="box" style="height: 330px;">','<div style="margin-bottom: 10px;">','<button type="button" class="btn btn-text-default auto" id="id-dlg-hyperlink-external">',this.textExternalLink,"</button>",'<button type="button" class="btn btn-text-default auto" id="id-dlg-hyperlink-internal">',this.textInternalLink,"</button>","</div>",'<div id="id-external-link">','<div class="input-row">',"<label>"+this.strLinkTo+"</label>","</div>",'<div id="id-dlg-hyperlink-url" class="input-row" style="margin-bottom: 5px;"></div>',"</div>",'<div id="id-internal-link" class="hidden">','<div class="input-row">',"<label>"+this.strLinkTo+"</label>","</div>",'<div id="id-dlg-hyperlink-list" style="width:100%; height: 171px;"></div>',"</div>",'<div class="input-row">',"<label>"+this.strDisplay+"</label>","</div>",'<div id="id-dlg-hyperlink-display" class="input-row" style="margin-bottom: 5px;"></div>','<div class="input-row">',"<label>"+this.textTipText+"</label>","</div>",'<div id="id-dlg-hyperlink-tip" class="input-row" style="margin-bottom: 5px;"></div>',"</div>"].join(""),this.options.tpl=_.template(this.template)(this.options),this.slides=this.options.slides,this.api=this.options.api,this.urlType=AscCommon.c_oAscUrlType.Invalid,this.appOptions=this.options.appOptions,Common.UI.Window.prototype.initialize.call(this,this.options)},render:function(){Common.UI.Window.prototype.render.call(this);var t=this,e=this.getChild();t.btnExternal=new Common.UI.Button({el:$("#id-dlg-hyperlink-external"),enableToggle:!0,toggleGroup:"hyperlink-type",allowDepress:!1,pressed:!0}),t.btnExternal.on("click",_.bind(t.onLinkTypeClick,t,c_oHyperlinkType.WebLink)),t.btnInternal=new Common.UI.Button({el:$("#id-dlg-hyperlink-internal"),enableToggle:!0,toggleGroup:"hyperlink-type",allowDepress:!1}),t.btnInternal.on("click",_.bind(t.onLinkTypeClick,t,c_oHyperlinkType.InternalLink)),Common.UI.GroupedButtons([t.btnExternal,t.btnInternal]);var i={el:$("#id-dlg-hyperlink-url"),allowBlank:!1,blankError:t.txtEmpty,validateOnBlur:!1,style:"width: 100%;",iconCls:"toolbar__icon btn-browse",placeHolder:t.appOptions.isDesktopApp?t.txtUrlPlaceholder:"",btnHint:t.textSelectFile,validation:function(e){var i=$.trim(e);return i.length>2083?t.txtSizeLimit:(t.urlType=t.api.asc_getUrlType(i),t.urlType!==AscCommon.c_oAscUrlType.Invalid||t.txtNotUrl)}};t.inputUrl=t.appOptions.isDesktopApp?new Common.UI.InputFieldBtn(i):new Common.UI.InputField(i),t.inputUrl._input.on("input",(function(e){t.isInputFirstChange&&t.inputUrl.showError(),t.isInputFirstChange=!1;var i=$(e.target).val();t.isAutoUpdate&&(t.inputDisplay.setValue(i),t.isTextChanged=!0),t.btnOk.setDisabled(""==$.trim(i))})),t.appOptions.isDesktopApp&&t.inputUrl.on("button:click",_.bind(t.onSelectFile,t)),t.inputDisplay=new Common.UI.InputField({el:$("#id-dlg-hyperlink-display"),allowBlank:!0,validateOnBlur:!1,style:"width: 100%;"}).on("changed:after",(function(){t.isTextChanged=!0})),t.inputDisplay._input.on("input",(function(e){t.isAutoUpdate=""==$(e.target).val()})),t.inputTip=new Common.UI.InputField({el:$("#id-dlg-hyperlink-tip"),style:"width: 100%;",maxLength:Asc.c_oAscMaxTooltipLength}),t.internalList=new Common.UI.TreeView({el:$("#id-dlg-hyperlink-list"),store:new Common.UI.TreeViewStore,enableKeyEvents:!0,tabindex:1}),t.internalList.on("item:select",_.bind(this.onSelectItem,this)),t.btnOk=_.find(this.getFooterButtons(),(function(t){return t.$el&&t.$el.find(".primary").addBack().filter(".primary").length>0}))||new Common.UI.Button({el:e.find(".primary")}),t.btnOk.setDisabled(!0),e.find(".dlg-btn").on("click",_.bind(this.onBtnClick,this)),t.internalList.on("entervalue",_.bind(t.onPrimary,t)),t.externalPanel=e.find("#id-external-link"),t.internalPanel=e.find("#id-internal-link")},getFocusedComponents:function(){return[this.btnExternal,this.btnInternal,this.inputUrl,this.internalList,this.inputDisplay,this.inputTip].concat(this.getFooterButtons())},setSettings:function(t){if(t){var e=this,i=e.parseUrl(t.get_Value());i==c_oHyperlinkType.WebLink?e.btnExternal.toggle(!0):e.btnInternal.toggle(!0),e.ShowHideElem(i,t.get_Value()),null!==t.get_Text()?(e.inputDisplay.setValue(t.get_Text()),e.inputDisplay.setDisabled(!1),e.isAutoUpdate=""==e.inputDisplay.getValue()||i==c_oHyperlinkType.WebLink&&e.inputUrl.getValue()==e.inputDisplay.getValue()):(this.inputDisplay.setValue(this.textDefault),this.inputDisplay.setDisabled(!0)),this.isTextChanged=!1,this.inputTip.setValue(t.get_ToolTip()),e._originalProps=t}},getSettings:function(){var t=this,e=new Asc.CHyperlinkProperty,i="",s=this.btnExternal.isActive()?c_oHyperlinkType.WebLink:c_oHyperlinkType.InternalLink;if(s==c_oHyperlinkType.InternalLink){var n="ppaction://hlink",a="",o=t.inputTip.getValue(),l=this.internalList.getSelectedRec();l&&(n+=l.get("type"),a=l.get("tiptext")),e.put_Value(n),e.put_ToolTip(_.isEmpty(o)?a:o),i=a}else{n=$.trim(t.inputUrl.getValue());t.urlType===AscCommon.c_oAscUrlType.Unsafe||/(((^https?)|(^ftp)):\/\/)|(^mailto:)/i.test(n)||(n=(t.urlType==AscCommon.c_oAscUrlType.Email?"mailto:":"http://")+n),n=n.replace(new RegExp("%20","g")," "),e.put_Value(n),e.put_ToolTip(t.inputTip.getValue()),i=n}return t.inputDisplay.isDisabled()||!t.isTextChanged&&!_.isEmpty(t.inputDisplay.getValue())?e.put_Text(null):((_.isEmpty(t.inputDisplay.getValue())||s==c_oHyperlinkType.WebLink&&t.isAutoUpdate)&&t.inputDisplay.setValue(i),e.put_Text(t.inputDisplay.getValue())),e},onBtnClick:function(t){t.currentTarget&&t.currentTarget.attributes.result&&this._handleInput(t.currentTarget.attributes.result.value)},onPrimary:function(t){return this._handleInput("ok"),!1},_handleInput:function(t){if(this.options.handler){if("ok"==t){var e=!this.btnExternal.isActive()||this.inputUrl.checkValidate(),i=this.inputDisplay.checkValidate();if(!0!==e)return this.isInputFirstChange=!0,void this.inputUrl.focus();if(!0!==i)return void this.inputDisplay.focus();!this._originalProps.get_Value()&&Common.Utils.InternalSettings.set("pdfe-settings-link-type",this.btnInternal.isActive())}this.options.handler.call(this,this,t)}this.close()},ShowHideElem:function(t,e){if(this.externalPanel.toggleClass("hidden",t!==c_oHyperlinkType.WebLink),this.internalPanel.toggleClass("hidden",t!==c_oHyperlinkType.InternalLink),t==c_oHyperlinkType.InternalLink){null!=e&&""!=e||(e="ppaction://hlinkshowjump?jump=firstslide");var i=this.internalList.store;if(i.length<1){var s=[],n=0;s.push(new Common.UI.TreeViewModel({name:this.txtFirst,level:0,index:n++,hasParent:!1,isEmptyItem:!1,isNotHeader:!0,hasSubItems:!1,type:"showjump?jump=firstslide",tiptext:this.txtFirst,selected:"ppaction://hlinkshowjump?jump=firstslide"==e})),s.push(new Common.UI.TreeViewModel({name:this.txtLast,level:0,index:n++,hasParent:!1,isEmptyItem:!1,isNotHeader:!0,hasSubItems:!1,type:"showjump?jump=lastslide",tiptext:this.txtLast,selected:"ppaction://hlinkshowjump?jump=lastslide"==e})),s.push(new Common.UI.TreeViewModel({name:this.txtNext,level:0,index:n++,hasParent:!1,isEmptyItem:!1,isNotHeader:!0,hasSubItems:!1,type:"showjump?jump=nextslide",tiptext:this.txtNext,selected:"ppaction://hlinkshowjump?jump=nextslide"==e})),s.push(new Common.UI.TreeViewModel({name:this.txtPrev,level:0,index:n++,hasParent:!1,isEmptyItem:!1,isNotHeader:!0,hasSubItems:!1,type:"showjump?jump=previousslide",tiptext:this.txtPrev,selected:"ppaction://hlinkshowjump?jump=previousslide"==e})),s.push(new Common.UI.TreeViewModel({name:this.textPages,level:0,index:n++,hasParent:!1,isEmptyItem:!1,isNotHeader:!0,hasSubItems:this.api.getCountPages()>0}));var a="ppaction://hlinksldjumpslide",o=0==e.indexOf(a)?parseInt(e.substring(28)):-1;for(n=0;n<this.api.getCountPages();n++)s.push(new Common.UI.TreeViewModel({name:this.txtPage+" "+(n+1),level:1,index:s.length,hasParent:!1,isEmptyItem:!1,isNotHeader:!0,hasSubItems:!1,type:"sldjumpslide"+n,tiptext:this.txtPage+" "+(n+1),selected:n==o}));i.reset(s)}var l=this.internalList.getSelectedRec();l&&this.internalList.scrollToRecord(l),this.btnOk.setDisabled(!l||4==l.get("index"));var r=this;_.delay((function(){r.inputDisplay.focus()}),50)}else{this.btnOk.setDisabled(""==$.trim(this.inputUrl.getValue()));r=this;_.delay((function(){r.inputUrl.focus()}),50)}},onLinkTypeClick:function(t,e,i){if(this.ShowHideElem(t),this.isAutoUpdate){if(t==c_oHyperlinkType.InternalLink){var s=this.internalList.getSelectedRec();this.inputDisplay.setValue(s&&(s.get("level")||s.get("index")<4)?s.get("name"):"")}else this.inputDisplay.setValue(this.inputUrl.getValue());this.isTextChanged=!0}},parseUrl:function(t){return null==t||""==t?Common.Utils.InternalSettings.get("pdfe-settings-link-type")?c_oHyperlinkType.InternalLink:c_oHyperlinkType.WebLink:0==t.indexOf("ppaction://hlink")?c_oHyperlinkType.InternalLink:(this.inputUrl.setValue(t?t.replace(new RegExp(" ","g"),"%20"):""),c_oHyperlinkType.WebLink)},onSelectItem:function(t,e,i,s){i&&(this.btnOk.setDisabled(4==i.get("index")),this.isAutoUpdate&&(this.inputDisplay.setValue(i.get("level")||i.get("index")<4?i.get("name"):""),this.isTextChanged=!0))},onSelectFile:function(){var t=this;if(t.api){t.api.asc_getFilePath((function(e){e&&(t.inputUrl.setValue(e),!0!==t.inputUrl.checkValidate()&&(t.isInputFirstChange=!0),t.isAutoUpdate&&(t.inputDisplay.setValue(e),t.isTextChanged=!0),t.btnOk.setDisabled(""==$.trim(e)))}))}},textTitle:"Hyperlink Settings",textInternalLink:"Place in Document",textExternalLink:"External Link",textEmptyLink:"Enter link here",textEmptyDesc:"Enter caption here",textEmptyTooltip:"Enter tooltip here",txtPage:"Page",strDisplay:"Display",textTipText:"Screen Tip Text",strLinkTo:"Link To",txtEmpty:"This field is required",txtNotUrl:'This field should be a URL in the format "http://www.example.com"',txtNext:"Next Page",txtPrev:"Previous Page",txtFirst:"First Page",txtLast:"Last Page",textDefault:"Selected text",textPages:"Pages",txtSizeLimit:"This field is limited to 2083 characters",txtUrlPlaceholder:"Enter the web address or select a file",textSelectFile:"Select file"},PDFE.Views.HyperlinkSettingsDialog||{}))})),define("text!pdfeditor/main/app/template/ShapeSettingsAdvanced.template",[],(function(){return'<div id="id-adv-shape-general" class="settings-panel active">\n    <div class="inner-content">\n    <table cols="1" width="100%">\n        <tr>\n            <td class="padding-large">\n                <label class="header"><%= scope.textShapeName %></label>\n                <div id="shape-general-object-name"></div>\n            </td>\n        </tr>\n    </table>\n    </div>\n</div>\n<div id="id-adv-shape-width" class="settings-panel active">\n    <div class="inner-content">\n        <table cols="3">\n            <tr>\n                <td colspan="3" width="88px" class="padding-small">\n                    <label class="header"><%= scope.textSize %></label>\n                </td>\n            </tr>\n            <tr>\n                <td width="93px">\n                    <label class="input-label"><%= scope.textWidth %></label>\n                    <div id="shape-advanced-spin-width"></div>\n                </td>\n                <td width="28px" style="vertical-align: bottom;">\n                    <div id="shape-advanced-button-ratio"></div>\n                </td>\n                <td width="93px">\n                    <label class="input-label"><%= scope.textHeight %></label>\n                    <div id="shape-advanced-spin-height"></div>\n                </td>\n            </tr>\n        </table>\n    </div>\n    <div class="padding-large"></div>\n    <div class="inner-content">\n        <table cols="2" style="width: 100%;">\n            <tr>\n                <td colspan="4" width="88px" class="padding-small">\n                    <label class="header"><%= scope.textPosition %></label>\n                </td>\n            </tr>\n            <tr>\n                <td class="padding-small" width="121px">\n                    <label class="input-label"><%= scope.textHorizontal %></label>\n                    <div id="shape-advanced-spin-x"></div>\n                </td>\n                <td class="padding-small">\n                    <label class="input-label"><%= scope.textFrom %></label>\n                    <div id="shape-advanced-combo-from-x"></div>\n                </td>\n            </tr>\n            <tr>\n                <td class="padding-small">\n                    <label class="input-label"><%= scope.textVertical %></label>\n                    <div id="shape-advanced-spin-y"></div>\n                </td>\n                <td class="padding-small">\n                    <label class="input-label"><%= scope.textFrom %></label>\n                    <div id="shape-advanced-combo-from-y"></div>\n                </td>\n            </tr>\n        </table>\n    </div>\n</div>\n<div id="id-adv-shape-rotate" class="settings-panel active">\n    <div class="inner-content  padding-large">\n        <div style="width: 100%;">\n            <label class="input-label"><%= scope.textAngle %></label>\n            <div id="shape-advanced-spin-angle" class="margin-left-5" style="display: inline-block;"></div>\n        </div>\n    </div>\n    <div class="separator horizontal padding-large"></div>\n    <div class="inner-content  padding-large">\n        <table cols="2">\n            <tr>\n                <td rowspan="2" class="padding-small" style="vertical-align: top;">\n                    <label class="input-label margin-right-15" style="vertical-align: top;"><%= scope.textFlipped %></label>\n                </td>\n                <td class="padding-small">\n                    <div id="shape-advanced-checkbox-hor"></div>\n                </td>\n            </tr>\n            <tr>\n                <td class="padding-small">\n                    <div id="shape-advanced-checkbox-vert"></div>\n                </td>\n            </tr>\n        </table>\n    </div>\n</div>\n<div id="id-adv-shape-shape" class="settings-panel">\n    <div class="inner-content">\n        <table cols="2" style="width: 100%;">\n            <tr>\n                <td colspan=2 class="padding-small">\n                    <label class="header"><%= scope.textLineStyle %></label>\n                </td>\n            </tr>\n            <tr>\n                <td class="padding-large" width="125px">\n                    <label class="input-label"><%= scope.textCapType %></label>\n                    <div id="shape-advanced-cap-type" style="width: 100px;"></div>\n                </td>\n                <td class="padding-large">\n                    <label class="input-label"><%= scope.textJoinType %></label>\n                    <div id="shape-advanced-join-type" style="width: 100px;"></div>\n                </td>\n            </tr>\n        </table>\n    </div>\n    <div class="separator horizontal padding-large"></div>\n    <div class="inner-content">\n        <table cols="2" style="width: 100%;">\n            <tr>\n                <td colspan=2 class="padding-small">\n                    <label class="header"><%= scope.textArrows %></label>\n                </td>\n            </tr>\n            <tr>\n                <td class="padding-small" width="125px">\n                    <label class="input-label"><%= scope.textBeginStyle %></label>\n                    <div id="shape-advanced-begin-style" style="width: 100px;"></div>\n                </td>\n                <td class="padding-small">\n                    <label class="input-label"><%= scope.textEndStyle %></label>\n                    <div id="shape-advanced-end-style" style="width: 100px;"></div>\n                </td>\n            </tr>\n            <tr>\n                <td class="padding-small">\n                    <label class="input-label"><%= scope.textBeginSize %></label>\n                    <div id="shape-advanced-begin-size" style="width: 100px;"></div>\n                </td>\n                <td class="padding-small">\n                    <label class="input-label"><%= scope.textEndSize %></label>\n                    <div id="shape-advanced-end-size" style="width: 100px;"></div>\n                </td>\n            </tr>\n        </table>\n    </div>\n</div>\n<div id="id-adv-shape-margins" class="settings-panel">\n    <div class="inner-content">\n        <table cols="1" style="width: 100%;">\n            <tr>\n                <td class="padding-small">\n                    <label class="header"><%= scope.textAutofit %></label>\n                </td>\n            </tr>\n            <tr>\n                <td class="padding-small">\n                    <div id="shape-radio-nofit"></div>\n                </td>\n            </tr>\n            <tr>\n                <td class="padding-small">\n                    <div id="shape-radio-shrink"></div>\n                </td>\n            </tr>\n            <tr>\n                <td class="padding-large">\n                    <div id="shape-radio-fit"></div>\n                </td>\n            </tr>\n        </table>\n        <div class="separator horizontal padding-large"></div>\n        <table cols="2" style="width: 100%;">\n            <tr>\n                <td colspan=2 class="padding-small">\n                    <label class="header"><%= scope.strMargins %></label>\n                </td>\n            </tr>\n            <tr>\n                <td class="padding-small" width="125px">\n                    <label class="input-label"><%= scope.textTop %></label>\n                    <div id="shape-margin-top"></div>\n                </td>\n                <td class="padding-small">\n                    <label class="input-label"><%= scope.textLeft %></label>\n                    <div id="shape-margin-left"></div>\n                </td>\n            </tr>\n            <tr>\n                <td class="padding-small">\n                    <label class="input-label"><%= scope.textBottom %></label>\n                    <div id="shape-margin-bottom"></div>\n                </td>\n                <td class="padding-small">\n                    <label class="input-label"><%= scope.textRight %></label>\n                    <div id="shape-margin-right"></div>\n                </td>\n            </tr>\n        </table>\n    </div>\n</div>\n<div id="id-adv-shape-columns" class="settings-panel">\n    <div class="inner-content">\n        <table cols="1" style="width: 100%;">\n            <tr>\n                <td class="padding-small">\n                    <label class="input-label"><%= scope.textColNumber %></label>\n                    <div id="shape-columns-number"></div>\n                </td>\n            </tr>\n            <tr>\n                <td class="padding-small">\n                    <label class="input-label"><%= scope.textSpacing %></label>\n                    <div id="shape-columns-spacing"></div>\n                </td>\n            </tr>\n        </table>\n    </div>\n</div>\n<div id="id-adv-shape-alttext" class="settings-panel">\n    <div class="inner-content">\n        <table cols="1" width="100%">\n            <tr>\n                <td class="padding-large">\n                    <label class="header"><%= scope.textAltTitle %></label>\n                    <div id="shape-advanced-alt-title"></div>\n                </td>\n            </tr>\n            <tr>\n                <td>\n                    <label class="header"><%= scope.textAltDescription %></label>\n                    <textarea id="shape-advanced-alt-description" class="form-control" style="width: 100%; height: 70px;"></textarea>\n                </td>\n            </tr>\n            <tr>\n                <td>\n                    <label><%= scope.textAltTip %></label>\n                </td>\n            </tr>\n        </table>\n    </div>\n</div>'})),define("pdfeditor/main/app/view/ShapeSettingsAdvanced",["text!pdfeditor/main/app/template/ShapeSettingsAdvanced.template","common/main/lib/view/AdvancedSettingsWindow"],(function(t){"use strict";PDFE.Views.ShapeSettingsAdvanced=Common.Views.AdvancedSettingsWindow.extend(_.extend({options:{contentWidth:300,contentHeight:270,toggleGroup:"shape-adv-settings-group",sizeOriginal:{width:0,height:0},sizeMax:{width:55.88,height:55.88},properties:null,storageName:"pdfe-shape-settings-adv-category"},initialize:function(e){_.extend(this.options,{title:this.textTitle,items:[{panelId:"id-adv-shape-general",panelCaption:this.textGeneral},{panelId:"id-adv-shape-width",panelCaption:this.textPlacement},{panelId:"id-adv-shape-rotate",panelCaption:this.textRotation},{panelId:"id-adv-shape-shape",panelCaption:this.textWeightArrows},{panelId:"id-adv-shape-margins",panelCaption:this.textTextBox},{panelId:"id-adv-shape-columns",panelCaption:this.strColumns},{panelId:"id-adv-shape-alttext",panelCaption:this.textAlt}],contentTemplate:_.template(t)({scope:this})},e),Common.Views.AdvancedSettingsWindow.prototype.initialize.call(this,this.options),this.spinners=[],this.Margins=void 0,this._nRatio=1,this._originalProps=this.options.shapeProps,this.slideSize=this.options.slideSize,this._changedProps=null},render:function(){Common.Views.AdvancedSettingsWindow.prototype.render.call(this);var t=this;this.inputShapeName=new Common.UI.InputField({el:$("#shape-general-object-name"),allowBlank:!0,validateOnBlur:!1,style:"width: 100%;"}).on("changed:after",(function(){t.isShapeNameChanged=!0})),this.spnWidth=new Common.UI.MetricSpinner({el:$("#shape-advanced-spin-width"),step:.1,width:85,defaultUnit:"cm",value:"3 cm",maxValue:55.88,minValue:0}),this.spnWidth.on("change",_.bind((function(t,e,i,s){if(this.btnRatio.pressed){var n=t.getNumberValue(),a=n/this._nRatio;a>this.sizeMax.height&&(n=(a=this.sizeMax.height)*this._nRatio,this.spnWidth.setValue(n,!0)),this.spnHeight.setValue(a,!0)}this._changedProps&&(this._changedProps.put_Width(Common.Utils.Metric.fnRecalcToMM(t.getNumberValue())),this._changedProps.put_Height(Common.Utils.Metric.fnRecalcToMM(this.spnHeight.getNumberValue())))}),this)),this.spinners.push(this.spnWidth),this.spnHeight=new Common.UI.MetricSpinner({el:$("#shape-advanced-spin-height"),step:.1,width:85,defaultUnit:"cm",value:"3 cm",maxValue:55.88,minValue:0}),this.spnHeight.on("change",_.bind((function(t,e,i,s){var n=t.getNumberValue(),a=null;this.btnRatio.pressed&&((a=n*this._nRatio)>this.sizeMax.width&&(n=(a=this.sizeMax.width)/this._nRatio,this.spnHeight.setValue(n,!0)),this.spnWidth.setValue(a,!0)),this._changedProps&&(this._changedProps.put_Height(Common.Utils.Metric.fnRecalcToMM(t.getNumberValue())),this._changedProps.put_Width(Common.Utils.Metric.fnRecalcToMM(this.spnWidth.getNumberValue())))}),this)),this.spinners.push(this.spnHeight),this.btnRatio=new Common.UI.Button({parentEl:$("#shape-advanced-button-ratio"),cls:"btn-toolbar",iconCls:"toolbar__icon btn-advanced-ratio",style:"margin-bottom: 1px;",enableToggle:!0,hint:this.textKeepRatio}),this.btnRatio.on("click",_.bind((function(t,e){t.pressed&&this.spnHeight.getNumberValue()>0&&(this._nRatio=this.spnWidth.getNumberValue()/this.spnHeight.getNumberValue()),this._changedProps&&this._changedProps.asc_putLockAspect(t.pressed)}),this)),this.spnX=new Common.UI.MetricSpinner({el:$("#shape-advanced-spin-x"),step:.1,width:85,defaultUnit:"cm",defaultValue:0,value:"0 cm",maxValue:55.87,minValue:-55.87}),this.spinners.push(this.spnX),this.spnY=new Common.UI.MetricSpinner({el:$("#shape-advanced-spin-y"),step:.1,width:85,defaultUnit:"cm",defaultValue:0,value:"0 cm",maxValue:55.87,minValue:-55.87}),this.spinners.push(this.spnY),this.cmbFromX=new Common.UI.ComboBox({el:$("#shape-advanced-combo-from-x"),cls:"input-group-nr",style:"width: 125px;",menuStyle:"min-width: 125px;",data:[{value:"left",displayValue:this.textTopLeftCorner},{value:"center",displayValue:this.textCenter}],editable:!1,takeFocusOnClose:!0}),this.cmbFromY=new Common.UI.ComboBox({el:$("#shape-advanced-combo-from-y"),cls:"input-group-nr",style:"width: 125px;",menuStyle:"min-width: 125px;",data:[{value:"left",displayValue:this.textTopLeftCorner},{value:"center",displayValue:this.textCenter}],editable:!1,takeFocusOnClose:!0}),this.spnMarginTop=new Common.UI.MetricSpinner({el:$("#shape-margin-top"),step:.1,width:100,defaultUnit:"cm",value:"0 cm",maxValue:55.87,minValue:0}),this.spnMarginTop.on("change",_.bind((function(t,e,i,s){this._changedProps&&(null!==this._changedProps.get_paddings()&&void 0!==this._changedProps.get_paddings()||this._changedProps.put_paddings(new Asc.asc_CPaddings),this._changedProps.get_paddings().put_Top(Common.Utils.Metric.fnRecalcToMM(t.getNumberValue())))}),this)),this.spinners.push(this.spnMarginTop),this.spnMarginBottom=new Common.UI.MetricSpinner({el:$("#shape-margin-bottom"),step:.1,width:100,defaultUnit:"cm",value:"0 cm",maxValue:55.87,minValue:0}),this.spnMarginBottom.on("change",_.bind((function(t,e,i,s){this._changedProps&&(null!==this._changedProps.get_paddings()&&void 0!==this._changedProps.get_paddings()||this._changedProps.put_paddings(new Asc.asc_CPaddings),this._changedProps.get_paddings().put_Bottom(Common.Utils.Metric.fnRecalcToMM(t.getNumberValue())))}),this)),this.spinners.push(this.spnMarginBottom),this.spnMarginLeft=new Common.UI.MetricSpinner({el:$("#shape-margin-left"),step:.1,width:100,defaultUnit:"cm",value:"0.19 cm",maxValue:55.87,minValue:0}),this.spnMarginLeft.on("change",_.bind((function(t,e,i,s){this._changedProps&&(null!==this._changedProps.get_paddings()&&void 0!==this._changedProps.get_paddings()||this._changedProps.put_paddings(new Asc.asc_CPaddings),this._changedProps.get_paddings().put_Left(Common.Utils.Metric.fnRecalcToMM(t.getNumberValue())))}),this)),this.spinners.push(this.spnMarginLeft),this.spnMarginRight=new Common.UI.MetricSpinner({el:$("#shape-margin-right"),step:.1,width:100,defaultUnit:"cm",value:"0.19 cm",maxValue:55.87,minValue:0}),this.spnMarginRight.on("change",_.bind((function(t,e,i,s){this._changedProps&&(null!==this._changedProps.get_paddings()&&void 0!==this._changedProps.get_paddings()||this._changedProps.put_paddings(new Asc.asc_CPaddings),this._changedProps.get_paddings().put_Right(Common.Utils.Metric.fnRecalcToMM(t.getNumberValue())))}),this)),this.spinners.push(this.spnMarginRight),this.radioNofit=new Common.UI.RadioBox({el:$("#shape-radio-nofit"),name:"asc-radio-fit",labelText:this.textNofit,value:AscFormat.text_fit_No}),this.radioNofit.on("change",_.bind(this.onRadioFitChange,this)),this.radioShrink=new Common.UI.RadioBox({el:$("#shape-radio-shrink"),name:"asc-radio-fit",labelText:this.textShrink,value:AscFormat.text_fit_NormAuto}),this.radioShrink.on("change",_.bind(this.onRadioFitChange,this)),this.radioFit=new Common.UI.RadioBox({el:$("#shape-radio-fit"),name:"asc-radio-fit",labelText:this.textResizeFit,value:AscFormat.text_fit_Auto}),this.radioFit.on("change",_.bind(this.onRadioFitChange,this)),this.spnAngle=new Common.UI.MetricSpinner({el:$("#shape-advanced-spin-angle"),step:1,width:80,defaultUnit:"",value:"0 ",maxValue:3600,minValue:-3600}),this.chFlipHor=new Common.UI.CheckBox({el:$("#shape-advanced-checkbox-hor"),labelText:this.textHorizontally}),this.chFlipVert=new Common.UI.CheckBox({el:$("#shape-advanced-checkbox-vert"),labelText:this.textVertically}),this._arrCapType=[{displayValue:this.textFlat,value:Asc.c_oAscLineCapType.Flat},{displayValue:this.textRound,value:Asc.c_oAscLineCapType.Round},{displayValue:this.textSquare,value:Asc.c_oAscLineCapType.Square}],this.cmbCapType=new Common.UI.ComboBox({el:$("#shape-advanced-cap-type"),cls:"input-group-nr",menuStyle:"min-width: 100px;",editable:!1,data:this._arrCapType,takeFocusOnClose:!0}),this.cmbCapType.setValue(Asc.c_oAscLineCapType.Flat),this.cmbCapType.on("selected",_.bind((function(t,e){this._changedProps&&(null===this._changedProps.get_stroke()&&this._changedProps.put_stroke(new Asc.asc_CStroke),this._changedProps.get_stroke().put_linecap(e.value))}),this)),this._arrJoinType=[{displayValue:this.textRound,value:Asc.c_oAscLineJoinType.Round},{displayValue:this.textBevel,value:Asc.c_oAscLineJoinType.Bevel},{displayValue:this.textMiter,value:Asc.c_oAscLineJoinType.Miter}],this.cmbJoinType=new Common.UI.ComboBox({el:$("#shape-advanced-join-type"),cls:"input-group-nr",menuStyle:"min-width: 100px;",editable:!1,data:this._arrJoinType,takeFocusOnClose:!0}),this.cmbJoinType.setValue(Asc.c_oAscLineJoinType.Round),this.cmbJoinType.on("selected",_.bind((function(t,e){this._changedProps&&(null===this._changedProps.get_stroke()&&this._changedProps.put_stroke(new Asc.asc_CStroke),this._changedProps.get_stroke().put_linejoin(e.value))}),this));var e=[],i=[];e.push({type:Asc.c_oAscLineBeginType.None,idsvg:"no-"}),e.push({type:Asc.c_oAscLineBeginType.Triangle,idsvg:""}),e.push({type:Asc.c_oAscLineBeginType.Arrow,idsvg:"open-"}),e.push({type:Asc.c_oAscLineBeginType.Stealth,idsvg:"stealth-"}),e.push({type:Asc.c_oAscLineBeginType.Diamond,idsvg:"dimond-"}),e.push({type:Asc.c_oAscLineBeginType.Oval,idsvg:"oval-"});for(var s=0;s<6;s++)e[s].value=s;for(s=0;s<9;s++)i.push({value:s,typearrow:""});for(i[0].type=Asc.c_oAscLineBeginSize.small_small,i[1].type=Asc.c_oAscLineBeginSize.small_mid,i[2].type=Asc.c_oAscLineBeginSize.small_large,i[3].type=Asc.c_oAscLineBeginSize.mid_small,i[4].type=Asc.c_oAscLineBeginSize.mid_mid,i[5].type=Asc.c_oAscLineBeginSize.mid_large,i[6].type=Asc.c_oAscLineBeginSize.large_small,i[7].type=Asc.c_oAscLineBeginSize.large_mid,i[8].type=Asc.c_oAscLineBeginSize.large_large,this.btnBeginStyle=new Common.UI.ComboBoxDataView({el:$("#shape-advanced-begin-style"),additionalAlign:this.menuAddAlign,cls:"combo-arrow-style move-focus",menuStyle:"min-width: 105px;",dataViewStyle:"width: 105px; margin: 0 5px;",store:new Common.UI.DataViewStore(e),formTemplate:_.template(['<div class="form-control" style="width: 100px;">','<i class="img-arrows"><svg><use xlink:href="#no-arrow-5"></use></svg></i>',"</div>"].join("")),itemTemplate:_.template('<div id="<%= id %>" class="item-arrow img-arrows"><svg><use xlink:href= "#<%= idsvg %>arrow-5"></use></svg></div>'),takeFocusOnClose:!0,updateFormControl:this.updateFormControl}),this.btnBeginStyle.on("item:click",_.bind(this.onSelectBeginStyle,this)),this.mnuBeginStylePicker=this.btnBeginStyle.getPicker(),this.btnBeginStyle.updateFormControl(),this.btnBeginSize=new Common.UI.ComboBoxDataView({el:$("#shape-advanced-begin-size"),additionalAlign:this.menuAddAlign,cls:"combo-arrow-style move-focus",menuStyle:"min-width: 105px;",dataViewStyle:"width: 160px; margin: 0 5px;",store:new Common.UI.DataViewStore(i),formTemplate:_.template(['<div class="form-control" style="width: 100px;">','<i class="img-arrows"><svg><use xlink:href=""></use></svg></i>',"</div>"].join("")),itemTemplate:_.template('<div id="<%= id %>" class="item-arrow img-arrows"><svg><use xlink:href="#<%= typearrow %>arrow-<%= (value+1) %>"></use></svg></div>'),takeFocusOnClose:!0,updateFormControl:this.updateFormControl}),this.btnBeginSize.on("item:click",_.bind(this.onSelectBeginSize,this)),this.mnuBeginSizePicker=this.btnBeginSize.getPicker(),this.btnBeginSize.updateFormControl(),s=0;s<e.length;s++)e[s].offsety+=200;for(s=0;s<i.length;s++)i[s].offsety+=200;this.btnEndStyle=new Common.UI.ComboBoxDataView({el:$("#shape-advanced-end-style"),additionalAlign:this.menuAddAlign,cls:"combo-arrow-style move-focus",menuStyle:"min-width: 105px;",dataViewStyle:"width: 105px; margin: 0 5px;",store:new Common.UI.DataViewStore(e),formTemplate:_.template(['<div class="form-control" style="width: 100px;">','<i class="img-arrows"><svg class ="svg-mirror"><use xlink:href="#no-arrow-5"></use></svg></i>',"</div>"].join("")),itemTemplate:_.template('<div id="<%= id %>" class="item-arrow img-arrows"><svg class ="svg-mirror"><use xlink:href="#<%= idsvg %>arrow-5"></use></svg></div>'),takeFocusOnClose:!0,updateFormControl:this.updateFormControl}),this.btnEndStyle.on("item:click",_.bind(this.onSelectEndStyle,this)),this.mnuEndStylePicker=this.btnEndStyle.getPicker(),this.btnEndStyle.updateFormControl(),this.btnEndSize=new Common.UI.ComboBoxDataView({el:$("#shape-advanced-end-size"),additionalAlign:this.menuAddAlign,cls:"combo-arrow-style move-focus",menuStyle:"min-width: 105px;",dataViewStyle:"width: 160px; margin: 0 5px;",store:new Common.UI.DataViewStore(i),formTemplate:_.template(['<div class="form-control" style="width: 100px;">','<i class="img-arrows"><svg class ="svg-mirror"><use xlink:href=""></use></svg></i>',"</div>"].join("")),itemTemplate:_.template('<div id="<%= id %>" class="item-arrow img-arrows"><svg class ="svg-mirror"><use xlink:href="#<%= typearrow %>arrow-<%= (value + 1) %>"></use></svg></div>'),takeFocusOnClose:!0,updateFormControl:this.updateFormControl}),this.btnEndSize.on("item:click",_.bind(this.onSelectEndSize,this)),this.mnuEndSizePicker=this.btnEndSize.getPicker(),this.btnEndSize.updateFormControl(),this.spnColumns=new Common.UI.MetricSpinner({el:$("#shape-columns-number"),step:1,allowDecimal:!1,width:100,defaultUnit:"",value:"1",maxValue:16,minValue:1}),this.spnColumns.on("change",_.bind((function(t,e,i,s){this._changedProps&&this._changedProps.asc_putColumnNumber(t.getNumberValue())}),this)),this.spnSpacing=new Common.UI.MetricSpinner({el:$("#shape-columns-spacing"),step:.1,width:100,defaultUnit:"cm",value:"0 cm",maxValue:40.64,minValue:0}),this.spnSpacing.on("change",_.bind((function(t,e,i,s){this._changedProps&&this._changedProps.asc_putColumnSpace(Common.Utils.Metric.fnRecalcToMM(t.getNumberValue()))}),this)),this.spinners.push(this.spnSpacing),this.inputAltTitle=new Common.UI.InputField({el:$("#shape-advanced-alt-title"),allowBlank:!0,validateOnBlur:!1,style:"width: 100%;"}).on("changed:after",(function(){t.isAltTitleChanged=!0})),this.textareaAltDescription=this.$window.find("textarea"),this.textareaAltDescription.keydown((function(e){e.keyCode==Common.UI.Keys.RETURN&&e.stopPropagation(),t.isAltDescChanged=!0})),this.afterRender()},getFocusedComponents:function(){return this.btnsCategory.concat([this.inputShapeName,this.spnWidth,this.btnRatio,this.spnHeight,this.spnX,this.cmbFromX,this.spnY,this.cmbFromY,this.spnAngle,this.chFlipHor,this.chFlipVert,this.cmbCapType,this.cmbJoinType,this.btnBeginStyle,this.btnEndStyle,this.btnBeginSize,this.btnEndSize,this.radioNofit,this.radioShrink,this.radioFit,this.spnMarginTop,this.spnMarginLeft,this.spnMarginBottom,this.spnMarginRight,this.spnColumns,this.spnSpacing,this.inputAltTitle,this.textareaAltDescription]).concat(this.getFooterButtons())},onCategoryClick:function(t,e){Common.Views.AdvancedSettingsWindow.prototype.onCategoryClick.call(this,t,e);var i=this;setTimeout((function(){switch(e){case 0:i.inputShapeName.focus();break;case 1:i.spnWidth.focus();break;case 2:i.spnAngle.focus();break;case 3:i.cmbCapType.focus();break;case 4:i.spnMarginTop.focus();break;case 5:i.spnColumns.focus();break;case 6:i.inputAltTitle.focus()}}),10)},afterRender:function(){if(this.updateMetricUnit(),this._setDefaults(this._originalProps),this.storageName){var t=Common.localStorage.getItem(this.storageName);this.setActiveCategory(null!==t?parseInt(t):0)}},_setDefaults:function(t){if(t){t.get_FromSmartArt()&&this.btnsCategory[2].setDisabled(!0),t.get_FromSmartArtInternal()&&(this.radioNofit.setDisabled(!0),this.radioShrink.setDisabled(!0),this.radioFit.setDisabled(!0),this.chFlipHor.setDisabled(!0),this.chFlipVert.setDisabled(!0),this.btnsCategory[1].setDisabled(!0));var e=t.asc_getName();if(this.inputShapeName.setValue(e||""),this.spnWidth.setValue(Common.Utils.Metric.fnRecalcFromMM(t.asc_getWidth()).toFixed(2),!0),this.spnHeight.setValue(Common.Utils.Metric.fnRecalcFromMM(t.asc_getHeight()).toFixed(2),!0),t.asc_getHeight()>0&&(this._nRatio=t.asc_getWidth()/t.asc_getHeight()),e=t.asc_getLockAspect(),this.btnRatio.toggle(e||t.get_FromSmartArt()),this.btnRatio.setDisabled(!!t.get_FromSmartArt()),this.cmbFromX.setValue("left"),this.cmbFromY.setValue("left"),t.asc_getPosition()){var i={X:t.asc_getPosition().get_X(),Y:t.asc_getPosition().get_Y()};this.spnX.setValue(null!=i.X?Common.Utils.Metric.fnRecalcFromMM(i.X):"",!0),this.spnY.setValue(null!=i.Y?Common.Utils.Metric.fnRecalcFromMM(i.Y):"",!0)}else this.spnX.setValue("",!0),this.spnY.setValue("",!0);this._setShapeDefaults(t);var s=t.get_paddings();if(s){var n=s.get_Left();this.spnMarginLeft.setValue(null!=n?Common.Utils.Metric.fnRecalcFromMM(n):"",!0),n=s.get_Top(),this.spnMarginTop.setValue(null!=n?Common.Utils.Metric.fnRecalcFromMM(n):"",!0),n=s.get_Right(),this.spnMarginRight.setValue(null!=n?Common.Utils.Metric.fnRecalcFromMM(n):"",!0),n=s.get_Bottom(),this.spnMarginBottom.setValue(null!=n?Common.Utils.Metric.fnRecalcFromMM(n):"",!0)}switch(e=t.asc_getTextFitType()){case AscFormat.text_fit_No:this.radioNofit.setValue(!0,!0);break;case AscFormat.text_fit_Auto:this.radioFit.setValue(!0,!0);break;case AscFormat.text_fit_NormAuto:this.radioShrink.setValue(!0,!0)}this.btnsCategory[4].setDisabled(null===s);var a=t.asc_getType();this.btnsCategory[5].setDisabled(t.get_FromSmartArtInternal()||"line"==a||"bentConnector2"==a||"bentConnector3"==a||"bentConnector4"==a||"bentConnector5"==a||"curvedConnector2"==a||"curvedConnector3"==a||"curvedConnector4"==a||"curvedConnector5"==a||"straightConnector1"==a),e=t.asc_getColumnNumber(),this.spnColumns.setValue(null!=e?e:"",!0),e=t.asc_getColumnSpace(),this.spnSpacing.setValue(null!=e?Common.Utils.Metric.fnRecalcFromMM(e):"",!0),e=t.asc_getTitle(),this.inputAltTitle.setValue(e||""),e=t.asc_getDescription(),this.textareaAltDescription.val(e||""),e=t.asc_getRot(),this.spnAngle.setValue(null==e||null===e?"":Math.floor(180*e/3.14159265358979+.5),!0),e=t.asc_getFlipH(),this.chFlipHor.setValue(null==e||null===e?"indeterminate":e),e=t.asc_getFlipV(),this.chFlipVert.setValue(null==e||null===e?"indeterminate":e),this._changedProps=new Asc.asc_CShapeProperty}},getSettings:function(){this.isShapeNameChanged&&this._changedProps.asc_putName(this.inputShapeName.getValue());var t=new Asc.CPosition;if(""!==this.spnX.getValue()){var e=Common.Utils.Metric.fnRecalcToMM(this.spnX.getNumberValue());"center"===this.cmbFromX.getValue()&&(e=this.slideSize.width/36e3/2+e),t.put_X(e)}if(""!==this.spnY.getValue()){var i=Common.Utils.Metric.fnRecalcToMM(this.spnY.getNumberValue());"center"===this.cmbFromY.getValue()&&(i=this.slideSize.height/36e3/2+i),t.put_Y(i)}return this._changedProps.asc_putPosition(t),this.isAltTitleChanged&&this._changedProps.asc_putTitle(this.inputAltTitle.getValue()),this.isAltDescChanged&&this._changedProps.asc_putDescription(this.textareaAltDescription.val()),this._changedProps.asc_putRot(3.14159265358979*this.spnAngle.getNumberValue()/180),"indeterminate"!==this.chFlipHor.getValue()&&this._changedProps.asc_putFlipH("checked"===this.chFlipHor.getValue()),"indeterminate"!==this.chFlipVert.getValue()&&this._changedProps.asc_putFlipV("checked"===this.chFlipVert.getValue()),Common.localStorage.setItem("pdfe-settings-shaperatio",this.btnRatio.pressed?1:0),{shapeProps:this._changedProps}},_setShapeDefaults:function(t){if(t){var e=t.get_stroke();if(e){this.btnsCategory[3].setDisabled(e.get_type()==Asc.c_oAscStrokeType.STROKE_NONE);for(var i=e.get_linejoin(),s=0;s<this._arrJoinType.length;s++)if(i==this._arrJoinType[s].value){this.cmbJoinType.setValue(i);break}for(i=e.get_linecap(),s=0;s<this._arrCapType.length;s++)if(i==this._arrCapType[s].value){this.cmbCapType.setValue(i);break}var n=e.get_canChangeArrows();if(this.btnBeginStyle.setDisabled(!n),this.btnEndStyle.setDisabled(!n),this.btnBeginSize.setDisabled(!n),this.btnEndSize.setDisabled(!n),n){i=e.get_linebeginsize();var a=this.mnuBeginSizePicker.store.findWhere({type:i});a?this._beginSizeIdx=a.get("value"):(this._beginSizeIdx=null,this.btnBeginSize.updateFormControl()),i=e.get_linebeginstyle(),a=this.mnuBeginStylePicker.store.findWhere({type:i}),this.btnBeginStyle.selectRecord(a),a&&this._updateSizeArr(this.btnBeginSize,this.mnuBeginSizePicker,a,this._beginSizeIdx),i=e.get_lineendsize(),(a=this.mnuEndSizePicker.store.findWhere({type:i}))?this._endSizeIdx=a.get("value"):(this._endSizeIdx=null,this.btnEndSize.updateFormControl()),i=e.get_lineendstyle(),a=this.mnuEndStylePicker.store.findWhere({type:i}),this.btnEndStyle.selectRecord(a),a&&this._updateSizeArr(this.btnEndSize,this.mnuEndSizePicker,a,this._endSizeIdx)}}}},updateMetricUnit:function(){if(this.spinners)for(var t=0;t<this.spinners.length;t++){var e=this.spinners[t];e.setDefaultUnit(Common.Utils.Metric.getCurrentMetricName()),e.setStep(Common.Utils.Metric.getCurrentMetric()==Common.Utils.Metric.c_MetricUnits.pt?1:.01)}this.sizeMax={width:Common.Utils.Metric.fnRecalcFromMM(10*this.options.sizeMax.width),height:Common.Utils.Metric.fnRecalcFromMM(10*this.options.sizeMax.height)},this.options.sizeOriginal&&(this.sizeOriginal={width:Common.Utils.Metric.fnRecalcFromMM(this.options.sizeOriginal.width),height:Common.Utils.Metric.fnRecalcFromMM(this.options.sizeOriginal.height)})},_updateSizeArr:function(t,e,i,s){i.get("value")>0?(e.store.each((function(t){t.set({typearrow:i.get("idsvg")})}),this),t.setDisabled(!1),t.selectRecord(null!==s?e.store.at(s):null)):(t.updateFormControl(),t.setDisabled(!0))},updateFormControl:function(t){var e=$(this.el).find(".form-control > .img-arrows use");if(e.length){var i="";if(t){var s=t.get("idsvg");i=void 0!==s?s+"arrow-5":t.get("typearrow")+"arrow-"+(t.get("value")+1)}e[0].setAttribute("xlink:href","#"+i)}},onSelectBeginStyle:function(t,e,i,s){this._changedProps&&(null===this._changedProps.get_stroke()&&this._changedProps.put_stroke(new Asc.asc_CStroke),this._changedProps.get_stroke().put_linebeginstyle(s.get("type"))),null!==this._beginSizeIdx&&void 0!==this._beginSizeIdx||(this._beginSizeIdx=4),this._updateSizeArr(this.btnBeginSize,this.mnuBeginSizePicker,s,this._beginSizeIdx)},onSelectBeginSize:function(t,e,i,s){this._changedProps&&(null===this._changedProps.get_stroke()&&this._changedProps.put_stroke(new Asc.asc_CStroke),this._changedProps.get_stroke().put_linebeginsize(s.get("type"))),this._beginSizeIdx=s.get("value")},onSelectEndStyle:function(t,e,i,s){this._changedProps&&(null===this._changedProps.get_stroke()&&this._changedProps.put_stroke(new Asc.asc_CStroke),this._changedProps.get_stroke().put_lineendstyle(s.get("type"))),null!==this._endSizeIdx&&void 0!==this._endSizeIdx||(this._endSizeIdx=4),this._updateSizeArr(this.btnEndSize,this.mnuEndSizePicker,s,this._endSizeIdx)},onSelectEndSize:function(t,e,i,s){this._changedProps&&(null===this._changedProps.get_stroke()&&this._changedProps.put_stroke(new Asc.asc_CStroke),this._changedProps.get_stroke().put_lineendsize(s.get("type"))),this._endSizeIdx=s.get("value")},onRadioFitChange:function(t,e,i){e&&this._changedProps&&this._changedProps.asc_putTextFitType(t.options.value)},textRound:"Round",textMiter:"Miter",textSquare:"Square",textFlat:"Flat",textBevel:"Bevel",textTitle:"Shape - Advanced Settings",txtNone:"None",textWeightArrows:"Weights & Arrows",textArrows:"Arrows",textLineStyle:"Line Style",textCapType:"Cap Type",textJoinType:"Join Type",textBeginStyle:"Begin Style",textBeginSize:"Begin Size",textEndStyle:"End Style",textEndSize:"End Size",textSize:"Size",textWidth:"Width",textHeight:"Height",textKeepRatio:"Constant Proportions",textTop:"Top",textLeft:"Left",textBottom:"Bottom",textRight:"Right",strMargins:"Text Padding",textAlt:"Alternative Text",textAltTitle:"Title",textAltDescription:"Description",textAltTip:"The alternative text-based representation of the visual object information, which will be read to the people with vision or cognitive impairments to help them better understand what information there is in the image, autoshape, chart or table.",strColumns:"Columns",textSpacing:"Spacing between columns",textColNumber:"Number of columns",textRotation:"Rotation",textAngle:"Angle",textFlipped:"Flipped",textHorizontally:"Horizontally",textVertically:"Vertically",textTextBox:"Text Box",textAutofit:"AutoFit",textNofit:"Do not Autofit",textShrink:"Shrink text on overflow",textResizeFit:"Resize shape to fit text",textPlacement:"Placement",textPosition:"Position",textHorizontal:"Horizontal",textFrom:"From",textVertical:"Vertical",textTopLeftCorner:"Top Left Corner",textCenter:"Center",textGeneral:"General",textShapeName:"Shape name"},PDFE.Views.ShapeSettingsAdvanced||{}))})),define("text!pdfeditor/main/app/template/TableSettingsAdvanced.template",[],(function(){return'<div id="id-adv-table-general" class="settings-panel active">\n    <div class="inner-content">\n    <table cols="1" width="100%">\n        <tr>\n            <td class="padding-large">\n                <label class="header"><%= scope.textTableName %></label>\n                <div id="tableadv-name"></div>\n            </td>\n        </tr>\n    </table>\n    </div>\n</div>\n<div  id="id-adv-table-placement" class="settings-panel active">\n    <div class="inner-content">\n        <table cols="3">\n            <tr>\n                <td colspan="3" width="88px" class="padding-small">\n                    <label class="header"><%= scope.textSize %></label>\n                </td>\n            </tr>\n            <tr>\n                <td width="93px">\n                    <label class="input-label"><%= scope.textWidth %></label>\n                    <div id="tableadv-spin-width"></div>\n                </td>\n                <td width="28px" style="vertical-align: bottom;">\n                    <div id="tableadv-button-ratio"></div>\n                </td>\n                <td width="93px">\n                    <label class="input-label"><%= scope.textHeight %></label>\n                    <div id="tableadv-spin-height"></div>\n                </td>\n            </tr>\n        </table>\n    </div>\n    <div class="padding-large"></div>\n    <div class="inner-content">\n        <table cols="2" style="width: 100%;">\n            <tr>\n                <td colspan="4" width="88px" class="padding-small">\n                    <label class="header"><%= scope.textPosition %></label>\n                </td>\n            </tr>\n            <tr>\n                <td class="padding-small" width="121px">\n                    <label class="input-label"><%= scope.textHorizontal %></label>\n                    <div id="tableadv-spin-x"></div>\n                </td>\n                <td class="padding-small">\n                    <label class="input-label"><%= scope.textFrom %></label>\n                    <div id="tableadv-combo-from-x"></div>\n                </td>\n            </tr>\n            <tr>\n                <td class="padding-small">\n                    <label class="input-label"><%= scope.textVertical %></label>\n                    <div id="tableadv-spin-y"></div>\n                </td>\n                <td class="padding-small">\n                    <label class="input-label"><%= scope.textFrom %></label>\n                    <div id="tableadv-combo-from-y"></div>\n                </td>\n            </tr>\n        </table>\n    </div>\n</div>\n<div id="id-adv-table-cell-props" class="settings-panel">\n    <div class="inner-content">\n        <table cols="2" style="width: 100%;">\n            <tr>\n                <td colspan=2 class="padding-small">\n                    <label class="header"><%= scope.textMargins %></label>\n                </td>\n            </tr>\n            <tr>\n                <td colspan="2" class="padding-small">\n                    <div id="tableadv-checkbox-margins"></div>\n                </td>\n            </tr>\n            <tr>\n                <td class="padding-small" width="125px">\n                    <label class="input-label"><%= scope.textTop %></label>\n                    <div id="tableadv-number-margin-top"></div>\n                </td>\n                <td class="padding-small">\n                    <label class="input-label"><%= scope.textLeft %></label>\n                    <div id="tableadv-number-margin-left"></div>\n                </td>\n            </tr>\n            <tr>\n                <td class="padding-large">\n                    <label class="input-label"><%= scope.textBottom %></label>\n                    <div id="tableadv-number-margin-bottom"></div>\n                </td>\n                <td class="padding-large">\n                    <label class="input-label"><%= scope.textRight %></label>\n                    <div id="tableadv-number-margin-right"></div>\n                </td>\n            </tr>\n            <tr>\n                <td colspan=2 class="padding-small">\n                    <label class="header"><%= scope.textDefaultMargins %></label>\n                </td>\n            </tr>\n            <tr>\n                <td class="padding-small" width="125px">\n                    <label class="input-label"><%= scope.textTop %></label>\n                    <div id="tableadv-number-margin-table-top"></div>\n                </td>\n                <td class="padding-small">\n                    <label class="input-label"><%= scope.textLeft %></label>\n                    <div id="tableadv-number-margin-table-left"></div>\n                </td>\n            </tr>\n            <tr>\n                <td class="padding-small">\n                    <label class="input-label"><%= scope.textBottom %></label>\n                    <div id="tableadv-number-margin-table-bottom"></div>\n                </td>\n                <td class="padding-small">\n                    <label class="input-label"><%= scope.textRight %></label>\n                    <div id="tableadv-number-margin-table-right"></div>\n                </td>\n            </tr>\n        </table>\n    </div>\n</div>\n<div id="id-adv-table-alttext" class="settings-panel">\n    <div class="inner-content">\n        <table cols="1" width="100%">\n            <tr>\n                <td class="padding-large">\n                    <label class="header"><%= scope.textAltTitle %></label>\n                    <div id="tableadv-alt-title"></div>\n                </td>\n            </tr>\n            <tr>\n                <td>\n                    <label class="header"><%= scope.textAltDescription %></label>\n                    <textarea id="tableadv-alt-description" class="form-control" style="width: 100%; height: 70px;"></textarea>\n                </td>\n            </tr>\n            <tr>\n                <td>\n                    <label><%= scope.textAltTip %></label>\n                </td>\n            </tr>\n        </table>\n    </div>\n</div>'})),define("pdfeditor/main/app/view/TableSettingsAdvanced",["text!pdfeditor/main/app/template/TableSettingsAdvanced.template","common/main/lib/view/AdvancedSettingsWindow"],(function(t){"use strict";PDFE.Views.TableSettingsAdvanced=Common.Views.AdvancedSettingsWindow.extend(_.extend({options:{alias:"TableSettingsAdvanced",contentWidth:280,contentHeight:300,storageName:"pdfe-table-settings-adv-category",sizeMax:{width:55.88,height:55.88}},initialize:function(e){_.extend(this.options,{title:this.textTitle,items:[{panelId:"id-adv-table-general",panelCaption:this.textGeneral},{panelId:"id-adv-table-placement",panelCaption:this.textPlacement},{panelId:"id-adv-table-cell-props",panelCaption:this.textWidthSpaces},{panelId:"id-adv-table-alttext",panelCaption:this.textAlt}],contentTemplate:_.template(t)({scope:this})},e),Common.Views.AdvancedSettingsWindow.prototype.initialize.call(this,this.options),this.spinners=[],this._changedProps=null,this._allTable=!1,this.TableMargins={Left:.19,Right:.19,Top:0,Bottom:0},this.CellMargins={Left:.19,Right:.19,Top:null,Bottom:null,Flag:0},this._initialMarginsDefault=!1,this._originalProps=new Asc.CTableProp(this.options.tableProps),this.slideSize=this.options.slideSize},render:function(){Common.Views.AdvancedSettingsWindow.prototype.render.call(this);var t=this;this.inputTableName=new Common.UI.InputField({el:$("#tableadv-name"),allowBlank:!0,validateOnBlur:!1,style:"width: 100%;"}).on("changed:after",(function(){t.isTableNameChanged=!0})),this.spnWidth=new Common.UI.MetricSpinner({el:$("#tableadv-spin-width"),step:.1,width:85,defaultUnit:"cm",value:"3 cm",maxValue:55.88,minValue:0}),this.spnWidth.on("change",_.bind((function(t){if(this.btnRatio.pressed){var e=t.getNumberValue(),i=e/this._nRatio;i>this.sizeMax.height&&(e=(i=this.sizeMax.height)*this._nRatio,this.spnWidth.setValue(e,!0)),this.spnHeight.setValue(i,!0)}}),this)),this.spinners.push(this.spnWidth),this.spnHeight=new Common.UI.MetricSpinner({el:$("#tableadv-spin-height"),step:.1,width:85,defaultUnit:"cm",value:"3 cm",maxValue:55.88,minValue:0}),this.spnHeight.on("change",_.bind((function(t,e,i,s){var n=t.getNumberValue(),a=null;this.btnRatio.pressed&&((a=n*this._nRatio)>this.sizeMax.width&&(n=(a=this.sizeMax.width)/this._nRatio,this.spnHeight.setValue(n,!0)),this.spnWidth.setValue(a,!0))}),this)),this.spinners.push(this.spnHeight),this.btnRatio=new Common.UI.Button({parentEl:$("#tableadv-button-ratio"),cls:"btn-toolbar",iconCls:"toolbar__icon btn-advanced-ratio",style:"margin-bottom: 1px;",enableToggle:!0,hint:this.textKeepRatio}),this.btnRatio.on("click",_.bind((function(t,e){t.pressed&&this.spnHeight.getNumberValue()>0&&(this._nRatio=this.spnWidth.getNumberValue()/this.spnHeight.getNumberValue())}),this)),this.spnX=new Common.UI.MetricSpinner({el:$("#tableadv-spin-x"),step:.1,width:85,defaultUnit:"cm",defaultValue:0,value:"0 cm",maxValue:55.87,minValue:-55.87}),this.spinners.push(this.spnX),this.spnY=new Common.UI.MetricSpinner({el:$("#tableadv-spin-y"),step:.1,width:85,defaultUnit:"cm",defaultValue:0,value:"0 cm",maxValue:55.87,minValue:-55.87}),this.spinners.push(this.spnY),this.cmbFromX=new Common.UI.ComboBox({el:$("#tableadv-combo-from-x"),cls:"input-group-nr",style:"width: 125px;",menuStyle:"min-width: 125px;",data:[{value:"left",displayValue:this.textTopLeftCorner},{value:"center",displayValue:this.textCenter}],editable:!1,takeFocusOnClose:!0}),this.cmbFromY=new Common.UI.ComboBox({el:$("#tableadv-combo-from-y"),cls:"input-group-nr",style:"width: 125px;",menuStyle:"min-width: 125px;",data:[{value:"left",displayValue:this.textTopLeftCorner},{value:"center",displayValue:this.textCenter}],editable:!1,takeFocusOnClose:!0}),this._marginsChange=function(t,e,i,s,n,a){"table"==n?this.TableMargins[a]=t.getNumberValue():this.CellMargins[a]=t.getNumberValue()},this.spnTableMarginTop=new Common.UI.MetricSpinner({el:$("#tableadv-number-margin-table-top"),step:.1,width:85,defaultUnit:"cm",value:"0 cm",maxValue:55.87,minValue:0}),this.spnTableMarginTop.on("change",_.bind((function(t,e,i,s){this._marginsChange(t,e,i,s,"table","Top"),this._changedProps&&(void 0===this._changedProps.get_DefaultMargins()&&this._changedProps.put_DefaultMargins(new Asc.asc_CPaddings),this._changedProps.get_DefaultMargins().put_Top(null!==this.TableMargins.Top?Common.Utils.Metric.fnRecalcToMM(this.TableMargins.Top):null),this.TableMargins.isChanged=!0)}),this)),this.spinners.push(this.spnTableMarginTop),this.spnTableMarginBottom=new Common.UI.MetricSpinner({el:$("#tableadv-number-margin-table-bottom"),step:.1,width:85,defaultUnit:"cm",value:"0 cm",maxValue:55.87,minValue:0}),this.spnTableMarginBottom.on("change",_.bind((function(t,e,i,s){this._marginsChange(t,e,i,s,"table","Bottom"),this._changedProps&&(void 0===this._changedProps.get_DefaultMargins()&&this._changedProps.put_DefaultMargins(new Asc.asc_CPaddings),this._changedProps.get_DefaultMargins().put_Bottom(null!==this.TableMargins.Bottom?Common.Utils.Metric.fnRecalcToMM(this.TableMargins.Bottom):null),this.TableMargins.isChanged=!0)}),this)),this.spinners.push(this.spnTableMarginBottom),this.spnTableMarginLeft=new Common.UI.MetricSpinner({el:$("#tableadv-number-margin-table-left"),step:.1,width:85,defaultUnit:"cm",value:"0.19 cm",maxValue:55.87,minValue:0}),this.spnTableMarginLeft.on("change",_.bind((function(t,e,i,s){this._marginsChange(t,e,i,s,"table","Left"),this._changedProps&&(void 0===this._changedProps.get_DefaultMargins()&&this._changedProps.put_DefaultMargins(new Asc.asc_CPaddings),this._changedProps.get_DefaultMargins().put_Left(null!==this.TableMargins.Left?Common.Utils.Metric.fnRecalcToMM(this.TableMargins.Left):null),this.TableMargins.isChanged=!0)}),this)),this.spinners.push(this.spnTableMarginLeft),this.spnTableMarginRight=new Common.UI.MetricSpinner({el:$("#tableadv-number-margin-table-right"),step:.1,width:85,defaultUnit:"cm",value:"0.19 cm",maxValue:55.87,minValue:0}),this.spnTableMarginRight.on("change",_.bind((function(t,e,i,s){this._marginsChange(t,e,i,s,"table","Right"),this._changedProps&&(void 0===this._changedProps.get_DefaultMargins()&&this._changedProps.put_DefaultMargins(new Asc.asc_CPaddings),this._changedProps.get_DefaultMargins().put_Right(null!==this.TableMargins.Right?Common.Utils.Metric.fnRecalcToMM(this.TableMargins.Right):null),this.TableMargins.isChanged=!0)}),this)),this.spinners.push(this.spnTableMarginRight);var e=function(){"indeterminate"==t.CellMargins.Flag?t._changedProps.get_CellMargins().put_Flag(1):"checked"==t.CellMargins.Flag?t._changedProps.get_CellMargins().put_Flag(0):t._changedProps.get_CellMargins().put_Flag(2)};this.chCellMargins=new Common.UI.CheckBox({el:$("#tableadv-checkbox-margins"),value:!0,labelText:this.textCheckMargins}),this.chCellMargins.on("change",_.bind((function(t,i,s,n){"checked"==s&&this._originalProps&&1==this._originalProps.get_CellMargins().get_Flag()&&t.setValue("indeterminate",!0),this.fillMargins.call(this,t.getValue()),this.CellMargins.Flag=t.getValue(),this._changedProps&&(void 0===this._changedProps.get_CellMargins()&&this._changedProps.put_CellMargins(new Asc.CMargins),this._changedProps.get_CellMargins().put_Left(null!==this.CellMargins.Left?Common.Utils.Metric.fnRecalcToMM(this.CellMargins.Left):null),this._changedProps.get_CellMargins().put_Top(null!==this.CellMargins.Top?Common.Utils.Metric.fnRecalcToMM(this.CellMargins.Top):null),this._changedProps.get_CellMargins().put_Bottom(null!==this.CellMargins.Bottom?Common.Utils.Metric.fnRecalcToMM(this.CellMargins.Bottom):null),this._changedProps.get_CellMargins().put_Right(null!==this.CellMargins.Right?Common.Utils.Metric.fnRecalcToMM(this.CellMargins.Right):null),e())}),this)),this.spnMarginTop=new Common.UI.MetricSpinner({el:$("#tableadv-number-margin-top"),step:.1,width:85,defaultUnit:"cm",value:"0 cm",maxValue:55.87,minValue:0}),this.spnMarginTop.on("change",_.bind((function(t,i,s,n){this._marginsChange(t,i,s,n,"cell","Top"),this._changedProps&&(void 0===this._changedProps.get_CellMargins()&&this._changedProps.put_CellMargins(new Asc.CMargins),this._changedProps.get_CellMargins().put_Top(null!==this.CellMargins.Top?Common.Utils.Metric.fnRecalcToMM(this.CellMargins.Top):null),e())}),this)),this.spinners.push(this.spnMarginTop),this.spnMarginBottom=new Common.UI.MetricSpinner({el:$("#tableadv-number-margin-bottom"),step:.1,width:85,defaultUnit:"cm",value:"0 cm",maxValue:55.87,minValue:0}),this.spnMarginBottom.on("change",_.bind((function(t,i,s,n){this._marginsChange(t,i,s,n,"cell","Bottom"),this._changedProps&&(void 0===this._changedProps.get_CellMargins()&&this._changedProps.put_CellMargins(new Asc.CMargins),this._changedProps.get_CellMargins().put_Bottom(null!==this.CellMargins.Bottom?Common.Utils.Metric.fnRecalcToMM(this.CellMargins.Bottom):null),e())}),this)),this.spinners.push(this.spnMarginBottom),this.spnMarginLeft=new Common.UI.MetricSpinner({el:$("#tableadv-number-margin-left"),step:.1,width:85,defaultUnit:"cm",value:"0.19 cm",maxValue:55.87,minValue:0}),this.spnMarginLeft.on("change",_.bind((function(t,i,s,n){this._marginsChange(t,i,s,n,"cell","Left"),this._changedProps&&(void 0===this._changedProps.get_CellMargins()&&this._changedProps.put_CellMargins(new Asc.CMargins),this._changedProps.get_CellMargins().put_Left(null!==this.CellMargins.Left?Common.Utils.Metric.fnRecalcToMM(this.CellMargins.Left):null),e())}),this)),this.spinners.push(this.spnMarginLeft),this.spnMarginRight=new Common.UI.MetricSpinner({el:$("#tableadv-number-margin-right"),step:.1,width:85,defaultUnit:"cm",value:"0.19 cm",maxValue:55.87,minValue:0}),this.spnMarginRight.on("change",_.bind((function(t,i,s,n){this._marginsChange(t,i,s,n,"cell","Right"),this._changedProps&&(void 0===this._changedProps.get_CellMargins()&&this._changedProps.put_CellMargins(new Asc.CMargins),this._changedProps.get_CellMargins().put_Right(null!==this.CellMargins.Right?Common.Utils.Metric.fnRecalcToMM(this.CellMargins.Right):null),e())}),this)),this.spinners.push(this.spnMarginRight),this.inputAltTitle=new Common.UI.InputField({el:$("#tableadv-alt-title"),allowBlank:!0,validateOnBlur:!1,style:"width: 100%;"}).on("changed:after",(function(){t.isAltTitleChanged=!0})),this.textareaAltDescription=this.$window.find("textarea"),this.textareaAltDescription.keydown((function(e){e.keyCode==Common.UI.Keys.RETURN&&e.stopPropagation(),t.isAltDescChanged=!0})),this.afterRender()},getFocusedComponents:function(){return this.btnsCategory.concat([this.inputTableName,this.spnWidth,this.btnRatio,this.spnHeight,this.spnX,this.cmbFromX,this.spnY,this.cmbFromY,this.chCellMargins,this.spnMarginTop,this.spnMarginLeft,this.spnMarginBottom,this.spnMarginRight,this.spnTableMarginTop,this.spnTableMarginLeft,this.spnTableMarginBottom,this.spnTableMarginRight,this.inputAltTitle,this.textareaAltDescription]).concat(this.getFooterButtons())},onCategoryClick:function(t,e){Common.Views.AdvancedSettingsWindow.prototype.onCategoryClick.call(this,t,e);var i=this;setTimeout((function(){switch(e){case 0:i.inputTableName.focus();break;case 1:i.spnWidth.focus();break;case 2:i.spnMarginTop.isDisabled()?i.spnTableMarginTop.focus():i.spnMarginTop.focus();break;case 3:i.inputAltTitle.focus()}}),10)},afterRender:function(){if(this.updateMetricUnit(),this._setDefaults(this._originalProps),this.storageName){var t=Common.localStorage.getItem(this.storageName);this.setActiveCategory(null!==t?parseInt(t):0)}},getSettings:function(){if(this.isTableNameChanged&&this._changedProps.put_TableName(this.inputTableName.getValue()),""!==this.spnHeight.getValue()&&this._changedProps.put_FrameHeight(Common.Utils.Metric.fnRecalcToMM(this.spnHeight.getNumberValue())),""!==this.spnWidth.getValue()&&this._changedProps.put_FrameWidth(Common.Utils.Metric.fnRecalcToMM(this.spnWidth.getNumberValue())),this._changedProps.put_FrameLockAspect(this.btnRatio.pressed),""!==this.spnX.getValue()){var t=Common.Utils.Metric.fnRecalcToMM(this.spnX.getNumberValue());"center"===this.cmbFromX.getValue()&&(t=this.slideSize.width/36e3/2+t),this._changedProps.put_FrameX(t)}if(""!==this.spnY.getValue()){var e=Common.Utils.Metric.fnRecalcToMM(this.spnY.getNumberValue());"center"===this.cmbFromY.getValue()&&(e=this.slideSize.height/36e3/2+e),this._changedProps.put_FrameY(e)}return this.isAltTitleChanged&&this._changedProps.put_TableCaption(this.inputAltTitle.getValue()),this.isAltDescChanged&&this._changedProps.put_TableDescription(this.textareaAltDescription.val()),{tableProps:this._changedProps}},_setDefaults:function(t){if(t){this._allTable=!t.get_CellSelect();var e=t.get_TableName();this.inputTableName.setValue(e||""),this.spnWidth.setMaxValue(this.sizeMax.width),this.spnHeight.setMaxValue(this.sizeMax.height),this.spnWidth.setValue(Common.Utils.Metric.fnRecalcFromMM(t.get_FrameWidth()).toFixed(2),!0),this.spnHeight.setValue(Common.Utils.Metric.fnRecalcFromMM(t.get_FrameHeight()).toFixed(2),!0),e=t.get_FrameLockAspect(),this.btnRatio.toggle(e),t.get_FrameHeight()>0&&(this._nRatio=t.get_FrameWidth()/t.get_FrameHeight()),this.cmbFromX.setValue("left"),this.cmbFromY.setValue("left");var i={x:t.get_FrameX(),y:t.get_FrameY()};this.spnX.setValue(null!=i.x?Common.Utils.Metric.fnRecalcFromMM(i.x):"",!0),this.spnY.setValue(null!=i.y?Common.Utils.Metric.fnRecalcFromMM(i.y):"",!0);var s=t.get_DefaultMargins();s&&(this.TableMargins={Left:null!==s.get_Left()?Common.Utils.Metric.fnRecalcFromMM(s.get_Left()):null,Right:null!==s.get_Right()?Common.Utils.Metric.fnRecalcFromMM(s.get_Right()):null,Top:null!==s.get_Top()?Common.Utils.Metric.fnRecalcFromMM(s.get_Top()):null,Bottom:null!==s.get_Bottom()?Common.Utils.Metric.fnRecalcFromMM(s.get_Bottom()):null});var n=void 0;(s=t.get_CellMargins())&&(this.CellMargins={Left:null!==s.get_Left()?Common.Utils.Metric.fnRecalcFromMM(s.get_Left()):null,Right:null!==s.get_Right()?Common.Utils.Metric.fnRecalcFromMM(s.get_Right()):null,Top:null!==s.get_Top()?Common.Utils.Metric.fnRecalcFromMM(s.get_Top()):null,Bottom:null!==s.get_Bottom()?Common.Utils.Metric.fnRecalcFromMM(s.get_Bottom()):null},n=s.get_Flag(),this.CellMargins.Flag=1==n?"indeterminate":0==n?"checked":"unchecked",this.chCellMargins.setValue(this.CellMargins.Flag,!0)),0===n&&(null===this.CellMargins.Left&&(this.CellMargins.Left=this.TableMargins.Left),null===this.CellMargins.Top&&(this.CellMargins.Top=this.TableMargins.Top),null===this.CellMargins.Right&&(this.CellMargins.Right=this.TableMargins.Right),null===this.CellMargins.Bottom&&(this.CellMargins.Bottom=this.TableMargins.Bottom)),this.fillMargins(this.CellMargins.Flag),e=t.get_TableCaption(),this.inputAltTitle.setValue(e||""),e=t.get_TableDescription(),this.textareaAltDescription.val(e||""),this._changedProps=new Asc.CTableProp}},fillMargins:function(t){this._initialMarginsDefault&&"unchecked"==t&&(null===this.CellMargins.Left&&(this.CellMargins.Left=0),null===this.CellMargins.Top&&(this.CellMargins.Top=0),null===this.CellMargins.Right&&(this.CellMargins.Right=0),null===this.CellMargins.Bottom&&(this.CellMargins.Bottom=0)),this.spnMarginLeft.setValue(null!==this.CellMargins.Left?this.CellMargins.Left:"",!0),this.spnMarginTop.setValue(null!==this.CellMargins.Top?this.CellMargins.Top:"",!0),this.spnMarginRight.setValue(null!==this.CellMargins.Right?this.CellMargins.Right:"",!0),this.spnMarginBottom.setValue(null!==this.CellMargins.Bottom?this.CellMargins.Bottom:"",!0);var e="checked"==t;this.spnMarginTop.setDisabled(e),this.spnMarginBottom.setDisabled(e),this.spnMarginLeft.setDisabled(e),this.spnMarginRight.setDisabled(e),this.spnTableMarginLeft.setValue(null!==this.TableMargins.Left?this.TableMargins.Left:"",!0),this.spnTableMarginTop.setValue(null!==this.TableMargins.Top?this.TableMargins.Top:"",!0),this.spnTableMarginRight.setValue(null!==this.TableMargins.Right?this.TableMargins.Right:"",!0),this.spnTableMarginBottom.setValue(null!==this.TableMargins.Bottom?this.TableMargins.Bottom:"",!0)},updateMetricUnit:function(){if(this.spinners)for(var t=0;t<this.spinners.length;t++){var e=this.spinners[t];e.setDefaultUnit(Common.Utils.Metric.getCurrentMetricName()),e.setStep(Common.Utils.Metric.getCurrentMetric()==Common.Utils.Metric.c_MetricUnits.pt?1:.1)}this.sizeMax={width:Common.Utils.Metric.fnRecalcFromMM(10*this.options.sizeMax.width),height:Common.Utils.Metric.fnRecalcFromMM(10*this.options.sizeMax.height)}},textWidthSpaces:"Margins",textMargins:"Cell Margins",textTop:"Top",textLeft:"Left",textBottom:"Bottom",textRight:"Right",textTitle:"Table - Advanced Settings",textDefaultMargins:"Default Margins",textCheckMargins:"Use default margins",textAlt:"Alternative Text",textAltTitle:"Title",textAltDescription:"Description",textAltTip:"The alternative text-based representation of the visual object information, which will be read to the people with vision or cognitive impairments to help them better understand what information there is in the image, autoshape, chart or table.",textPlacement:"Placement",textSize:"Size",textPosition:"Position",textHorizontal:"Horizontal",textVertical:"Vertical",textFrom:"From",textTopLeftCorner:"Top Left Corner",textCenter:"Center",textWidth:"Width",textHeight:"Height",textKeepRatio:"Constant Proportions",textGeneral:"General",textTableName:"Table name"},PDFE.Views.TableSettingsAdvanced||{}))})),define("pdfeditor/main/app/view/FormatSettingsDialog",["common/main/lib/view/AdvancedSettingsWindow"],(function(){"use strict";PDFE.Views.FormatSettingsDialog=Common.Views.AdvancedSettingsWindow.extend(_.extend({options:{contentWidth:300,contentHeight:345},initialize:function(t){var e=this;this.api=t.api,this.handler=t.handler,this.props=t.props,_.extend(this.options,{title:this.textTitle,contentHeight:345,contentStyle:"padding: 5px; position:relative;",contentTemplate:_.template(['<div class="settings-panel active">','<div class="inner-content">','<table cols="2" style="width: 100%;">',"<tr>",'<td colspan="2" style="width:170px;" class="padding-large">','<label class="header">',e.textCategory,"</label>",'<div id="format-settings-combo-format" class="input-group-nr"></div>',"</td>","</tr>",'<tr class="format-decimal">','<td colspan="2" class="padding-medium" style="vertical-align: bottom;">','<label class="header">',e.textDecimal,"</label>",'<div id="format-settings-spin-decimal"></div>',"</td>","</tr>",'<tr class="format-separator">','<td colspan="2" class="padding-medium">','<label class="header">',e.textSeparator,"</label>",'<div id="format-settings-combo-separator" class="input-group-nr"</div>',"</td>","</tr>",'<tr class="format-number">','<td class="padding-medium padding-right-5" style="width:50%;">','<label class="header">',e.textSymbol,"</label>",'<div id="format-settings-combo-symbols" class="input-group-nr" ></div>',"</td>",'<td class="padding-medium padding-left-5">','<label class="header">',e.textLocation,"</label>",'<div id="format-settings-combo-location" class="input-group-nr" ></div>',"</td>","</tr>",'<tr class="format-number">','<td colspan="2" class="padding-very-small">','<label class="header">',e.textNegative,"</label>","</td>","</tr>",'<tr class="format-number">','<td colspan="2" class="padding-very-small">','<div id="format-settings-chk-parens"></div>',"</td>","</tr>",'<tr class="format-number">','<td colspan="2" >','<div id="format-settings-chk-red"></div>',"</td>","</tr>",'<tr class="form-special">','<td colspan="2" class="padding-small">','<div id="format-settings-special" style="width: 100%;"></div>',"</td>","</tr>",'<tr class="form-special-mask">','<td colspan="2" class="padding-small">','<div id="format-settings-mask" style="width: 100%;"></div>',"</td>","</tr>",'<tr class="format-date-time">','<td colspan="2" class="padding-large">','<label class="header">',e.textFormat,"</label>",'<div id="format-settings-list-format" style="height: 116px;margin-bottom: 8px;"></div>','<div id="format-settings-txt-custom" class="input-group-nr"></div>',"</td>","</tr>","</table>",'<div class="format-example" style="white-space: nowrap;position:absolute; bottom: 4px;width:280px;">','<label class="format-sample margin-right-4" style="vertical-align: middle;">'+e.txtSample+"</label>",'<label class="format-sample" id="format-settings-label-example" style="vertical-align: middle; max-width: 220px; overflow: hidden; text-overflow: ellipsis;">100</label>',"</div>","</div></div>"].join(""))({scope:this})},t),Common.Views.AdvancedSettingsWindow.prototype.initialize.call(this,this.options),this._state={DateFormatCustom:"",DateFormat:"",TimeFormat:0,NegStyle:AscPDF.NegativeStyle.BLACK_MINUS,Mask:"*",RegExp:"."},this.FormatType=AscPDF.FormatType.NONE},render:function(){Common.Views.AdvancedSettingsWindow.prototype.render.call(this);var t=this;this.cmbFormat=new Common.UI.ComboBox({el:$("#format-settings-combo-format"),cls:"input-group-nr",menuStyle:"min-width: 100%;",editable:!1,data:[{displayValue:this.textNone,value:AscPDF.FormatType.NONE},{displayValue:this.textNumber,value:AscPDF.FormatType.NUMBER},{displayValue:this.textPercent,value:AscPDF.FormatType.PERCENTAGE},{displayValue:this.textDate,value:AscPDF.FormatType.DATE},{displayValue:this.textTime,value:AscPDF.FormatType.TIME},{displayValue:this.textSpecial,value:AscPDF.FormatType.SPECIAL},{displayValue:this.textReg,value:AscPDF.FormatType.REGULAR}],takeFocusOnClose:!0}),this.cmbFormat.setValue(this.FormatType),this.cmbFormat.on("selected",_.bind(this.onFormatSelect,this)),this.spnDecimal=new Common.UI.MetricSpinner({el:$("#format-settings-spin-decimal"),step:1,width:45,defaultUnit:"",value:2,maxValue:30,minValue:0,allowDecimal:!1}),this.spnDecimal.on("change",_.bind(this.updateFormatExample,this)),this.cmbSeparator=new Common.UI.ComboBox({el:$("#format-settings-combo-separator"),cls:"input-group-nr",menuStyle:"min-width: 100%;max-height:235px;",editable:!1,data:[{displayValue:"1,234.56",value:AscPDF.SeparatorStyle.COMMA_DOT},{displayValue:"1234.56",value:AscPDF.SeparatorStyle.NO_SEPARATOR},{displayValue:"1.234,56",value:AscPDF.SeparatorStyle.DOT_COMMA},{displayValue:"1234,56",value:AscPDF.SeparatorStyle.NO_SEPARATOR_COMMA},{displayValue:"1'234.56",value:AscPDF.SeparatorStyle.APOSTROPHE_DOT}],scrollAlwaysVisible:!0,takeFocusOnClose:!0,search:!0}),this.cmbSeparator.setValue(AscPDF.SeparatorStyle.COMMA_DOT),this.cmbSeparator.on("selected",_.bind(this.updateFormatExample,this));let e=[];this.api.asc_getNumberFormatCurrencySymbols().forEach((function(t){e.push({value:t,displayValue:t})})),e.unshift({value:null,displayValue:t.textNone}),this.cmbSymbols=new Common.UI.ComboBox({el:$("#format-settings-combo-symbols"),cls:"input-group-nr",menuStyle:"min-width: 100%;max-height:235px;",editable:!1,data:e,scrollAlwaysVisible:!0,takeFocusOnClose:!0,search:!0}),this.cmbSymbols.setValue(null),this.cmbSymbols.on("selected",_.bind(this.onSymbolsSelect,this)),this.cmbLocation=new Common.UI.ComboBox({el:$("#format-settings-combo-location"),cls:"input-group-nr",menuStyle:"min-width: 100%;max-height:235px;",editable:!1,data:[{displayValue:this.textBeforeSpace,value:0},{displayValue:this.textBefore,value:1},{displayValue:this.textAfterSpace,value:2},{displayValue:this.textAfter,value:3}],scrollAlwaysVisible:!0,takeFocusOnClose:!0}),this.cmbLocation.setValue(0),this.cmbLocation.setDisabled(!0),this.cmbLocation.on("selected",_.bind(this.updateFormatExample,this)),this.chParens=new Common.UI.CheckBox({el:$("#format-settings-chk-parens"),labelText:this.textParens}),this.chParens.on("change",_.bind(this.onNegativeChange,this)),this.chRed=new Common.UI.CheckBox({el:$("#format-settings-chk-red"),labelText:this.textRed}),this.chRed.on("change",_.bind(this.onNegativeChange,this)),this.dateTimeList=new Common.UI.ListView({el:$("#format-settings-list-format"),store:new Common.UI.DataViewStore,tabindex:1,itemTemplate:_.template('<div id="<%= id %>" class="list-item" style="pointer-events:none;overflow: hidden; text-overflow: ellipsis;"><%= Common.Utils.String.htmlEncode(displayValue) %></div>')}),this.dateTimeList.on("item:select",_.bind(this.onDateTimeListSelect,this)),this.dateTimeList.on("entervalue",_.bind(this.onPrimary,this)),this.inputCustomFormat=new Common.UI.InputField({el:$("#format-settings-txt-custom"),allowBlank:!0,validateOnChange:!0,validation:function(){return!0}}).on("changing",(function(e,i){t._state.DateFormat=i,t.lblExample.text(t.api.asc_getFieldDateTimeFormatExample(i))})),this.cmbSpecial=new Common.UI.ComboBox({el:$("#format-settings-special"),cls:"input-group-nr",menuStyle:"min-width: 100%;max-height:235px;",editable:!1,data:[{displayValue:this.textZipCode,value:AscPDF.SpecialFormatType.ZIP_CODE},{displayValue:this.textZipCode4,value:AscPDF.SpecialFormatType.ZIP_PLUS_4},{displayValue:this.textPhone,value:AscPDF.SpecialFormatType.PHONE},{displayValue:this.textSSN,value:AscPDF.SpecialFormatType.SSN},{displayValue:this.textMask,value:-1}],scrollAlwaysVisible:!0,takeFocusOnClose:!0}),this.cmbSpecial.setValue(AscPDF.SpecialFormatType.PHONE),this.cmbSpecial.on("selected",this.onSpecialChanged.bind(this)),this.txtMask=new Common.UI.InputField({el:$("#format-settings-mask"),allowBlank:!0,validateOnChange:!0,validateOnBlur:!1,style:"width: 100%;",value:"",dataHint:"1",dataHintDirection:"left",dataHintOffset:"small"}).on("changing",(function(e,i){t._state[t.FormatType===AscPDF.FormatType.REGULAR?"RegExp":"Mask"]=i}));var i=[];this.api.asc_getFieldDateFormatOptions().forEach((function(t){i.push({value:t,displayValue:t})})),this.dateFormats=i.concat({value:"",displayValue:this.txtCustom,isCustom:!0}),i=[];var s=this.api.asc_getFieldTimeFormatOptions(),n=[];for(let t in s)s.hasOwnProperty(t)&&(i.push({value:s[t],displayValue:t}),n[s[t]]=t);this.timeFormats=i,this.timeVal2Str=n,this._decimalPanel=this.$window.find(".format-decimal"),this._numberPanel=this.$window.find(".format-number"),this._separatorPanel=this.$window.find(".format-separator"),this._specialPanel=this.$window.find(".form-special"),this._maskPanel=this.$window.find(".form-special-mask"),this._datePanel=this.$window.find(".format-date-time"),this._examplePanel=this.$window.find(".format-example"),this.lblExample=this.$window.find("#format-settings-label-example"),this.afterRender()},getFocusedComponents:function(){return[this.cmbFormat,this.spnDecimal,this.cmbSeparator,this.cmbSymbols,this.cmbLocation,this.chParens,this.chRed,this.dateTimeList,this.inputCustomFormat,this.cmbSpecial,this.txtMask].concat(this.getFooterButtons())},getDefaultFocusableComponent:function(){return this.cmbFormat},afterRender:function(){this._setDefaults(this.props)},show:function(){Common.Views.AdvancedSettingsWindow.prototype.show.apply(this,arguments)},_setDefaults:function(t){if(t){let i=t.asc_getFormat(),s=i?i.asc_getType():AscPDF.FormatType.NONE;if(this.cmbFormat.setValue(null!=s?s:AscPDF.FormatType.NONE,""),this.FormatType=s,this.FormatType===AscPDF.FormatType.SPECIAL&&(s=i.asc_getFormat(),this._state.SpecialType=void 0===s?-1:s),this.onFormatSelect(this.cmbFormat,this.cmbFormat.getSelectedRecord()),this.FormatType===AscPDF.FormatType.DATE||this.FormatType===AscPDF.FormatType.TIME){s=i.asc_getFormat();var e=this.dateTimeList.store.findWhere({value:s});this.inputCustomFormat.setVisible(this.FormatType===AscPDF.FormatType.DATE&&!e),this.FormatType!==AscPDF.FormatType.DATE||e||((e=this.dateTimeList.store.findWhere({isCustom:!0}))&&e.set({value:s}),this.inputCustomFormat.setValue(s),this._state.DateFormatCustom=s),e&&(this.dateTimeList.selectRecord(e),this.dateTimeList.scrollToRecord(e)),this._state[this.FormatType===AscPDF.FormatType.DATE?"DateFormat":"TimeFormat"]=s}else this.FormatType!==AscPDF.FormatType.NUMBER&&this.FormatType!==AscPDF.FormatType.PERCENTAGE||(this.spnDecimal.setValue(i.asc_getDecimals()),this.cmbSeparator.setValue(i.asc_getSepStyle(),""),this.FormatType===AscPDF.FormatType.NUMBER&&(s=i.asc_getCurrency(),this.cmbSymbols.setValue(s?s.trim():null,""),this.cmbLocation.setDisabled(!s),s&&-1===s.indexOf(" ")?this.cmbLocation.setValue(i.asc_getCurrencyPrepend()?1:3):this.cmbLocation.setValue(i.asc_getCurrencyPrepend()?0:2),s=i.asc_getNegStyle(),this._state.NegStyle=s,this.chParens.setValue(s===AscPDF.NegativeStyle.PARENS_BLACK||s===AscPDF.NegativeStyle.PARENS_RED,!0),this.chRed.setValue(s===AscPDF.NegativeStyle.RED_MINUS||s===AscPDF.NegativeStyle.PARENS_RED,!0)));this.FormatType===AscPDF.FormatType.REGULAR&&(this._state.RegExp=i.asc_getRegExp()||"",this.txtMask.setValue(this._state.RegExp)),this.FormatType===AscPDF.FormatType.SPECIAL&&(this.cmbSpecial.setValue(this._state.SpecialType,""),-1===this._state.SpecialType&&(this._state.Mask=i.asc_getMask()||"",this.txtMask.setValue(this._state.Mask))),this.updateFormatExample()}},getSettings:function(){switch(this.FormatType){case AscPDF.FormatType.NUMBER:let t=this.cmbLocation.getValue(),e=this.cmbSymbols.getValue();return!e||0!==t&&2!==t||(e=0===t?e+" ":" "+e),{FormatType:this.FormatType,decimal:this.spnDecimal.getNumberValue(),separator:this.cmbSeparator.getValue(),negative:this._state.NegStyle,symbol:e||"",location:t<2};case AscPDF.FormatType.PERCENTAGE:return{FormatType:this.FormatType,decimal:this.spnDecimal.getNumberValue(),separator:this.cmbSeparator.getValue()};case AscPDF.FormatType.DATE:return{FormatType:this.FormatType,dateformat:this._state.DateFormat};case AscPDF.FormatType.TIME:return{FormatType:this.FormatType,timeformat:this._state.TimeFormat};case AscPDF.FormatType.SPECIAL:return{FormatType:this.FormatType,special:this.cmbSpecial.getValue(),mask:this.txtMask.getValue()};case AscPDF.FormatType.REGULAR:return{FormatType:this.FormatType,regexp:this.txtMask.getValue()}}},onDlgBtnClick:function(t){var e="object"==typeof t?t.currentTarget.attributes.result.value:t;"ok"==e&&this.handler&&this.handler.call(this,e,"ok"==e?this.getSettings():void 0),this.close()},onPrimary:function(){return this.onDlgBtnClick("ok"),!1},updateFormatExample:function(){let t="";switch(this.FormatType){case AscPDF.FormatType.NUMBER:let e=this.cmbLocation.getValue(),i=this.cmbSymbols.getValue();!i||0!==e&&2!==e||(i=0===e?i+" ":" "+i),t=this.api.asc_getFieldNumberFormatExample(this.spnDecimal.getNumberValue(),this.cmbSeparator.getValue(),this._state.NegStyle,i||"",e<2);break;case AscPDF.FormatType.PERCENTAGE:t=this.api.asc_getFieldPercentFormatExample(this.spnDecimal.getNumberValue(),this.cmbSeparator.getValue());break;case AscPDF.FormatType.DATE:t=this.api.asc_getFieldDateTimeFormatExample(this._state.DateFormat);break;case AscPDF.FormatType.TIME:t=this.api.asc_getFieldDateTimeFormatExample(this.timeVal2Str[this._state.TimeFormat])}this.lblExample.toggleClass("red-color",this.FormatType===AscPDF.FormatType.NUMBER&&(this._state.NegStyle===AscPDF.NegativeStyle.PARENS_RED||this._state.NegStyle===AscPDF.NegativeStyle.RED_MINUS)),this.lblExample.text(t)},onSymbolsSelect:function(t,e){this.cmbLocation.setDisabled(null===e.value),this.updateFormatExample()},onNegativeChange:function(t,e,i,s){var n="checked"===this.chRed.getValue(),a="checked"===this.chParens.getValue();this._state.NegStyle=n?a?AscPDF.NegativeStyle.PARENS_RED:AscPDF.NegativeStyle.RED_MINUS:a?AscPDF.NegativeStyle.PARENS_BLACK:AscPDF.NegativeStyle.BLACK_MINUS,this.updateFormatExample()},onDateTimeListSelect:function(t,e,i){if(i){var s=this.FormatType===AscPDF.FormatType.DATE&&!!i.get("isCustom");this.inputCustomFormat.setVisible(s),s&&this.inputCustomFormat.setValue(this._state.DateFormatCustom),this._state[this.FormatType===AscPDF.FormatType.DATE?"DateFormat":"TimeFormat"]=s?this.inputCustomFormat.getValue():i.get("value"),this.updateFormatExample()}},onSpecialChanged:function(t,e){this._state.SpecialType=e.value,this._maskPanel.toggleClass("hidden",-1!==this._state.SpecialType),-1===this._state.SpecialType&&this.txtMask.setValue(this._state.Mask),this.updateFormatExample()},onFormatSelect:function(t,e,i){if(e){this.FormatType=e.value;var s=this.FormatType===AscPDF.FormatType.NUMBER,n=this.FormatType===AscPDF.FormatType.PERCENTAGE;this._decimalPanel.toggleClass("hidden",!(s||n)),this._separatorPanel.toggleClass("hidden",!(s||n)),this._numberPanel.toggleClass("hidden",!s),this._specialPanel.toggleClass("hidden",this.FormatType!==AscPDF.FormatType.SPECIAL),this._maskPanel.toggleClass("hidden",!(this.FormatType===AscPDF.FormatType.REGULAR||this.FormatType===AscPDF.FormatType.SPECIAL&&-1===this._state.SpecialType)),this.FormatType===AscPDF.FormatType.REGULAR&&this.txtMask.setValue(this._state.RegExp),this.FormatType===AscPDF.FormatType.SPECIAL&&-1===this._state.SpecialType&&this.txtMask.setValue(this._state.Mask),this._datePanel.toggleClass("hidden",!(this.FormatType===AscPDF.FormatType.DATE||this.FormatType===AscPDF.FormatType.TIME)),this.FormatType!==AscPDF.FormatType.DATE&&this.FormatType!==AscPDF.FormatType.TIME||(this.dateTimeList.$el[0].style.height=this.FormatType===AscPDF.FormatType.DATE?"184px":"116px",this.dateTimeList.store.reset(this.FormatType===AscPDF.FormatType.DATE?this.dateFormats:this.timeFormats),this.dateTimeList.selectRecord(this.dateTimeList.store.at(this.FormatType===AscPDF.FormatType.DATE?1:0)),this.dateTimeList.scrollToRecord(this.dateTimeList.store.at(0)),this.inputCustomFormat.setVisible(!1)),this._examplePanel.toggleClass("hidden",this.FormatType===AscPDF.FormatType.SPECIAL||this.FormatType===AscPDF.FormatType.REGULAR||this.FormatType===AscPDF.FormatType.NONE),this.updateFormatExample()}},textTitle:"Format Settings",textCategory:"Category",textDecimal:"Decimal places",textSeparator:"Separator style",textSymbol:"Currency symbol",textLocation:"Symbol location",textNegative:"Negative number style",textParens:"Show parentheses",textRed:"Use red text",textFormat:"Format",textReg:"Regular expression",textMask:"Arbitrary Mask",textPhone:"Phone Number",textZipCode:"ZIP Code",textZipCode4:"ZIP Code + 4",textSSN:"Social Security Number",textNumber:"Number",txtCustom:"Custom",textDate:"Date",textTime:"Time",textPercent:"Percentage",textSpecial:"Special",txtSample:"Example:",textNone:"None",textBeforeSpace:"Before with space",textAfterSpace:"After with space",textBefore:"Before no space",textAfter:"After no space"},PDFE.Views.FormatSettingsDialog||{}))})),define("text!presentationeditor/main/app/template/ChartSettingsAdvanced.template",[],(function(){return'<div id="id-chart-settings-dlg-layout" class="settings-panel">\n    <div class="inner-content">\n        <table cols="2" style="width: 100%;">\n            <tr>\n                <td class="padding-small" width="50%">\n                    <label class="input-label"><%= scope.textChartTitle %></label>\n                    <div id="chart-dlg-combo-chart-title" class="input-group-nr margin-right-7"></div>\n                </td>\n                <td class="padding-small" width="50%">\n                    <label class="input-label margin-left-7"><%= scope.textLegendPos %></label>\n                    <div id="chart-dlg-combo-legend-pos" class="input-group-nr margin-left-7"></div>\n                </td>\n            </tr>\n            <tr>\n                <td class="padding-small" width="50%">\n                    <label class="input-label"><%= scope.textDataLabels %></label>\n                    <div id="chart-dlg-combo-data-labels" class="input-group-nr margin-right-7"></div>\n                </td>\n                <td rowspan="2" class="padding-small" width="50%">\n                    <div id="chart-dlg-check-series"></div>\n                    <div id="chart-dlg-check-category"></div>\n                    <div id="chart-dlg-check-value"></div>\n                </td>\n            </tr>\n            <tr>\n                <td class="padding-small" width="50%">\n                    <label class="input-label"><%= scope.textSeparator %></label>\n                    <div id="chart-dlg-txt-separator" class="input-row margin-right-7"></div>\n                </td>\n            </tr>\n            <tr>\n                <td width="50%">\n                    <label id="chart-dlg-label-lines" class="input-label"><%= scope.textLines %></label>\n                    <div id="chart-dlg-combo-lines" class="input-group-nr margin-right-7"></div>\n                </td>\n                <td style="vertical-align: bottom;" width="50%">\n                    <div id="chart-dlg-check-markers" class="margin-left-7"></div>\n                </td>\n            </tr>\n        </table>\n    </div>\n</div>\n<div id="id-chart-settings-dlg-vert" class="settings-panel">\n</div>\n<div id="id-chart-settings-dlg-vert-sec" class="settings-panel">\n</div>\n<div id="id-chart-settings-dlg-hor" class="settings-panel">\n</div>\n<div id="id-chart-settings-dlg-hor-sec" class="settings-panel">\n</div>\n<div id="id-adv-chart-general" class="settings-panel active">\n    <div class="inner-content">\n    <table cols="1" width="100%" role="presentation">\n        <tr>\n            <td class="padding-large">\n                <label class="header"><%= scope.textChartName %></label>\n                <div id="chart-advanced-name"></div>\n            </td>\n        </tr>\n    </table>\n    </div>\n</div>\n<div  id="id-adv-chart-placement" class="settings-panel active">\n    <div class="inner-content">\n        <table cols="3" role="presentation">\n            <tr>\n                <td colspan="4" width="88px" class="padding-small">\n                    <label class="header"><%= scope.textSize %></label>\n                </td>\n            </tr>\n            <tr>\n                <td width="93px" class="padding-large">\n                    <label class="input-label"><%= scope.textWidth %></label>\n                    <div id="chart-advanced-spin-width"></div>\n                </td>\n                <td width="28px" style="vertical-align: bottom;" class="padding-large">\n                    <div id="chart-advanced-button-ratio"></div>\n                </td>\n                <td width="93px" class="padding-large">\n                    <label class="input-label"><%= scope.textHeight %></label>\n                    <div id="chart-advanced-spin-height"></div>\n                </td>\n            </tr>\n        </table>\n    </div>\n    <div class="inner-content">\n        <table cols="2" style="width: 100%;" role="presentation">\n            <tr>\n                <td colspan="4" width="88px" class="padding-small">\n                    <label class="header"><%= scope.textPosition %></label>\n                </td>\n            </tr>\n            <tr>\n                <td class="padding-small" width="121px">\n                    <label class="input-label"><%= scope.textHorizontal %></label>\n                    <div id="chart-advanced-spin-x"></div>\n                </td>\n                <td class="padding-small">\n                    <label class="input-label"><%= scope.textFrom %></label>\n                    <div id="chart-advanced-combo-from-x"></div>\n                </td>\n            </tr>\n            <tr>\n                <td class="padding-small">\n                    <label class="input-label"><%= scope.textVertical %></label>\n                    <div id="chart-advanced-spin-y"></div>\n                </td>\n                <td class="padding-small">\n                    <label class="input-label"><%= scope.textFrom %></label>\n                    <div id="chart-advanced-combo-from-y"></div>\n                </td>\n            </tr>\n        </table>\n    </div>\n</div>\n<div id="id-adv-chart-alttext" class="settings-panel">\n    <div class="inner-content">\n        <table cols="1" width="100%" role="presentation">\n            <tr>\n                <td class="padding-large">\n                    <label class="header"><%= scope.textAltTitle %></label>\n                    <div id="chart-advanced-alt-title"></div>\n                </td>\n            </tr>\n            <tr>\n                <td>\n                    <label class="header"><%= scope.textAltDescription %></label>\n                    <textarea id="chart-advanced-alt-description" class="form-control" style="width: 100%; height: 70px;"></textarea>\n                </td>\n            </tr>\n            <tr>\n                <td>\n                    <label><%= scope.textAltTip %></label>\n                </td>\n            </tr>\n        </table>\n    </div>\n</div>'})),define("text!common/main/lib/template/ChartVertAxis.template",[],(function(){return'<div class="inner-content">\n    <table cols="2" style="width: 100%" role="presentation">\n        <tr>\n            <td colspan="2" class="padding-small">\n                <div id="chart-dlg-chk-vert-hide-<%=idx%>" class="input-group-nr"></div>\n            </td>\n        </tr>\n        <tr>\n            <td class="padding-large" width="50%">\n                <label class="input-label"><%= scope.textAxisTitle %></label>\n                <div id="chart-dlg-combo-vert-title-<%=idx%>" class="input-group-nr margin-right-7"></div>\n            </td>\n            <td class="padding-large" width="50%">\n                <label class="input-label margin-left-7"><%= scope.textGridLines %></label>\n                <div id="chart-dlg-combo-vert-grid-<%=idx%>" class="input-group-nr margin-left-7"></div>\n            </td>\n        </tr>\n    </table>\n    <table cols="3" style="width: 100%" role="presentation">\n        <tr>\n            <td class="padding-small" width="110">\n                <label class="input-label"><%= scope.textMinValue %></label>\n            </td>\n            <td class="padding-small padding-right-10" width="120">\n                <div id="chart-dlg-combo-mintype-<%=idx%>"></div>\n            </td>\n            <td class="padding-small" width="90">\n                <div id="chart-dlg-input-min-value-<%=idx%>"></div>\n            </td>\n        </tr>\n        <tr>\n            <td class="padding-small" width="110">\n                <label class="input-label"><%= scope.textMaxValue %></label>\n            </td>\n            <td class="padding-small padding-right-10" width="120">\n                <div id="chart-dlg-combo-maxtype-<%=idx%>"></div>\n            </td>\n            <td class="padding-small" width="90">\n                <div id="chart-dlg-input-max-value-<%=idx%>"></div>\n            </td>\n        </tr>\n        <tr>\n            <td class="padding-large" width="110">\n                <label class="input-label"><%= scope.textAxisCrosses %></label>\n            </td>\n            <td class="padding-large padding-right-10" width="120">\n                <div id="chart-dlg-combo-v-crosstype-<%=idx%>"></div>\n            </td>\n            <td class="padding-large" width="90">\n                <div id="chart-dlg-input-v-axis-crosses-<%=idx%>"></div>\n            </td>\n        </tr>\n    </table>\n    <table cols="2" role="presentation">\n        <tr>\n            <td class="padding-small padding-right-10" style="min-width: 110px;">\n                <label class="input-label"><%= scope.textUnits %></label>\n            </td>\n            <td class="padding-small padding-right-10" width="120>\n                <div id="chart-dlg-combo-units-<%=idx%>"></div>\n            </td>\n        </tr>\n    </table>\n</div>\n<div class="inner-content">\n    <table cols="2" style="width: 100%;" role="presentation">\n        <tr>\n            <td colspan=2 class="padding-small">\n                <div id="chart-dlg-check-v-reverse-<%=idx%>"></div>\n            </td>\n        </tr>\n        <tr>\n            <td class="padding-large">\n                <div id="chart-dlg-check-v-logscale-<%=idx%>"></div>\n            </td>\n            <td class="padding-large">\n                <div class="base float-right">\n                    <label class="input-label vertical-align-baseline"><%= scope.textBase %></label>\n                    <div id="chart-dlg-input-base-<%=idx%>" class="margin-left-5 vertical-align-baseline" style="display: inline-block;"></div>\n                </div>\n            </td>\n        </tr>\n    </table>\n</div>\n<div class="inner-content">\n    <table cols="2" style="width: 100%;" role="presentation">\n        <tr>\n            <td colspan=2 class="padding-small">\n                <label class="header"><%= scope.textTickOptions %></label>\n            </td>\n        </tr>\n        <tr>\n            <td class="padding-large" width="50%">\n                <label class="input-label"><%= scope.textMajorType %></label>\n                <div id="chart-dlg-combo-v-major-type-<%=idx%>" class="input-group-nr margin-right-7"></div>\n            </td>\n            <td class="padding-large" width="50%">\n                <label class="input-label margin-left-7"><%= scope.textMinorType %></label>\n                <div id="chart-dlg-combo-v-minor-type-<%=idx%>" class="input-group-nr margin-left-7"></div>\n            </td>\n        </tr>\n        <tr>\n            <td colspan=2 class="padding-small">\n                <label class="header"><%= scope.textLabelOptions %></label>\n            </td>\n        </tr>\n        <tr>\n            <td>\n                <label class="input-label"><%= scope.textLabelPos %></label>\n            </td>\n            <td>\n            </td>\n        </tr>\n        <tr>\n            <td width="50%">\n                <div id="chart-dlg-combo-v-label-pos-<%=idx%>" class="input-group-nr margin-right-7"></div>\n            </td>\n            <td width="50%">\n                <button type="button" class="btn btn-text-default auto margin-left-7" id="chart-dlg-btn-v-format-<%=idx%>" style="min-width: 100px;"><%= scope.textFormat %></button>\n            </td>\n        </tr>\n    </table>\n</div>'})),define("text!common/main/lib/template/ChartHorAxis.template",[],(function(){return'<div class="inner-content">\n    <table cols="2" style="width: 100%" role="presentation">\n        <tr>\n            <td colspan="2" class="padding-small">\n                <div id="chart-dlg-chk-hor-hide-<%=idx%>" class="input-group-nr"></div>\n            </td>\n        </tr>\n        <tr>\n            <td class="padding-large" width="50%">\n                <label class="input-label"><%= scope.textAxisTitle %></label>\n                <div id="chart-dlg-combo-hor-title-<%=idx%>" class="input-group-nr margin-right-7"></div>\n            </td>\n            <td class="padding-large" width="50%">\n                <label class="input-label margin-left-7"><%= scope.textGridLines %></label>\n                <div id="chart-dlg-combo-hor-grid-<%=idx%>" class="input-group-nr margin-left-7"></div>\n            </td>\n        </tr>\n    </table>\n    <table cols="3" style="width: 100%" role="presentation">\n        <tr>\n            <td class="padding-small" width="110">\n                <label class="input-label"><%= scope.textAxisCrosses %></label>\n            </td>\n            <td class="padding-small padding-right-10" width="120">\n                <div id="chart-dlg-combo-h-crosstype-<%=idx%>"></div>\n            </td>\n            <td class="padding-small" width="90">\n                <div id="chart-dlg-input-h-axis-crosses-<%=idx%>"></div>\n            </td>\n        </tr>\n        <tr>\n            <td class="padding-large" width="110">\n                <label class="input-label"><%= scope.textAxisPos %></label>\n            </td>\n            <td colspan=2 class="padding-large">\n                <div id="chart-dlg-combo-axis-pos-<%=idx%>" class="input-group-nr" style="width:140px;"></div>\n            </td>\n        </tr>\n        <tr>\n            <td colspan=3 class="padding-large">\n                <div id="chart-dlg-check-h-reverse-<%=idx%>"></div>\n            </td>\n        </tr>\n    </table>\n</div>\n<div class="inner-content">\n    <table cols="2" style="width: 100%;" role="presentation">\n        <tr>\n            <td colspan=2 class="padding-small">\n                <label class="header"><%= scope.textTickOptions %></label>\n            </td>\n        </tr>\n        <tr>\n            <td class="padding-small" width="50%">\n                <label class="input-label"><%= scope.textMajorType %></label>\n                <div id="chart-dlg-combo-h-major-type-<%=idx%>" class="input-group-nr margin-right-7"></div>\n            </td>\n            <td class="padding-small" width="50%">\n                <label class="input-label margin-left-7"><%= scope.textMinorType %></label>\n                <div id="chart-dlg-combo-h-minor-type-<%=idx%>" class="input-group-nr margin-left-7"></div>\n            </td>\n        </tr>\n        <tr>\n            <td width="100%" colspan="2">\n                <label class="input-label"><%= scope.textMarksInterval %></label>\n            </td>\n        </tr>\n        <tr>\n            <td class="padding-large" width="50%">\n                <div id="chart-dlg-input-marks-interval-<%=idx%>" class="margin-right-7"></div>\n            </td>\n            <td class="padding-large" width="50%">\n            </td>\n        </tr>\n    </table>\n</div>\n<div class="inner-content">\n    <table cols="2" style="width: 100%;" role="presentation">\n        <tr>\n            <td colspan=2 class="padding-small">\n                <label class="header"><%= scope.textLabelOptions %></label>\n            </td>\n        </tr>\n        <tr>\n            <td class="padding-small" width="50%">\n                <label class="input-label"><%= scope.textLabelPos %></label>\n                <div id="chart-dlg-combo-h-label-pos-<%=idx%>" class="input-group-nr margin-right-7"></div>\n            </td>\n            <td class="padding-small" width="50%">\n                <label class="input-label margin-left-7"><%= scope.textLabelDist %></label>\n                <div id="chart-dlg-input-label-dist-<%=idx%>" class="margin-left-7"></div>\n            </td>\n        </tr>\n        <tr>\n            <td width="100%" colspan="2">\n                <label class="input-label"><%= scope.textLabelInterval %></label>\n            </td>\n        </tr>\n        <tr>\n            <td width="100%" colspan="2">\n                <div id="chart-dlg-combo-label-int-<%=idx%>" class="input-group-nr" style="display: inline-block;width: 100px;vertical-align: middle;"></div>\n                <div id="chart-dlg-input-label-int-<%=idx%>" class="margin-left-3" style="display: inline-block;width: 60px;vertical-align: middle;"></div>\n                <button type="button" class="btn btn-text-default auto float-right margin-left-5" id="chart-dlg-btn-h-format-<%=idx%>" style="min-width:100px; vertical-align: middle;"><%= scope.textFormat %></button>\n            </td>\n        </tr>\n    </table>\n</div>'})),define("pdfeditor/main/app/view/ChartSettingsAdvanced",["text!presentationeditor/main/app/template/ChartSettingsAdvanced.template","text!common/main/lib/template/ChartVertAxis.template","text!common/main/lib/template/ChartHorAxis.template","common/main/lib/view/AdvancedSettingsWindow"],(function(t,e,i){"use strict";PDFE.Views.ChartSettingsAdvanced=Common.Views.AdvancedSettingsWindow.extend(_.extend({options:{contentWidth:340,contentHeight:450,toggleGroup:"chart-adv-settings-group",properties:null,chartSettings:null,storageName:"pe-chart-settings-adv-category",sizeMax:{width:55.88,height:55.88}},initialize:function(e){_.extend(this.options,{title:this.textTitle,items:[{panelId:"id-adv-chart-general",panelCaption:this.textGeneral},{panelId:"id-chart-settings-dlg-layout",panelCaption:this.textLayout},{panelId:"id-chart-settings-dlg-vert",panelCaption:this.textVertAxis},{panelId:"id-chart-settings-dlg-vert-sec",panelCaption:this.textVertAxisSec},{panelId:"id-chart-settings-dlg-hor",panelCaption:this.textHorAxis},{panelId:"id-chart-settings-dlg-hor-sec",panelCaption:this.textHorAxisSec},{panelId:"id-adv-chart-placement",panelCaption:this.textPlacement},{panelId:"id-adv-chart-alttext",panelCaption:this.textAlt}],contentTemplate:_.template(t)({scope:this})},e),Common.Views.AdvancedSettingsWindow.prototype.initialize.call(this,this.options),this.spinners=[],this.currentChartType=Asc.c_oAscChartTypeSettings.barNormal,this.chartSettings=this.options.chartSettings,this.vertAxisProps=[],this.vertAxisPropsIndexes=[],this.horAxisProps=[],this.horAxisPropsIndexes=[],this.currentAxisProps=[],this.api=this.options.api,this._originalProps=this.options.chartProps,this.slideSize=this.options.slideSize,this._changedProps=null},render:function(){Common.Views.AdvancedSettingsWindow.prototype.render.call(this);var t=this;this.inputChartName=new Common.UI.InputField({el:$("#chart-advanced-name"),allowBlank:!0,validateOnBlur:!1,style:"width: 100%;"}).on("changed:after",(function(){t.isChartNameChanged=!0})),this.spnWidth=new Common.UI.MetricSpinner({el:$("#chart-advanced-spin-width"),step:.1,width:85,defaultUnit:"cm",value:"3 cm",maxValue:55.88,minValue:0}),this.spnWidth.on("change",_.bind((function(t){if(this.btnRatio.pressed){var e=t.getNumberValue(),i=e/this._nRatio;i>this.sizeMax.height&&(e=(i=this.sizeMax.height)*this._nRatio,this.spnWidth.setValue(e,!0)),this.spnHeight.setValue(i,!0)}this._changedProps&&(this._changedProps.put_Width(Common.Utils.Metric.fnRecalcToMM(t.getNumberValue())),this._changedProps.put_Height(Common.Utils.Metric.fnRecalcToMM(this.spnHeight.getNumberValue())))}),this)),this.spinners.push(this.spnWidth),this.spnHeight=new Common.UI.MetricSpinner({el:$("#chart-advanced-spin-height"),step:.1,width:85,defaultUnit:"cm",value:"3 cm",maxValue:55.88,minValue:0}),this.spnHeight.on("change",_.bind((function(t,e,i,s){var n=t.getNumberValue(),a=null;this.btnRatio.pressed&&((a=n*this._nRatio)>this.sizeMax.width&&(n=(a=this.sizeMax.width)/this._nRatio,this.spnHeight.setValue(n,!0)),this.spnWidth.setValue(a,!0)),this._changedProps&&(this._changedProps.put_Height(Common.Utils.Metric.fnRecalcToMM(t.getNumberValue())),this._changedProps.put_Width(Common.Utils.Metric.fnRecalcToMM(this.spnWidth.getNumberValue())))}),this)),this.spinners.push(this.spnHeight),this.btnRatio=new Common.UI.Button({parentEl:$("#chart-advanced-button-ratio"),cls:"btn-toolbar",iconCls:"toolbar__icon btn-advanced-ratio",style:"margin-bottom: 1px;",enableToggle:!0,hint:this.textKeepRatio}),this.btnRatio.on("click",_.bind((function(t,e){t.pressed&&this.spnHeight.getNumberValue()>0&&(this._nRatio=this.spnWidth.getNumberValue()/this.spnHeight.getNumberValue()),this._changedProps&&this._changedProps.asc_putLockAspect(t.pressed)}),this)),this.spnX=new Common.UI.MetricSpinner({el:$("#chart-advanced-spin-x"),step:.1,width:85,defaultUnit:"cm",defaultValue:0,value:"0 cm",maxValue:55.87,minValue:-55.87}),this.spinners.push(this.spnX),this.spnY=new Common.UI.MetricSpinner({el:$("#chart-advanced-spin-y"),step:.1,width:85,defaultUnit:"cm",defaultValue:0,value:"0 cm",maxValue:55.87,minValue:-55.87}),this.spinners.push(this.spnY),this.cmbFromX=new Common.UI.ComboBox({el:$("#chart-advanced-combo-from-x"),cls:"input-group-nr",style:"width: 125px;",menuStyle:"min-width: 125px;",data:[{value:"left",displayValue:this.textTopLeftCorner},{value:"center",displayValue:this.textCenter}],editable:!1,takeFocusOnClose:!0}),this.cmbFromY=new Common.UI.ComboBox({el:$("#chart-advanced-combo-from-y"),cls:"input-group-nr",style:"width: 125px;",menuStyle:"min-width: 125px;",data:[{value:"left",displayValue:this.textTopLeftCorner},{value:"center",displayValue:this.textCenter}],editable:!1,takeFocusOnClose:!0}),this.inputAltTitle=new Common.UI.InputField({el:$("#chart-advanced-alt-title"),allowBlank:!0,validateOnBlur:!1,style:"width: 100%;"}).on("changed:after",(function(){t.isAltTitleChanged=!0})),this.textareaAltDescription=this.$window.find("textarea"),this.textareaAltDescription.keydown((function(e){e.keyCode==Common.UI.Keys.RETURN&&e.stopPropagation(),t.isAltDescChanged=!0})),this.cmbChartTitle=new Common.UI.ComboBox({el:$("#chart-dlg-combo-chart-title"),menuStyle:"min-width: 100%;",editable:!1,cls:"input-group-nr",data:[{value:Asc.c_oAscChartTitleShowSettings.none,displayValue:this.textNone},{value:Asc.c_oAscChartTitleShowSettings.overlay,displayValue:this.textOverlay},{value:Asc.c_oAscChartTitleShowSettings.noOverlay,displayValue:this.textNoOverlay}],takeFocusOnClose:!0}),this.cmbLegendPos=new Common.UI.ComboBox({el:$("#chart-dlg-combo-legend-pos"),menuStyle:"min-width: 100%;",editable:!1,cls:"input-group-nr",data:[{value:Asc.c_oAscChartLegendShowSettings.none,displayValue:this.textNone},{value:Asc.c_oAscChartLegendShowSettings.bottom,displayValue:this.textLegendBottom},{value:Asc.c_oAscChartLegendShowSettings.top,displayValue:this.textLegendTop},{value:Asc.c_oAscChartLegendShowSettings.right,displayValue:this.textLegendRight},{value:Asc.c_oAscChartLegendShowSettings.left,displayValue:this.textLegendLeft},{value:Asc.c_oAscChartLegendShowSettings.leftOverlay,displayValue:this.textLeftOverlay},{value:Asc.c_oAscChartLegendShowSettings.rightOverlay,displayValue:this.textRightOverlay}],takeFocusOnClose:!0}),this.cmbDataLabels=new Common.UI.ComboBox({el:$("#chart-dlg-combo-data-labels"),menuStyle:"min-width: 100%;",editable:!1,cls:"input-group-nr",data:[{value:Asc.c_oAscChartDataLabelsPos.none,displayValue:this.textNone},{value:Asc.c_oAscChartDataLabelsPos.ctr,displayValue:this.textCenter},{value:Asc.c_oAscChartDataLabelsPos.inBase,displayValue:this.textInnerBottom},{value:Asc.c_oAscChartDataLabelsPos.inEnd,displayValue:this.textInnerTop},{value:Asc.c_oAscChartDataLabelsPos.outEnd,displayValue:this.textOuterTop}],takeFocusOnClose:!0}),this.cmbDataLabels.on("selected",_.bind(t.onSelectDataLabels,this)),this.txtSeparator=new Common.UI.InputField({el:$("#chart-dlg-txt-separator"),name:"range",style:"width: 100%;",allowBlank:!0,blankError:this.txtEmpty}),this.chSeriesName=new Common.UI.CheckBox({el:$("#chart-dlg-check-series"),labelText:this.textSeriesName}),this.chCategoryName=new Common.UI.CheckBox({el:$("#chart-dlg-check-category"),labelText:this.textCategoryName}),this.chValue=new Common.UI.CheckBox({el:$("#chart-dlg-check-value"),labelText:this.textValue}),this.cmbLines=new Common.UI.ComboBox({el:$("#chart-dlg-combo-lines"),menuStyle:"min-width: 100%;",editable:!1,cls:"input-group-nr",data:[{value:0,displayValue:this.textNone},{value:1,displayValue:this.textStraight},{value:2,displayValue:this.textSmooth}],takeFocusOnClose:!0}).on("selected",_.bind((function(t,e){this.chartSettings&&(this.chartSettings.putLine(0!==e.value),e.value>0&&this.chartSettings.putSmooth(2==e.value))}),this)),this.chMarkers=new Common.UI.CheckBox({el:$("#chart-dlg-check-markers"),labelText:this.textMarkers}).on("change",_.bind((function(t,e){this.chartSettings&&this.chartSettings.putShowMarker("checked"==e)}),this)),this.lblLines=$("#chart-dlg-label-lines"),this.cmbMinType=[],this.spnMinValue=[],this.cmbMaxType=[],this.spnMaxValue=[],this.cmbVCrossType=[],this.spnVAxisCrosses=[],this.cmbUnits=[],this.chVReverse=[],this.cmbVMajorType=[],this.cmbVMinorType=[],this.cmbVLabelPos=[],this.cmbVertTitle=[],this.cmbVertGrid=[],this.chVertHide=[],this.btnVFormat=[],this.chVLogScale=[],this.spnBase=[],this._arrVertTitle=[{value:Asc.c_oAscChartVertAxisLabelShowSettings.none,displayValue:t.textNone},{value:Asc.c_oAscChartVertAxisLabelShowSettings.rotated,displayValue:t.textRotated},{value:Asc.c_oAscChartVertAxisLabelShowSettings.horizontal,displayValue:t.textHorizontal}],this.cmbHCrossType=[],this.cmbAxisPos=[],this.spnHAxisCrosses=[],this.chHReverse=[],this.cmbHMajorType=[],this.cmbHMinorType=[],this.spnMarksInterval=[],this.cmbHLabelPos=[],this.spnLabelDist=[],this.cmbLabelInterval=[],this.spnLabelInterval=[],this.cmbHorTitle=[],this.cmbHorGrid=[],this.chHorHide=[],this.btnHFormat=[],this._arrHorTitle=[{value:Asc.c_oAscChartHorAxisLabelShowSettings.none,displayValue:t.textNone},{value:Asc.c_oAscChartHorAxisLabelShowSettings.noOverlay,displayValue:t.textNoOverlay}],this.afterRender()},afterRender:function(){if(this.updateMetricUnit(),this._setDefaults(this._originalProps),this.storageName){var t=Common.localStorage.getItem(this.storageName);this.setActiveCategory(null!==t?parseInt(t):0),2==(t=this.getActiveCategory())||3==t?this.onVCategoryClick(t-2):4!=t&&5!=t||this.onHCategoryClick(t-4)}},onCategoryClick:function(t,e){Common.Views.AdvancedSettingsWindow.prototype.onCategoryClick.call(this,t,e);var i=this;setTimeout((function(){switch(e){case 0:i.inputChartName.focus();break;case 1:i.cmbChartTitle.focus();break;case 2:case 3:e-=2;var t=i.vertAxisPropsIndexes[e];i.onVCategoryClick(e),i.vertAxisProps[e].getAxisType()===Asc.c_oAscAxisType.val?i.cmbMinType[t].focus():i.cmbHCrossType[t].isDisabled()?i.btnHFormat[t].focus():i.cmbHCrossType[t].focus();break;case 4:case 5:e-=4;t=i.horAxisPropsIndexes[e];i.onHCategoryClick(e),i.horAxisProps[e].getAxisType()===Asc.c_oAscAxisType.val?i.cmbMinType[t].focus():i.cmbHCrossType[t].isDisabled()?i.btnHFormat[t].focus():i.cmbHCrossType[t].focus();break;case 6:i.spnWidth.focus();break;case 7:i.inputAltTitle.focus()}}),10)},_setDefaults:function(t){if(Common.UI.FocusManager.add(this,this.btnsCategory),t){var e=t.asc_getName();if(this.inputChartName.setValue(e||""),this.spnWidth.setMaxValue(this.sizeMax.width),this.spnHeight.setMaxValue(this.sizeMax.height),this.spnWidth.setValue(Common.Utils.Metric.fnRecalcFromMM(t.asc_getWidth()).toFixed(2),!0),this.spnHeight.setValue(Common.Utils.Metric.fnRecalcFromMM(t.asc_getHeight()).toFixed(2),!0),t.asc_getHeight()>0&&(this._nRatio=t.asc_getWidth()/t.asc_getHeight()),e=t.asc_getLockAspect(),this.btnRatio.toggle(e),this.cmbFromX.setValue("left"),this.cmbFromY.setValue("left"),t.asc_getPosition()){var i={X:t.asc_getPosition().get_X(),Y:t.asc_getPosition().get_Y()};this.spnX.setValue(null!=i.X?Common.Utils.Metric.fnRecalcFromMM(i.X):"",!0),this.spnY.setValue(null!=i.Y?Common.Utils.Metric.fnRecalcFromMM(i.Y):"",!0)}else this.spnX.setValue("",!0),this.spnY.setValue("",!0);e=t.asc_getTitle(),this.inputAltTitle.setValue(e||""),e=t.asc_getDescription(),this.textareaAltDescription.val(e||""),Common.UI.FocusManager.add(this,[this.inputChartName]),this._setChartDefaults(this.chartSettings),this._changedProps=new Asc.CAscChartProp,Common.UI.FocusManager.add(this,[this.spnWidth,this.btnRatio,this.spnHeight,this.spnX,this.cmbFromX,this.spnY,this.cmbFromY,this.inputAltTitle,this.textareaAltDescription])}Common.UI.FocusManager.add(this,this.getFooterButtons())},getSettings:function(){var t=new Asc.CPosition;if(this.isChartNameChanged&&this._changedProps.asc_putName(this.inputChartName.getValue()),""!==this.spnX.getValue()){var e=Common.Utils.Metric.fnRecalcToMM(this.spnX.getNumberValue());"center"===this.cmbFromX.getValue()&&(e=this.slideSize.width/36e3/2+e),t.put_X(e)}if(""!==this.spnY.getValue()){var i=Common.Utils.Metric.fnRecalcToMM(this.spnY.getNumberValue());"center"===this.cmbFromY.getValue()&&(i=this.slideSize.height/36e3/2+i),t.put_Y(i)}this._changedProps.asc_putPosition(t),this.isAltTitleChanged&&this._changedProps.asc_putTitle(this.inputAltTitle.getValue()),this.isAltDescChanged&&this._changedProps.asc_putDescription(this.textareaAltDescription.val());var s=this.currentChartType;this.chartSettings.putType(s),this.chartSettings.putTitle(this.cmbChartTitle.getValue()),this.chartSettings.putLegendPos(this.cmbLegendPos.getValue()),this.chartSettings.putDataLabelsPos(this.cmbDataLabels.getValue()),this.chartSettings.putShowSerName("checked"==this.chSeriesName.getValue()),this.chartSettings.putShowCatName("checked"==this.chCategoryName.getValue()),this.chartSettings.putShowVal("checked"==this.chValue.getValue()),this.chartSettings.putSeparator(_.isEmpty(this.txtSeparator.getValue())?" ":this.txtSeparator.getValue()),this.chMarkers.isVisible()&&this.chartSettings.putShowMarker("checked"==this.chMarkers.getValue());var n=s==Asc.c_oAscChartTypeSettings.lineNormal||s==Asc.c_oAscChartTypeSettings.lineStacked||s==Asc.c_oAscChartTypeSettings.lineStackedPer||s==Asc.c_oAscChartTypeSettings.lineNormalMarker||s==Asc.c_oAscChartTypeSettings.lineStackedMarker||s==Asc.c_oAscChartTypeSettings.lineStackedPerMarker||s==Asc.c_oAscChartTypeSettings.scatter||s==Asc.c_oAscChartTypeSettings.scatterSmoothMarker||s==Asc.c_oAscChartTypeSettings.scatterSmooth||s==Asc.c_oAscChartTypeSettings.scatterLineMarker||s==Asc.c_oAscChartTypeSettings.scatterLine;return n&&(n=this.cmbLines.getValue(),this.chartSettings.putLine(0!==n),n>0&&this.chartSettings.putSmooth(2==n)),this._changedProps.put_ChartProperties(this.chartSettings),{chartProps:this._changedProps}},_setChartDefaults:function(t){if(t){this.currentChartType=t.getType(),this.cmbChartTitle.setValue(t.getTitle()),this.cmbLegendPos.setValue(t.getLegendPos()),this.updateDataLabels(this.currentChartType,t.getDataLabelsPos()),this.cmbDataLabels.setDisabled(this.currentChartType==Asc.c_oAscChartTypeSettings.surfaceNormal||this.currentChartType==Asc.c_oAscChartTypeSettings.surfaceWireframe),this.chSeriesName.setValue(this.chartSettings.getShowSerName(),!0),this.chCategoryName.setValue(this.chartSettings.getShowCatName(),!0),this.chValue.setValue(this.chartSettings.getShowVal(),!0);var e=t.getSeparator();if(this.txtSeparator.setValue(e||""),Common.UI.FocusManager.add(this,[this.cmbChartTitle,this.cmbLegendPos,this.cmbDataLabels,this.chSeriesName,this.chCategoryName,this.chValue,this.txtSeparator,this.cmbLines,this.chMarkers]),this.vertAxisProps=t.getVertAxesProps(),this.vertAxisProps.length>0){var i=this.$window.find("#id-chart-settings-dlg-vert");this.vertAxisPropsIndexes[0]=this.vertAxisProps[0].getAxisType()===Asc.c_oAscAxisType.val?this.addControlsV(i):this.addControlsH(i)}if(this.vertAxisProps.length>1){i=this.$window.find("#id-chart-settings-dlg-vert-sec");this.vertAxisPropsIndexes[1]=this.vertAxisProps[1].getAxisType()===Asc.c_oAscAxisType.val?this.addControlsV(i):this.addControlsH(i)}if(this.horAxisProps=t.getHorAxesProps(),this.horAxisProps.length>0){i=this.$window.find("#id-chart-settings-dlg-hor");this.horAxisPropsIndexes[0]=this.horAxisProps[0].getAxisType()===Asc.c_oAscAxisType.val?this.addControlsV(i):this.addControlsH(i)}if(this.horAxisProps.length>1){i=this.$window.find("#id-chart-settings-dlg-hor-sec");this.horAxisPropsIndexes[1]=this.horAxisProps[1].getAxisType()===Asc.c_oAscAxisType.val?this.addControlsV(i):this.addControlsH(i)}this.updateAxisProps(this.currentChartType)}},addControlsV:function(t){var i=this,s=i.chVertHide.length,n=$(_.template(e)({scope:i,idx:s}));return t.append(n),i.chVertHide[s]=new Common.UI.CheckBox({el:$("#chart-dlg-chk-vert-hide-"+s),labelText:i.textHideAxis}).on("change",_.bind((function(t,e){i.currentAxisProps[s]&&i.currentAxisProps[s].putShow("checked"!==e)}),i)),Common.UI.FocusManager.add(this,i.chVertHide[s]),i.cmbVertTitle[s]=new Common.UI.ComboBox({el:$("#chart-dlg-combo-vert-title-"+s),menuStyle:"min-width: 100%;",editable:!1,cls:"input-group-nr",data:i._arrVertTitle,takeFocusOnClose:!0}).on("selected",_.bind((function(t,e){i.currentAxisProps[s]&&i.currentAxisProps[s].putLabel(e.value)}),i)),Common.UI.FocusManager.add(this,i.cmbVertTitle[s]),i.cmbVertGrid[s]=new Common.UI.ComboBox({el:$("#chart-dlg-combo-vert-grid-"+s),menuStyle:"min-width: 100%;",editable:!1,cls:"input-group-nr",data:[{value:Asc.c_oAscGridLinesSettings.none,displayValue:i.textNone},{value:Asc.c_oAscGridLinesSettings.major,displayValue:i.textMajor},{value:Asc.c_oAscGridLinesSettings.minor,displayValue:i.textMinor},{value:Asc.c_oAscGridLinesSettings.majorMinor,displayValue:i.textMajorMinor}],takeFocusOnClose:!0}).on("selected",_.bind((function(t,e){i.currentAxisProps[s]&&i.currentAxisProps[s].putGridlines(e.value)}),i)),Common.UI.FocusManager.add(this,i.cmbVertGrid[s]),i.cmbMinType[s]=new Common.UI.ComboBox({el:$("#chart-dlg-combo-mintype-"+s),cls:"input-group-nr",menuStyle:"min-width: 100%;",editable:!1,data:[{displayValue:i.textAuto,value:Asc.c_oAscValAxisRule.auto},{displayValue:i.textFixed,value:Asc.c_oAscValAxisRule.fixed}],takeFocusOnClose:!0}).on("selected",_.bind((function(t,e){i.currentAxisProps[s]&&(i.currentAxisProps[s].putMinValRule(e.value),e.value==Asc.c_oAscValAxisRule.auto&&i.spnMinValue[s].setValue(i._originalAxisVValues[s].minAuto,!0))}),i)),Common.UI.FocusManager.add(this,i.cmbMinType[s]),i.spnMinValue[s]=new Common.UI.MetricSpinner({el:$("#chart-dlg-input-min-value-"+s),maxValue:1e6,minValue:-1e6,step:.1,defaultUnit:"",defaultValue:0,value:""}).on("change",_.bind((function(t,e,n){i.cmbMinType[s].suspendEvents(),i.cmbMinType[s].setValue(Asc.c_oAscValAxisRule.fixed),i.cmbMinType[s].resumeEvents(),i.currentAxisProps[s]&&(i.currentAxisProps[s].putMinValRule(Asc.c_oAscValAxisRule.fixed),i.currentAxisProps[s].putMinVal(t.getNumberValue()))}),i)),Common.UI.FocusManager.add(this,i.spnMinValue[s]),i.cmbMaxType[s]=new Common.UI.ComboBox({el:$("#chart-dlg-combo-maxtype-"+s),cls:"input-group-nr",menuStyle:"min-width: 100%;",editable:!1,data:[{displayValue:i.textAuto,value:Asc.c_oAscValAxisRule.auto},{displayValue:i.textFixed,value:Asc.c_oAscValAxisRule.fixed}],takeFocusOnClose:!0}).on("selected",_.bind((function(t,e){i.currentAxisProps[s]&&(i.currentAxisProps[s].putMaxValRule(e.value),e.value==Asc.c_oAscValAxisRule.auto&&i.spnMaxValue[s].setValue(i._originalAxisVValues[s].maxAuto,!0))}),i)),Common.UI.FocusManager.add(this,i.cmbMaxType[s]),i.spnMaxValue[s]=new Common.UI.MetricSpinner({el:$("#chart-dlg-input-max-value-"+s),maxValue:1e6,minValue:-1e6,step:.1,defaultUnit:"",defaultValue:0,value:""}).on("change",_.bind((function(t,e,n){i.cmbMaxType[s].suspendEvents(),i.cmbMaxType[s].setValue(Asc.c_oAscValAxisRule.fixed),i.cmbMaxType[s].resumeEvents(),i.currentAxisProps[s]&&(i.currentAxisProps[s].putMaxValRule(Asc.c_oAscValAxisRule.fixed),i.currentAxisProps[s].putMaxVal(t.getNumberValue()))}),i)),Common.UI.FocusManager.add(this,i.spnMaxValue[s]),i.cmbVCrossType[s]=new Common.UI.ComboBox({el:$("#chart-dlg-combo-v-crosstype-"+s),cls:"input-group-nr",menuStyle:"min-width: 100%;",editable:!1,data:[{displayValue:i.textAuto,value:Asc.c_oAscCrossesRule.auto},{displayValue:i.textValue,value:Asc.c_oAscCrossesRule.value},{displayValue:i.textMinValue,value:Asc.c_oAscCrossesRule.minValue},{displayValue:i.textMaxValue,value:Asc.c_oAscCrossesRule.maxValue}],takeFocusOnClose:!0}).on("selected",_.bind((function(t,e){if(i.currentAxisProps[s])switch(i.currentAxisProps[s].putCrossesRule(e.value),e.value){case Asc.c_oAscCrossesRule.minValue:i.spnVAxisCrosses[s].setValue(i.spnMinValue[s].getNumberValue(),!0);break;case Asc.c_oAscCrossesRule.maxValue:i.spnVAxisCrosses[s].setValue(i.spnMaxValue[s].getNumberValue(),!0);break;case Asc.c_oAscCrossesRule.auto:i.spnVAxisCrosses[s].setValue(i._originalAxisVValues[s].crossesAuto,!0)}}),i)),Common.UI.FocusManager.add(this,i.cmbVCrossType[s]),i.spnVAxisCrosses[s]=new Common.UI.MetricSpinner({el:$("#chart-dlg-input-v-axis-crosses-"+s),maxValue:1e6,minValue:-1e6,step:.1,defaultUnit:"",defaultValue:0,value:""}).on("change",_.bind((function(t,e,n){i.cmbVCrossType[s].suspendEvents(),i.cmbVCrossType[s].setValue(Asc.c_oAscCrossesRule.value),i.cmbVCrossType[s].resumeEvents(),i.currentAxisProps[s]&&(i.currentAxisProps[s].putCrossesRule(Asc.c_oAscCrossesRule.value),i.currentAxisProps[s].putCrosses(t.getNumberValue()))}),i)),Common.UI.FocusManager.add(this,i.spnVAxisCrosses[s]),i.cmbUnits[s]=new Common.UI.ComboBox({el:$("#chart-dlg-combo-units-"+s),cls:"input-group-nr",menuStyle:"min-width: 100%;",editable:!1,data:[{displayValue:i.textNone,value:Asc.c_oAscValAxUnits.none},{displayValue:i.textHundreds,value:Asc.c_oAscValAxUnits.HUNDREDS},{displayValue:i.textThousands,value:Asc.c_oAscValAxUnits.THOUSANDS},{displayValue:i.textTenThousands,value:Asc.c_oAscValAxUnits.TEN_THOUSANDS},{displayValue:i.textHundredThousands,value:Asc.c_oAscValAxUnits.HUNDRED_THOUSANDS},{displayValue:i.textMillions,value:Asc.c_oAscValAxUnits.MILLIONS},{displayValue:i.textTenMillions,value:Asc.c_oAscValAxUnits.TEN_MILLIONS},{displayValue:i.textHundredMil,value:Asc.c_oAscValAxUnits.HUNDRED_MILLIONS},{displayValue:i.textBillions,value:Asc.c_oAscValAxUnits.BILLIONS},{displayValue:i.textTrillions,value:Asc.c_oAscValAxUnits.TRILLIONS}],takeFocusOnClose:!0}).on("selected",_.bind((function(t,e){i.currentAxisProps[s]&&i.currentAxisProps[s].putDispUnitsRule(e.value)}),i)),Common.UI.FocusManager.add(this,i.cmbUnits[s]),i.chVReverse[s]=new Common.UI.CheckBox({el:$("#chart-dlg-check-v-reverse-"+s),labelText:i.textReverse}).on("change",_.bind((function(t,e){i.currentAxisProps[s]&&i.currentAxisProps[s].putInvertValOrder("checked"==e)}),i)),Common.UI.FocusManager.add(this,i.chVReverse[s]),i.cmbVMajorType[s]=new Common.UI.ComboBox({el:$("#chart-dlg-combo-v-major-type-"+s),cls:"input-group-nr",menuStyle:"min-width: 100%;",editable:!1,data:[{displayValue:i.textNone,value:Asc.c_oAscTickMark.TICK_MARK_NONE},{displayValue:i.textCross,value:Asc.c_oAscTickMark.TICK_MARK_CROSS},{displayValue:i.textIn,value:Asc.c_oAscTickMark.TICK_MARK_IN},{displayValue:i.textOut,value:Asc.c_oAscTickMark.TICK_MARK_OUT}],takeFocusOnClose:!0}).on("selected",_.bind((function(t,e){i.currentAxisProps[s]&&i.currentAxisProps[s].putMajorTickMark(e.value)}),i)),Common.UI.FocusManager.add(this,i.cmbVMajorType[s]),i.cmbVMinorType[s]=new Common.UI.ComboBox({el:$("#chart-dlg-combo-v-minor-type-"+s),cls:"input-group-nr",menuStyle:"min-width: 100%;",editable:!1,data:[{displayValue:i.textNone,value:Asc.c_oAscTickMark.TICK_MARK_NONE},{displayValue:i.textCross,value:Asc.c_oAscTickMark.TICK_MARK_CROSS},{displayValue:i.textIn,value:Asc.c_oAscTickMark.TICK_MARK_IN},{displayValue:i.textOut,value:Asc.c_oAscTickMark.TICK_MARK_OUT}],takeFocusOnClose:!0}).on("selected",_.bind((function(t,e){i.currentAxisProps[s]&&i.currentAxisProps[s].putMinorTickMark(e.value)}),i)),Common.UI.FocusManager.add(this,i.cmbVMinorType[s]),i.cmbVLabelPos[s]=new Common.UI.ComboBox({el:$("#chart-dlg-combo-v-label-pos-"+s),cls:"input-group-nr",menuStyle:"min-width: 100%;",editable:!1,data:[{displayValue:i.textNone,value:Asc.c_oAscTickLabelsPos.TICK_LABEL_POSITION_NONE},{displayValue:i.textLow,value:Asc.c_oAscTickLabelsPos.TICK_LABEL_POSITION_LOW},{displayValue:i.textHigh,value:Asc.c_oAscTickLabelsPos.TICK_LABEL_POSITION_HIGH},{displayValue:i.textNextToAxis,value:Asc.c_oAscTickLabelsPos.TICK_LABEL_POSITION_NEXT_TO}],takeFocusOnClose:!0}).on("selected",_.bind((function(t,e){i.currentAxisProps[s]&&i.currentAxisProps[s].putTickLabelsPos(e.value)}),i)),Common.UI.FocusManager.add(this,i.cmbVLabelPos[s]),i.btnVFormat[s]=new Common.UI.Button({el:$("#chart-dlg-btn-v-format-"+s)}).on("click",_.bind(i.openFormat,i,s)),Common.UI.FocusManager.add(this,i.btnVFormat[s]),i.chVLogScale[s]=new Common.UI.CheckBox({el:$("#chart-dlg-check-v-logscale-"+s),labelText:i.textLogScale}).on("change",_.bind((function(t,e){i.currentAxisProps[s]&&(i.currentAxisProps[s].putLogScale("checked"==e),"checked"==e&&i.currentAxisProps[s].putLogBase(i.spnBase[s].getNumberValue())),i.spnBase[s].setDisabled("checked"!==e)}),i)),Common.UI.FocusManager.add(this,i.chVLogScale[s]),i.spnBase[s]=new Common.UI.MetricSpinner({el:$("#chart-dlg-input-base-"+s),maxValue:1e3,minValue:2,step:1,defaultUnit:"",value:10}).on("change",_.bind((function(t,e,n){i.currentAxisProps[s]&&i.currentAxisProps[s].putLogBase(t.getNumberValue())}),i)),Common.UI.FocusManager.add(this,i.spnBase[s]),s},addControlsH:function(t){var e=this,s=e.chHorHide.length,n=$(_.template(i)({scope:e,idx:s}));return t.append(n),e.chHorHide[s]=new Common.UI.CheckBox({el:$("#chart-dlg-chk-hor-hide-"+s),labelText:e.textHideAxis}).on("change",_.bind((function(t,i){e.currentAxisProps[s]&&e.currentAxisProps[s].putShow("checked"!==i)}),e)),Common.UI.FocusManager.add(this,e.chHorHide[s]),e.cmbHorTitle[s]=new Common.UI.ComboBox({el:$("#chart-dlg-combo-hor-title-"+s),menuStyle:"min-width: 100%;",editable:!1,cls:"input-group-nr",data:e._arrHorTitle,takeFocusOnClose:!0}).on("selected",_.bind((function(t,i){e.currentAxisProps[s]&&e.currentAxisProps[s].putLabel(i.value)}),e)),Common.UI.FocusManager.add(this,e.cmbHorTitle[s]),e.cmbHorGrid[s]=new Common.UI.ComboBox({el:$("#chart-dlg-combo-hor-grid-"+s),menuStyle:"min-width: 100%;",editable:!1,cls:"input-group-nr",data:[{value:Asc.c_oAscGridLinesSettings.none,displayValue:e.textNone},{value:Asc.c_oAscGridLinesSettings.major,displayValue:e.textMajor},{value:Asc.c_oAscGridLinesSettings.minor,displayValue:e.textMinor},{value:Asc.c_oAscGridLinesSettings.majorMinor,displayValue:e.textMajorMinor}],takeFocusOnClose:!0}).on("selected",_.bind((function(t,i){e.currentAxisProps[s]&&e.currentAxisProps[s].putGridlines(i.value)}),e)),Common.UI.FocusManager.add(this,e.cmbHorGrid[s]),e.cmbHCrossType[s]=new Common.UI.ComboBox({el:$("#chart-dlg-combo-h-crosstype-"+s),cls:"input-group-nr",menuStyle:"min-width: 100%;",editable:!1,data:[{displayValue:e.textAuto,value:Asc.c_oAscCrossesRule.auto},{displayValue:e.textValue,value:Asc.c_oAscCrossesRule.value},{displayValue:e.textMinValue,value:Asc.c_oAscCrossesRule.minValue},{displayValue:e.textMaxValue,value:Asc.c_oAscCrossesRule.maxValue}],takeFocusOnClose:!0}).on("selected",_.bind((function(t,i){e.currentAxisProps[s]&&(e.currentAxisProps[s].putCrossesRule(i.value),i.value==Asc.c_oAscCrossesRule.auto?e.spnHAxisCrosses[s].setValue(e._originalAxisHValues[s].crossesAuto,!0):i.value==Asc.c_oAscCrossesRule.minValue?e.spnHAxisCrosses[s].setValue(e._originalAxisHValues[s].minAuto,!0):i.value==Asc.c_oAscCrossesRule.maxValue&&e.spnHAxisCrosses[s].setValue(e._originalAxisHValues[s].maxAuto,!0))}),e)),Common.UI.FocusManager.add(this,e.cmbHCrossType[s]),e.spnHAxisCrosses[s]=new Common.UI.MetricSpinner({el:$("#chart-dlg-input-h-axis-crosses-"+s),maxValue:1e6,minValue:-1e6,step:.1,defaultUnit:"",defaultValue:0,value:""}).on("change",_.bind((function(t,i,n){e.cmbHCrossType[s].suspendEvents(),e.cmbHCrossType[s].setValue(Asc.c_oAscCrossesRule.value),e.cmbHCrossType[s].resumeEvents(),e.currentAxisProps[s]&&(e.currentAxisProps[s].putCrossesRule(Asc.c_oAscCrossesRule.value),e.currentAxisProps[s].putCrosses(t.getNumberValue()))}),e)),Common.UI.FocusManager.add(this,e.spnHAxisCrosses[s]),e.cmbAxisPos[s]=new Common.UI.ComboBox({el:$("#chart-dlg-combo-axis-pos-"+s),cls:"input-group-nr",menuStyle:"min-width: 100%;",editable:!1,data:[{displayValue:e.textOnTickMarks,value:Asc.c_oAscLabelsPosition.byDivisions},{displayValue:e.textBetweenTickMarks,value:Asc.c_oAscLabelsPosition.betweenDivisions}],takeFocusOnClose:!0}).on("selected",_.bind((function(t,i){e.currentAxisProps[s]&&e.currentAxisProps[s].putLabelsPosition(i.value)}),e)),Common.UI.FocusManager.add(this,e.cmbAxisPos[s]),e.chHReverse[s]=new Common.UI.CheckBox({el:$("#chart-dlg-check-h-reverse-"+s),labelText:e.textReverse}).on("change",_.bind((function(t,i){e.currentAxisProps[s]&&e.currentAxisProps[s].putInvertCatOrder("checked"==i)}),e)),Common.UI.FocusManager.add(this,e.chHReverse[s]),e.cmbHMajorType[s]=new Common.UI.ComboBox({el:$("#chart-dlg-combo-h-major-type-"+s),cls:"input-group-nr",menuStyle:"min-width: 100%;",editable:!1,data:[{displayValue:e.textNone,value:Asc.c_oAscTickMark.TICK_MARK_NONE},{displayValue:e.textCross,value:Asc.c_oAscTickMark.TICK_MARK_CROSS},{displayValue:e.textIn,value:Asc.c_oAscTickMark.TICK_MARK_IN},{displayValue:e.textOut,value:Asc.c_oAscTickMark.TICK_MARK_OUT}],takeFocusOnClose:!0}).on("selected",_.bind((function(t,i){e.currentAxisProps[s]&&e.currentAxisProps[s].putMajorTickMark(i.value)}),e)),Common.UI.FocusManager.add(this,e.cmbHMajorType[s]),e.cmbHMinorType[s]=new Common.UI.ComboBox({el:$("#chart-dlg-combo-h-minor-type-"+s),cls:"input-group-nr",menuStyle:"min-width: 100%;",editable:!1,data:[{displayValue:e.textNone,value:Asc.c_oAscTickMark.TICK_MARK_NONE},{displayValue:e.textCross,value:Asc.c_oAscTickMark.TICK_MARK_CROSS},{displayValue:e.textIn,value:Asc.c_oAscTickMark.TICK_MARK_IN},{displayValue:e.textOut,value:Asc.c_oAscTickMark.TICK_MARK_OUT}],takeFocusOnClose:!0}).on("selected",_.bind((function(t,i){e.currentAxisProps[s]&&e.currentAxisProps[s].putMinorTickMark(i.value)}),e)),Common.UI.FocusManager.add(this,e.cmbHMinorType[s]),e.spnMarksInterval[s]=new Common.UI.MetricSpinner({el:$("#chart-dlg-input-marks-interval-"+s),width:"auto",maxValue:1e6,minValue:1,step:1,defaultUnit:"",value:""}).on("change",_.bind((function(t,i,n){e.currentAxisProps[s]&&e.currentAxisProps[s].putIntervalBetweenTick(t.getNumberValue())}),e)),Common.UI.FocusManager.add(this,e.spnMarksInterval[s]),e.cmbHLabelPos[s]=new Common.UI.ComboBox({el:$("#chart-dlg-combo-h-label-pos-"+s),cls:"input-group-nr",menuStyle:"min-width: 100%;",editable:!1,data:[{displayValue:e.textNone,value:Asc.c_oAscTickLabelsPos.TICK_LABEL_POSITION_NONE},{displayValue:e.textLow,value:Asc.c_oAscTickLabelsPos.TICK_LABEL_POSITION_LOW},{displayValue:e.textHigh,value:Asc.c_oAscTickLabelsPos.TICK_LABEL_POSITION_HIGH},{displayValue:e.textNextToAxis,value:Asc.c_oAscTickLabelsPos.TICK_LABEL_POSITION_NEXT_TO}],takeFocusOnClose:!0}).on("selected",_.bind((function(t,i){e.currentAxisProps[s]&&e.currentAxisProps[s].putTickLabelsPos(i.value)}),e)),Common.UI.FocusManager.add(this,e.cmbHLabelPos[s]),e.spnLabelDist[s]=new Common.UI.MetricSpinner({el:$("#chart-dlg-input-label-dist-"+s),width:"auto",maxValue:1e3,minValue:0,step:1,defaultUnit:"",value:""}).on("change",_.bind((function(t,i,n){e.currentAxisProps[s]&&e.currentAxisProps[s].putLabelsAxisDistance(t.getNumberValue())}),e)),Common.UI.FocusManager.add(this,e.spnLabelDist[s]),e.spnLabelInterval[s]=new Common.UI.MetricSpinner({el:$("#chart-dlg-input-label-int-"+s),width:60,maxValue:1e6,minValue:1,step:1,defaultUnit:"",value:""}).on("change",_.bind((function(t,i,n){e.cmbLabelInterval[s].suspendEvents(),e.cmbLabelInterval[s].setValue(Asc.c_oAscBetweenLabelsRule.manual),e.cmbLabelInterval[s].resumeEvents(),e.currentAxisProps[s]&&(e.currentAxisProps[s].putIntervalBetweenLabelsRule(Asc.c_oAscBetweenLabelsRule.manual),e.currentAxisProps[s].putIntervalBetweenLabels(t.getNumberValue()))}),e)),Common.UI.FocusManager.add(this,e.spnLabelInterval[s]),e.cmbLabelInterval[s]=new Common.UI.ComboBox({el:$("#chart-dlg-combo-label-int-"+s),cls:"input-group-nr",menuStyle:"min-width: 100%;",editable:!1,data:[{displayValue:e.textAuto,value:Asc.c_oAscBetweenLabelsRule.auto},{displayValue:e.textManual,value:Asc.c_oAscBetweenLabelsRule.manual}],takeFocusOnClose:!0}).on("selected",_.bind((function(t,i){e.currentAxisProps[s]&&(e.currentAxisProps[s].putIntervalBetweenLabelsRule(i.value),i.value==Asc.c_oAscBetweenLabelsRule.auto&&e.spnLabelInterval[s].setValue(1,!0))}),e)),Common.UI.FocusManager.add(this,e.cmbLabelInterval[s]),e.btnHFormat[s]=new Common.UI.Button({el:$("#chart-dlg-btn-h-format-"+s)}).on("click",_.bind(e.openFormat,e,s)),Common.UI.FocusManager.add(this,e.btnHFormat[s]),s},updateAxisProps:function(t,e){var i=t==Asc.c_oAscChartTypeSettings.lineNormal||t==Asc.c_oAscChartTypeSettings.lineStacked||t==Asc.c_oAscChartTypeSettings.lineStackedPer||t==Asc.c_oAscChartTypeSettings.lineNormalMarker||t==Asc.c_oAscChartTypeSettings.lineStackedMarker||t==Asc.c_oAscChartTypeSettings.lineStackedPerMarker||t==Asc.c_oAscChartTypeSettings.scatter||t==Asc.c_oAscChartTypeSettings.scatterSmoothMarker||t==Asc.c_oAscChartTypeSettings.scatterSmooth||t==Asc.c_oAscChartTypeSettings.scatterLineMarker||t==Asc.c_oAscChartTypeSettings.scatterLine;this.chMarkers.setVisible(i),this.cmbLines.setVisible(i),this.lblLines.toggleClass("hidden",!i),i&&(this.chMarkers.setValue(this.chartSettings.getShowMarker(),!0),this.cmbLines.setValue(this.chartSettings.getLine()?this.chartSettings.getSmooth()?2:1:0)),i=t==Asc.c_oAscChartTypeSettings.pie||t==Asc.c_oAscChartTypeSettings.doughnut||t==Asc.c_oAscChartTypeSettings.pie3d,this.btnsCategory[2].setDisabled(i),this.btnsCategory[3].setDisabled(i),this.btnsCategory[4].setDisabled(i),this.btnsCategory[5].setDisabled(i),this.btnsCategory[2].setVisible(this.vertAxisProps.length>0),this.btnsCategory[3].setVisible(this.vertAxisProps.length>1),this.btnsCategory[4].setVisible(this.horAxisProps.length>0),this.btnsCategory[5].setVisible(this.horAxisProps.length>1),i=t==Asc.c_oAscChartTypeSettings.barNormal3d||t==Asc.c_oAscChartTypeSettings.barStacked3d||t==Asc.c_oAscChartTypeSettings.barStackedPer3d||t==Asc.c_oAscChartTypeSettings.hBarNormal3d||t==Asc.c_oAscChartTypeSettings.hBarStacked3d||t==Asc.c_oAscChartTypeSettings.hBarStackedPer3d||t==Asc.c_oAscChartTypeSettings.barNormal3dPerspective;for(var s=0;s<this.cmbAxisPos.length;s++)this.cmbAxisPos[s].setDisabled(i)},updateDataLabels:function(t,e){if(t!==this.currentChartType){var i=[{value:Asc.c_oAscChartDataLabelsPos.none,displayValue:this.textNone},{value:Asc.c_oAscChartDataLabelsPos.ctr,displayValue:this.textCenter}];t==Asc.c_oAscChartTypeSettings.barNormal||t==Asc.c_oAscChartTypeSettings.hBarNormal?i.push({value:Asc.c_oAscChartDataLabelsPos.inBase,displayValue:this.textInnerBottom},{value:Asc.c_oAscChartDataLabelsPos.inEnd,displayValue:this.textInnerTop},{value:Asc.c_oAscChartDataLabelsPos.outEnd,displayValue:this.textOuterTop}):t==Asc.c_oAscChartTypeSettings.barStacked||t==Asc.c_oAscChartTypeSettings.barStackedPer||t==Asc.c_oAscChartTypeSettings.hBarStacked||t==Asc.c_oAscChartTypeSettings.hBarStackedPer?i.push({value:Asc.c_oAscChartDataLabelsPos.inBase,displayValue:this.textInnerBottom},{value:Asc.c_oAscChartDataLabelsPos.inEnd,displayValue:this.textInnerTop}):t==Asc.c_oAscChartTypeSettings.lineNormal||t==Asc.c_oAscChartTypeSettings.lineStacked||t==Asc.c_oAscChartTypeSettings.lineStackedPer||t==Asc.c_oAscChartTypeSettings.lineNormalMarker||t==Asc.c_oAscChartTypeSettings.lineStackedMarker||t==Asc.c_oAscChartTypeSettings.lineStackedPerMarker||t==Asc.c_oAscChartTypeSettings.stock||t==Asc.c_oAscChartTypeSettings.scatter||t==Asc.c_oAscChartTypeSettings.scatterSmoothMarker||t==Asc.c_oAscChartTypeSettings.scatterSmooth||t==Asc.c_oAscChartTypeSettings.scatterLineMarker||t==Asc.c_oAscChartTypeSettings.scatterLine?i.push({value:Asc.c_oAscChartDataLabelsPos.l,displayValue:this.textLeft},{value:Asc.c_oAscChartDataLabelsPos.r,displayValue:this.textRight},{value:Asc.c_oAscChartDataLabelsPos.t,displayValue:this.textTop},{value:Asc.c_oAscChartDataLabelsPos.b,displayValue:this.textBottom}):t!=Asc.c_oAscChartTypeSettings.pie&&t!=Asc.c_oAscChartTypeSettings.pie3d||i.push({value:Asc.c_oAscChartDataLabelsPos.bestFit,displayValue:this.textFit},{value:Asc.c_oAscChartDataLabelsPos.inEnd,displayValue:this.textInnerTop},{value:Asc.c_oAscChartDataLabelsPos.outEnd,displayValue:this.textOuterTop}),this.cmbDataLabels.setData(i)}void 0!==e?this.cmbDataLabels.store.findWhere({value:e})||(e=Asc.c_oAscChartDataLabelsPos.ctr):e=Asc.c_oAscChartDataLabelsPos.none;this.cmbDataLabels.setValue(e),this.onSelectDataLabels(this.cmbDataLabels,{value:e})},onVCategoryClick:function(t){this.vertAxisProps[t].getAxisType()==Asc.c_oAscAxisType.val?this.fillVProps(this.vertAxisProps[t],this.vertAxisPropsIndexes[t]):this.fillHProps(this.vertAxisProps[t],this.vertAxisPropsIndexes[t],!0)},onHCategoryClick:function(t){this.horAxisProps[t].getAxisType()==Asc.c_oAscAxisType.val?this.fillVProps(this.horAxisProps[t],this.horAxisPropsIndexes[t],!0):this.fillHProps(this.horAxisProps[t],this.horAxisPropsIndexes[t])},fillVProps:function(t,e,i){if(t.getAxisType()===Asc.c_oAscAxisType.val){null==this._originalAxisVValues&&(this._originalAxisVValues=[]),null==this._originalAxisVValues[e]&&(this._originalAxisVValues[e]={minAuto:null==t.getMinVal()?0:t.getMinVal(),maxAuto:null==t.getMaxVal()?10:t.getMaxVal(),crossesAuto:null==t.getCrosses()?0:t.getCrosses()}),this.chVertHide[e].setValue(!t.getShow()),this.cmbVertGrid[e].setValue(t.getGridlines()),this.cmbVertTitle[e].setData(i?this._arrHorTitle:this._arrVertTitle),this.cmbVertTitle[e].setValue(t.getLabel()),this.cmbVertTitle[e].setDisabled(!!t.isRadarAxis()),this.cmbMinType[e].setValue(t.getMinValRule());var s=t.getMinValRule()==Asc.c_oAscValAxisRule.auto?this._originalAxisVValues[e].minAuto:t.getMinVal();switch(this.spnMinValue[e].setValue(null==s?"":s,!0),this.cmbMaxType[e].setValue(t.getMaxValRule()),s=t.getMaxValRule()==Asc.c_oAscValAxisRule.auto?this._originalAxisVValues[e].maxAuto:t.getMaxVal(),this.spnMaxValue[e].setValue(null==s?"":s,!0),s=t.getCrossesRule(),this.cmbVCrossType[e].setValue(s),s){case Asc.c_oAscCrossesRule.minValue:s=this.spnMinValue[e].getNumberValue();break;case Asc.c_oAscCrossesRule.maxValue:s=this.spnMaxValue[e].getNumberValue();break;case Asc.c_oAscCrossesRule.auto:s=this._originalAxisVValues[e].crossesAuto;break;default:s=t.getCrosses()}this.spnVAxisCrosses[e].setValue(null==s?"":s,!0),this.cmbUnits[e].setValue(t.getDispUnitsRule()),this.chVReverse[e].setValue(t.getInvertValOrder(),!0),this.cmbVMajorType[e].setValue(t.getMajorTickMark()),this.cmbVMinorType[e].setValue(t.getMinorTickMark()),this.cmbVLabelPos[e].setValue(t.getTickLabelsPos()),s=t.getLogScale(),this.chVLogScale[e].setValue(!!s,!0),this.spnBase[e].setDisabled(!s),s&&this.spnBase[e].setValue(t.getLogBase(),!0),this.currentAxisProps[e]=t}},fillHProps:function(t,e,i){if(t.getAxisType()===Asc.c_oAscAxisType.cat){null==this._originalAxisHValues&&(this._originalAxisHValues=[]),null==this._originalAxisHValues[e]&&(this._originalAxisHValues[e]={minAuto:null==t.getCrossMinVal()?0:t.getCrossMinVal(),maxAuto:null==t.getCrossMaxVal()?10:t.getCrossMaxVal(),crossesAuto:null==t.getCrosses()?0:t.getCrosses()}),this.chHorHide[e].setValue(!t.getShow()),this.cmbHorGrid[e].setValue(t.getGridlines()),this.cmbHorTitle[e].setData(i?this._arrVertTitle:this._arrHorTitle),this.cmbHorTitle[e].setValue(t.getLabel());var s=t.getCrossesRule();switch(this.cmbHCrossType[e].setValue(s),s){case Asc.c_oAscCrossesRule.minValue:s=this._originalAxisHValues[e].minAuto;break;case Asc.c_oAscCrossesRule.maxValue:s=this._originalAxisHValues[e].maxAuto;break;case Asc.c_oAscCrossesRule.auto:s=this._originalAxisHValues[e].crossesAuto;break;default:s=t.getCrosses()}this.spnHAxisCrosses[e].setValue(null==s?"":s,!0),this.cmbAxisPos[e].setValue(t.getLabelsPosition()),this.chHReverse[e].setValue(t.getInvertCatOrder(),!0),this.cmbHMajorType[e].setValue(t.getMajorTickMark()),this.cmbHMinorType[e].setValue(t.getMinorTickMark()),this.spnMarksInterval[e].setValue(t.getIntervalBetweenTick(),!0),this.cmbHLabelPos[e].setValue(t.getTickLabelsPos()),this.spnLabelDist[e].setValue(t.getLabelsAxisDistance(),!0),s=t.getIntervalBetweenLabelsRule(),this.cmbLabelInterval[e].setValue(s),this.spnLabelInterval[e].setValue(s===Asc.c_oAscBetweenLabelsRule.manual?t.getIntervalBetweenLabels():1,!0),s=!!t.isRadarAxis(),this.chHorHide[e].setDisabled(s),this.cmbHorTitle[e].setDisabled(s),this.cmbHorGrid[e].setDisabled(s),this.cmbHCrossType[e].setDisabled(s),this.spnHAxisCrosses[e].setDisabled(s),this.chHReverse[e].setDisabled(s),this.cmbHMajorType[e].setDisabled(s),this.cmbHMinorType[e].setDisabled(s),this.spnMarksInterval[e].setDisabled(s),this.cmbHLabelPos[e].setDisabled(s),this.spnLabelDist[e].setDisabled(s),this.cmbLabelInterval[e].setDisabled(s),this.spnLabelInterval[e].setDisabled(s);var n=this.currentChartType;s=!!t.isRadarAxis()||n==Asc.c_oAscChartTypeSettings.barNormal3d||n==Asc.c_oAscChartTypeSettings.barStacked3d||n==Asc.c_oAscChartTypeSettings.barStackedPer3d||n==Asc.c_oAscChartTypeSettings.hBarNormal3d||n==Asc.c_oAscChartTypeSettings.hBarStacked3d||n==Asc.c_oAscChartTypeSettings.hBarStackedPer3d||n==Asc.c_oAscChartTypeSettings.barNormal3dPerspective,this.cmbAxisPos[e].setDisabled(s),this.currentAxisProps[e]=t}},onSelectDataLabels:function(t,e,i){var s=e.value==Asc.c_oAscChartDataLabelsPos.none;this.chSeriesName.setDisabled(s),this.chCategoryName.setDisabled(s),this.chValue.setDisabled(s),this.txtSeparator.setDisabled(s),s||"checked"===this.chSeriesName.getValue()||"checked"===this.chCategoryName.getValue()||"checked"===this.chValue.getValue()||this.chValue.setValue("checked",!0)},openFormat:function(t,e){var i=this,s=i.currentAxisProps[t].getNumFmt(),n=Common.Utils.InternalSettings.get("de-config-lang"),a=new Common.Views.FormatSettingsDialog({api:i.api,handler:function(t,e){"ok"==t&&e&&(s.putSourceLinked(e.linked),s.putFormatCode(e.format),i.chartSettings.endEditData(),i._isEditFormat=!1)},linked:!0,props:{format:s.getFormatCode(),formatInfo:s.getFormatCellsInfo(),langId:n,chartFormat:s}}).on("close",(function(){i._isEditFormat&&i.chartSettings.cancelEditData(),i._isEditFormat=!1,e.focus()}));i._isEditFormat=!0,i.chartSettings.startEditData(),a.show()},updateMetricUnit:function(){if(this.spinners)for(var t=0;t<this.spinners.length;t++){var e=this.spinners[t];e.setDefaultUnit(Common.Utils.Metric.getCurrentMetricName()),e.setStep(Common.Utils.Metric.getCurrentMetric()==Common.Utils.Metric.c_MetricUnits.pt?1:.1)}this.sizeMax={width:Common.Utils.Metric.fnRecalcFromMM(10*this.options.sizeMax.width),height:Common.Utils.Metric.fnRecalcFromMM(10*this.options.sizeMax.height)}},close:function(){this.api&&this.api.asc_onCloseFrameEditor(),Common.Views.AdvancedSettingsWindow.prototype.close.apply(this,arguments)},textTitle:"Chart - Advanced Settings",textAlt:"Alternative Text",textAltTitle:"Title",textAltDescription:"Description",textAltTip:"The alternative text-based representation of the visual object information, which will be read to the people with vision or cognitive impairments to help them better understand what information there is in the image, autoshape, chart or table.",textPlacement:"Placement",textSize:"Size",textWidth:"Width",textHeight:"Height",textPosition:"Position",textHorizontal:"Horizontal",textVertical:"Vertical",textFrom:"From",textTopLeftCorner:"Top Left Corner",textCenter:"Center",textKeepRatio:"Constant Proportions",textGeneral:"General",textChartName:"Chart name",textLegendBottom:"Bottom",textLegendTop:"Top",textLegendRight:"Right",textLegendLeft:"Left",textChartTitle:"Chart Title",textLayout:"Layout",textLegendPos:"Legend",textDataLabels:"Data Labels",textSeparator:"Data Labels Separator",textSeriesName:"Series Name",textCategoryName:"Category Name",textValue:"Value",textMinValue:"Minimum Value",textMaxValue:"Maximum Value",textAxisCrosses:"Axis Crosses",textUnits:"Display Units",textTickOptions:"Tick Options",textMajorType:"Major Type",textMinorType:"Minor Type",textLabelOptions:"Label Options",textLabelPos:"Label Position",textReverse:"Values in reverse order",textVertAxis:"Vertical Axis",textHorAxis:"Horizontal Axis",textMarksInterval:"Interval between Marks",textLabelDist:"Axis Label Distance",textLabelInterval:"Interval between Labels",textAxisPos:"Axis Position",textLeftOverlay:"Left Overlay",textRightOverlay:"Right Overlay",textOverlay:"Overlay",textNoOverlay:"No Overlay",textRotated:"Rotated",textInnerBottom:"Inner Bottom",textInnerTop:"Inner Top",textOuterTop:"Outer Top",textNone:"None",textFixed:"Fixed",textAuto:"Auto",textCross:"Cross",textIn:"In",textOut:"Out",textLow:"Low",textHigh:"High",textNextToAxis:"Next to axis",textHundreds:"Hundreds",textThousands:"Thousands",textTenThousands:"10 000",textHundredThousands:"100 000",textMillions:"Millions",textTenMillions:"10 000 000",textHundredMil:"100 000 000",textBillions:"Billions",textTrillions:"Trillions",textCustom:"Custom",textManual:"Manual",textBetweenTickMarks:"Between Tick Marks",textOnTickMarks:"On Tick Marks",textLines:"Lines",textMarkers:"Markers",textMajor:"Major",textMinor:"Minor",textMajorMinor:"Major and Minor",textStraight:"Straight",textSmooth:"Smooth",textGridLines:"Gridlines",textFit:"Fit Width",textVertAxisSec:"Secondary Vertical Axis",textHorAxisSec:"Secondary Horizontal Axis",textAxisTitle:"Title",textHideAxis:"Hide axis",textFormat:"Label format",textBase:"Base",textLogScale:"Logarithmic Scale"},PDFE.Views.ChartSettingsAdvanced||{}))})),require(["common/main/lib/util/define","common/main/lib/controller/ScreenReaderFocus","common/main/lib/component/ComboBoxDataView","common/main/lib/view/AdvancedSettingsWindow","common/main/lib/view/AutoCorrectDialog","common/main/lib/view/DocumentAccessDialog","common/main/lib/view/SaveAsDlg","common/main/lib/view/CopyWarningDialog","common/main/lib/view/SelectFileDlg","common/main/lib/view/SymbolTableDialog","common/main/lib/view/InsertTableDialog","common/main/lib/view/SearchDialog","common/main/lib/view/RenameDialog","common/main/lib/view/ExternalEditor","common/main/lib/view/ExternalDiagramEditor","common/main/lib/view/FormatSettingsDialog","common/main/lib/view/PluginDlg","common/main/lib/view/PluginPanel","common/main/lib/view/ShapeShadowDialog","common/main/lib/view/TextInputDialog","common/main/lib/view/DocumentHolderExt","common/main/lib/view/ListSettingsDialog","common/main/lib/view/ExternalLinksDlg","common/main/lib/view/CustomizeQuickAccessDialog","common/main/lib/view/PasswordDialog","common/main/lib/component/TextareaField","common/main/lib/view/ShortcutsDialog","common/main/lib/view/ShortcutsEditDialog","pdfeditor/main/app/controller/DocumentHolderExt","pdfeditor/main/app/view/FileMenuPanels","pdfeditor/main/app/view/DocumentHolderExt","pdfeditor/main/app/view/FormsTab","pdfeditor/main/app/view/FormSettings","pdfeditor/main/app/view/ParagraphSettingsAdvanced","pdfeditor/main/app/view/ImageSettingsAdvanced","pdfeditor/main/app/view/HyperlinkSettingsDialog","pdfeditor/main/app/view/ShapeSettingsAdvanced","pdfeditor/main/app/view/TableSettingsAdvanced","pdfeditor/main/app/view/FormatSettingsDialog","pdfeditor/main/app/view/ChartSettingsAdvanced"],(function(){Common.NotificationCenter.trigger("app-pack:loaded")})),define("../apps/pdfeditor/main/app_pack.js",(function(){}));